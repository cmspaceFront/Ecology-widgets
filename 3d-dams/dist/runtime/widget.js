/*! For license information please see widget.js.LICENSE.txt */
System.register(["jimu-core","jimu-core/react","jimu-core/react-dom"],(function(e,t){var n={},r={},i={};return Object.defineProperty(r,"__esModule",{value:!0}),{setters:[function(e){n.jsx=e.jsx},function(e){Object.keys(e).forEach((function(t){r[t]=e[t]}))},function(e){i.createPortal=e.createPortal,i.unstable_batchedUpdates=e.unstable_batchedUpdates}],execute:function(){e((()=>{var e,t,a={3722:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),a=n(3645),o=n.n(a)()(i());o.push([e.id,".reservoir-scene-container{background-color:#f7f7f7;box-sizing:border-box;overflow:hidden;position:relative;width:100%;height:100%;min-height:100%}.dark-theme .reservoir-scene-container{background-color:#10111b}.reservoir-scene-container.fullscreen{position:fixed;top:0;left:0;right:0;bottom:0;z-index:40;height:100%}.reservoir-scene-container.normal{position:relative;width:100%;height:100%;grid-column:span 4;grid-row:span 1;border-radius:8px}.loading-container{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex;flex-direction:column;align-items:center;gap:20px;background:rgba(0,0,0,0);padding:32px 40px;color:#2c3e50;z-index:1000;min-width:280px}.dark-theme .loading-container{background:rgba(0,0,0,0);color:#e0e0e0}.error-message{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);width:90%;max-width:480px;z-index:1000}.error-content{background:rgba(255,255,255,.98);backdrop-filter:blur(20px);padding:48px 36px;border-radius:24px;text-align:center;border:none;animation:errorFadeIn .4s ease-out;position:relative;overflow:hidden}.dark .error-content{background:#161723;border:none}.dark-theme .error-content{background:#161723;border:none}@keyframes errorFadeIn{from{opacity:0;transform:translateY(-10px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}.error-title{font-size:20px;font-weight:600;color:#2c3e50;margin-bottom:12px;line-height:1.4;letter-spacing:-0.01em}.dark .error-title{color:#fff}.dark-theme .error-title{color:#fff}.error-description{color:#5f6368;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:360px;margin-left:auto;margin-right:auto}.dark .error-description{color:rgba(255,255,255,.75)}.dark-theme .error-description{color:rgba(255,255,255,.75)}.reservoir-status-message{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;padding:24px 32px;min-width:240px;max-width:90%;text-align:center;background:rgba(255,255,255,.94);color:#1f2933;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,.12);border:1px solid rgba(255,255,255,.25);backdrop-filter:blur(18px);z-index:1000}.dark-theme .reservoir-status-message{background:rgba(16,17,27,.94);color:#f5f5f5;border:1px solid rgba(255,255,255,.12);box-shadow:0 8px 32px rgba(0,0,0,.4)}.reservoir-status-title,.reservoir-status-subtitle{color:inherit}.loading-text{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0}.loading-text-visible{font-size:16px;font-weight:600;color:#1a1a1a;text-align:center;margin:0}.dark-theme .loading-text-visible{color:#e0e0e0}.loading-subtext{font-size:13px;color:#666;text-align:center;margin:0;opacity:.8}.dark-theme .loading-subtext{color:#a0a0a0}.loading-spinner-modern{position:relative;width:64px;height:64px;display:flex;align-items:center;justify-content:center}.loading-spinner-modern .spinner-ring{position:absolute;width:100%;height:100%;border:3px solid rgba(0,0,0,0);border-top-color:#4a90e2;border-radius:50%;animation:spin-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite}.loading-spinner-modern .spinner-ring:nth-child(1){width:64px;height:64px;border-top-color:#4a90e2;animation-delay:0s}.loading-spinner-modern .spinner-ring:nth-child(2){width:48px;height:48px;border-top-color:#5ba3ff;animation-delay:-0.4s}.loading-spinner-modern .spinner-ring:nth-child(3){width:32px;height:32px;border-top-color:#7bb8ff;animation-delay:-0.8s}.dark-theme .loading-spinner-modern .spinner-ring:nth-child(1){border-top-color:#0078d4}.dark-theme .loading-spinner-modern .spinner-ring:nth-child(2){border-top-color:#40a9ff}.dark-theme .loading-spinner-modern .spinner-ring:nth-child(3){border-top-color:#69c0ff}@keyframes spin-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.rotation-button{position:absolute;bottom:56px;right:8px;width:40px;height:40px;background-color:#e5e7eb;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background-color 200ms;border:none;cursor:pointer}.dark-theme .rotation-button{background-color:#3a3a3a}.rotation-button:hover{background-color:#d1d5db}.dark-theme .rotation-button:hover{background-color:#4a4a4a}.button-icon-container{width:12px;height:12px;display:flex;align-items:center;justify-content:center}.pause-icon{display:flex;gap:2px}.pause-line{width:2px;height:12px;background-color:#4b5563;border-radius:1px}.dark-theme .pause-line{background-color:#e0e0e0}.play-icon{width:0;height:0;border-left:6px solid #4b5563;border-top:4px solid rgba(0,0,0,0);border-bottom:4px solid rgba(0,0,0,0);margin-left:2px}.dark-theme .play-icon{border-left-color:#e0e0e0}.error-icon-wrapper{display:flex;justify-content:center;align-items:center;margin-bottom:24px;position:relative}.error-icon-svg{width:80px;height:80px;color:#4a90e2;opacity:.9;animation:iconPulse 2s ease-in-out infinite;filter:drop-shadow(0 4px 8px rgba(74, 144, 226, 0.2))}.dark .error-icon-svg{color:#40a9ff;filter:drop-shadow(0 4px 8px rgba(64, 169, 255, 0.3))}.dark-theme .error-icon-svg{color:#40a9ff;filter:drop-shadow(0 4px 8px rgba(64, 169, 255, 0.3))}@keyframes iconPulse{0%,100%{transform:scale(1);opacity:.9}50%{transform:scale(1.05);opacity:1}}",""]);const s=o},8418:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),a=n(3645),o=n.n(a)()(i());o.push([e.id,'.line-chart-modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:10000;backdrop-filter:blur(4px)}.dark-theme.line-chart-modal-overlay{background:rgba(0,0,0,.7)}.line-chart-modal{background:#fff;border-radius:24px;box-shadow:0 4px 20px rgba(0,0,0,.15);width:928px;height:614px;overflow:hidden;animation:modalSlideIn .3s ease-out}.dark-theme .line-chart-modal{background:#1a1a1a;box-shadow:0 4px 20px rgba(0,0,0,.4)}@keyframes modalSlideIn{from{opacity:0;transform:scale(0.9) translateY(-20px)}to{opacity:1;transform:scale(1) translateY(0)}}.line-chart-header{display:flex;justify-content:space-between;align-items:center;padding:18px 24px;background:#fff;height:60px;box-sizing:border-box}.dark-theme .line-chart-header{background:#1a1a1a;border-bottom:1px solid #333}.download-button{display:flex;align-items:center;gap:8px;background:#fff;color:#000;border:none;padding:8px 16px;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.dark-theme .download-button{background:#2d2d2d;color:#e0e0e0}.download-button:hover{background:#fff}.dark-theme .download-button:hover{background:#3a3a3a}.download-icon{font-size:16px}.close-button{background:none;border:none;font-size:20px;color:#666;cursor:pointer;padding:4px 8px;border-radius:4px;transition:all .2s ease}.dark-theme .close-button{color:#a0a0a0}.close-button:hover{background:#f0f0f0;color:#333}.dark-theme .close-button:hover{background:#3a3a3a;color:#e0e0e0}.line-chart-content{padding:20px;background:#fff;height:calc(100% - 60px);display:flex;flex-direction:column}.dark-theme .line-chart-content{background:#1a1a1a}.profile-metadata{display:flex;gap:20px;margin-bottom:20px;padding:12px 16px;background:#f8f9fa;border-radius:8px;border-left:4px solid #0078d4}.dark-theme .profile-metadata{background:#2d2d2d;border-left:4px solid #0078d4}.metadata-item{display:flex;flex-direction:column;gap:4px}.metadata-label{font-size:12px;color:#666;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.dark-theme .metadata-label{color:#a0a0a0}.metadata-value{font-size:16px;font-weight:bold;color:#333}.dark-theme .metadata-value{color:#e0e0e0}.recharts-wrapper{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.recharts-cartesian-axis-tick-value{fill:#666;font-size:12px}.dark-theme .recharts-cartesian-axis-tick-value{fill:#a0a0a0}.recharts-cartesian-grid-horizontal line,.recharts-cartesian-grid-vertical line{stroke:#e0e0e0;stroke-dasharray:3 3}.dark-theme .recharts-cartesian-grid-horizontal line,.dark-theme .recharts-cartesian-grid-vertical line{stroke:#404040}.recharts-tooltip-wrapper{outline:none}.line-chart-loading,.line-chart-empty-state{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;background:rgba(255,255,255,.92);color:#333;font-size:16px;font-weight:500;z-index:5;border-radius:16px;text-align:center;padding:0 32px}.line-chart-loading.dark,.line-chart-empty-state.dark{background:rgba(0,0,0,.72);color:#e0e0e0}.line-chart-loader-orbit{position:relative;width:92px;height:92px;display:flex;align-items:center;justify-content:center}.line-chart-loader-orbit span{position:absolute;width:100%;height:100%;border-radius:50%;border:2px solid rgba(0,120,212,.25);animation:lineChartOrbit 1.8s linear infinite}.line-chart-loader-orbit span:nth-child(2){width:70px;height:70px;border-color:rgba(0,120,212,.45);animation-delay:-0.4s}.line-chart-loader-orbit span:nth-child(3){width:48px;height:48px;border-color:rgba(0,120,212,.85);animation-delay:-0.8s;box-shadow:0 0 12px rgba(0,120,212,.4)}.line-chart-loading.dark .line-chart-loader-orbit span{border-color:rgba(0,183,255,.35);box-shadow:0 0 14px rgba(0,183,255,.45)}.line-chart-loader-text{display:flex;flex-direction:column;gap:4px;text-align:center;color:inherit}.line-chart-loader-text strong{font-size:18px;letter-spacing:.3px}.line-chart-loader-text span{font-size:14px;opacity:.8}.line-chart-empty-state p{margin:0;line-height:1.5}@keyframes lineChartOrbit{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@media(max-width: 1024px){.line-chart-modal{width:90%;max-width:928px;height:auto;max-height:614px}}@media(max-width: 768px){.line-chart-modal{width:95%;height:auto;margin:20px}.line-chart-header{padding:12px 16px}.line-chart-content{padding:16px}.download-button{padding:6px 12px;font-size:13px}}',""]);const s=o},5131:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),a=n(3645),o=n.n(a)()(i());o.push([e.id,'.type1-component{position:relative;width:100%;height:100%;display:flex;flex-direction:column;background:#f8f9fa;overflow:hidden}.type1-component.dark{background:#10111b}.type1-layout{width:100%;height:100%;position:relative}.drawing-tools{position:absolute;top:20px;right:20px;z-index:1000;display:flex;flex-direction:column;gap:12px}.icon-button{background:rgba(255,255,255,.95);border:1px solid rgba(0,0,0,.1);border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;font-size:16px;cursor:pointer;transition:all .2s ease;backdrop-filter:blur(10px);color:#2c3e50;box-shadow:0 2px 8px rgba(0,0,0,.1)}.dark .icon-button{background:#1f2030;border:1px solid #555;color:#e0e0e0}.icon-button:hover{background:#fff;border-color:#4a90e2;color:#4a90e2;transform:scale(1.1);box-shadow:0 4px 12px rgba(74,144,226,.3)}.dark .icon-button:hover{background:#3c3c3c;border-color:#0078d4;color:#0078d4}.icon-button.active{background:#fff;color:#4a90e2;border-color:#4a90e2;transform:scale(1.1);box-shadow:0 4px 12px rgba(74,144,226,.3)}.dark .icon-button.active{background:#1f2030;color:#0078d4;border-color:#0078d4;transform:scale(1.1)}.icon-button.edit-mode{background:#ff9800;color:#fff;border-color:#ff9800}.dark .icon-button.edit-mode{background:#ff9800;color:#fff;border-color:#ff9800}.icon-button.edit-mode:hover{background:#f57c00}.icon-button.delete-icon{background:#ef5350;color:#fff;border-color:#ef5350}.dark .icon-button.delete-icon{background:#dc3545;color:#fff;border-color:#dc3545}.icon-button.delete-icon:hover{background:#e53935}.dark .icon-button.delete-icon:hover{background:#c82333}.icon-button.active:hover{background:#fff;color:#4a90e2;border-color:#4a90e2;transform:scale(1.1);box-shadow:0 4px 12px rgba(74,144,226,.3)}.dark .icon-button.active:hover{background:#3c3c3c;color:#0078d4;border-color:#0078d4;transform:scale(1.1)}.icon-button.spinning{animation:pulse 1s ease-in-out infinite alternate}.icon-button.disabled{opacity:.45;cursor:not-allowed;border-color:rgba(0,0,0,.1);background:rgba(255,255,255,.7);transform:none}.icon-button.disabled:hover{background:rgba(255,255,255,.7);border-color:rgba(0,0,0,.1);transform:none}.dark .icon-button.disabled{background:rgba(45,45,45,.7);border-color:#3a3a3a}.dark .icon-button.disabled:hover{background:rgba(45,45,45,.7);border-color:#3a3a3a;transform:none}@keyframes pulse{from{background:#4a90e2;transform:scale(1)}to{background:#357abd;transform:scale(1.05)}}.container-3d{position:absolute;top:0;left:0;width:100%;height:100%;background:#f5f7fa;overflow:hidden;cursor:default}.container-3d.drawing-mode{cursor:crosshair}.container-3d.edit-mode{cursor:pointer}.container-3d.edit-mode:active{cursor:grabbing}.dark .container-3d{background:#10111b}.container-3d.drawing-mode{cursor:crosshair}.container-3d.edit-mode{cursor:grab}.container-3d.edit-mode:active{cursor:grabbing}.container-3d.drawing-mode .drawing-mode-message{position:absolute;top:10px;left:50%;transform:translateX(-50%);background:rgba(74,144,226,.95);color:#fff;padding:8px 16px;border-radius:4px;font-size:14px;z-index:100;pointer-events:none}.dark .container-3d.drawing-mode .drawing-mode-message{background:rgba(0,120,212,.9)}.container-3d.edit-mode::after{content:"✏️ Edit Mode - Drag points to adjust the line";position:absolute;top:10px;left:50%;transform:translateX(-50%);background:rgba(255,152,0,.95);color:#fff;padding:8px 16px;border-radius:4px;font-size:14px;z-index:100;pointer-events:none}.dark .container-3d.edit-mode::after{background:rgba(255,102,0,.9)}.container-3d.spinning-mode{cursor:not-allowed}.integrated-chart-section{position:absolute;bottom:20px;right:20px;width:clamp(360px,42vw,900px);height:clamp(240px,38vh,500px);max-width:calc(100% - 40px);max-height:calc(100% - 40px);background:rgba(255,255,255,.9);backdrop-filter:blur(10px);border:1px solid rgba(0,0,0,.1);border-radius:16px;display:flex;flex-direction:column;padding:0;box-sizing:border-box;box-shadow:0 8px 32px rgba(0,0,0,.15);z-index:100;overflow:hidden}.integrated-chart-section.dark{background:rgba(26,32,46,.78);border:1px solid rgba(255,255,255,.1);box-shadow:0 8px 32px rgba(0,0,0,.5);backdrop-filter:blur(10px)}.chart-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;flex-shrink:0;z-index:100;border-bottom:1px solid rgba(0,0,0,.08)}.dark .chart-header{border-bottom:1px solid rgba(255,255,255,.08)}.chart-title{font-size:14px;font-weight:500;color:#2c3e50;margin:0;display:flex;align-items:center;gap:8px}.dark .chart-title{color:#fff}.chart-actions{display:flex;gap:8px;align-items:center}.chart-download-button{background:rgba(0,0,0,0);border:1px solid rgba(74,144,226,.3);color:#4a90e2;padding:6px 12px;border-radius:6px;font-size:13px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:6px}.chart-download-button:hover{background:rgba(74,144,226,.1);border-color:rgba(74,144,226,.5)}.dark .chart-download-button{background:rgba(0,0,0,0);border:1px solid rgba(255,255,255,.2);color:#fff}.dark .chart-download-button:hover{background:rgba(255,255,255,.1);border-color:rgba(255,255,255,.3)}.chart-close-button{background:rgba(0,0,0,0);border:none;color:rgba(0,0,0,.6);font-size:20px;cursor:pointer;padding:4px 8px;border-radius:4px;transition:all .2s ease;line-height:1}.chart-close-button:hover{background:rgba(0,0,0,.08);color:#2c3e50}.dark .chart-close-button{color:rgba(255,255,255,.6)}.dark .chart-close-button:hover{background:rgba(255,255,255,.1);color:#fff}.chart-body{flex:1;display:flex;flex-direction:column;padding:16px 20px;min-height:0}.profile-metadata-inline{display:flex;gap:16px;margin-bottom:8px;padding:4px 0;font-size:12px;flex-shrink:0;color:#2c3e50}.integrated-chart-section.dark .profile-metadata-inline{color:rgba(255,255,255,.9)}.chart-content-wrapper{flex:1;position:relative;min-height:0;width:100%}.chart-loading,.chart-empty-state,.chart-error{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;background:rgba(0,0,0,0);color:#2c3e50;font-size:14px;font-weight:500;z-index:5;text-align:center;padding:0 24px}.chart-loading.dark,.chart-empty-state.dark,.chart-error.dark{background:rgba(0,0,0,0);color:rgba(255,255,255,.9)}.chart-error{color:#ef5350}.chart-error.dark{color:#ff6b6b}.chart-loader-orbit{position:relative;width:64px;height:64px;display:flex;align-items:center;justify-content:center}.chart-loader-orbit span{position:absolute;width:100%;height:100%;border-radius:50%;border:2px solid rgba(74,144,226,.25);animation:chartOrbit 1.8s linear infinite}.chart-loader-orbit span:nth-child(2){width:48px;height:48px;border-color:rgba(74,144,226,.45);animation-delay:-0.4s}.chart-loader-orbit span:nth-child(3){width:32px;height:32px;border-color:rgba(74,144,226,.85);animation-delay:-0.8s;box-shadow:0 0 12px rgba(74,144,226,.4)}.chart-loading.dark .chart-loader-orbit span{border-color:rgba(0,183,255,.35);box-shadow:0 0 14px rgba(0,183,255,.45)}.chart-loading.dark .chart-loader-orbit span:nth-child(2){border-color:rgba(0,183,255,.55)}.chart-loading.dark .chart-loader-orbit span:nth-child(3){border-color:rgba(0,183,255,.85)}@keyframes chartOrbit{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.loading{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex;flex-direction:column;align-items:center;gap:20px;background:rgba(0,0,0,0);padding:32px 40px;color:#2c3e50;z-index:1000;min-width:280px}.dark .loading{background:rgba(0,0,0,0);color:#e0e0e0}.loading-text{font-size:16px;font-weight:600;color:#2c3e50;text-align:center;margin:0}.dark .loading-text{color:#e0e0e0}.loading-subtext{font-size:13px;color:#5f6368;text-align:center;margin:0;opacity:.8}.dark .loading-subtext{color:#a0a0a0}.loading-spinner-modern{position:relative;width:64px;height:64px;display:flex;align-items:center;justify-content:center}.spinner-ring{position:absolute;width:100%;height:100%;border:3px solid rgba(0,0,0,0);border-top-color:#4a90e2;border-radius:50%;animation:spin-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite}.spinner-ring:nth-child(1){width:64px;height:64px;border-top-color:#4a90e2;animation-delay:0s}.spinner-ring:nth-child(2){width:48px;height:48px;border-top-color:#5ba3ff;animation-delay:-0.4s}.spinner-ring:nth-child(3){width:32px;height:32px;border-top-color:#7bb8ff;animation-delay:-0.8s}.dark .spinner-ring:nth-child(1){border-top-color:#0078d4}.dark .spinner-ring:nth-child(2){border-top-color:#40a9ff}.dark .spinner-ring:nth-child(3){border-top-color:#69c0ff}@keyframes spin-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.error-message{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);width:90%;max-width:480px;z-index:1000}.error-content{background:rgba(255,255,255,.98);backdrop-filter:blur(20px);padding:48px 36px;border-radius:24px;text-align:center;border:none;animation:errorFadeIn .4s ease-out;position:relative;overflow:hidden}.dark .error-content{background:#161723;border:none}@keyframes errorFadeIn{from{opacity:0;transform:translateY(-10px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}.error-icon-wrapper{display:flex;justify-content:center;align-items:center;margin-bottom:24px;position:relative}.error-icon-svg{width:80px;height:80px;color:#4a90e2;opacity:.9;animation:iconPulse 2s ease-in-out infinite;filter:drop-shadow(0 4px 8px rgba(74, 144, 226, 0.2))}.dark .error-icon-svg{color:#40a9ff;filter:drop-shadow(0 4px 8px rgba(64, 169, 255, 0.3))}@keyframes iconPulse{0%,100%{transform:scale(1);opacity:.9}50%{transform:scale(1.05);opacity:1}}.error-title{font-size:20px;font-weight:600;color:#2c3e50;margin-bottom:12px;line-height:1.4;letter-spacing:-0.01em}.dark .error-title{color:#fff}.error-description{color:#5f6368;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:360px;margin-left:auto;margin-right:auto}.dark .error-description{color:rgba(255,255,255,.75)}.retry-button{background:linear-gradient(135deg, #4a90e2 0%, #357abd 100%);color:#fff;border:none;padding:12px 28px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .3s ease;box-shadow:0 4px 12px rgba(74,144,226,.3);display:inline-flex;align-items:center;gap:8px}.retry-button:hover{background:linear-gradient(135deg, #357abd 0%, #2a5f8f 100%);transform:translateY(-2px);box-shadow:0 6px 16px rgba(74,144,226,.4)}.retry-button:active{transform:translateY(0);box-shadow:0 2px 8px rgba(74,144,226,.3)}.dark .retry-button{background:linear-gradient(135deg, #0078d4 0%, #005a9e 100%);box-shadow:0 4px 12px rgba(0,120,212,.3)}.dark .retry-button:hover{background:linear-gradient(135deg, #005a9e 0%, #004578 100%);box-shadow:0 6px 16px rgba(0,120,212,.4)}.recharts-wrapper{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.recharts-cartesian-axis-tick-value{fill:#2c3e50;font-size:11px}.dark .recharts-cartesian-axis-tick-value{fill:rgba(255,255,255,.9)}.recharts-cartesian-grid-horizontal line,.recharts-cartesian-grid-vertical line{stroke:rgba(0,0,0,.08);stroke-dasharray:3 3}.dark .recharts-cartesian-grid-horizontal line,.dark .recharts-cartesian-grid-vertical line{stroke:rgba(255,255,255,.08)}.recharts-tooltip-wrapper{outline:none}@media(max-width: 1366px){.integrated-chart-section{width:clamp(320px,55vw,720px);height:clamp(220px,40vh,420px);bottom:18px;right:18px}}@media(max-width: 1024px){.integrated-chart-section{width:clamp(300px,70vw,560px);height:clamp(200px,42vh,360px);bottom:15px;right:15px}}@media(max-width: 768px){.drawing-tools{right:10px;top:10px}.integrated-chart-section{width:calc(100% - 20px);height:clamp(180px,32vh,300px);bottom:10px;right:10px;left:10px}.chart-header{padding:12px 16px}.chart-body{padding:12px 16px}.chart-title{font-size:12px}.chart-download-button{font-size:11px;padding:4px 8px}.profile-metadata-inline{flex-direction:column;gap:4px;font-size:10px}}@media(max-height: 700px){.integrated-chart-section{height:clamp(180px,32vh,360px)}}@media(max-height: 520px){.integrated-chart-section{position:relative;right:auto;left:10px;width:calc(100% - 20px);height:clamp(160px,40vh,280px)}}',""]);const s=o},4331:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8081),i=n.n(r),a=n(3645),o=n.n(a)()(i());o.push([e.id,'.widget-3d-dams{position:relative;width:100%;height:100%;background:#fff;overflow:hidden;display:flex;flex-direction:column}.widget-3d-dams.dark-theme{background:#10111b}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.show-graphic-button-container{position:absolute;top:20px;left:20px;z-index:1000}.show-graphic-button{background:#0078d4;color:#fff;border:none;padding:12px 20px;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 8px rgba(0,120,212,.3)}.show-graphic-button:hover{background:#005a9e;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,120,212,.4)}.show-graphic-button:active{transform:translateY(0);box-shadow:0 2px 6px rgba(0,120,212,.3)}.top-left-controls{position:absolute;top:20px;left:20px;z-index:1000;display:flex;flex-direction:column;gap:12px;align-items:flex-start}.top-right-controls{position:absolute;top:20px;right:20px;z-index:1000;display:flex;flex-direction:row;gap:26px}.graphic-button-container{margin-bottom:8px}.delete-button-container{margin-bottom:8px}.delete-button{background:#dc3545;color:#fff;border:none;padding:12px;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 8px rgba(220,53,69,.3);display:flex;align-items:center;justify-content:center;width:44px;height:44px}.delete-button:hover{background:#c82333;transform:translateY(-1px);box-shadow:0 4px 12px rgba(220,53,69,.4)}.delete-button:active{transform:translateY(0);box-shadow:0 2px 6px rgba(220,53,69,.3)}.graphic-button{background:#0078d4;color:#fff;border:none;padding:12px 20px;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 8px rgba(0,120,212,.3)}.graphic-button:hover{background:#005a9e;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,120,212,.4)}.graphic-button:active{transform:translateY(0);box-shadow:0 2px 6px rgba(0,120,212,.3)}.line-management-info{display:flex;flex-direction:column;gap:8px;margin-bottom:15px}.line-points-label{background:rgba(255,255,255,.9);padding:8px 12px;border-radius:6px;font-size:12px;font-weight:500;color:#333;box-shadow:0 2px 8px rgba(0,0,0,.1)}.lines-count-label{background:rgba(0,120,212,.1);padding:8px 12px;border-radius:6px;font-size:12px;font-weight:600;color:#0078d4;box-shadow:0 2px 8px rgba(0,120,212,.2)}.clear-lines-button{background:#dc3545;color:#fff;border:none;padding:8px 12px;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 8px rgba(220,53,69,.3)}.clear-lines-button:hover{background:#c82333;transform:translateY(-1px);box-shadow:0 4px 12px rgba(220,53,69,.4)}.clear-lines-button:active{transform:translateY(0);box-shadow:0 2px 6px rgba(220,53,69,.3)}.type-selection{display:flex;flex-direction:column;gap:6px;padding:20px;background:#fff;align-items:center;justify-content:center;border-radius:16px}.dark-theme .type-selection{background:#161723}.type-button{background:#e7e7e8;border:1px solid #e8e8e8;padding:10px 16px;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease;color:#10111b;min-width:70px;text-align:center;width:166px;height:44px}.dark-theme .type-button{background:#1f2030;border:1px solid #282a3d;color:#fff}.type-button.active{background:#e9f1ff;color:#2176ff;border-color:#bad5ff}.dark-theme .type-button.active{background:#282a3d;color:#2176ff;border-color:#0e326b}.type-button:hover{background:#e7e7e8;border-color:#bad5ff;color:#2176ff}.dark-theme .type-button:hover{background:#282a3d;border-color:rgba(33,118,255,.2509803922)}.type-button.active:hover{background:#e9f1ff;border-color:#bad5ff;color:#2176ff}.dark-theme .type-button.active:hover{background:#282a3d;border-color:rgba(33,118,255,.2509803922)}.type1-component{position:relative;width:100%;height:100%;display:flex;flex-direction:column}.drawing-tools{position:absolute;top:40%;right:20px;transform:translateY(-50%);z-index:1000;display:flex;flex-direction:column;gap:12px}.icon-button{background:rgba(255,255,255,.9);border:1px solid #ddd;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-size:16px;cursor:pointer;transition:all .2s ease;backdrop-filter:blur(10px);color:#2c3e50}.dark-theme .icon-button{background:#1f2030;border:1px solid #555;color:#e0e0e0}.icon-button:hover{background:#fff;border-color:#0078d4;color:#0078d4;transform:scale(1.1)}.dark-theme .icon-button:hover{background:#1f2030;border-color:#0078d4;color:#0078d4}.icon-button.active{background:#fff;color:#0078d4;border-color:#0078d4;transform:scale(1.1)}.dark-theme .icon-button.active{background:#1f2030;color:#0078d4;border-color:#0078d4;transform:scale(1.1)}.icon-button.active:hover{background:#fff;color:#0078d4;border-color:#0078d4;transform:scale(1.1)}.dark-theme .icon-button.active:hover{background:#1f2030;color:#0078d4;border-color:#0078d4;transform:scale(1.1)}.icon-button.spinning{animation:pulse 1s ease-in-out infinite alternate}.icon-button.disabled{opacity:.45;cursor:not-allowed;border-color:#ddd;background:rgba(255,255,255,.7);transform:none}.icon-button.disabled:hover{background:rgba(255,255,255,.7);border-color:#ddd;transform:none}.dark-theme .icon-button.disabled{background:rgba(45,45,45,.7);border-color:#3a3a3a}@keyframes pulse{from{background:#0078d4;transform:scale(1)}to{background:#005a9e;transform:scale(1.05)}}.container-3d{flex:1;position:relative;width:100%;height:100%;background:#f0f0f0;border-radius:8px;overflow:hidden;cursor:default}.dark-theme .container-3d{background:#10111b}.container-3d.drawing-mode{cursor:crosshair}.container-3d.spinning-mode{cursor:not-allowed}.water-data{position:absolute;bottom:20px;left:20px;right:20px;display:flex;gap:12px;z-index:10}.data-card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 12px rgba(0,0,0,.08);flex:1;min-width:180px;border:1px solid #f1f3f4;transition:all .2s ease;text-align:center}.dark-theme .data-card{background:#1f2030;border:none;box-shadow:0 2px 12px rgba(0,0,0,.3)}.data-card:hover{box-shadow:0 4px 20px rgba(0,0,0,.12);transform:translateY(-2px)}.dark-theme .data-card:hover{box-shadow:0 4px 20px rgba(0,0,0,.5)}.data-value{font-size:22px;font-weight:600;color:#1a1a1a;margin-bottom:6px;margin-top:4px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.dark-theme .data-value{color:#e0e0e0}.data-label{font-size:11px;color:#6c757d;text-transform:uppercase;letter-spacing:.8px;font-weight:500;margin-bottom:4px}.dark-theme .data-label{color:#a0a0a0}.water-level-slider{position:absolute;bottom:120px;left:20px;right:20px;z-index:10}.slider{width:100%;height:8px;border-radius:4px;background:#e9ecef;outline:none;-webkit-appearance:none;appearance:none;cursor:pointer;transition:all .2s ease}.slider:hover{background:#dee2e6}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:24px;height:24px;border-radius:50%;background:#fff;cursor:pointer;border:3px solid #0078d4;box-shadow:0 2px 8px rgba(0,120,212,.3);transition:all .2s ease}.slider::-webkit-slider-thumb:hover{transform:scale(1.1);box-shadow:0 4px 12px rgba(0,120,212,.4)}.slider::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:#fff;cursor:pointer;border:3px solid #0078d4;box-shadow:0 2px 8px rgba(0,120,212,.3);transition:all .2s ease}.slider::-moz-range-thumb:hover{transform:scale(1.1);box-shadow:0 4px 12px rgba(0,120,212,.4)}.slider::-webkit-slider-track{background:linear-gradient(to right, #0078d4 0%, #0078d4 var(--value, 50%), #e9ecef var(--value, 50%), #e9ecef 100%);border-radius:4px}.loading{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex;flex-direction:column;align-items:center;gap:20px;background:rgba(0,0,0,0);padding:32px 40px;color:#333;z-index:1000;min-width:280px}.dark-theme .loading{background:rgba(0,0,0,0);color:#e0e0e0}.loading-text{font-size:16px;font-weight:600;color:#1a1a1a;text-align:center;margin:0}.dark-theme .loading-text{color:#e0e0e0}.loading-subtext{font-size:13px;color:#666;text-align:center;margin:0;opacity:.8}.dark-theme .loading-subtext{color:#a0a0a0}.loading-spinner-modern{position:relative;width:64px;height:64px;display:flex;align-items:center;justify-content:center}.spinner-ring{position:absolute;width:100%;height:100%;border:3px solid rgba(0,0,0,0);border-top-color:#0078d4;border-radius:50%;animation:spin-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite}.spinner-ring:nth-child(1){width:64px;height:64px;border-top-color:#0078d4;animation-delay:0s}.spinner-ring:nth-child(2){width:48px;height:48px;border-top-color:#40a9ff;animation-delay:-0.4s}.spinner-ring:nth-child(3){width:32px;height:32px;border-top-color:#69c0ff;animation-delay:-0.8s}.dark-theme .spinner-ring:nth-child(1){border-top-color:#2176ff}.dark-theme .spinner-ring:nth-child(2){border-top-color:#4a9eff}.dark-theme .spinner-ring:nth-child(3){border-top-color:#6bb3ff}@keyframes spin-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.loading-spinner{width:32px;height:32px;border:3px solid #f3f3f3;border-top:3px solid #0078d4;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.error-message{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);background:#fff;padding:24px;border-radius:8px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,.15);border-radius:24px}.dark-theme .error-message{background:#161723;box-shadow:0 4px 12px rgba(0,0,0,.4)}.error-icon{font-size:32px;margin-bottom:8px}.error-title{font-size:18px;font-weight:bold;color:#ff5722;margin-bottom:8px}.error-details{color:#666;margin-bottom:16px}.dark-theme .error-details{color:#a0a0a0}.retry-button{background:#0078d4;color:#fff;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;font-size:14px}.retry-button:hover{background:#005a9e}.type2-component{position:relative;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;background:#f7f7f7}.dark-theme .type2-component{background:#10111b}.scene-container{min-height:400px;display:flex;flex-direction:column;height:70%;width:100%;border-radius:12px;overflow:hidden}.type2-spin-tools{pointer-events:none}.type2-spin-tools .icon-button{pointer-events:auto}.slider-container{width:100%;height:30%;background:#f8f9fa;border-radius:12px;padding:20px}.dark-theme .slider-container{background:#10111b}.water-level-slider-container{padding:20px;height:100%;min-height:300px;display:flex;flex-direction:column;gap:20px;width:100%;align-items:center}.dark-theme .water-level-slider-container{background:rgba(0,0,0,0)}.water-level-slider-cards{display:flex;gap:12px;justify-content:space-between;width:100%;max-width:800px}.water-level-slider-section{display:flex;flex-direction:column;align-items:center;gap:12px;width:100%;max-width:800px}.water-level-slider-input-wrapper{width:100%;max-width:400px;position:relative}#water-level.water-level-input::-webkit-slider-thumb{appearance:none;width:20px;height:20px;border-radius:50%;background:#fff;border:2px solid #69f;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2);position:relative}#water-level.water-level-input::-webkit-slider-thumb::before{content:"||";position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);font-size:8px;color:#000;font-weight:bold}#water-level.water-level-input::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#fff;border:2px solid #69f;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}.water-level-slider-labels{display:flex;justify-content:space-between;width:100%;max-width:400px;font-size:12px;color:#666}.dark-theme .water-level-slider-labels{color:#a0a0a0}.water-level-not-available{text-align:center;padding:16px}.water-level-not-available-title{font-size:18px;font-weight:bold;margin-bottom:8px;color:#1a1a1a}.dark-theme .water-level-not-available-title{color:#e0e0e0}.water-level-not-available-text{font-size:14px;color:#666}.dark-theme .water-level-not-available-text{color:#a0a0a0}.water-level-status{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;text-align:center;width:100%;height:100%;padding:24px;box-sizing:border-box}.water-level-status-title{font-size:18px;font-weight:600;color:#1f2933}.water-level-status-subtitle{font-size:14px;color:#4a5568;max-width:320px}.dark-theme .water-level-status-title{color:#f5f7fa}.dark-theme .water-level-status-subtitle{color:#cbd5f5}.type2-loading-overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(16,17,27,.45);backdrop-filter:blur(6px);z-index:50}.light-theme .type2-loading-overlay{background:rgba(255,255,255,.55)}@media(max-width: 768px){.water-data{flex-direction:column;gap:8px}.data-card{min-width:auto}.top-left-controls{top:10px;left:10px}.top-right-controls{top:10px;right:10px}.drawing-tools{right:10px}.slider-container{width:100%;max-width:400px}}.type3-component{position:relative;width:100%;height:100%;background:#f0f0f0;border-radius:8px;overflow:hidden;display:flex;flex-direction:column}.dark-theme .type3-component{background:#0f0f0f}.type3-controls{position:absolute;top:12px;left:12px;z-index:1000;display:flex;flex-direction:column;gap:8px;font-family:system-ui,Arial,sans-serif}.control-row{display:flex;gap:8px;align-items:center;background:#fff;padding:6px 10px;border:1px solid #ccc;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,.08)}.dark-theme .control-row{background:#10111b;border:1px solid #404040;box-shadow:0 1px 4px rgba(0,0,0,.3)}.mode-button{padding:6px 10px;border-radius:8px;border:1px solid #ccc;background:#fff;cursor:pointer;font-size:12px;transition:all .2s ease;color:#333}.dark-theme .mode-button{background:#3a3a3a;border:1px solid #4a4a4a;color:#e0e0e0}.mode-button:hover{background:#f0f0f0;border-color:#999}.dark-theme .mode-button:hover{background:#4a4a4a;border-color:#5a5a5a}.mode-button.active{background:#0078d4;color:#fff;border-color:#0078d4}.dark-theme .mode-button.active{background:#0078d4;color:#fff;border-color:#0078d4}.info-text{font-size:11px;opacity:.8;color:#666;white-space:nowrap}.dark-theme .info-text{color:#a0a0a0}.control-row label{font-size:12px;opacity:.8;color:#666;min-width:80px}.dark-theme .control-row label{color:#b0b0b0}.slider{width:400px;height:4px;background:#ddd;outline:none;border-radius:2px;-webkit-appearance:none;appearance:none}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;background:#0078d4;border-radius:50%;cursor:pointer}.slider::-moz-range-thumb{width:16px;height:16px;background:#0078d4;border-radius:50%;cursor:pointer;border:none}.value-display{font-size:11px;font-family:monospace;color:#333;min-width:60px;text-align:right}.dark-theme .value-display{color:#e0e0e0}',""]);const s=o},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&o[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},1903:(e,t,n)=>{e.exports=n(9130).get},207:(e,t,n)=>{e.exports=n(2194).last},157:(e,t,n)=>{e.exports=n(2355).range},5211:(e,t,n)=>{e.exports=n(9679).sortBy},3356:(e,t,n)=>{e.exports=n(6537).throttle},2996:(e,t,n)=>{e.exports=n(6294).uniqBy},5127:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isEqualsSameValueZero=function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}},8492:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isUnsafeProperty=function(e){return"__proto__"===e}},7495:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.flatten=function(e,t=1){const n=[],r=Math.floor(t),i=(e,t)=>{for(let a=0;a<e.length;a++){const o=e[a];Array.isArray(o)&&t<r?i(o,t+1):n.push(o)}};return i(e,0),n}},1611:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.last=function(e){return e[e.length-1]}},6658:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.uniqBy=function(e,t){const n=new Map;for(let r=0;r<e.length;r++){const i=e[r],a=t(i,r,e);n.has(a)||n.set(a,i)}return Array.from(n.values())}},6873:(e,t)=>{"use strict";function n(e){return"symbol"==typeof e?1:null===e?2:void 0===e?3:e!=e?4:0}Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.compareValues=(e,t,r)=>{if(e!==t){const i=n(e),a=n(t);if(i===a&&0===i){if(e<t)return"desc"===r?1:-1;if(e>t)return"desc"===r?-1:1}return"desc"===r?a-i:i-a}return 0}},9608:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getSymbols=function(e){return Object.getOwnPropertySymbols(e).filter((t=>Object.prototype.propertyIsEnumerable.call(e,t)))}},5303:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getTag=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}},9419:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isDeepKey=function(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}},7154:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;t.isIndex=function(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return n.test(e)}}},2966:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7154),i=n(8214),a=n(7499),o=n(5127);t.isIterateeCall=function(e,t,n){return!!a.isObject(n)&&!!("number"==typeof t&&i.isArrayLike(n)&&r.isIndex(t)&&t<n.length||"string"==typeof t&&t in n)&&o.isEqualsSameValueZero(n[t],e)}},1519:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6020),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.isKey=function(e,t){return!Array.isArray(e)&&(!("number"!=typeof e&&"boolean"!=typeof e&&null!=e&&!r.isSymbol(e))||"string"==typeof e&&(a.test(e)||!i.test(e))||null!=t&&Object.hasOwn(t,e))}},284:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.argumentsTag="[object Arguments]",t.arrayBufferTag="[object ArrayBuffer]",t.arrayTag="[object Array]",t.bigInt64ArrayTag="[object BigInt64Array]",t.bigUint64ArrayTag="[object BigUint64Array]",t.booleanTag="[object Boolean]",t.dataViewTag="[object DataView]",t.dateTag="[object Date]",t.errorTag="[object Error]",t.float32ArrayTag="[object Float32Array]",t.float64ArrayTag="[object Float64Array]",t.functionTag="[object Function]",t.int16ArrayTag="[object Int16Array]",t.int32ArrayTag="[object Int32Array]",t.int8ArrayTag="[object Int8Array]",t.mapTag="[object Map]",t.numberTag="[object Number]",t.objectTag="[object Object]",t.regexpTag="[object RegExp]",t.setTag="[object Set]",t.stringTag="[object String]",t.symbolTag="[object Symbol]",t.uint16ArrayTag="[object Uint16Array]",t.uint32ArrayTag="[object Uint32Array]",t.uint8ArrayTag="[object Uint8Array]",t.uint8ClampedArrayTag="[object Uint8ClampedArray]"},7581:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toArray=function(e){return Array.isArray(e)?e:Array.from(e)}},6:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toKey=function(e){return"string"==typeof e||"symbol"==typeof e?e:Object.is(e?.valueOf?.(),-0)?"-0":String(e)}},2194:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1611),i=n(7581),a=n(8214);t.last=function(e){if(a.isArrayLike(e))return r.last(i.toArray(e))}},6852:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6873),i=n(1519),a=n(2749);t.orderBy=function(e,t,n,o){if(null==e)return[];n=o?void 0:n,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=null==t?[null]:[t]),0===t.length&&(t=[null]),Array.isArray(n)||(n=null==n?[]:[n]),n=n.map((e=>String(e)));const s=(e,t)=>{let n=e;for(let e=0;e<t.length&&null!=n;++e)n=n[t[e]];return n},l=t.map((e=>(Array.isArray(e)&&1===e.length&&(e=e[0]),null==e||"function"==typeof e||Array.isArray(e)||i.isKey(e)?e:{key:e,path:a.toPath(e)})));return e.map((e=>({original:e,criteria:l.map((t=>((e,t)=>null==t||null==e?t:"object"==typeof e&&"key"in e?Object.hasOwn(t,e.key)?t[e.key]:s(t,e.path):"function"==typeof e?e(t):Array.isArray(e)?s(t,e):"object"==typeof t?t[e]:t)(t,e)))}))).slice().sort(((e,t)=>{for(let i=0;i<l.length;i++){const a=r.compareValues(e.criteria[i],t.criteria[i],n[i]);if(0!==a)return a}return 0})).map((e=>e.original))}},9679:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6852),i=n(7495),a=n(2966);t.sortBy=function(e,...t){const n=t.length;return n>1&&a.isIterateeCall(e,t[0],t[1])?t=[]:n>2&&a.isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),r.orderBy(e,i.flatten(t),["asc"])}},6294:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6658),i=n(684),a=n(775),o=n(1505),s=n(4711);t.uniqBy=function(e,t=a.identity){return o.isArrayLikeObject(e)?r.uniqBy(Array.from(e),i.ary(s.iteratee(t),1)):[]}},8657:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7083);t.debounce=function(e,t=0,n={}){"object"!=typeof n&&(n={});const{leading:i=!1,trailing:a=!0,maxWait:o}=n,s=Array(2);let l;i&&(s[0]="leading"),a&&(s[1]="trailing");let c=null;const u=r.debounce((function(...t){l=e.apply(this,t),c=null}),t,{edges:s}),d=function(...t){return null!=o&&(null===c&&(c=Date.now()),Date.now()-c>=o)?(l=e.apply(this,t),c=Date.now(),u.cancel(),u.schedule(),l):(u.apply(this,t),l)};return d.cancel=u.cancel,d.flush=()=>(u.flush(),l),d}},6537:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8657);t.throttle=function(e,t=0,n={}){const{leading:i=!0,trailing:a=!0}=n;return r.debounce(e,t,{leading:i,maxWait:t,trailing:a})}},2355:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2966),i=n(3646);t.range=function(e,t,n){n&&"number"!=typeof n&&r.isIterateeCall(e,t,n)&&(t=n=void 0),e=i.toFinite(e),void 0===t?(t=e,e=0):t=i.toFinite(t),n=void 0===n?e<t?1:-1:i.toFinite(n);const a=Math.max(Math.ceil((t-e)/(n||1)),0),o=new Array(a);for(let t=0;t<a;t++)o[t]=e,e+=n;return o}},3017:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6808);t.cloneDeep=function(e){return r.cloneDeepWith(e)}},6808:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7858),i=n(5303),a=n(284);t.cloneDeepWith=function(e,t){return r.cloneDeepWith(e,((n,o,s,l)=>{const c=t?.(n,o,s,l);if(void 0!==c)return c;if("object"==typeof e){if(i.getTag(e)===a.objectTag&&"function"!=typeof e.constructor){const t={};return l.set(e,t),r.copyProperties(t,e,s,l),t}switch(Object.prototype.toString.call(e)){case a.numberTag:case a.stringTag:case a.booleanTag:{const t=new e.constructor(e?.valueOf());return r.copyProperties(t,e),t}case a.argumentsTag:{const t={};return r.copyProperties(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}}}))}},9130:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8492),i=n(9419),a=n(6),o=n(2749);t.get=function e(t,n,s){if(null==t)return s;switch(typeof n){case"string":{if(r.isUnsafeProperty(n))return s;const a=t[n];return void 0===a?i.isDeepKey(n)?e(t,o.toPath(n),s):s:a}case"number":case"symbol":{"number"==typeof n&&(n=a.toKey(n));const e=t[n];return void 0===e?s:e}default:{if(Array.isArray(n))return function(e,t,n){if(0===t.length)return n;let i=e;for(let e=0;e<t.length;e++){if(null==i)return n;if(r.isUnsafeProperty(t[e]))return n;i=i[t[e]]}return void 0===i?n:i}(t,n,s);if(n=Object.is(n?.valueOf(),-0)?"-0":String(n),r.isUnsafeProperty(n))return s;const e=t[n];return void 0===e?s:e}}}},5453:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9419),i=n(7154),a=n(9477),o=n(2749);t.has=function(e,t){let n;if(n=Array.isArray(t)?t:"string"==typeof t&&r.isDeepKey(t)&&null==e?.[t]?o.toPath(t):[t],0===n.length)return!1;let s=e;for(let e=0;e<n.length;e++){const t=n[e];if(!(null!=s&&Object.hasOwn(s,t)||(Array.isArray(s)||a.isArguments(s))&&i.isIndex(t)&&t<s.length))return!1;s=s[t]}return!0}},1468:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9130);t.property=function(e){return function(t){return r.get(t,e)}}},9477:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5303);t.isArguments=function(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===r.getTag(e)}},8214:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8328);t.isArrayLike=function(e){return null!=e&&"function"!=typeof e&&r.isLength(e.length)}},1505:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8214),i=n(1345);t.isArrayLikeObject=function(e){return i.isObjectLike(e)&&r.isArrayLike(e)}},2918:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2208);t.isMatch=function(e,t){return r.isMatchWith(e,t,(()=>{}))}},2208:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7499),i=n(6222),a=n(5127);function o(e,t,n,c){if(t===e)return!0;switch(typeof t){case"object":return function(e,t,n,r){if(null==t)return!0;if(Array.isArray(t))return s(e,t,n,r);if(t instanceof Map)return function(e,t,n,r){if(0===t.size)return!0;if(!(e instanceof Map))return!1;for(const[i,a]of t.entries())if(!1===n(e.get(i),a,i,e,t,r))return!1;return!0}(e,t,n,r);if(t instanceof Set)return l(e,t,n,r);const a=Object.keys(t);if(null==e||i.isPrimitive(e))return 0===a.length;if(0===a.length)return!0;if(r?.has(t))return r.get(t)===e;r?.set(t,e);try{for(let o=0;o<a.length;o++){const s=a[o];if(!i.isPrimitive(e)&&!(s in e))return!1;if(void 0===t[s]&&void 0!==e[s])return!1;if(null===t[s]&&null!==e[s])return!1;if(!n(e[s],t[s],s,e,t,r))return!1}return!0}finally{r?.delete(t)}}(e,t,n,c);case"function":return Object.keys(t).length>0?o(e,{...t},n,c):a.isEqualsSameValueZero(e,t);default:return r.isObject(e)?"string"!=typeof t||""===t:a.isEqualsSameValueZero(e,t)}}function s(e,t,n,r){if(0===t.length)return!0;if(!Array.isArray(e))return!1;const i=new Set;for(let a=0;a<t.length;a++){const o=t[a];let s=!1;for(let l=0;l<e.length;l++){if(i.has(l))continue;let c=!1;if(n(e[l],o,a,e,t,r)&&(c=!0),c){i.add(l),s=!0;break}}if(!s)return!1}return!0}function l(e,t,n,r){return 0===t.size||e instanceof Set&&s([...e],[...t],n,r)}t.isMatchWith=function e(t,n,r){return"function"!=typeof r?e(t,n,(()=>{})):o(t,n,(function e(t,n,i,a,s,l){const c=r(t,n,i,a,s,l);return void 0!==c?Boolean(c):o(t,n,e,l)}),new Map)},t.isSetMatch=l},7499:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObject=function(e){return null!==e&&("object"==typeof e||"function"==typeof e)}},1345:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObjectLike=function(e){return"object"==typeof e&&null!==e}},6020:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isSymbol=function(e){return"symbol"==typeof e||e instanceof Symbol}},9105:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2918),i=n(2217);t.matches=function(e){return e=i.cloneDeep(e),t=>r.isMatch(t,e)}},237:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2918),i=n(6),a=n(3017),o=n(9130),s=n(5453);t.matchesProperty=function(e,t){switch(typeof e){case"object":Object.is(e?.valueOf(),-0)&&(e="-0");break;case"number":e=i.toKey(e)}return t=a.cloneDeep(t),function(n){const i=o.get(n,e);return void 0===i?s.has(n,e):void 0===t?void 0===i:r.isMatch(i,t)}}},4711:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(775),i=n(1468),a=n(9105),o=n(237);t.iteratee=function(e){if(null==e)return r.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&2===e.length?o.matchesProperty(e[0],e[1]):a.matches(e);case"string":case"symbol":case"number":return i.property(e)}}},3646:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4178);t.toFinite=function(e){return e?(e=r.toNumber(e))===1/0||e===-1/0?(e<0?-1:1)*Number.MAX_VALUE:e==e?e:0:0===e?e:0}},4178:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6020);t.toNumber=function(e){return r.isSymbol(e)?NaN:Number(e)}},2749:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(267),i=n(6);t.toPath=function(e){if(Array.isArray(e))return e.map(i.toKey);if("symbol"==typeof e)return[e];const t=[],n=(e=r.toString(e)).length;if(0===n)return t;let a=0,o="",s="",l=!1;for(46===e.charCodeAt(0)&&(t.push(""),a++);a<n;){const r=e[a];s?"\\"===r&&a+1<n?(a++,o+=e[a]):r===s?s="":o+=r:l?'"'===r||"'"===r?s=r:"]"===r?(l=!1,t.push(o),o=""):o+=r:"["===r?(l=!0,o&&(t.push(o),o="")):"."===r?o&&(t.push(o),o=""):o+=r,a++}return o&&t.push(o),t}},267:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toString=function e(t){if(null==t)return"";if("string"==typeof t)return t;if(Array.isArray(t))return t.map(e).join(",");const n=String(t);return"0"===n&&Object.is(Number(t),-0)?"-0":n}},684:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.ary=function(e,t){return function(...n){return e.apply(this,n.slice(0,t))}}},7083:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.debounce=function(e,t,{signal:n,edges:r}={}){let i,a=null;const o=null!=r&&r.includes("leading"),s=null==r||r.includes("trailing"),l=()=>{null!==a&&(e.apply(i,a),i=void 0,a=null)};let c=null;const u=()=>{null!=c&&clearTimeout(c),c=setTimeout((()=>{c=null,s&&l(),d()}),t)},d=()=>{null!==c&&(clearTimeout(c),c=null),i=void 0,a=null},h=function(...e){if(n?.aborted)return;i=this,a=e;const t=null==c;u(),o&&t&&l()};return h.schedule=u,h.cancel=d,h.flush=()=>{l()},n?.addEventListener("abort",d,{once:!0}),h}},775:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.identity=function(e){return e}},2217:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7858);t.cloneDeep=function(e){return r.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}},7858:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9608),i=n(5303),a=n(284),o=n(6222),s=n(945);function l(e,t,n,r=new Map,u=void 0){const d=u?.(e,t,n,r);if(void 0!==d)return d;if(o.isPrimitive(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const t=new Array(e.length);r.set(e,t);for(let i=0;i<e.length;i++)t[i]=l(e[i],i,n,r,u);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;r.set(e,t);for(const[i,a]of e)t.set(i,l(a,i,n,r,u));return t}if(e instanceof Set){const t=new Set;r.set(e,t);for(const i of e)t.add(l(i,void 0,n,r,u));return t}if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(s.isTypedArray(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);r.set(e,t);for(let i=0;i<e.length;i++)t[i]=l(e[i],i,n,r,u);return t}if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),c(t,e,n,r,u),t}if("undefined"!=typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return r.set(e,t),c(t,e,n,r,u),t}if("undefined"!=typeof Blob&&e instanceof Blob){const t=new Blob([e],{type:e.type});return r.set(e,t),c(t,e,n,r,u),t}if(e instanceof Error){const t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,c(t,e,n,r,u),t}if(e instanceof Boolean){const t=new Boolean(e.valueOf());return r.set(e,t),c(t,e,n,r,u),t}if(e instanceof Number){const t=new Number(e.valueOf());return r.set(e,t),c(t,e,n,r,u),t}if(e instanceof String){const t=new String(e.valueOf());return r.set(e,t),c(t,e,n,r,u),t}if("object"==typeof e&&function(e){switch(i.getTag(e)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),c(t,e,n,r,u),t}return e}function c(e,t,n=e,i,a){const o=[...Object.keys(t),...r.getSymbols(t)];for(let r=0;r<o.length;r++){const s=o[r],c=Object.getOwnPropertyDescriptor(e,s);(null==c||c.writable)&&(e[s]=l(t[s],s,n,i,a))}}t.cloneDeepWith=function(e,t){return l(e,void 0,e,new Map,t)},t.cloneDeepWithImpl=l,t.copyProperties=c},8328:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isLength=function(e){return Number.isSafeInteger(e)&&e>=0}},6222:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPrimitive=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e}},945:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isTypedArray=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}},6729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,r,a,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,a||e,o),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,a,o){var s=n?n+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,a),!0;case 6:return u.fn.call(u.context,t,r,i,a,o),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||o(this,a);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||i&&!s[l].once||r&&s[l].context!==r)&&c.push(s[l]);c.length?this._events[a]=1===c.length?c[0]:c:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},8679:(e,t,n)=>{"use strict";var r=n(9864),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return r.isMemo(e)?o:s[e.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(f){var i=p(n);i&&i!==f&&e(t,i,r)}var o=u(n);d&&(o=o.concat(d(n)));for(var s=l(t),m=l(n),g=0;g<o.length;++g){var v=o[g];if(!(a[v]||r&&r[v]||m&&m[v]||s&&s[v])){var y=h(n,v);try{c(t,v,y)}catch(e){}}}}return t}},9921:(e,t)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,x=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function _(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case a:case s:case o:case p:return e;default:switch(e=e&&e.$$typeof){case c:case h:case g:case m:case l:return e;default:return t}}case i:return t}}}function w(e){return _(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=h,t.Fragment=a,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=s,t.StrictMode=o,t.Suspense=p,t.isAsyncMode=function(e){return w(e)||_(e)===u},t.isConcurrentMode=w,t.isContextConsumer=function(e){return _(e)===c},t.isContextProvider=function(e){return _(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return _(e)===h},t.isFragment=function(e){return _(e)===a},t.isLazy=function(e){return _(e)===g},t.isMemo=function(e){return _(e)===m},t.isPortal=function(e){return _(e)===i},t.isProfiler=function(e){return _(e)===s},t.isStrictMode=function(e){return _(e)===o},t.isSuspense=function(e){return _(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===d||e===s||e===o||e===p||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===h||e.$$typeof===y||e.$$typeof===x||e.$$typeof===b||e.$$typeof===v)},t.typeOf=_},9864:(e,t,n)=>{"use strict";e.exports=n(9921)},8359:(e,t)=>{"use strict";Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen");Symbol.for("react.module.reference")},2973:(e,t,n)=>{"use strict";n(8359)},3379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var a={},o=[],s=0;s<e.length;s++){var l=e[s],c=r.base?l[0]+r.base:l[0],u=a[c]||0,d="".concat(c," ").concat(u);a[c]=u+1;var h=n(d),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=i(p,r);r.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}o.push(d)}return o}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var a=r(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<a.length;o++){var s=n(a[o]);t[s].references--}for(var l=r(e,i),c=0;c<a.length;c++){var u=n(a[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}a=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},83:(e,t,n)=>{"use strict";var r=n(1315),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useState,o=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),i=r[0].inst,u=r[1];return s((function(){i.value=n,i.getSnapshot=t,c(i)&&u({inst:i})}),[e,n,t]),o((function(){return c(i)&&u({inst:i}),e((function(){c(i)&&u({inst:i})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},6251:(e,t,n)=>{"use strict";var r=n(1315),i=n(1688),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=i.useSyncExternalStore,s=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var d=s(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=c((function(){function e(e){if(!l){if(l=!0,o=e,e=r(e),void 0!==i&&h.hasValue){var t=h.value;if(i(t,e))return s=t}return s=e}if(t=s,a(o,e))return t;var n=r(e);return void 0!==i&&i(t,n)?(o=e,t):(o=e,s=n)}var o,s,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,i]);var p=o(e,d[0],d[1]);return l((function(){h.hasValue=!0,h.value=p}),[p]),u(p),p}},1688:(e,t,n)=>{"use strict";e.exports=n(83)},2798:(e,t,n)=>{"use strict";e.exports=n(6251)},8891:e=>{"use strict";e.exports=n},1315:e=>{"use strict";e.exports=r},800:e=>{"use strict";e.exports=i}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,exports:{}};return a[e].call(n.exports,n,n.exports,s),n.exports}s.m=a,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>"vendors-node_modules_html2canvas_dist_html2canvas_esm_js"===e?"widgets/chunks/vendors-node_modules_html2canvas_dist_html2canvas_esm_js.js":"vendors-node_modules_jspdf_dist_jspdf_es_min_js"===e?"widgets/chunks/vendors-node_modules_jspdf_dist_jspdf_es_min_js.js":"vendors-node_modules_dompurify_dist_purify_es_mjs"===e?"widgets/chunks/vendors-node_modules_dompurify_dist_purify_es_mjs.js":"vendors-node_modules_canvg_lib_index_es_js"===e?"widgets/chunks/vendors-node_modules_canvg_lib_index_es_js.js":void 0,s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="exb-client:",s.l=(n,r,i,a)=>{if(e[n])e[n].push(r);else{var o,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+i),o.src=n),e[n]=[r];var h=(t,r)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(r))),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="",(()=>{var e={"widgets/3d-dams/dist/runtime/widget":0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var a=s.p+s.u(t),o=new Error;s.l(a,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",o.name="ChunkLoadError",o.type=i,o.request=a,r[1](o)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,[a,o,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(r in o)s.o(o,r)&&(s.m[r]=o[r]);l&&l(s)}for(t&&t(n);c<a.length;c++)i=a[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkexb_client=self.webpackChunkexb_client||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var l={};return s.p=window.jimuConfig.baseUrl,(()=>{"use strict";s.r(l),s.d(l,{__set_webpack_public_path__:()=>Bj,default:()=>jj});var e={};s.r(e),s.d(e,{hasBrowserEnv:()=>Nd,hasStandardBrowserEnv:()=>Ud,hasStandardBrowserWebWorkerEnv:()=>Fd,navigator:()=>kd,origin:()=>zd});var t={};s.r(t),s.d(t,{scaleBand:()=>tx,scaleDiverging:()=>VS,scaleDivergingLog:()=>GS,scaleDivergingPow:()=>XS,scaleDivergingSqrt:()=>qS,scaleDivergingSymlog:()=>WS,scaleIdentity:()=>jb,scaleImplicit:()=>Qy,scaleLinear:()=>zb,scaleLog:()=>Kb,scaleOrdinal:()=>ex,scalePoint:()=>rx,scalePow:()=>i_,scaleQuantile:()=>f_,scaleQuantize:()=>m_,scaleRadial:()=>s_,scaleSequential:()=>kS,scaleSequentialLog:()=>US,scaleSequentialPow:()=>zS,scaleSequentialQuantile:()=>BS,scaleSequentialSqrt:()=>jS,scaleSequentialSymlog:()=>FS,scaleSqrt:()=>a_,scaleSymlog:()=>Qb,scaleThreshold:()=>g_,scaleTime:()=>DS,scaleUtc:()=>IS,tickFormat:()=>Ub});var n=s(8891),r=s(1315);const i="182",a=100,o=0,c="attached",u=301,d=302,h=306,p=1e3,f=1001,m=1002,g=1003,v=1005,y=1006,x=1007,b=1008,_=1009,w=1010,S=1011,M=1012,E=1013,T=1014,A=1015,C=1016,P=1017,R=1018,O=1020,D=35902,I=35899,L=1021,N=1022,k=1023,U=1026,F=1027,z=1028,j=1029,B=1030,H=1031,V=1033,G=33776,W=33777,X=33778,q=33779,Y=35840,K=35841,$=35842,Z=35843,J=36196,Q=37492,ee=37496,te=37488,ne=37489,re=37490,ie=37491,ae=37808,oe=37809,se=37810,le=37811,ce=37812,ue=37813,de=37814,he=37815,pe=37816,fe=37817,me=37818,ge=37819,ve=37820,ye=37821,xe=36492,be=36494,_e=36495,we=36283,Se=36284,Me=36285,Ee=36286,Te=2300,Ae=2301,Ce=2302,Pe="",Re="srgb",Oe="srgb-linear",De="linear",Ie="srgb",Le=7680,Ne=35044,ke="300 es",Ue=2e3,Fe=2001;function ze(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function je(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Be(){const e=je("canvas");return e.style.display="block",e}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const He={};let Ve=null;function Ge(...e){const t="THREE."+e.shift();Ve?Ve("log",t,...e):console.log(t,...e)}function We(...e){const t="THREE."+e.shift();Ve?Ve("warn",t,...e):console.warn(t,...e)}function Xe(...e){const t="THREE."+e.shift();Ve?Ve("error",t,...e):console.error(t,...e)}function qe(...e){const t=e.join(" ");t in He||(He[t]=!0,We(...e))}class Ye{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const r=n[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);e.target=null}}}const Ke=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const $e=Math.PI/180,Ze=180/Math.PI;function Je(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Ke[255&e]+Ke[e>>8&255]+Ke[e>>16&255]+Ke[e>>24&255]+"-"+Ke[255&t]+Ke[t>>8&255]+"-"+Ke[t>>16&15|64]+Ke[t>>24&255]+"-"+Ke[63&n|128]+Ke[n>>8&255]+"-"+Ke[n>>16&255]+Ke[n>>24&255]+Ke[255&r]+Ke[r>>8&255]+Ke[r>>16&255]+Ke[r>>24&255]).toLowerCase()}function Qe(e,t,n){return Math.max(t,Math.min(n,e))}function et(e,t){return(e%t+t)%t}function tt(e,t,n){return(1-n)*e+n*t}function nt(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function rt(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const it=$e,at=function(e){return e*Ze};class ot{constructor(e=0,t=0){ot.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Qe(this.x,e.x,t.x),this.y=Qe(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Qe(this.x,e,t),this.y=Qe(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Qe(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Qe(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class st{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,o){let s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3],d=i[a+0],h=i[a+1],p=i[a+2],f=i[a+3];if(o<=0)return e[t+0]=s,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(o>=1)return e[t+0]=d,e[t+1]=h,e[t+2]=p,void(e[t+3]=f);if(u!==f||s!==d||l!==h||c!==p){let e=s*d+l*h+c*p+u*f;e<0&&(d=-d,h=-h,p=-p,f=-f,e=-e);let t=1-o;if(e<.9995){const n=Math.acos(e),r=Math.sin(n);t=Math.sin(t*n)/r,s=s*t+d*(o=Math.sin(o*n)/r),l=l*t+h*o,c=c*t+p*o,u=u*t+f*o}else{s=s*t+d*o,l=l*t+h*o,c=c*t+p*o,u=u*t+f*o;const e=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=e,l*=e,c*=e,u*=e}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,a){const o=n[r],s=n[r+1],l=n[r+2],c=n[r+3],u=i[a],d=i[a+1],h=i[a+2],p=i[a+3];return e[t]=o*p+c*u+s*h-l*d,e[t+1]=s*p+c*d+l*u-o*h,e[t+2]=l*p+c*h+o*d-s*u,e[t+3]=c*p-o*u-s*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(n/2),c=o(r/2),u=o(i/2),d=s(n/2),h=s(r/2),p=s(i/2);switch(a){case"XYZ":this._x=d*c*u+l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u-d*h*p;break;case"YXZ":this._x=d*c*u+l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u+d*h*p;break;case"ZXY":this._x=d*c*u-l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u-d*h*p;break;case"ZYX":this._x=d*c*u-l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u+d*h*p;break;case"YZX":this._x=d*c*u+l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u-d*h*p;break;case"XZY":this._x=d*c*u-l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u+d*h*p;break;default:We("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],c=t[6],u=t[10],d=n+o+u;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(c-s)*e,this._y=(i-l)*e,this._z=(a-r)*e}else if(n>o&&n>u){const e=2*Math.sqrt(1+n-o-u);this._w=(c-s)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-n-u);this._w=(i-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(s+c)/e}else{const e=2*Math.sqrt(1+u-n-o);this._w=(a-r)/e,this._x=(i+l)/e,this._y=(s+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qe(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=n*c+a*o+r*l-i*s,this._y=r*c+a*s+i*o-n*l,this._z=i*c+a*l+n*s-r*o,this._w=a*c-n*o-r*s-i*l,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,i=e._z,a=e._w,o=this.dot(e);o<0&&(n=-n,r=-r,i=-i,a=-a,o=-o);let s=1-t;if(o<.9995){const e=Math.acos(o),l=Math.sin(e);s=Math.sin(s*e)/l,t=Math.sin(t*e)/l,this._x=this._x*s+n*t,this._y=this._y*s+r*t,this._z=this._z*s+i*t,this._w=this._w*s+a*t,this._onChangeCallback()}else this._x=this._x*s+n*t,this._y=this._y*s+r*t,this._z=this._z*s+i*t,this._w=this._w*s+a*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class lt{constructor(e=0,t=0,n=0){lt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ut.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ut.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=2*(a*r-o*n),c=2*(o*t-i*r),u=2*(i*n-a*t);return this.x=t+s*l+a*u-o*c,this.y=n+s*c+o*l-i*u,this.z=r+s*u+i*c-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Qe(this.x,e.x,t.x),this.y=Qe(this.y,e.y,t.y),this.z=Qe(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Qe(this.x,e,t),this.y=Qe(this.y,e,t),this.z=Qe(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Qe(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ct.copy(this).projectOnVector(e),this.sub(ct)}reflect(e){return this.sub(ct.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Qe(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ct=new lt,ut=new st;class dt{constructor(e,t,n,r,i,a,o,s,l){dt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,o,s,l)}set(e,t,n,r,i,a,o,s,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=i,c[5]=s,c[6]=n,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],c=n[4],u=n[7],d=n[2],h=n[5],p=n[8],f=r[0],m=r[3],g=r[6],v=r[1],y=r[4],x=r[7],b=r[2],_=r[5],w=r[8];return i[0]=a*f+o*v+s*b,i[3]=a*m+o*y+s*_,i[6]=a*g+o*x+s*w,i[1]=l*f+c*v+u*b,i[4]=l*m+c*y+u*_,i[7]=l*g+c*x+u*w,i[2]=d*f+h*v+p*b,i[5]=d*m+h*y+p*_,i[8]=d*g+h*x+p*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-n*i*c+n*o*s+r*i*l-r*a*s}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*a-o*l,d=o*s-c*i,h=l*i-a*s,p=t*u+n*d+r*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(r*l-c*n)*f,e[2]=(o*n-r*a)*f,e[3]=d*f,e[4]=(c*t-r*s)*f,e[5]=(r*i-o*t)*f,e[6]=h*f,e[7]=(n*s-l*t)*f,e[8]=(a*t-n*i)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,o){const s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(ht.makeScale(e,t)),this}rotate(e){return this.premultiply(ht.makeRotation(-e)),this}translate(e,t){return this.premultiply(ht.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const ht=new dt,pt=(new dt).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),ft=(new dt).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function mt(){const e={enabled:!0,workingColorSpace:Oe,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===Ie&&(e.r=vt(e.r),e.g=vt(e.g),e.b=vt(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===Ie&&(e.r=yt(e.r),e.g=yt(e.g),e.b=yt(e.b)),e):e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===Pe?De:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,n){return qe("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,n)},toWorkingColorSpace:function(t,n){return qe("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,n)}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[Oe]:{primaries:t,whitePoint:r,transfer:De,toXYZ:pt,fromXYZ:ft,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Re},outputColorSpaceConfig:{drawingBufferColorSpace:Re}},[Re]:{primaries:t,whitePoint:r,transfer:Ie,toXYZ:pt,fromXYZ:ft,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Re}}}),e}const gt=mt();function vt(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function yt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let xt;class bt{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{void 0===xt&&(xt=je("canvas")),xt.width=e.width,xt.height=e.height;const t=xt.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),n=xt}return n.toDataURL(t)}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=je("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*vt(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*vt(t[e]/255)):t[e]=vt(t[e]);return{data:t,width:e.width,height:e.height}}return We("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let _t=0;class wt{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_t++}),this.uuid=Je(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):"undefined"!=typeof VideoFrame&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(St(r[t].image)):e.push(St(r[t]))}else e=St(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function St(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?bt.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(We("Texture: Unable to serialize Texture."),{})}let Mt=0;const Et=new lt;class Tt extends Ye{constructor(e=Tt.DEFAULT_IMAGE,t=Tt.DEFAULT_MAPPING,n=1001,r=1001,i=1006,a=1008,o=k,s=_,l=Tt.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Mt++}),this.uuid=Je(),this.name="",this.source=new wt(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new ot(0,0),this.repeat=new ot(1,1),this.center=new ot(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new dt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Et).x}get height(){return this.source.getSize(Et).y}get depth(){return this.source.getSize(Et).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(void 0===n){We(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n:We(`Texture.setValues(): property '${t}' does not exist.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case p:e.x=e.x-Math.floor(e.x);break;case f:e.x=e.x<0?0:1;break;case m:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case p:e.y=e.y-Math.floor(e.y);break;case f:e.y=e.y<0?0:1;break;case m:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}Tt.DEFAULT_IMAGE=null,Tt.DEFAULT_MAPPING=300,Tt.DEFAULT_ANISOTROPY=1;class At{constructor(e=0,t=0,n=0,r=1){At.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const a=.01,o=.1,s=e.elements,l=s[0],c=s[4],u=s[8],d=s[1],h=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(c-d)<a&&Math.abs(u-f)<a&&Math.abs(p-m)<a){if(Math.abs(c+d)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(l+h+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,s=(h+1)/2,v=(g+1)/2,y=(c+d)/4,x=(u+f)/4,b=(p+m)/4;return e>s&&e>v?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=x/n):s>v?s<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=y/r,i=b/r):v<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=x/i,r=b/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(d-c)*(d-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(u-f)/v,this.z=(d-c)/v,this.w=Math.acos((l+h+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Qe(this.x,e.x,t.x),this.y=Qe(this.y,e.y,t.y),this.z=Qe(this.z,e.z,t.z),this.w=Qe(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Qe(this.x,e,t),this.y=Qe(this.y,e,t),this.z=Qe(this.z,e,t),this.w=Qe(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Qe(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ct extends Ye{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:y,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new At(0,0,e,t),this.scissorTest=!1,this.viewport=new At(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new Tt(r);this.textures=[];const a=n.count;for(let e=0;e<a;e++)this.textures[e]=i.clone(),this.textures[e].isRenderTargetTexture=!0,this.textures[e].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:y,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let e=0;e<this.textures.length;e++)this.textures[e].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,!0!==this.textures[r].isData3DTexture&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new wt(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Pt extends Ct{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Rt extends Tt{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=g,this.minFilter=g,this.wrapR=f,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Ot extends Tt{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=g,this.minFilter=g,this.wrapR=f,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Dt{constructor(e=new lt(1/0,1/0,1/0),t=new lt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Lt.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Lt.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Lt.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Lt):Lt.fromBufferAttribute(r,t),Lt.applyMatrix4(e.matrixWorld),this.expandByPoint(Lt);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Nt.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Nt.copy(n.boundingBox)),Nt.applyMatrix4(e.matrixWorld),this.union(Nt)}const r=e.children;for(let e=0,n=r.length;e<n;e++)this.expandByObject(r[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Lt),Lt.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ht),Vt.subVectors(this.max,Ht),kt.subVectors(e.a,Ht),Ut.subVectors(e.b,Ht),Ft.subVectors(e.c,Ht),zt.subVectors(Ut,kt),jt.subVectors(Ft,Ut),Bt.subVectors(kt,Ft);let t=[0,-zt.z,zt.y,0,-jt.z,jt.y,0,-Bt.z,Bt.y,zt.z,0,-zt.x,jt.z,0,-jt.x,Bt.z,0,-Bt.x,-zt.y,zt.x,0,-jt.y,jt.x,0,-Bt.y,Bt.x,0];return!!Xt(t,kt,Ut,Ft,Vt)&&(t=[1,0,0,0,1,0,0,0,1],!!Xt(t,kt,Ut,Ft,Vt)&&(Gt.crossVectors(zt,jt),t=[Gt.x,Gt.y,Gt.z],Xt(t,kt,Ut,Ft,Vt)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Lt).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Lt).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(It[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),It[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),It[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),It[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),It[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),It[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),It[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),It[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(It)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const It=[new lt,new lt,new lt,new lt,new lt,new lt,new lt,new lt],Lt=new lt,Nt=new Dt,kt=new lt,Ut=new lt,Ft=new lt,zt=new lt,jt=new lt,Bt=new lt,Ht=new lt,Vt=new lt,Gt=new lt,Wt=new lt;function Xt(e,t,n,r,i){for(let a=0,o=e.length-3;a<=o;a+=3){Wt.fromArray(e,a);const o=i.x*Math.abs(Wt.x)+i.y*Math.abs(Wt.y)+i.z*Math.abs(Wt.z),s=t.dot(Wt),l=n.dot(Wt),c=r.dot(Wt);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>o)return!1}return!0}const qt=new Dt,Yt=new lt,Kt=new lt;class $t{constructor(e=new lt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):qt.setFromPoints(e).getCenter(n);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Yt.subVectors(e,this.center);const t=Yt.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Yt,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Kt.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Yt.copy(e.center).add(Kt)),this.expandByPoint(Yt.copy(e.center).sub(Kt))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Zt=new lt,Jt=new lt,Qt=new lt,en=new lt,tn=new lt,nn=new lt,rn=new lt;class an{constructor(e=new lt,t=new lt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Zt)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Zt.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Zt.copy(this.origin).addScaledVector(this.direction,t),Zt.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Jt.copy(e).add(t).multiplyScalar(.5),Qt.copy(t).sub(e).normalize(),en.copy(this.origin).sub(Jt);const i=.5*e.distanceTo(t),a=-this.direction.dot(Qt),o=en.dot(this.direction),s=-en.dot(Qt),l=en.lengthSq(),c=Math.abs(1-a*a);let u,d,h,p;if(c>0)if(u=a*s-o,d=a*o-s,p=i*c,u>=0)if(d>=-p)if(d<=p){const e=1/c;u*=e,d*=e,h=u*(u+a*d+2*o)+d*(a*u+d+2*s)+l}else d=i,u=Math.max(0,-(a*d+o)),h=-u*u+d*(d+2*s)+l;else d=-i,u=Math.max(0,-(a*d+o)),h=-u*u+d*(d+2*s)+l;else d<=-p?(u=Math.max(0,-(-a*i+o)),d=u>0?-i:Math.min(Math.max(-i,-s),i),h=-u*u+d*(d+2*s)+l):d<=p?(u=0,d=Math.min(Math.max(-i,-s),i),h=d*(d+2*s)+l):(u=Math.max(0,-(a*i+o)),d=u>0?i:Math.min(Math.max(-i,-s),i),h=-u*u+d*(d+2*s)+l);else d=a>0?-i:i,u=Math.max(0,-(a*d+o)),h=-u*u+d*(d+2*s)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(Jt).addScaledVector(Qt,d),h}intersectSphere(e,t){Zt.subVectors(e.center,this.origin);const n=Zt.dot(this.direction),r=Zt.dot(Zt)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),o=n-a,s=n+a;return s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,o,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),c>=0?(i=(e.min.y-d.y)*c,a=(e.max.y-d.y)*c):(i=(e.max.y-d.y)*c,a=(e.min.y-d.y)*c),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),u>=0?(o=(e.min.z-d.z)*u,s=(e.max.z-d.z)*u):(o=(e.max.z-d.z)*u,s=(e.min.z-d.z)*u),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,Zt)}intersectTriangle(e,t,n,r,i){tn.subVectors(t,e),nn.subVectors(n,e),rn.crossVectors(tn,nn);let a,o=this.direction.dot(rn);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}en.subVectors(this.origin,e);const s=a*this.direction.dot(nn.crossVectors(en,nn));if(s<0)return null;const l=a*this.direction.dot(tn.cross(en));if(l<0)return null;if(s+l>o)return null;const c=-a*en.dot(rn);return c<0?null:this.at(c/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class on{constructor(e,t,n,r,i,a,o,s,l,c,u,d,h,p,f,m){on.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,o,s,l,c,u,d,h,p,f,m)}set(e,t,n,r,i,a,o,s,l,c,u,d,h,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=d,g[3]=h,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new on).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return 0===this.determinant()?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(0===e.determinant())return this.identity();const t=this.elements,n=e.elements,r=1/sn.setFromMatrixColumn(e,0).length(),i=1/sn.setFromMatrixColumn(e,1).length(),a=1/sn.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=a*c,n=a*u,r=o*c,i=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-o*s,t[2]=i-e*l,t[6]=r+n*l,t[10]=a*s}else if("YXZ"===e.order){const e=s*c,n=s*u,r=l*c,i=l*u;t[0]=e+i*o,t[4]=r*o-n,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-o,t[2]=n*o-r,t[6]=i+e*o,t[10]=a*s}else if("ZXY"===e.order){const e=s*c,n=s*u,r=l*c,i=l*u;t[0]=e-i*o,t[4]=-a*u,t[8]=r+n*o,t[1]=n+r*o,t[5]=a*c,t[9]=i-e*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){const e=a*c,n=a*u,r=o*c,i=o*u;t[0]=s*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=s*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){const e=a*s,n=a*l,r=o*s,i=o*l;t[0]=s*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=a*s,n=a*l,r=o*s,i=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=a*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=o*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cn,e,un)}lookAt(e,t,n){const r=this.elements;return pn.subVectors(e,t),0===pn.lengthSq()&&(pn.z=1),pn.normalize(),dn.crossVectors(n,pn),0===dn.lengthSq()&&(1===Math.abs(n.z)?pn.x+=1e-4:pn.z+=1e-4,pn.normalize(),dn.crossVectors(n,pn)),dn.normalize(),hn.crossVectors(pn,dn),r[0]=dn.x,r[4]=hn.x,r[8]=pn.x,r[1]=dn.y,r[5]=hn.y,r[9]=pn.y,r[2]=dn.z,r[6]=hn.z,r[10]=pn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],c=n[1],u=n[5],d=n[9],h=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],b=n[15],_=r[0],w=r[4],S=r[8],M=r[12],E=r[1],T=r[5],A=r[9],C=r[13],P=r[2],R=r[6],O=r[10],D=r[14],I=r[3],L=r[7],N=r[11],k=r[15];return i[0]=a*_+o*E+s*P+l*I,i[4]=a*w+o*T+s*R+l*L,i[8]=a*S+o*A+s*O+l*N,i[12]=a*M+o*C+s*D+l*k,i[1]=c*_+u*E+d*P+h*I,i[5]=c*w+u*T+d*R+h*L,i[9]=c*S+u*A+d*O+h*N,i[13]=c*M+u*C+d*D+h*k,i[2]=p*_+f*E+m*P+g*I,i[6]=p*w+f*T+m*R+g*L,i[10]=p*S+f*A+m*O+g*N,i[14]=p*M+f*C+m*D+g*k,i[3]=v*_+y*E+x*P+b*I,i[7]=v*w+y*T+x*R+b*L,i[11]=v*S+y*A+x*O+b*N,i[15]=v*M+y*C+x*D+b*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14],p=e[3],f=e[7],m=e[11],g=e[15],v=s*h-l*d,y=o*h-l*u,x=o*d-s*u,b=a*h-l*c,_=a*d-s*c,w=a*u-o*c;return t*(f*v-m*y+g*x)-n*(p*v-m*b+g*_)+r*(p*y-f*b+g*w)-i*(p*x-f*_+m*w)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*d*l+f*s*h-o*m*h-u*s*g+o*d*g,y=p*d*l-c*m*l-p*s*h+a*m*h+c*s*g-a*d*g,x=c*f*l-p*u*l+p*o*h-a*f*h-c*o*g+a*u*g,b=p*u*s-c*f*s-p*o*d+a*f*d+c*o*m-a*u*m,_=t*v+n*y+r*x+i*b;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/_;return e[0]=v*w,e[1]=(f*d*i-u*m*i-f*r*h+n*m*h+u*r*g-n*d*g)*w,e[2]=(o*m*i-f*s*i+f*r*l-n*m*l-o*r*g+n*s*g)*w,e[3]=(u*s*i-o*d*i-u*r*l+n*d*l+o*r*h-n*s*h)*w,e[4]=y*w,e[5]=(c*m*i-p*d*i+p*r*h-t*m*h-c*r*g+t*d*g)*w,e[6]=(p*s*i-a*m*i-p*r*l+t*m*l+a*r*g-t*s*g)*w,e[7]=(a*d*i-c*s*i+c*r*l-t*d*l-a*r*h+t*s*h)*w,e[8]=x*w,e[9]=(p*u*i-c*f*i-p*n*h+t*f*h+c*n*g-t*u*g)*w,e[10]=(a*f*i-p*o*i+p*n*l-t*f*l-a*n*g+t*o*g)*w,e[11]=(c*o*i-a*u*i-c*n*l+t*u*l+a*n*h-t*o*h)*w,e[12]=b*w,e[13]=(c*f*r-p*u*r+p*n*d-t*f*d-c*n*m+t*u*m)*w,e[14]=(p*o*r-a*f*r-p*n*s+t*f*s+a*n*m-t*o*m)*w,e[15]=(a*u*r-c*o*r+c*n*s-t*u*s-a*n*d+t*o*d)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,l=i*a,c=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,c*o+n,c*s-r*a,0,l*s-r*o,c*s+r*a,i*s*s+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,c=a+a,u=o+o,d=i*l,h=i*c,p=i*u,f=a*c,m=a*u,g=o*u,v=s*l,y=s*c,x=s*u,b=n.x,_=n.y,w=n.z;return r[0]=(1-(f+g))*b,r[1]=(h+x)*b,r[2]=(p-y)*b,r[3]=0,r[4]=(h-x)*_,r[5]=(1-(d+g))*_,r[6]=(m+v)*_,r[7]=0,r[8]=(p+y)*w,r[9]=(m-v)*w,r[10]=(1-(d+f))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],0===this.determinant())return n.set(1,1,1),t.identity(),this;let i=sn.set(r[0],r[1],r[2]).length();const a=sn.set(r[4],r[5],r[6]).length(),o=sn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),ln.copy(this);const s=1/i,l=1/a,c=1/o;return ln.elements[0]*=s,ln.elements[1]*=s,ln.elements[2]*=s,ln.elements[4]*=l,ln.elements[5]*=l,ln.elements[6]*=l,ln.elements[8]*=c,ln.elements[9]*=c,ln.elements[10]*=c,t.setFromRotationMatrix(ln),n.x=i,n.y=a,n.z=o,this}makePerspective(e,t,n,r,i,a,o=2e3,s=!1){const l=this.elements,c=2*i/(t-e),u=2*i/(n-r),d=(t+e)/(t-e),h=(n+r)/(n-r);let p,f;if(s)p=i/(a-i),f=a*i/(a-i);else if(o===Ue)p=-(a+i)/(a-i),f=-2*a*i/(a-i);else{if(o!==Fe)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-a/(a-i),f=-a*i/(a-i)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,i,a,o=2e3,s=!1){const l=this.elements,c=2/(t-e),u=2/(n-r),d=-(t+e)/(t-e),h=-(n+r)/(n-r);let p,f;if(s)p=1/(a-i),f=a/(a-i);else if(o===Ue)p=-2/(a-i),f=-(a+i)/(a-i);else{if(o!==Fe)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);p=-1/(a-i),f=-i/(a-i)}return l[0]=c,l[4]=0,l[8]=0,l[12]=d,l[1]=0,l[5]=u,l[9]=0,l[13]=h,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const sn=new lt,ln=new on,cn=new lt(0,0,0),un=new lt(1,1,1),dn=new lt,hn=new lt,pn=new lt,fn=new on,mn=new st;class gn{constructor(e=0,t=0,n=0,r=gn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],l=r[5],c=r[9],u=r[2],d=r[6],h=r[10];switch(t){case"XYZ":this._y=Math.asin(Qe(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Qe(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,h),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Qe(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-Qe(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Qe(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-Qe(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,h),this._y=0);break;default:We("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return fn.makeRotationFromQuaternion(e),this.setFromRotationMatrix(fn,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return mn.setFromEuler(this),this.setFromQuaternion(mn,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}gn.DEFAULT_ORDER="XYZ";class vn{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let yn=0;const xn=new lt,bn=new st,_n=new on,wn=new lt,Sn=new lt,Mn=new lt,En=new st,Tn=new lt(1,0,0),An=new lt(0,1,0),Cn=new lt(0,0,1),Pn={type:"added"},Rn={type:"removed"},On={type:"childadded",child:null},Dn={type:"childremoved",child:null};class In extends Ye{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:yn++}),this.uuid=Je(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=In.DEFAULT_UP.clone();const e=new lt,t=new gn,n=new st,r=new lt(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new on},normalMatrix:{value:new dt}}),this.matrix=new on,this.matrixWorld=new on,this.matrixAutoUpdate=In.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=In.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new vn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return bn.setFromAxisAngle(e,t),this.quaternion.multiply(bn),this}rotateOnWorldAxis(e,t){return bn.setFromAxisAngle(e,t),this.quaternion.premultiply(bn),this}rotateX(e){return this.rotateOnAxis(Tn,e)}rotateY(e){return this.rotateOnAxis(An,e)}rotateZ(e){return this.rotateOnAxis(Cn,e)}translateOnAxis(e,t){return xn.copy(e).applyQuaternion(this.quaternion),this.position.add(xn.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Tn,e)}translateY(e){return this.translateOnAxis(An,e)}translateZ(e){return this.translateOnAxis(Cn,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_n.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?wn.copy(e):wn.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Sn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_n.lookAt(Sn,wn,this.up):_n.lookAt(wn,Sn,this.up),this.quaternion.setFromRotationMatrix(_n),r&&(_n.extractRotation(r.matrixWorld),bn.setFromRotationMatrix(_n),this.quaternion.premultiply(bn.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(Xe("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Pn),On.child=e,this.dispatchEvent(On),On.child=null):Xe("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Rn),Dn.child=e,this.dispatchEvent(Dn),Dn.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),_n.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),_n.multiply(e.parent.matrixWorld)),e.applyMatrix4(_n),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Pn),On.child=e,this.dispatchEvent(On),On.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sn,e,Mn),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sn,En,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map((e=>({...e,boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0}))),r.instanceInfo=this._instanceInfo.map((e=>({...e}))),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(r.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=a(e.geometries),r=a(e.materials),i=a(e.textures),o=a(e.images),s=a(e.shapes),l=a(e.skeletons),c=a(e.animations),u=a(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),o.length>0&&(n.images=o),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function a(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}In.DEFAULT_UP=new lt(0,1,0),In.DEFAULT_MATRIX_AUTO_UPDATE=!0,In.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ln=new lt,Nn=new lt,kn=new lt,Un=new lt,Fn=new lt,zn=new lt,jn=new lt,Bn=new lt,Hn=new lt,Vn=new lt,Gn=new At,Wn=new At,Xn=new At;class qn{constructor(e=new lt,t=new lt,n=new lt){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ln.subVectors(e,t),r.cross(Ln);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Ln.subVectors(r,t),Nn.subVectors(n,t),kn.subVectors(e,t);const a=Ln.dot(Ln),o=Ln.dot(Nn),s=Ln.dot(kn),l=Nn.dot(Nn),c=Nn.dot(kn),u=a*l-o*o;if(0===u)return i.set(0,0,0),null;const d=1/u,h=(l*s-o*c)*d,p=(a*c-o*s)*d;return i.set(1-h-p,p,h)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,Un)&&Un.x>=0&&Un.y>=0&&Un.x+Un.y<=1}static getInterpolation(e,t,n,r,i,a,o,s){return null===this.getBarycoord(e,t,n,r,Un)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,Un.x),s.addScaledVector(a,Un.y),s.addScaledVector(o,Un.z),s)}static getInterpolatedAttribute(e,t,n,r,i,a){return Gn.setScalar(0),Wn.setScalar(0),Xn.setScalar(0),Gn.fromBufferAttribute(e,t),Wn.fromBufferAttribute(e,n),Xn.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(Gn,i.x),a.addScaledVector(Wn,i.y),a.addScaledVector(Xn,i.z),a}static isFrontFacing(e,t,n,r){return Ln.subVectors(n,t),Nn.subVectors(e,t),Ln.cross(Nn).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ln.subVectors(this.c,this.b),Nn.subVectors(this.a,this.b),.5*Ln.cross(Nn).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return qn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return qn.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return qn.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return qn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return qn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,o;Fn.subVectors(r,n),zn.subVectors(i,n),Bn.subVectors(e,n);const s=Fn.dot(Bn),l=zn.dot(Bn);if(s<=0&&l<=0)return t.copy(n);Hn.subVectors(e,r);const c=Fn.dot(Hn),u=zn.dot(Hn);if(c>=0&&u<=c)return t.copy(r);const d=s*u-c*l;if(d<=0&&s>=0&&c<=0)return a=s/(s-c),t.copy(n).addScaledVector(Fn,a);Vn.subVectors(e,i);const h=Fn.dot(Vn),p=zn.dot(Vn);if(p>=0&&h<=p)return t.copy(i);const f=h*l-s*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(n).addScaledVector(zn,o);const m=c*p-h*u;if(m<=0&&u-c>=0&&h-p>=0)return jn.subVectors(i,r),o=(u-c)/(u-c+(h-p)),t.copy(r).addScaledVector(jn,o);const g=1/(m+f+d);return a=f*g,o=d*g,t.copy(n).addScaledVector(Fn,a).addScaledVector(zn,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Yn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Kn={h:0,s:0,l:0},$n={h:0,s:0,l:0};function Zn(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Jn{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Re){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,gt.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=gt.workingColorSpace){return this.r=e,this.g=t,this.b=n,gt.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=gt.workingColorSpace){if(e=et(e,1),t=Qe(t,0,1),n=Qe(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Zn(i,r,e+1/3),this.g=Zn(i,r,e),this.b=Zn(i,r,e-1/3)}return gt.colorSpaceToWorking(this,r),this}setStyle(e,t=Re){function n(t){void 0!==t&&parseFloat(t)<1&&We("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:We("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===i)return this.setHex(parseInt(n,16),t);We("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Re){const n=Yn[e.toLowerCase()];return void 0!==n?this.setHex(n,t):We("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=vt(e.r),this.g=vt(e.g),this.b=vt(e.b),this}copyLinearToSRGB(e){return this.r=yt(e.r),this.g=yt(e.g),this.b=yt(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Re){return gt.workingToColorSpace(Qn.copy(this),e),65536*Math.round(Qe(255*Qn.r,0,255))+256*Math.round(Qe(255*Qn.g,0,255))+Math.round(Qe(255*Qn.b,0,255))}getHexString(e=Re){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=gt.workingColorSpace){gt.workingToColorSpace(Qn.copy(this),t);const n=Qn.r,r=Qn.g,i=Qn.b,a=Math.max(n,r,i),o=Math.min(n,r,i);let s,l;const c=(o+a)/2;if(o===a)s=0,l=0;else{const e=a-o;switch(l=c<=.5?e/(a+o):e/(2-a-o),a){case n:s=(r-i)/e+(r<i?6:0);break;case r:s=(i-n)/e+2;break;case i:s=(n-r)/e+4}s/=6}return e.h=s,e.s=l,e.l=c,e}getRGB(e,t=gt.workingColorSpace){return gt.workingToColorSpace(Qn.copy(this),t),e.r=Qn.r,e.g=Qn.g,e.b=Qn.b,e}getStyle(e=Re){gt.workingToColorSpace(Qn.copy(this),e);const t=Qn.r,n=Qn.g,r=Qn.b;return e!==Re?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(Kn),this.setHSL(Kn.h+e,Kn.s+t,Kn.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Kn),e.getHSL($n);const n=tt(Kn.h,$n.h,t),r=tt(Kn.s,$n.s,t),i=tt(Kn.l,$n.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Qn=new Jn;Jn.NAMES=Yn;let er=0;class tr extends Ye{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:er++}),this.uuid=Je(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=a,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Jn(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Le,this.stencilZFail=Le,this.stencilZPass=Le,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){We(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:We(`Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==a&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Le&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Le&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Le&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!1===this.allowOverride&&(n.allowOverride=!1),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class nr extends tr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Jn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new gn,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const rr=new lt,ir=new ot;let ar=0;class or{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:ar++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Ne,this.updateRanges=[],this.gpuType=A,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)ir.fromBufferAttribute(this,t),ir.applyMatrix3(e),this.setXY(t,ir.x,ir.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)rr.fromBufferAttribute(this,t),rr.applyMatrix3(e),this.setXYZ(t,rr.x,rr.y,rr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)rr.fromBufferAttribute(this,t),rr.applyMatrix4(e),this.setXYZ(t,rr.x,rr.y,rr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)rr.fromBufferAttribute(this,t),rr.applyNormalMatrix(e),this.setXYZ(t,rr.x,rr.y,rr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)rr.fromBufferAttribute(this,t),rr.transformDirection(e),this.setXYZ(t,rr.x,rr.y,rr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=nt(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=rt(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=nt(t,this.array)),t}setX(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=nt(t,this.array)),t}setY(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=nt(t,this.array)),t}setZ(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=nt(t,this.array)),t}setW(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array),i=rt(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Ne&&(e.usage=this.usage),e}}class sr extends or{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class lr extends or{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class cr extends or{constructor(e,t,n){super(new Float32Array(e),t,n)}}let ur=0;const dr=new on,hr=new In,pr=new lt,fr=new Dt,mr=new Dt,gr=new lt;class vr extends Ye{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ur++}),this.uuid=Je(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ze(e)?lr:sr)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new dt).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return dr.makeRotationFromQuaternion(e),this.applyMatrix4(dr),this}rotateX(e){return dr.makeRotationX(e),this.applyMatrix4(dr),this}rotateY(e){return dr.makeRotationY(e),this.applyMatrix4(dr),this}rotateZ(e){return dr.makeRotationZ(e),this.applyMatrix4(dr),this}translate(e,t,n){return dr.makeTranslation(e,t,n),this.applyMatrix4(dr),this}scale(e,t,n){return dr.makeScale(e,t,n),this.applyMatrix4(dr),this}lookAt(e){return hr.lookAt(e),hr.updateMatrix(),this.applyMatrix4(hr.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pr).negate(),this.translate(pr.x,pr.y,pr.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new cr(t,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const n=e[r];t.setXYZ(r,n.x,n.y,n.z||0)}e.length>t.count&&We("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Dt);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return Xe("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new lt(-1/0,-1/0,-1/0),new lt(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];fr.setFromBufferAttribute(n),this.morphTargetsRelative?(gr.addVectors(this.boundingBox.min,fr.min),this.boundingBox.expandByPoint(gr),gr.addVectors(this.boundingBox.max,fr.max),this.boundingBox.expandByPoint(gr)):(this.boundingBox.expandByPoint(fr.min),this.boundingBox.expandByPoint(fr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Xe('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new $t);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return Xe("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new lt,1/0);if(e){const n=this.boundingSphere.center;if(fr.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];mr.setFromBufferAttribute(n),this.morphTargetsRelative?(gr.addVectors(fr.min,mr.min),fr.expandByPoint(gr),gr.addVectors(fr.max,mr.max),fr.expandByPoint(gr)):(fr.expandByPoint(mr.min),fr.expandByPoint(mr.max))}fr.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)gr.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(gr));if(t)for(let i=0,a=t.length;i<a;i++){const a=t[i],o=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)gr.fromBufferAttribute(a,t),o&&(pr.fromBufferAttribute(e,t),gr.add(pr)),r=Math.max(r,n.distanceToSquared(gr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&Xe('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void Xe("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new or(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),o=[],s=[];for(let e=0;e<n.count;e++)o[e]=new lt,s[e]=new lt;const l=new lt,c=new lt,u=new lt,d=new ot,h=new ot,p=new ot,f=new lt,m=new lt;function g(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,r),d.fromBufferAttribute(i,e),h.fromBufferAttribute(i,t),p.fromBufferAttribute(i,r),c.sub(l),u.sub(l),h.sub(d),p.sub(d);const a=1/(h.x*p.y-p.x*h.y);isFinite(a)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(u,-h.y).multiplyScalar(a),m.copy(u).multiplyScalar(h.x).addScaledVector(c,-p.x).multiplyScalar(a),o[e].add(f),o[t].add(f),o[r].add(f),s[e].add(m),s[t].add(m),s[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)g(e.getX(t+0),e.getX(t+1),e.getX(t+2))}const y=new lt,x=new lt,b=new lt,_=new lt;function w(e){b.fromBufferAttribute(r,e),_.copy(b);const t=o[e];y.copy(t),y.sub(b.multiplyScalar(b.dot(t))).normalize(),x.crossVectors(_,t);const n=x.dot(s[e])<0?-1:1;a.setXYZW(e,y.x,y.y,y.z,n)}for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)w(e.getX(t+0)),w(e.getX(t+1)),w(e.getX(t+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new or(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new lt,i=new lt,a=new lt,o=new lt,s=new lt,l=new lt,c=new lt,u=new lt;if(e)for(let d=0,h=e.count;d<h;d+=3){const h=e.getX(d+0),p=e.getX(d+1),f=e.getX(d+2);r.fromBufferAttribute(t,h),i.fromBufferAttribute(t,p),a.fromBufferAttribute(t,f),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),o.fromBufferAttribute(n,h),s.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),o.add(c),s.add(c),l.add(c),n.setXYZ(h,o.x,o.y,o.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)gr.fromBufferAttribute(e,t),gr.normalize(),e.setXYZ(t,gr.x,gr.y,gr.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r);let o=0,s=0;for(let i=0,l=t.length;i<l;i++){o=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*r;for(let e=0;e<r;e++)a[s++]=n[o++]}return new or(a,r,i)}if(null===this.index)return We("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vr,n=this.index.array,r=this.attributes;for(const i in r){const a=e(r[i],n);t.setAttribute(i,a)}const i=this.morphAttributes;for(const r in i){const a=[],o=i[r];for(let t=0,r=o.length;t<r;t++){const r=e(o[t],n);a.push(r)}t.morphAttributes[r]=a}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let e=0,n=a.length;e<n;e++){const n=a[e];t.addGroup(n.start,n.count,n.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const r=n[t];e.data.attributes[t]=r.toJSON(e.data)}const r={};let i=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],a=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];a.push(r.toJSON(e.data))}a.length>0&&(r[t]=a,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere=o.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const r=e.attributes;for(const e in r){const n=r[e];this.setAttribute(e,n.clone(t))}const i=e.morphAttributes;for(const e in i){const n=[],r=i[e];for(let e=0,i=r.length;e<i;e++)n.push(r[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let e=0,t=a.length;e<t;e++){const t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const yr=new on,xr=new an,br=new $t,_r=new lt,wr=new lt,Sr=new lt,Mr=new lt,Er=new lt,Tr=new lt,Ar=new lt,Cr=new lt;class Pr extends In{constructor(e=new vr,t=new nr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(i&&o){Tr.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=o[n],s=i[n];0!==r&&(Er.fromBufferAttribute(s,e),a?Tr.addScaledVector(Er,r):Tr.addScaledVector(Er.sub(t),r))}t.add(Tr)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),br.copy(n.boundingSphere),br.applyMatrix4(i),xr.copy(e.ray).recast(e.near),!1===br.containsPoint(xr.origin)){if(null===xr.intersectSphere(br,_r))return;if(xr.origin.distanceToSquared(_r)>(e.far-e.near)**2)return}yr.copy(i).invert(),xr.copy(e.ray).applyMatrix4(yr),null!==n.boundingBox&&!1===xr.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,xr)}}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,d=i.groups,h=i.drawRange;if(null!==o)if(Array.isArray(a))for(let i=0,s=d.length;i<s;i++){const s=d[i],p=a[s.materialIndex];for(let i=Math.max(s.start,h.start),a=Math.min(o.count,Math.min(s.start+s.count,h.start+h.count));i<a;i+=3)r=Rr(this,p,e,n,l,c,u,o.getX(i),o.getX(i+1),o.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=s.materialIndex,t.push(r))}else for(let i=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);i<s;i+=3)r=Rr(this,a,e,n,l,c,u,o.getX(i),o.getX(i+1),o.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r));else if(void 0!==s)if(Array.isArray(a))for(let i=0,o=d.length;i<o;i++){const o=d[i],p=a[o.materialIndex];for(let i=Math.max(o.start,h.start),a=Math.min(s.count,Math.min(o.start+o.count,h.start+h.count));i<a;i+=3)r=Rr(this,p,e,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=o.materialIndex,t.push(r))}else for(let i=Math.max(0,h.start),o=Math.min(s.count,h.start+h.count);i<o;i+=3)r=Rr(this,a,e,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}function Rr(e,t,n,r,i,a,o,s,l,c){e.getVertexPosition(s,wr),e.getVertexPosition(l,Sr),e.getVertexPosition(c,Mr);const u=function(e,t,n,r,i,a,o,s){let l;if(l=1===t.side?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,0===t.side,s),null===l)return null;Cr.copy(s),Cr.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(Cr);return c<n.near||c>n.far?null:{distance:c,point:Cr.clone(),object:e}}(e,t,n,r,wr,Sr,Mr,Ar);if(u){const e=new lt;qn.getBarycoord(Ar,wr,Sr,Mr,e),i&&(u.uv=qn.getInterpolatedAttribute(i,s,l,c,e,new ot)),a&&(u.uv1=qn.getInterpolatedAttribute(a,s,l,c,e,new ot)),o&&(u.normal=qn.getInterpolatedAttribute(o,s,l,c,e,new lt),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const t={a:s,b:l,c,normal:new lt,materialIndex:0};qn.getNormal(wr,Sr,Mr,t.normal),u.face=t,u.barycoord=e}return u}class Or extends vr{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const o=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const s=[],l=[],c=[],u=[];let d=0,h=0;function p(e,t,n,r,i,a,p,f,m,g,v){const y=a/m,x=p/g,b=a/2,_=p/2,w=f/2,S=m+1,M=g+1;let E=0,T=0;const A=new lt;for(let a=0;a<M;a++){const o=a*x-_;for(let s=0;s<S;s++){const d=s*y-b;A[e]=d*r,A[t]=o*i,A[n]=w,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(s/m),u.push(1-a/g),E+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=d+t+S*e,r=d+t+S*(e+1),i=d+(t+1)+S*(e+1),a=d+(t+1)+S*e;s.push(n,r,a),s.push(r,i,a),T+=6}o.addGroup(h,T,v),h+=T,d+=E}p("z","y","x",-1,-1,n,t,e,a,i,0),p("z","y","x",1,-1,n,t,-e,a,i,1),p("x","z","y",1,1,e,n,t,r,a,2),p("x","z","y",1,-1,e,n,-t,r,a,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new cr(l,3)),this.setAttribute("normal",new cr(c,3)),this.setAttribute("uv",new cr(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Or(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Dr(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(We("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Ir(e){const t={};for(let n=0;n<e.length;n++){const r=Dr(e[n]);for(const e in r)t[e]=r[e]}return t}function Lr(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:gt.workingColorSpace}const Nr={clone:Dr,merge:Ir};class kr extends tr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Dr(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Ur extends In{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new on,this.projectionMatrix=new on,this.projectionMatrixInverse=new on,this.coordinateSystem=Ue,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Fr=new lt,zr=new ot,jr=new ot;class Br extends Ur{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Ze*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*$e*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Ze*Math.atan(Math.tan(.5*$e*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Fr.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Fr.x,Fr.y).multiplyScalar(-e/Fr.z),Fr.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Fr.x,Fr.y).multiplyScalar(-e/Fr.z)}getViewSize(e,t){return this.getViewBounds(e,zr,jr),t.subVectors(jr,zr)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*$e*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,o=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/o,r*=a.width/e,n*=a.height/o}const o=this.filmOffset;0!==o&&(i+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Hr=-90;class Vr extends In{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Br(Hr,1,e,t);r.layers=this.layers,this.add(r);const i=new Br(Hr,1,e,t);i.layers=this.layers,this.add(i);const a=new Br(Hr,1,e,t);a.layers=this.layers,this.add(a);const o=new Br(Hr,1,e,t);o.layers=this.layers,this.add(o);const s=new Br(Hr,1,e,t);s.layers=this.layers,this.add(s);const l=new Br(Hr,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,o,s]=t;for(const e of t)this.remove(e);if(e===Ue)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),s.up.set(0,1,0),s.lookAt(0,0,-1);else{if(e!==Fe)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),s.up.set(0,-1,0),s.lookAt(0,0,-1)}for(const e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,o,s,l,c]=this.children,u=e.getRenderTarget(),d=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,o),e.setRenderTarget(n,3,r),e.render(t,s),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(u,d,h),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class Gr extends Tt{constructor(e=[],t=301,n,r,i,a,o,s,l,c){super(e,t,n,r,i,a,o,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Wr extends Pt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Gr(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new Or(5,5,5),o=new kr({name:"CubemapFromEquirect",uniforms:Dr(n),vertexShader:r,fragmentShader:i,side:1,blending:0});o.uniforms.tEquirect.value=t;const s=new Pr(a,o),l=t.minFilter;return t.minFilter===b&&(t.minFilter=y),new Vr(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(i)}}class Xr extends In{constructor(){super(),this.isGroup=!0,this.type="Group"}}const qr={type:"move"};class Yr{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Xr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Xr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new lt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new lt),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Xr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new lt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new lt),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;for(const r of e.hand.values()){const e=t.getJointPose(r,n),i=this._getHandJoint(l,r);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],o=r.position.distanceTo(i.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1));null!==o&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(qr)))}return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Xr;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Kr extends In{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new gn,this.environmentIntensity=1,this.environmentRotation=new gn,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class $r{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Ne,this.updateRanges=[],this.version=0,this.uuid=Je()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Je()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Je()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Zr=new lt;class Jr{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.applyMatrix4(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.applyNormalMatrix(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.transformDirection(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=nt(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=rt(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=nt(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=nt(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=nt(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=nt(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array),i=rt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){Ge("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new or(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Jr(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){Ge("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const Qr=new lt,ei=new At,ti=new At,ni=new lt,ri=new on,ii=new lt,ai=new $t,oi=new on,si=new an;class li extends Pr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=c,this.bindMatrix=new on,this.bindMatrixInverse=new on,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Dt),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let e=0;e<t.count;e++)this.getVertexPosition(e,ii),this.boundingBox.expandByPoint(ii)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new $t),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let e=0;e<t.count;e++)this.getVertexPosition(e,ii),this.boundingSphere.expandByPoint(ii)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),ai.copy(this.boundingSphere),ai.applyMatrix4(r),!1!==e.ray.intersectsSphere(ai)&&(oi.copy(r).invert(),si.copy(e.ray).applyMatrix4(oi),null!==this.boundingBox&&!1===si.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,si)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new At,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===c?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():We("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;ei.fromBufferAttribute(r.attributes.skinIndex,e),ti.fromBufferAttribute(r.attributes.skinWeight,e),Qr.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const r=ti.getComponent(e);if(0!==r){const i=ei.getComponent(e);ri.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(ni.copy(Qr).applyMatrix4(ri),r)}}return t.applyMatrix4(this.bindMatrixInverse)}}class ci extends In{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ui extends Tt{constructor(e=null,t=1,n=1,r,i,a,o,s,l=1003,c=1003,u,d){super(null,a,o,s,l,c,r,i,u,d),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const di=new on,hi=new on;class pi{constructor(e=[],t=[]){this.uuid=Je(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){We("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new on)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new on;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,i=e.length;r<i;r++){const i=e[r]?e[r].matrixWorld:hi;di.multiplyMatrices(i,t[r]),di.toArray(n,16*r)}null!==r&&(r.needsUpdate=!0)}clone(){return new pi(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new ui(t,e,e,k,A);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let i=t[r];void 0===i&&(We("Skeleton: No bone found with UUID:",r),i=new ci),this.bones.push(i),this.boneInverses.push((new on).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class fi extends or{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const mi=new on,gi=new on,vi=[],yi=new Dt,xi=new on,bi=new Pr,_i=new $t;class wi extends Pr{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new fi(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let e=0;e<n;e++)this.setMatrixAt(e,xi)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Dt),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,mi),yi.copy(e.boundingBox).applyMatrix4(mi),this.boundingBox.union(yi)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new $t),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,mi),_i.copy(e.boundingSphere).applyMatrix4(mi),this.boundingSphere.union(_i)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,i=e*(n.length+1)+1;for(let e=0;e<n.length;e++)n[e]=r[i+e]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(bi.geometry=this.geometry,bi.material=this.material,void 0!==bi.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),_i.copy(this.boundingSphere),_i.applyMatrix4(n),!1!==e.ray.intersectsSphere(_i)))for(let i=0;i<r;i++){this.getMatrixAt(i,mi),gi.multiplyMatrices(n,mi),bi.matrixWorld=gi,bi.raycast(e,vi);for(let e=0,n=vi.length;e<n;e++){const n=vi[e];n.instanceId=i,n.object=this,t.push(n)}vi.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new fi(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;null===this.morphTexture&&(this.morphTexture=new ui(new Float32Array(r*this.count),r,this.count,z,A));const i=this.morphTexture.source.data.data;let a=0;for(let e=0;e<n.length;e++)a+=n[e];const o=this.geometry.morphTargetsRelative?1:1-a,s=r*e;i[s]=o,i.set(n,s+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const Si=new lt,Mi=new lt,Ei=new dt;class Ti{constructor(e=new lt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Si.subVectors(n,t).cross(Mi.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Si),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ei.getNormalMatrix(e),r=this.coplanarPoint(Si).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ai=new $t,Ci=new ot(.5,.5),Pi=new lt;class Ri{constructor(e=new Ti,t=new Ti,n=new Ti,r=new Ti,i=new Ti,a=new Ti){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=2e3,n=!1){const r=this.planes,i=e.elements,a=i[0],o=i[1],s=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],p=i[8],f=i[9],m=i[10],g=i[11],v=i[12],y=i[13],x=i[14],b=i[15];if(r[0].setComponents(l-a,h-c,g-p,b-v).normalize(),r[1].setComponents(l+a,h+c,g+p,b+v).normalize(),r[2].setComponents(l+o,h+u,g+f,b+y).normalize(),r[3].setComponents(l-o,h-u,g-f,b-y).normalize(),n)r[4].setComponents(s,d,m,x).normalize(),r[5].setComponents(l-s,h-d,g-m,b-x).normalize();else if(r[4].setComponents(l-s,h-d,g-m,b-x).normalize(),t===Ue)r[5].setComponents(l+s,h+d,g+m,b+x).normalize();else{if(t!==Fe)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(s,d,m,x).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Ai.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Ai.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ai)}intersectsSprite(e){Ai.center.set(0,0,0);const t=Ci.distanceTo(e.center);return Ai.radius=.7071067811865476+t,Ai.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ai)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Pi.x=r.normal.x>0?e.max.x:e.min.x,Pi.y=r.normal.y>0?e.max.y:e.min.y,Pi.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Pi)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class Oi extends tr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Jn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Di=new lt,Ii=new lt,Li=new on,Ni=new an,ki=new $t,Ui=new lt,Fi=new lt;class zi extends In{constructor(e=new vr,t=new Oi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)Di.fromBufferAttribute(t,e-1),Ii.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Di.distanceTo(Ii);e.setAttribute("lineDistance",new cr(n,1))}else We("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ki.copy(n.boundingSphere),ki.applyMatrix4(r),ki.radius+=i,!1===e.ray.intersectsSphere(ki))return;Li.copy(r).invert(),Ni.copy(e.ray).applyMatrix4(Li);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,a.start),r=Math.min(c.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=c.getX(i),r=c.getX(i+1),a=ji(this,e,Ni,s,n,r,i);a&&t.push(a)}if(this.isLineLoop){const i=c.getX(r-1),a=c.getX(n),o=ji(this,e,Ni,s,i,a,r-1);o&&t.push(o)}}else{const n=Math.max(0,a.start),r=Math.min(u.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=ji(this,e,Ni,s,i,i+1,i);n&&t.push(n)}if(this.isLineLoop){const i=ji(this,e,Ni,s,r-1,n,r-1);i&&t.push(i)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function ji(e,t,n,r,i,a,o){const s=e.geometry.attributes.position;if(Di.fromBufferAttribute(s,i),Ii.fromBufferAttribute(s,a),n.distanceSqToSegment(Di,Ii,Ui,Fi)>r)return;Ui.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo(Ui);return l<t.near||l>t.far?void 0:{distance:l,point:Fi.clone().applyMatrix4(e.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:e}}const Bi=new lt,Hi=new lt;class Vi extends zi{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)Bi.fromBufferAttribute(t,e),Hi.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+Bi.distanceTo(Hi);e.setAttribute("lineDistance",new cr(n,1))}else We("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Gi extends zi{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Wi extends tr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Jn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Xi=new on,qi=new an,Yi=new $t,Ki=new lt;class $i extends In{constructor(e=new vr,t=new Wi){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Yi.copy(n.boundingSphere),Yi.applyMatrix4(r),Yi.radius+=i,!1===e.ray.intersectsSphere(Yi))return;Xi.copy(r).invert(),qi.copy(e.ray).applyMatrix4(Xi);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=n.index,c=n.attributes.position;if(null!==l)for(let n=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);n<i;n++){const i=l.getX(n);Ki.fromBufferAttribute(c,i),Zi(Ki,i,s,r,e,t,this)}else for(let n=Math.max(0,a.start),i=Math.min(c.count,a.start+a.count);n<i;n++)Ki.fromBufferAttribute(c,n),Zi(Ki,n,s,r,e,t,this)}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Zi(e,t,n,r,i,a,o){const s=qi.distanceSqToPoint(e);if(s<n){const n=new lt;qi.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:o})}}class Ji extends Tt{constructor(e,t,n,r,i,a,o,s,l){super(e,t,n,r,i,a,o,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Qi extends Tt{constructor(e,t,n=T,r,i,a,o=1003,s=1003,l,c=1026,u=1){if(c!==U&&c!==F)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:u},r,i,a,o,s,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new wt(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class ea extends Qi{constructor(e,t=T,n=301,r,i,a=1003,o=1003,s,l=1026){const c={width:e,height:e,depth:1},u=[c,c,c,c,c,c];super(e,e,t,n,r,i,a,o,s,l),this.image=u,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class ta extends Tt{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class na extends vr{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,o=Math.floor(n),s=Math.floor(r),l=o+1,c=s+1,u=e/o,d=t/s,h=[],p=[],f=[],m=[];for(let e=0;e<c;e++){const t=e*d-a;for(let n=0;n<l;n++){const r=n*u-i;p.push(r,-t,0),f.push(0,0,1),m.push(n/o),m.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<o;t++){const n=t+l*e,r=t+l*(e+1),i=t+1+l*(e+1),a=t+1+l*e;h.push(n,r,a),h.push(r,i,a)}this.setIndex(h),this.setAttribute("position",new cr(p,3)),this.setAttribute("normal",new cr(f,3)),this.setAttribute("uv",new cr(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new na(e.width,e.height,e.widthSegments,e.heightSegments)}}class ra extends vr{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const s=Math.min(a+o,Math.PI);let l=0;const c=[],u=new lt,d=new lt,h=[],p=[],f=[],m=[];for(let h=0;h<=n;h++){const g=[],v=h/n;let y=0;0===h&&0===a?y=.5/t:h===n&&s===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const s=n/t;u.x=-e*Math.cos(r+s*i)*Math.sin(a+v*o),u.y=e*Math.cos(a+v*o),u.z=e*Math.sin(r+s*i)*Math.sin(a+v*o),p.push(u.x,u.y,u.z),d.copy(u).normalize(),f.push(d.x,d.y,d.z),m.push(s+y,1-v),g.push(l++)}c.push(g)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){const t=c[e][r+1],i=c[e][r],o=c[e+1][r],l=c[e+1][r+1];(0!==e||a>0)&&h.push(t,i,l),(e!==n-1||s<Math.PI)&&h.push(i,o,l)}this.setIndex(h),this.setAttribute("position",new cr(p,3)),this.setAttribute("normal",new cr(f,3)),this.setAttribute("uv",new cr(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ra(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class ia extends kr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class aa extends tr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Jn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new gn,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class oa extends aa{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ot(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Qe(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Jn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Jn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Jn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class sa extends tr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Jn(16777215),this.specular=new Jn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new gn,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class la extends tr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Jn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new gn,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ca extends tr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ua extends tr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function da(e,t){return e&&e.constructor!==t?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function ha(e){const t=e.length,n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;return n.sort((function(t,n){return e[t]-e[n]})),n}function pa(e,t,n){const r=e.length,i=new e.constructor(r);for(let a=0,o=0;o!==r;++a){const r=n[a]*t;for(let n=0;n!==t;++n)i[o++]=e[r+n]}return i}function fa(e,t,n,r){let i=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[i++];if(void 0===a)return;let o=a[r];if(void 0!==o)if(Array.isArray(o))do{o=a[r],void 0!==o&&(t.push(a.time),n.push(...o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[r],void 0!==o&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{o=a[r],void 0!==o&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}class ma{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(e>=i)break e;{const o=t[1];e<o&&(n=2,i=o);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===a)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0}}for(;n<a;){const r=n+a>>>1;e<t[r]?a=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e)t[e]=n[i+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ga extends ma{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=e,o=2*t-n;break;case 2402:i=r.length-2,o=t+r[i]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=e,s=2*n-t;break;case 2402:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*c,this._offsetNext=a*c}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,h=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,g=-d*m+2*d*f-d*p,v=(1+d)*m+(-1.5-2*d)*f+(-.5+d)*p+1,y=(-1-h)*m+(1.5+h)*f+.5*p,x=h*m-h*f;for(let e=0;e!==o;++e)i[e]=g*a[c+e]+v*a[l+e]+y*a[s+e]+x*a[u+e];return i}}class va extends ma{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(n-t)/(r-t),u=1-c;for(let e=0;e!==o;++e)i[e]=a[l+e]*u+a[s+e]*c;return i}}class ya extends ma{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class xa{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=da(t,this.TimeBufferType),this.values=da(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:da(e.times,Array),values:da(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new ya(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new va(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ga(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Te:t=this.InterpolantFactoryMethodDiscrete;break;case Ae:t=this.InterpolantFactoryMethodLinear;break;case Ce:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return We("KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Te;case this.InterpolantFactoryMethodLinear:return Ae;case this.InterpolantFactoryMethodSmooth:return Ce}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const e=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*e,a*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(Xe("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(Xe("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==i;t++){const r=n[t];if("number"==typeof r&&isNaN(r)){Xe("KeyframeTrack: Time is not a valid number.",this,t,r),e=!1;break}if(null!==a&&a>r){Xe("KeyframeTrack: Out of order keys.",this,t,r,a),e=!1;break}a=r}if(void 0!==r&&function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(r))for(let t=0,n=r.length;t!==n;++t){const n=r[t];if(isNaN(n)){Xe("KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Ce,i=e.length-1;let a=1;for(let o=1;o<i;++o){let i=!1;const s=e[o];if(s!==e[o+1]&&(1!==o||s!==e[0]))if(r)i=!0;else{const e=o*n,r=e-n,a=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[r+o]||n!==t[a+o]){i=!0;break}}}if(i){if(o!==a){e[a]=e[o];const r=o*n,i=a*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*n,r=a*n,o=0;o!==n;++o)t[r+o]=t[e+o];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}xa.prototype.ValueTypeName="",xa.prototype.TimeBufferType=Float32Array,xa.prototype.ValueBufferType=Float32Array,xa.prototype.DefaultInterpolation=Ae;class ba extends xa{constructor(e,t,n){super(e,t,n)}}ba.prototype.ValueTypeName="bool",ba.prototype.ValueBufferType=Array,ba.prototype.DefaultInterpolation=Te,ba.prototype.InterpolantFactoryMethodLinear=void 0,ba.prototype.InterpolantFactoryMethodSmooth=void 0;class _a extends xa{constructor(e,t,n,r){super(e,t,n,r)}}_a.prototype.ValueTypeName="color";class wa extends xa{constructor(e,t,n,r){super(e,t,n,r)}}wa.prototype.ValueTypeName="number";class Sa extends ma{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t);let l=e*o;for(let e=l+o;l!==e;l+=4)st.slerpFlat(i,0,a,l-o,a,l,s);return i}}class Ma extends xa{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new Sa(this.times,this.values,this.getValueSize(),e)}}Ma.prototype.ValueTypeName="quaternion",Ma.prototype.InterpolantFactoryMethodSmooth=void 0;class Ea extends xa{constructor(e,t,n){super(e,t,n)}}Ea.prototype.ValueTypeName="string",Ea.prototype.ValueBufferType=Array,Ea.prototype.DefaultInterpolation=Te,Ea.prototype.InterpolantFactoryMethodLinear=void 0,Ea.prototype.InterpolantFactoryMethodSmooth=void 0;class Ta extends xa{constructor(e,t,n,r){super(e,t,n,r)}}Ta.prototype.ValueTypeName="vector";class Aa{constructor(e="",t=-1,n=[],r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Je(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let e=0,i=n.length;e!==i;++e)t.push(Ca(n[e]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i.userData=JSON.parse(e.userData||"{}"),i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let e=0,r=n.length;e!==r;++e)t.push(xa.toJSON(n[e]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let e=0;e<i;e++){let o=[],s=[];o.push((e+i-1)%i,e,(e+1)%i),s.push(0,1,0);const l=ha(o);o=pa(o,1,l),s=pa(s,1,l),r||0!==o[0]||(o.push(i),s.push(s[0])),a.push(new wa(".morphTargetInfluences["+t[e].name+"]",o,s).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){const n=e[t],a=n.name.match(i);if(a&&a.length>1){const e=a[1];let t=r[e];t||(r[e]=t=[]),t.push(n)}}const a=[];for(const e in r)a.push(this.CreateFromMorphTargetSequence(e,r[e],t,n));return a}static parseAnimation(e,t){if(We("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Xe("AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const a=[],o=[];fa(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode;let s=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const i=l[e].keys;if(i&&0!==i.length)if(i[0].morphTargets){const e={};let t;for(t=0;t<i.length;t++)if(i[t].morphTargets)for(let n=0;n<i[t].morphTargets.length;n++)e[i[t].morphTargets[n]]=-1;for(const n in e){const e=[],a=[];for(let r=0;r!==i[t].morphTargets.length;++r){const r=i[t];e.push(r.time),a.push(r.morphTarget===n?1:0)}r.push(new wa(".morphTargetInfluence["+n+"]",e,a))}s=e.length*a}else{const a=".bones["+t[e].name+"]";n(Ta,a+".position",i,"pos",r),n(Ma,a+".quaternion",i,"rot",r),n(Ta,a+".scale",i,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function Ca(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return wa;case"vector":case"vector2":case"vector3":case"vector4":return Ta;case"color":return _a;case"quaternion":return Ma;case"bool":case"boolean":return ba;case"string":return Ea}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];fa(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Pa={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Ra{constructor(e,t,n){const r=this;let i,a=!1,o=0,s=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(e){s++,!1===a&&void 0!==r.onStart&&r.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,s),o===s&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const Oa=new Ra;class Da{constructor(e){this.manager=void 0!==e?e:Oa,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}Da.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ia={};class La extends Error{constructor(e,t){super(e),this.response=t}}class Na extends Da{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=Pa.get(`file:${e}`);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==Ia[e])return void Ia[e].push({onLoad:t,onProgress:n,onError:r});Ia[e]=[],Ia[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),o=this.mimeType,s=this.responseType;fetch(a).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&We("FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=Ia[e],r=t.body.getReader(),i=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),a=i?parseInt(i):0,o=0!==a;let s=0;const l=new ReadableStream({start(e){!function t(){r.read().then((({done:r,value:i})=>{if(r)e.close();else{s+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(i),t()}}),(t=>{e.error(t)}))}()}});return new Response(l)}throw new La(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(s){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(""===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((e=>r.decode(e)))}}})).then((t=>{Pa.add(`file:${e}`,t);const n=Ia[e];delete Ia[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}})).catch((t=>{const n=Ia[e];if(void 0===n)throw this.manager.itemError(e),t;delete Ia[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const ka=new WeakMap;class Ua extends Da{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=Pa.get(`image:${e}`);if(void 0!==a){if(!0===a.complete)i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0);else{let e=ka.get(a);void 0===e&&(e=[],ka.set(a,e)),e.push({onLoad:t,onError:r})}return a}const o=je("img");function s(){c(),t&&t(this);const n=ka.get(this)||[];for(let e=0;e<n.length;e++){const t=n[e];t.onLoad&&t.onLoad(this)}ka.delete(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),Pa.remove(`image:${e}`);const n=ka.get(this)||[];for(let e=0;e<n.length;e++){const r=n[e];r.onError&&r.onError(t)}ka.delete(this),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),Pa.add(`image:${e}`,o),i.manager.itemStart(e),o.src=e,o}}class Fa extends Da{constructor(e){super(e)}load(e,t,n,r){const i=new Tt,a=new Ua(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}class za extends In{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Jn(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class ja extends za{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(In.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Jn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const Ba=new on,Ha=new lt,Va=new lt;class Ga{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ot(512,512),this.mapType=_,this.map=null,this.mapPass=null,this.matrix=new on,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ri,this._frameExtents=new ot(1,1),this._viewportCount=1,this._viewports=[new At(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Ha.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ha),Va.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Va),t.updateMatrixWorld(),Ba.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ba,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Ba)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Wa extends Ga{constructor(){super(new Br(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=2*Ze*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Xa extends za{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(In.DEFAULT_UP),this.updateMatrix(),this.target=new In,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new Wa}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class qa extends Ga{constructor(){super(new Br(90,1,.5,500)),this.isPointLightShadow=!0}}class Ya extends za{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new qa}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Ka extends Ur{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class $a extends Ga{constructor(){super(new Ka(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Za extends za{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(In.DEFAULT_UP),this.updateMatrix(),this.target=new In,this.shadow=new $a}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class Ja extends za{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Qa{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}const eo=new WeakMap;class to extends Da{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&We("ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&We("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=Pa.get(`image-bitmap:${e}`);if(void 0!==a)return i.manager.itemStart(e),a.then?void a.then((n=>{if(!0!==eo.has(a))return t&&t(n),i.manager.itemEnd(e),n;r&&r(eo.get(a)),i.manager.itemError(e),i.manager.itemEnd(e)})):(setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a);const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,o.signal="function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const s=fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){return Pa.add(`image-bitmap:${e}`,n),t&&t(n),i.manager.itemEnd(e),n})).catch((function(t){r&&r(t),eo.set(s,t),Pa.remove(`image-bitmap:${e}`),i.manager.itemError(e),i.manager.itemEnd(e)}));Pa.add(`image-bitmap:${e}`,s),i.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class no extends Br{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const ro="\\[\\]\\.:\\/",io=new RegExp("["+ro+"]","g"),ao="[^"+ro+"]",oo="[^"+ro.replace("\\.","")+"]",so=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",ao)+/(WCOD+)?/.source.replace("WCOD",oo)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ao)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ao)+"$"),lo=["material","materials","bones","map"];class co{constructor(e,t,n){this.path=t,this.parsedPath=n||co.parseTrackName(t),this.node=co.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new co.Composite(e,t,n):new co(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(io,"")}static parseTrackName(e){const t=so.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==lo.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=co.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void We("PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void Xe("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void Xe("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void Xe("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void Xe("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void Xe("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void Xe("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void Xe("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const a=e[r];if(void 0===a)return void Xe("PropertyBinding: Trying to update property for track: "+t.nodeName+"."+r+" but it wasn't found.",e);let o=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?o=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void Xe("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void Xe("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}co.Composite=class{constructor(e,t,n){const r=n||co.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},co.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},co.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},co.prototype.GetterByBindingType=[co.prototype._getValue_direct,co.prototype._getValue_array,co.prototype._getValue_arrayElement,co.prototype._getValue_toArray],co.prototype.SetterByBindingTypeAndVersioning=[[co.prototype._setValue_direct,co.prototype._setValue_direct_setNeedsUpdate,co.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[co.prototype._setValue_array,co.prototype._setValue_array_setNeedsUpdate,co.prototype._setValue_array_setMatrixWorldNeedsUpdate],[co.prototype._setValue_arrayElement,co.prototype._setValue_arrayElement_setNeedsUpdate,co.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[co.prototype._setValue_fromArray,co.prototype._setValue_fromArray_setNeedsUpdate,co.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);const uo=new on;class ho{constructor(e,t,n=0,r=1/0){this.ray=new an(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new vn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Xe("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return uo.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(uo),this}intersectObject(e,t=!0,n=[]){return fo(e,this,n,t),n.sort(po),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)fo(e[r],this,n,t);return n.sort(po),n}}function po(e,t){return e.distance-t.distance}function fo(e,t,n,r){let i=!0;if(e.layers.test(t.layers)&&!1===e.raycast(t,n)&&(i=!1),!0===i&&!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)fo(r[e],t,n,!0)}}class mo{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Qe(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Qe(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class go extends Vi{constructor(e=10,t=10,n=4473924,r=8947848){n=new Jn(n),r=new Jn(r);const i=t/2,a=e/t,o=e/2,s=[],l=[];for(let e=0,c=0,u=-o;e<=t;e++,u+=a){s.push(-o,0,u,o,0,u),s.push(u,0,-o,u,0,o);const t=e===i?n:r;t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3}const c=new vr;c.setAttribute("position",new cr(s,3)),c.setAttribute("color",new cr(l,3)),super(c,new Oi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class vo extends Vi{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new vr;n.setAttribute("position",new cr(t,3)),n.setAttribute("color",new cr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new Oi({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Jn,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class yo extends Ye{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):We("Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function xo(e,t,n,r){const i=function(e){switch(e){case _:case w:return{byteLength:1,components:1};case M:case S:case C:return{byteLength:2,components:1};case P:case R:return{byteLength:2,components:4};case T:case E:case A:return{byteLength:4,components:1};case D:case I:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}(r);switch(n){case L:return e*t;case z:case j:return e*t/i.components*i.byteLength;case B:case H:return e*t*2/i.components*i.byteLength;case N:return e*t*3/i.components*i.byteLength;case k:case V:return e*t*4/i.components*i.byteLength;case G:case W:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case X:case q:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case K:case Z:return Math.max(e,16)*Math.max(t,8)/4;case Y:case $:return Math.max(e,8)*Math.max(t,8)/2;case J:case Q:case te:case ne:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case ee:case re:case ie:case ae:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case oe:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case se:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case le:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case ce:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case ue:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case de:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case he:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case pe:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case fe:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case me:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case ge:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case ve:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case ye:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case xe:case be:case _e:return Math.ceil(e/4)*Math.ceil(t/4)*16;case we:case Se:return Math.ceil(e/4)*Math.ceil(t/4)*8;case Me:case Ee:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function bo(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function _o(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,a=r.byteLength,o=e.createBuffer();let s;if(e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)s=e.FLOAT;else if("undefined"!=typeof Float16Array&&r instanceof Float16Array)s=e.HALF_FLOAT;else if(r instanceof Uint16Array)s=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)s=e.SHORT;else if(r instanceof Uint32Array)s=e.UNSIGNED_INT;else if(r instanceof Int32Array)s=e.INT;else if(r instanceof Int8Array)s=e.BYTE;else if(r instanceof Uint8Array)s=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);s=e.UNSIGNED_BYTE}return{buffer:o,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:a}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,a=n.updateRanges;if(e.bindBuffer(r,t),0===a.length)e.bufferSubData(r,0,i);else{a.sort(((e,t)=>e.start-t.start));let t=0;for(let e=1;e<a.length;e++){const n=a[t],r=a[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,a[t]=r)}a.length=t+1;for(let t=0,n=a.length;t<n;t++){const n=a[t];e.bufferSubData(r,n.start*i.BYTES_PER_ELEMENT,i,n.start,n.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}})),"undefined"!=typeof window&&(window.__THREE__?We("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=i);const wo={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.metalness = metalnessFactor;\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = vec3( 0.04 );\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"uniform sampler2D dfgLUT;\nstruct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tvec3 diffuseContribution;\n\tvec3 specularColor;\n\tvec3 specularColorBlended;\n\tfloat roughness;\n\tfloat metalness;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t\tvec3 iridescenceFresnelDielectric;\n\t\tvec3 iridescenceFresnelMetallic;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn v;\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColorBlended;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat rInv = 1.0 / ( roughness + 0.1 );\n\tfloat a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;\n\tfloat b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;\n\tfloat DG = exp( a * dotNV + b );\n\treturn saturate( DG );\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nvec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;\n\tvec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;\n\tvec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;\n\tvec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;\n\tfloat Ess_V = dfgV.x + dfgV.y;\n\tfloat Ess_L = dfgL.x + dfgL.y;\n\tfloat Ems_V = 1.0 - Ess_V;\n\tfloat Ems_L = 1.0 - Ess_L;\n\tvec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;\n\tvec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );\n\tfloat compensationFactor = Ems_V * Ems_L;\n\tvec3 multiScatter = Fms * compensationFactor;\n\treturn singleScatter + multiScatter;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n \n \t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n \n \t\tfloat sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n \t\tfloat sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );\n \n \t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );\n \n \t\tirradiance *= sheenEnergyComp;\n \n \t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tdiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectDiffuse += diffuse;\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;\n \t#endif\n\tvec3 singleScatteringDielectric = vec3( 0.0 );\n\tvec3 multiScatteringDielectric = vec3( 0.0 );\n\tvec3 singleScatteringMetallic = vec3( 0.0 );\n\tvec3 multiScatteringMetallic = vec3( 0.0 );\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#endif\n\tvec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );\n\tvec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );\n\tvec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;\n\tvec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tvec3 indirectSpecular = radiance * singleScattering;\n\tindirectSpecular += multiScattering * cosineWeightedIrradiance;\n\tvec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tindirectSpecular *= sheenEnergyComp;\n\t\tindirectDiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectSpecular += indirectSpecular;\n\treflectedLight.indirectDiffuse += indirectDiffuse;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );\n\t\tmaterial.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\t\t\tuniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat interleavedGradientNoise( vec2 position ) {\n\t\t\treturn fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );\n\t\t}\n\t\tvec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {\n\t\t\tconst float goldenAngle = 2.399963229728653;\n\t\t\tfloat r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );\n\t\t\tfloat theta = float( sampleIndex ) * goldenAngle + phi;\n\t\t\treturn vec2( cos( theta ), sin( theta ) ) * r;\n\t\t}\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\t\tfloat radius = shadowRadius * texelSize.x;\n\t\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )\n\t\t\t\t) * 0.2;\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;\n\t\t\t\tfloat mean = distribution.x;\n\t\t\t\tfloat variance = distribution.y * distribution.y;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tfloat hard_shadow = step( mean, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tfloat hard_shadow = step( shadowCoord.z, mean );\n\t\t\t\t#endif\n\t\t\t\tif ( hard_shadow == 1.0 ) {\n\t\t\t\t\tshadow = 1.0;\n\t\t\t\t} else {\n\t\t\t\t\tvariance = max( variance, 0.0000001 );\n\t\t\t\t\tfloat d = shadowCoord.z - mean;\n\t\t\t\t\tfloat p_max = variance / ( variance + d * d );\n\t\t\t\t\tp_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );\n\t\t\t\t\tshadow = max( hard_shadow, p_max );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#else\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tfloat depth = texture2D( shadowMap, shadowCoord.xy ).r;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tshadow = step( depth, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tshadow = step( shadowCoord.z, depth );\n\t\t\t\t#endif\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\tfloat getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat texelSize = shadowRadius / shadowMapSize.x;\n\t\t\tvec3 absDir = abs( bd3D );\n\t\t\tvec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );\n\t\t\ttangent = normalize( cross( bd3D, tangent ) );\n\t\t\tvec3 bitangent = cross( bd3D, tangent );\n\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\tshadow = (\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )\n\t\t\t) * 0.2;\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\tfloat getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat depth = textureCube( shadowMap, bd3D ).r;\n\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\tshadow = step( depth, dp );\n\t\t\t#else\n\t\t\t\tshadow = step( dp, depth );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#endif\n\t#endif\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distance_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distance_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n \n\t\toutgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;\n \n \t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},So={common:{diffuse:{value:new Jn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new dt},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new dt}},envmap:{envMap:{value:null},envMapRotation:{value:new dt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new dt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new dt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new dt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new dt},normalScale:{value:new ot(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new dt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new dt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new dt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new dt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Jn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Jn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0},uvTransform:{value:new dt}},sprite:{diffuse:{value:new Jn(16777215)},opacity:{value:1},center:{value:new ot(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new dt},alphaMap:{value:null},alphaMapTransform:{value:new dt},alphaTest:{value:0}}},Mo={basic:{uniforms:Ir([So.common,So.specularmap,So.envmap,So.aomap,So.lightmap,So.fog]),vertexShader:wo.meshbasic_vert,fragmentShader:wo.meshbasic_frag},lambert:{uniforms:Ir([So.common,So.specularmap,So.envmap,So.aomap,So.lightmap,So.emissivemap,So.bumpmap,So.normalmap,So.displacementmap,So.fog,So.lights,{emissive:{value:new Jn(0)}}]),vertexShader:wo.meshlambert_vert,fragmentShader:wo.meshlambert_frag},phong:{uniforms:Ir([So.common,So.specularmap,So.envmap,So.aomap,So.lightmap,So.emissivemap,So.bumpmap,So.normalmap,So.displacementmap,So.fog,So.lights,{emissive:{value:new Jn(0)},specular:{value:new Jn(1118481)},shininess:{value:30}}]),vertexShader:wo.meshphong_vert,fragmentShader:wo.meshphong_frag},standard:{uniforms:Ir([So.common,So.envmap,So.aomap,So.lightmap,So.emissivemap,So.bumpmap,So.normalmap,So.displacementmap,So.roughnessmap,So.metalnessmap,So.fog,So.lights,{emissive:{value:new Jn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:wo.meshphysical_vert,fragmentShader:wo.meshphysical_frag},toon:{uniforms:Ir([So.common,So.aomap,So.lightmap,So.emissivemap,So.bumpmap,So.normalmap,So.displacementmap,So.gradientmap,So.fog,So.lights,{emissive:{value:new Jn(0)}}]),vertexShader:wo.meshtoon_vert,fragmentShader:wo.meshtoon_frag},matcap:{uniforms:Ir([So.common,So.bumpmap,So.normalmap,So.displacementmap,So.fog,{matcap:{value:null}}]),vertexShader:wo.meshmatcap_vert,fragmentShader:wo.meshmatcap_frag},points:{uniforms:Ir([So.points,So.fog]),vertexShader:wo.points_vert,fragmentShader:wo.points_frag},dashed:{uniforms:Ir([So.common,So.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wo.linedashed_vert,fragmentShader:wo.linedashed_frag},depth:{uniforms:Ir([So.common,So.displacementmap]),vertexShader:wo.depth_vert,fragmentShader:wo.depth_frag},normal:{uniforms:Ir([So.common,So.bumpmap,So.normalmap,So.displacementmap,{opacity:{value:1}}]),vertexShader:wo.meshnormal_vert,fragmentShader:wo.meshnormal_frag},sprite:{uniforms:Ir([So.sprite,So.fog]),vertexShader:wo.sprite_vert,fragmentShader:wo.sprite_frag},background:{uniforms:{uvTransform:{value:new dt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:wo.background_vert,fragmentShader:wo.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new dt}},vertexShader:wo.backgroundCube_vert,fragmentShader:wo.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:wo.cube_vert,fragmentShader:wo.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wo.equirect_vert,fragmentShader:wo.equirect_frag},distance:{uniforms:Ir([So.common,So.displacementmap,{referencePosition:{value:new lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wo.distance_vert,fragmentShader:wo.distance_frag},shadow:{uniforms:Ir([So.lights,So.fog,{color:{value:new Jn(0)},opacity:{value:1}}]),vertexShader:wo.shadow_vert,fragmentShader:wo.shadow_frag}};Mo.physical={uniforms:Ir([Mo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new dt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new dt},clearcoatNormalScale:{value:new ot(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new dt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new dt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new dt},sheen:{value:0},sheenColor:{value:new Jn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new dt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new dt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new dt},transmissionSamplerSize:{value:new ot},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new dt},attenuationDistance:{value:0},attenuationColor:{value:new Jn(0)},specularColor:{value:new Jn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new dt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new dt},anisotropyVector:{value:new ot},anisotropyMap:{value:null},anisotropyMapTransform:{value:new dt}}]),vertexShader:wo.meshphysical_vert,fragmentShader:wo.meshphysical_frag};const Eo={r:0,b:0,g:0},To=new gn,Ao=new on;function Co(e,t,n,r,i,a,o){const s=new Jn(0);let l,c,u=!0===a?0:1,d=null,p=0,f=null;function m(e){let r=!0===e.isScene?e.background:null;return r&&r.isTexture&&(r=(e.backgroundBlurriness>0?n:t).get(r)),r}function g(t,n){t.getRGB(Eo,Lr(e)),r.buffers.color.setClear(Eo.r,Eo.g,Eo.b,n,o)}return{getClearColor:function(){return s},setClearColor:function(e,t=1){s.set(e),u=t,g(s,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,g(s,u)},render:function(t){let n=!1;const i=m(t);null===i?g(s,u):i&&i.isColor&&(g(i,1),n=!0);const a=e.xr.getEnvironmentBlendMode();"additive"===a?r.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===a&&r.buffers.color.setClear(0,0,0,0,o),(e.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const r=m(n);r&&(r.isCubeTexture||r.mapping===h)?(void 0===c&&(c=new Pr(new Or(1,1,1),new kr({name:"BackgroundCubeMaterial",uniforms:Dr(Mo.backgroundCube.uniforms),vertexShader:Mo.backgroundCube.vertexShader,fragmentShader:Mo.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),To.copy(n.backgroundRotation),To.x*=-1,To.y*=-1,To.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(To.y*=-1,To.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(Ao.makeRotationFromEuler(To)),c.material.toneMapped=gt.getTransfer(r.colorSpace)!==Ie,d===r&&p===r.version&&f===e.toneMapping||(c.material.needsUpdate=!0,d=r,p=r.version,f=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===l&&(l=new Pr(new na(2,2),new kr({name:"BackgroundMaterial",uniforms:Dr(Mo.background.uniforms),vertexShader:Mo.background.vertexShader,fragmentShader:Mo.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=r,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=gt.getTransfer(r.colorSpace)!==Ie,!0===r.matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),d===r&&p===r.version&&f===e.toneMapping||(l.material.needsUpdate=!0,d=r,p=r.version,f=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function Po(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=c(null);let a=i,o=!1;function s(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],r=[],i=[];for(let e=0;e<n;e++)t[e]=0,r[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function u(){const e=a.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function d(e){h(e,0)}function h(t,n){const r=a.newAttributes,i=a.enabledAttributes,o=a.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),o[t]!==n&&(e.vertexAttribDivisor(t,n),o[t]=n)}function p(){const t=a.newAttributes,n=a.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function f(t,n,r,i,a,o,s){!0===s?e.vertexAttribIPointer(t,n,r,a,o):e.vertexAttribPointer(t,n,r,i,a,o)}function m(){g(),o=!0,a!==i&&(a=i,s(a.object))}function g(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,l,m,g){let v=!1;const y=function(t,n,i){const a=!0===i.wireframe;let o=r[t.id];void 0===o&&(o={},r[t.id]=o);let s=o[n.id];void 0===s&&(s={},o[n.id]=s);let l=s[a];return void 0===l&&(l=c(e.createVertexArray()),s[a]=l),l}(m,l,i);a!==y&&(a=y,s(a.object)),v=function(e,t,n,r){const i=a.attributes,o=t.attributes;let s=0;const l=n.getAttributes();for(const t in l)if(l[t].location>=0){const n=i[t];let r=o[t];if(void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor)),void 0===n)return!0;if(n.attribute!==r)return!0;if(r&&n.data!==r.data)return!0;s++}return a.attributesNum!==s||a.index!==r}(n,m,l,g),v&&function(e,t,n,r){const i={},o=t.attributes;let s=0;const l=n.getAttributes();for(const t in l)if(l[t].location>=0){let n=o[t];void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor));const r={};r.attribute=n,n&&n.data&&(r.data=n.data),i[t]=r,s++}a.attributes=i,a.attributesNum=s,a.index=r}(n,m,l,g),null!==g&&t.update(g,e.ELEMENT_ARRAY_BUFFER),(v||o)&&(o=!1,function(n,r,i,a){u();const o=a.attributes,s=i.getAttributes(),l=r.defaultAttributeValues;for(const r in s){const i=s[r];if(i.location>=0){let s=o[r];if(void 0===s&&("instanceMatrix"===r&&n.instanceMatrix&&(s=n.instanceMatrix),"instanceColor"===r&&n.instanceColor&&(s=n.instanceColor)),void 0!==s){const r=s.normalized,o=s.itemSize,l=t.get(s);if(void 0===l)continue;const c=l.buffer,u=l.type,p=l.bytesPerElement,m=u===e.INT||u===e.UNSIGNED_INT||s.gpuType===E;if(s.isInterleavedBufferAttribute){const t=s.data,l=t.stride,g=s.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)h(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)f(i.location+e,o/i.locationSize,u,r,l*p,(g+o/i.locationSize*e)*p,m)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)h(i.location+e,s.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)f(i.location+e,o/i.locationSize,u,r,o*p,o/i.locationSize*e*p,m)}}else if(void 0!==l){const t=l[r];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}p()}(n,i,l,m),null!==g&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)l(i[e].object),delete i[e];delete n[e.id]}},initAttributes:u,enableAttribute:d,disableUnusedAttributes:p}}function Ro(e,t,n){let r;function i(t,i,a){0!==a&&(e.drawArraysInstanced(r,t,i,a),n.update(i,r,a))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,a);let o=0;for(let e=0;e<a;e++)o+=i[e];n.update(o,r,1)},this.renderMultiDrawInstances=function(e,a,o,s){if(0===o)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],a[t],s[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,a,0,s,0,o);let t=0;for(let e=0;e<o;e++)t+=a[e]*s[e];n.update(t,r,1)}}}function Oo(e,t,n,r){let i;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=void 0!==n.precision?n.precision:"highp";const s=a(o);return s!==o&&(We("WebGLRenderer:",o,"not supported, using",s,"instead."),o=s),{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:a,textureFormatReadable:function(t){return t===k||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===C&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==_&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==A&&!i)},precision:o,logarithmicDepthBuffer:!0===n.logarithmicDepthBuffer,reversedDepthBuffer:!0===n.reversedDepthBuffer&&t.has("EXT_clip_control"),maxTextures:e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),maxVertexTextures:e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),maxSamples:e.getParameter(e.MAX_SAMPLES),samples:e.getParameter(e.SAMPLES)}}function Do(e){const t=this;let n=null,r=0,i=!1,a=!1;const o=new Ti,s=new dt,l={value:null,needsUpdate:!1};function c(e,n,r,i){const a=null!==e?e.length:0;let c=null;if(0!==a){if(c=l.value,!0!==i||null===c){const t=r+4*a,i=n.matrixWorldInverse;s.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,n=r;t!==a;++t,n+=4)o.copy(e[t]).applyMatrix4(i,s),o.normal.toArray(c,n),c[n+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(o,s,u){const d=o.clippingPlanes,h=o.clipIntersection,p=o.clipShadows,f=e.get(o);if(!i||null===d||0===d.length||a&&!p)a?c(null):(l.value!==n&&(l.value=n,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0);else{const e=a?0:r,t=4*e;let i=f.clippingState||null;l.value=i,i=c(d,s,t,u);for(let e=0;e!==t;++e)i[e]=n[e];f.clippingState=i,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function Io(e){let t=new WeakMap;function n(e,t){return 303===t?e.mapping=u:304===t&&(e.mapping=d),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping;if(303===a||304===a){if(t.has(i))return n(t.get(i).texture,i.mapping);{const a=i.image;if(a&&a.height>0){const o=new Wr(a.height);return o.fromEquirectangularTexture(e,i),t.set(i,o),i.addEventListener("dispose",r),n(o.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}const Lo=[.125,.215,.35,.446,.526,.582],No=new Ka,ko=new Jn;let Uo=null,Fo=0,zo=0,jo=!1;const Bo=new lt;class Ho{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,i={}){const{size:a=256,position:o=Bo}=i;Uo=this._renderer.getRenderTarget(),Fo=this._renderer.getActiveCubeFace(),zo=this._renderer.getActiveMipmapLevel(),jo=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s,o),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Xo(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Wo(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._ggxMaterial&&this._ggxMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(Uo,Fo,zo),this._renderer.xr.enabled=jo,e.scissorTest=!1,Go(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===u||e.mapping===d?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Uo=this._renderer.getRenderTarget(),Fo=this._renderer.getActiveCubeFace(),zo=this._renderer.getActiveMipmapLevel(),jo=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:y,minFilter:y,generateMipmaps:!1,type:C,format:k,colorSpace:Oe,depthBuffer:!1},r=Vo(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Vo(e,t,n);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const a=e-4+1+Lo.length;for(let o=0;o<a;o++){const a=Math.pow(2,i);t.push(a);let s=1/a;o>e-4?s=Lo[o-e+4-1]:0===o&&(s=0),n.push(s);const l=1/(a-2),c=-l,u=1+l,d=[c,c,u,c,u,u,c,c,u,u,c,u],h=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*h),y=new Float32Array(m*p*h),x=new Float32Array(g*p*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(r,f*p*e),y.set(d,m*p*e);const i=[e,e,e,e,e,e];x.set(i,g*p*e)}const b=new vr;b.setAttribute("position",new or(v,f)),b.setAttribute("uv",new or(y,m)),b.setAttribute("faceIndex",new or(x,g)),r.push(new Pr(b,null)),i>4&&i--}return{lodMeshes:r,sizeLods:t,sigmas:n}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(20),i=new lt(0,1,0);return new kr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(r,e,t),this._ggxMaterial=function(e,t,n){return new kr({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:256,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:'\n\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform float roughness;\n\t\t\tuniform float mipInt;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\t#define PI 3.14159265359\n\n\t\t\t// Van der Corput radical inverse\n\t\t\tfloat radicalInverse_VdC(uint bits) {\n\t\t\t\tbits = (bits << 16u) | (bits >> 16u);\n\t\t\t\tbits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n\t\t\t\tbits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n\t\t\t\tbits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n\t\t\t\tbits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n\t\t\t\treturn float(bits) * 2.3283064365386963e-10; // / 0x100000000\n\t\t\t}\n\n\t\t\t// Hammersley sequence\n\t\t\tvec2 hammersley(uint i, uint N) {\n\t\t\t\treturn vec2(float(i) / float(N), radicalInverse_VdC(i));\n\t\t\t}\n\n\t\t\t// GGX VNDF importance sampling (Eric Heitz 2018)\n\t\t\t// "Sampling the GGX Distribution of Visible Normals"\n\t\t\t// https://jcgt.org/published/0007/04/01/\n\t\t\tvec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {\n\t\t\t\tfloat alpha = roughness * roughness;\n\n\t\t\t\t// Section 3.2: Transform view direction to hemisphere configuration\n\t\t\t\tvec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));\n\n\t\t\t\t// Section 4.1: Orthonormal basis\n\t\t\t\tfloat lensq = Vh.x * Vh.x + Vh.y * Vh.y;\n\t\t\t\tvec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 T2 = cross(Vh, T1);\n\n\t\t\t\t// Section 4.2: Parameterization of projected area\n\t\t\t\tfloat r = sqrt(Xi.x);\n\t\t\t\tfloat phi = 2.0 * PI * Xi.y;\n\t\t\t\tfloat t1 = r * cos(phi);\n\t\t\t\tfloat t2 = r * sin(phi);\n\t\t\t\tfloat s = 0.5 * (1.0 + Vh.z);\n\t\t\t\tt2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;\n\n\t\t\t\t// Section 4.3: Reprojection onto hemisphere\n\t\t\t\tvec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;\n\n\t\t\t\t// Section 3.4: Transform back to ellipsoid configuration\n\t\t\t\treturn normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec3 N = normalize(vOutputDirection);\n\t\t\t\tvec3 V = N; // Assume view direction equals normal for pre-filtering\n\n\t\t\t\tvec3 prefilteredColor = vec3(0.0);\n\t\t\t\tfloat totalWeight = 0.0;\n\n\t\t\t\t// For very low roughness, just sample the environment directly\n\t\t\t\tif (roughness < 0.001) {\n\t\t\t\t\tgl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Tangent space basis for VNDF sampling\n\t\t\t\tvec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 tangent = normalize(cross(up, N));\n\t\t\t\tvec3 bitangent = cross(N, tangent);\n\n\t\t\t\tfor(uint i = 0u; i < uint(GGX_SAMPLES); i++) {\n\t\t\t\t\tvec2 Xi = hammersley(i, uint(GGX_SAMPLES));\n\n\t\t\t\t\t// For PMREM, V = N, so in tangent space V is always (0, 0, 1)\n\t\t\t\t\tvec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);\n\n\t\t\t\t\t// Transform H back to world space\n\t\t\t\t\tvec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);\n\t\t\t\t\tvec3 L = normalize(2.0 * dot(V, H) * H - V);\n\n\t\t\t\t\tfloat NdotL = max(dot(N, L), 0.0);\n\n\t\t\t\t\tif(NdotL > 0.0) {\n\t\t\t\t\t\t// Sample environment at fixed mip level\n\t\t\t\t\t\t// VNDF importance sampling handles the distribution filtering\n\t\t\t\t\t\tvec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);\n\n\t\t\t\t\t\t// Weight by NdotL for the split-sum approximation\n\t\t\t\t\t\t// VNDF PDF naturally accounts for the visible microfacet distribution\n\t\t\t\t\t\tprefilteredColor += sampleColor * NdotL;\n\t\t\t\t\t\ttotalWeight += NdotL;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (totalWeight > 0.0) {\n\t\t\t\t\tprefilteredColor = prefilteredColor / totalWeight;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4(prefilteredColor, 1.0);\n\t\t\t}\n\t\t',blending:0,depthTest:!1,depthWrite:!1})}(r,e,t)}return r}_compileMaterial(e){const t=new Pr(new vr,e);this._renderer.compile(t,No)}_sceneToCubeUV(e,t,n,r,i){const a=new Br(90,1,t,n),s=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],c=this._renderer,u=c.autoClear,d=c.toneMapping;c.getClearColor(ko),c.toneMapping=o,c.autoClear=!1,c.state.buffers.depth.getReversed()&&(c.setRenderTarget(r),c.clearDepth(),c.setRenderTarget(null)),null===this._backgroundBox&&(this._backgroundBox=new Pr(new Or,new nr({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1})));const h=this._backgroundBox,p=h.material;let f=!1;const m=e.background;m?m.isColor&&(p.color.copy(m),e.background=null,f=!0):(p.color.copy(ko),f=!0);for(let t=0;t<6;t++){const n=t%3;0===n?(a.up.set(0,s[t],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+l[t],i.y,i.z)):1===n?(a.up.set(0,0,s[t]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+l[t],i.z)):(a.up.set(0,s[t],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+l[t]));const o=this._cubeSize;Go(r,n*o,t>2?o:0,o,o),c.setRenderTarget(r),f&&c.render(h,a),c.render(e,a)}c.toneMapping=d,c.autoClear=u,e.background=m}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===u||e.mapping===d;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=Xo()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Wo());const i=r?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=i,i.uniforms.envMap.value=e;const o=this._cubeSize;Go(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,No)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let t=1;t<r;t++)this._applyGGXFilter(e,t-1,t);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,i=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[n];o.material=a;const s=a.uniforms,l=n/(this._lodMeshes.length-1),c=t/(this._lodMeshes.length-1),u=Math.sqrt(l*l-c*c)*(0+1.25*l),{_lodMax:d}=this,h=this._sizeLods[n],p=3*h*(n>d-4?n-d+4:0),f=4*(this._cubeSize-h);s.envMap.value=e.texture,s.roughness.value=u,s.mipInt.value=d-t,Go(i,p,f,3*h,2*h),r.setRenderTarget(i),r.render(o,No),s.envMap.value=i.texture,s.roughness.value=0,s.mipInt.value=d-n,Go(e,p,f,3*h,2*h),r.setRenderTarget(e),r.render(o,No)}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,o){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&Xe("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[r];c.material=l;const u=l.uniforms,d=this._sizeLods[n]-1,h=isFinite(i)?Math.PI/(2*d):2*Math.PI/39,p=i/h,f=isFinite(i)?1+Math.floor(3*p):20;f>20&&We(`sigmaRadians, ${i}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<20;++e){const t=e/p,n=Math.exp(-t*t/2);m.push(n),0===e?g+=n:e<f&&(g+=2*n)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===a,o&&(u.poleAxis.value=o);const{_lodMax:v}=this;u.dTheta.value=h,u.mipInt.value=v-n;const y=this._sizeLods[r];Go(t,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),s.setRenderTarget(t),s.render(c,No)}}function Vo(e,t,n){const r=new Pt(e,t,n);return r.texture.mapping=h,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Go(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function Wo(){return new kr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Xo(){return new kr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function qo(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping,o=303===a||304===a,s=a===u||a===d;if(o||s){let a=t.get(i);const l=void 0!==a?a.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new Ho(e)),a=o?n.fromEquirectangular(i,a):n.fromCubemap(i,a),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),a.texture;if(void 0!==a)return a.texture;{const l=i.image;return o&&l&&l.height>0||s&&l&&function(e){let t=0;for(let n=0;n<6;n++)void 0!==e[n]&&t++;return 6===t}(l)?(null===n&&(n=new Ho(e)),a=o?n.fromEquirectangular(i):n.fromCubemap(i),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),i.addEventListener("dispose",r),a.texture):null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Yo(e){const t={};function n(n){if(void 0!==t[n])return t[n];const r=e.getExtension(n);return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&qe("WebGLRenderer: "+e+" extension not supported."),t}}}function Ko(e,t,n,r){const i={},a=new WeakMap;function o(e){const s=e.target;null!==s.index&&t.remove(s.index);for(const e in s.attributes)t.remove(s.attributes[e]);s.removeEventListener("dispose",o),delete i[s.id];const l=a.get(s);l&&(t.remove(l),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){const n=[],r=e.index,i=e.attributes.position;let o=0;if(null!==r){const e=r.array;o=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{if(void 0===i)return;{const e=i.array;o=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const s=new(ze(n)?lr:sr)(n,1);s.version=o;const l=a.get(e);l&&t.remove(l),a.set(e,s)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const n in r)t.update(r[n],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function $o(e,t,n){let r,i,a;function o(t,o,s){0!==s&&(e.drawElementsInstanced(r,o,i,t*a,s),n.update(o,r,s))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,o){e.drawElements(r,o,i,t*a),n.update(o,r,1)},this.renderInstances=o,this.renderMultiDraw=function(e,a,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,a,0,i,e,0,o);let s=0;for(let e=0;e<o;e++)s+=a[e];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,s,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)o(e[t]/a,s[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(r,s,0,i,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=s[e]*c[e];n.update(t,r,1)}}}function Zo(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:Xe("WebGLInfo: Unknown draw mode:",r)}}}}function Jo(e,t,n){const r=new WeakMap,i=new At;return{update:function(a,o,s){const l=a.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,u=void 0!==c?c.length:0;let d=r.get(o);if(void 0===d||d.count!==u){void 0!==d&&d.texture.dispose();const h=void 0!==o.morphAttributes.position,p=void 0!==o.morphAttributes.normal,f=void 0!==o.morphAttributes.color,m=o.morphAttributes.position||[],g=o.morphAttributes.normal||[],v=o.morphAttributes.color||[];let y=0;!0===h&&(y=1),!0===p&&(y=2),!0===f&&(y=3);let x=o.attributes.position.count*y,b=1;x>t.maxTextureSize&&(b=Math.ceil(x/t.maxTextureSize),x=t.maxTextureSize);const _=new Float32Array(x*b*4*u),w=new Rt(_,x,b,u);w.type=A,w.needsUpdate=!0;const S=4*y;for(let E=0;E<u;E++){const T=m[E],C=g[E],P=v[E],R=x*b*4*E;for(let O=0;O<T.count;O++){const D=O*S;!0===h&&(i.fromBufferAttribute(T,O),_[R+D+0]=i.x,_[R+D+1]=i.y,_[R+D+2]=i.z,_[R+D+3]=0),!0===p&&(i.fromBufferAttribute(C,O),_[R+D+4]=i.x,_[R+D+5]=i.y,_[R+D+6]=i.z,_[R+D+7]=0),!0===f&&(i.fromBufferAttribute(P,O),_[R+D+8]=i.x,_[R+D+9]=i.y,_[R+D+10]=i.z,_[R+D+11]=4===P.itemSize?i.w:1)}}function M(){w.dispose(),r.delete(o),o.removeEventListener("dispose",M)}d={count:u,texture:w,size:new ot(x,b)},r.set(o,d),o.addEventListener("dispose",M)}if(!0===a.isInstancedMesh&&null!==a.morphTexture)s.getUniforms().setValue(e,"morphTexture",a.morphTexture,n);else{let I=0;for(let N=0;N<l.length;N++)I+=l[N];const L=o.morphTargetsRelative?1:1-I;s.getUniforms().setValue(e,"morphTargetBaseInfluence",L),s.getUniforms().setValue(e,"morphTargetInfluences",l)}s.getUniforms().setValue(e,"morphTargetsTexture",d.texture,n),s.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function Qo(e,t,n,r){let i=new WeakMap;function a(e){const t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){const s=r.render.frame,l=o.geometry,c=t.get(o,l);if(i.get(c)!==s&&(t.update(c),i.set(c,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){const e=o.skeleton;i.get(e)!==s&&(e.update(),i.set(e,s))}return c},dispose:function(){i=new WeakMap}}}const es={1:"LINEAR_TONE_MAPPING",2:"REINHARD_TONE_MAPPING",3:"CINEON_TONE_MAPPING",4:"ACES_FILMIC_TONE_MAPPING",6:"AGX_TONE_MAPPING",7:"NEUTRAL_TONE_MAPPING",5:"CUSTOM_TONE_MAPPING"};function ts(e,t,n,r,i){const a=new Pt(t,n,{type:e,depthBuffer:r,stencilBuffer:i}),s=new Pt(t,n,{type:C,depthBuffer:!1,stencilBuffer:!1}),l=new vr;l.setAttribute("position",new cr([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new cr([0,2,0,0,2,0],2));const c=new ia({uniforms:{tDiffuse:{value:null}},vertexShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main() {\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t}",fragmentShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform sampler2D tDiffuse;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\t#include <tonemapping_pars_fragment>\n\t\t\t#include <colorspace_pars_fragment>\n\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t\t#ifdef LINEAR_TONE_MAPPING\n\t\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( AGX_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CUSTOM_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef SRGB_TRANSFER\n\t\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\t\t\t\t#endif\n\t\t\t}",depthTest:!1,depthWrite:!1}),u=new Pr(l,c),d=new Ka(-1,1,1,-1,0,1);let h,p=null,f=null,m=!1,g=null,v=[],y=!1;this.setSize=function(e,t){a.setSize(e,t),s.setSize(e,t);for(let n=0;n<v.length;n++){const r=v[n];r.setSize&&r.setSize(e,t)}},this.setEffects=function(e){v=e,y=v.length>0&&!0===v[0].isRenderPass;const t=a.width,n=a.height;for(let e=0;e<v.length;e++){const r=v[e];r.setSize&&r.setSize(t,n)}},this.begin=function(e,t){if(m)return!1;if(e.toneMapping===o&&0===v.length)return!1;if(g=t,null!==t){const e=t.width,n=t.height;a.width===e&&a.height===n||this.setSize(e,n)}return!1===y&&e.setRenderTarget(a),h=e.toneMapping,e.toneMapping=o,!0},this.hasRenderPass=function(){return y},this.end=function(e,t){e.toneMapping=h,m=!0;let n=a,r=s;for(let i=0;i<v.length;i++){const a=v[i];if(!1!==a.enabled&&(a.render(e,r,n,t),!1!==a.needsSwap)){const e=n;n=r,r=e}}if(p!==e.outputColorSpace||f!==e.toneMapping){p=e.outputColorSpace,f=e.toneMapping,c.defines={},gt.getTransfer(p)===Ie&&(c.defines.SRGB_TRANSFER="");const t=es[f];t&&(c.defines[t]=""),c.needsUpdate=!0}c.uniforms.tDiffuse.value=n.texture,e.setRenderTarget(g),e.render(u,d),g=null,m=!1},this.isCompositing=function(){return m},this.dispose=function(){a.dispose(),s.dispose(),l.dispose(),c.dispose()}}const ns=new Tt,rs=new Qi(1,1),is=new Rt,as=new Ot,os=new Gr,ss=[],ls=[],cs=new Float32Array(16),us=new Float32Array(9),ds=new Float32Array(4);function hs(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=ss[i];if(void 0===a&&(a=new Float32Array(i),ss[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function ps(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function fs(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function ms(e,t){let n=ls[t];void 0===n&&(n=new Int32Array(t),ls[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function gs(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function vs(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ps(n,t))return;e.uniform2fv(this.addr,t),fs(n,t)}}function ys(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(ps(n,t))return;e.uniform3fv(this.addr,t),fs(n,t)}}function xs(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ps(n,t))return;e.uniform4fv(this.addr,t),fs(n,t)}}function bs(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(ps(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),fs(n,t)}else{if(ps(n,r))return;ds.set(r),e.uniformMatrix2fv(this.addr,!1,ds),fs(n,r)}}function _s(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(ps(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),fs(n,t)}else{if(ps(n,r))return;us.set(r),e.uniformMatrix3fv(this.addr,!1,us),fs(n,r)}}function ws(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(ps(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),fs(n,t)}else{if(ps(n,r))return;cs.set(r),e.uniformMatrix4fv(this.addr,!1,cs),fs(n,r)}}function Ss(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Ms(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ps(n,t))return;e.uniform2iv(this.addr,t),fs(n,t)}}function Es(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(ps(n,t))return;e.uniform3iv(this.addr,t),fs(n,t)}}function Ts(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ps(n,t))return;e.uniform4iv(this.addr,t),fs(n,t)}}function As(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Cs(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ps(n,t))return;e.uniform2uiv(this.addr,t),fs(n,t)}}function Ps(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(ps(n,t))return;e.uniform3uiv(this.addr,t),fs(n,t)}}function Rs(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ps(n,t))return;e.uniform4uiv(this.addr,t),fs(n,t)}}function Os(e,t,n){const r=this.cache,i=n.allocateTextureUnit();let a;r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),this.type===e.SAMPLER_2D_SHADOW?(rs.compareFunction=n.isReversedDepthBuffer()?518:515,a=rs):a=ns,n.setTexture2D(t||a,i)}function Ds(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||as,i)}function Is(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||os,i)}function Ls(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||is,i)}function Ns(e,t){e.uniform1fv(this.addr,t)}function ks(e,t){const n=hs(t,this.size,2);e.uniform2fv(this.addr,n)}function Us(e,t){const n=hs(t,this.size,3);e.uniform3fv(this.addr,n)}function Fs(e,t){const n=hs(t,this.size,4);e.uniform4fv(this.addr,n)}function zs(e,t){const n=hs(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function js(e,t){const n=hs(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Bs(e,t){const n=hs(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Hs(e,t){e.uniform1iv(this.addr,t)}function Vs(e,t){e.uniform2iv(this.addr,t)}function Gs(e,t){e.uniform3iv(this.addr,t)}function Ws(e,t){e.uniform4iv(this.addr,t)}function Xs(e,t){e.uniform1uiv(this.addr,t)}function qs(e,t){e.uniform2uiv(this.addr,t)}function Ys(e,t){e.uniform3uiv(this.addr,t)}function Ks(e,t){e.uniform4uiv(this.addr,t)}function $s(e,t,n){const r=this.cache,i=t.length,a=ms(n,i);let o;ps(r,a)||(e.uniform1iv(this.addr,a),fs(r,a)),o=this.type===e.SAMPLER_2D_SHADOW?rs:ns;for(let e=0;e!==i;++e)n.setTexture2D(t[e]||o,a[e])}function Zs(e,t,n){const r=this.cache,i=t.length,a=ms(n,i);ps(r,a)||(e.uniform1iv(this.addr,a),fs(r,a));for(let e=0;e!==i;++e)n.setTexture3D(t[e]||as,a[e])}function Js(e,t,n){const r=this.cache,i=t.length,a=ms(n,i);ps(r,a)||(e.uniform1iv(this.addr,a),fs(r,a));for(let e=0;e!==i;++e)n.setTextureCube(t[e]||os,a[e])}function Qs(e,t,n){const r=this.cache,i=t.length,a=ms(n,i);ps(r,a)||(e.uniform1iv(this.addr,a),fs(r,a));for(let e=0;e!==i;++e)n.setTexture2DArray(t[e]||is,a[e])}class el{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return gs;case 35664:return vs;case 35665:return ys;case 35666:return xs;case 35674:return bs;case 35675:return _s;case 35676:return ws;case 5124:case 35670:return Ss;case 35667:case 35671:return Ms;case 35668:case 35672:return Es;case 35669:case 35673:return Ts;case 5125:return As;case 36294:return Cs;case 36295:return Ps;case 36296:return Rs;case 35678:case 36198:case 36298:case 36306:case 35682:return Os;case 35679:case 36299:case 36307:return Ds;case 35680:case 36300:case 36308:case 36293:return Is;case 36289:case 36303:case 36311:case 36292:return Ls}}(t.type)}}class tl{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ns;case 35664:return ks;case 35665:return Us;case 35666:return Fs;case 35674:return zs;case 35675:return js;case 35676:return Bs;case 5124:case 35670:return Hs;case 35667:case 35671:return Vs;case 35668:case 35672:return Gs;case 35669:case 35673:return Ws;case 5125:return Xs;case 36294:return qs;case 36295:return Ys;case 36296:return Ks;case 35678:case 36198:case 36298:case 36306:case 35682:return $s;case 35679:case 36299:case 36307:return Zs;case 35680:case 36300:case 36308:case 36293:return Js;case 36289:case 36303:case 36311:case 36292:return Qs}}(t.type)}}class nl{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}}}const rl=/(\w+)(\])?(\[|\.)?/g;function il(e,t){e.seq.push(t),e.map[t.id]=t}function al(e,t,n){const r=e.name,i=r.length;for(rl.lastIndex=0;;){const a=rl.exec(r),o=rl.lastIndex;let s=a[1];const l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===i){il(n,void 0===c?new el(s,e,t):new tl(s,e,t));break}{let e=n.map[s];void 0===e&&(e=new nl(s),il(n,e)),n=e}}}class ol{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);al(n,e.getUniformLocation(t,n.name),this)}const r=[],i=[];for(const t of this.seq)t.type===e.SAMPLER_2D_SHADOW||t.type===e.SAMPLER_CUBE_SHADOW||t.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(t):i.push(t);r.length>0&&(this.seq=r.concat(i))}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],o=n[a.id];!1!==o.needsUpdate&&a.setValue(e,o.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function sl(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}const ll=37297;let cl=0;const ul=new dt;function dl(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(r&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let e=i;e<a;e++){const i=e+1;r.push(`${i===t?">":" "} ${i}: ${n[e]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return i}function hl(e,t){const n=function(e){gt._getMatrix(ul,gt.workingColorSpace,e);const t=`mat3( ${ul.elements.map((e=>e.toFixed(4)))} )`;switch(gt.getTransfer(e)){case De:return[t,"LinearTransferOETF"];case Ie:return[t,"sRGBTransferOETF"];default:return We("WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}const pl={1:"Linear",2:"Reinhard",3:"Cineon",4:"ACESFilmic",6:"AgX",7:"Neutral",5:"Custom"};function fl(e,t){const n=pl[t];return void 0===n?(We("WebGLProgram: Unsupported toneMapping:",t),"vec3 "+e+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const ml=new lt;function gl(e){return""!==e}function vl(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function yl(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const xl=/^[ \t]*#include +<([\w\d./]+)>/gm;function bl(e){return e.replace(xl,wl)}const _l=new Map;function wl(e,t){let n=wo[t];if(void 0===n){const e=_l.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=wo[e],We('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return bl(n)}const Sl=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ml(e){return e.replace(Sl,El)}function El(e,t,n,r){let i="";for(let e=parseInt(t);e<parseInt(n);e++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function Tl(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}const Al={1:"SHADOWMAP_TYPE_PCF",3:"SHADOWMAP_TYPE_VSM"},Cl={[u]:"ENVMAP_TYPE_CUBE",[d]:"ENVMAP_TYPE_CUBE",[h]:"ENVMAP_TYPE_CUBE_UV"},Pl={[d]:"ENVMAP_MODE_REFRACTION"},Rl={0:"ENVMAP_BLENDING_MULTIPLY",1:"ENVMAP_BLENDING_MIX",2:"ENVMAP_BLENDING_ADD"};function Ol(e,t,n,r){const i=e.getContext(),a=n.defines;let s=n.vertexShader,l=n.fragmentShader;const c=function(e){return Al[e.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}(n),u=function(e){return!1===e.envMap?"ENVMAP_TYPE_CUBE":Cl[e.envMapMode]||"ENVMAP_TYPE_CUBE"}(n),d=function(e){return!1===e.envMap?"ENVMAP_MODE_REFLECTION":Pl[e.envMapMode]||"ENVMAP_MODE_REFLECTION"}(n),h=function(e){return!1===e.envMap?"ENVMAP_BLENDING_NONE":Rl[e.combine]||"ENVMAP_BLENDING_NONE"}(n),p=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),f=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(gl).join("\n")}(n),m=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(a),g=i.createProgram();let v,y,x=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(gl).join("\n"),v.length>0&&(v+="\n"),y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(gl).join("\n"),y.length>0&&(y+="\n")):(v=[Tl(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(gl).join("\n"),y=[Tl(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",n.envMap?"#define "+h:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==o?"#define TONE_MAPPING":"",n.toneMapping!==o?wo.tonemapping_pars_fragment:"",n.toneMapping!==o?fl("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",wo.colorspace_pars_fragment,hl("linearToOutputTexel",n.outputColorSpace),(gt.getLuminanceCoefficients(ml),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${ml.x.toFixed(4)}, ${ml.y.toFixed(4)}, ${ml.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(gl).join("\n")),s=bl(s),s=vl(s,n),s=yl(s,n),l=bl(l),l=vl(l,n),l=yl(l,n),s=Ml(s),l=Ml(l),!0!==n.isRawShaderMaterial&&(x="#version 300 es\n",v=[f,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,y=["#define varying in",n.glslVersion===ke?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===ke?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const b=x+v+s,_=x+y+l,w=sl(i,i.VERTEX_SHADER,b),S=sl(i,i.FRAGMENT_SHADER,_);function M(t){if(e.debug.checkShaderErrors){const n=i.getProgramInfoLog(g)||"",r=i.getShaderInfoLog(w)||"",a=i.getShaderInfoLog(S)||"",o=n.trim(),s=r.trim(),l=a.trim();let c=!0,u=!0;if(!1===i.getProgramParameter(g,i.LINK_STATUS))if(c=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(i,g,w,S);else{const e=dl(i,w,"vertex"),n=dl(i,S,"fragment");Xe("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(g,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+o+"\n"+e+"\n"+n)}else""!==o?We("WebGLProgram: Program Info Log:",o):""!==s&&""!==l||(u=!1);u&&(t.diagnostics={runnable:c,programLog:o,vertexShader:{log:s,prefix:v},fragmentShader:{log:l,prefix:y}})}i.deleteShader(w),i.deleteShader(S),E=new ol(i,g),T=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),a=r.name;let o=1;r.type===e.FLOAT_MAT2&&(o=2),r.type===e.FLOAT_MAT3&&(o=3),r.type===e.FLOAT_MAT4&&(o=4),n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:o}}return n}(i,g)}let E,T;i.attachShader(g,w),i.attachShader(g,S),void 0!==n.index0AttributeName?i.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(g,0,"position"),i.linkProgram(g),this.getUniforms=function(){return void 0===E&&M(this),E},this.getAttributes=function(){return void 0===T&&M(this),T};let A=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===A&&(A=i.getProgramParameter(g,ll)),A},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=cl++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=S,this}let Dl=0;class Il{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new Ll(e),t.set(e,n)),n}}class Ll{constructor(e){this.id=Dl++,this.code=e,this.usedTimes=0}}function Nl(e,t,n,r,i,a,s){const l=new vn,c=new Il,u=new Set,d=[],p=new Map,f=i.logarithmicDepthBuffer;let m=i.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(e){return u.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(a,l,d,p,y){const x=p.fog,b=y.geometry,_=a.isMeshStandardMaterial?p.environment:null,w=(a.isMeshStandardMaterial?n:t).get(a.envMap||_),S=w&&w.mapping===h?w.image.height:null,M=g[a.type];null!==a.precision&&(m=i.getMaxPrecision(a.precision),m!==a.precision&&We("WebGLProgram.getParameters:",a.precision,"not supported, using",m,"instead."));const E=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,T=void 0!==E?E.length:0;let A,C,P,R,O=0;if(void 0!==b.morphAttributes.position&&(O=1),void 0!==b.morphAttributes.normal&&(O=2),void 0!==b.morphAttributes.color&&(O=3),M){const e=Mo[M];A=e.vertexShader,C=e.fragmentShader}else A=a.vertexShader,C=a.fragmentShader,c.update(a),P=c.getVertexShaderID(a),R=c.getFragmentShaderID(a);const D=e.getRenderTarget(),I=e.state.buffers.depth.getReversed(),L=!0===y.isInstancedMesh,N=!0===y.isBatchedMesh,k=!!a.map,U=!!a.matcap,F=!!w,z=!!a.aoMap,j=!!a.lightMap,B=!!a.bumpMap,H=!!a.normalMap,V=!!a.displacementMap,G=!!a.emissiveMap,W=!!a.metalnessMap,X=!!a.roughnessMap,q=a.anisotropy>0,Y=a.clearcoat>0,K=a.dispersion>0,$=a.iridescence>0,Z=a.sheen>0,J=a.transmission>0,Q=q&&!!a.anisotropyMap,ee=Y&&!!a.clearcoatMap,te=Y&&!!a.clearcoatNormalMap,ne=Y&&!!a.clearcoatRoughnessMap,re=$&&!!a.iridescenceMap,ie=$&&!!a.iridescenceThicknessMap,ae=Z&&!!a.sheenColorMap,oe=Z&&!!a.sheenRoughnessMap,se=!!a.specularMap,le=!!a.specularColorMap,ce=!!a.specularIntensityMap,ue=J&&!!a.transmissionMap,de=J&&!!a.thicknessMap,he=!!a.gradientMap,pe=!!a.alphaMap,fe=a.alphaTest>0,me=!!a.alphaHash,ge=!!a.extensions;let ve=o;a.toneMapped&&(null!==D&&!0!==D.isXRRenderTarget||(ve=e.toneMapping));const ye={shaderID:M,shaderType:a.type,shaderName:a.name,vertexShader:A,fragmentShader:C,defines:a.defines,customVertexShaderID:P,customFragmentShaderID:R,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:m,batching:N,batchingColor:N&&null!==y._colorsTexture,instancing:L,instancingColor:L&&null!==y.instanceColor,instancingMorph:L&&null!==y.morphTexture,outputColorSpace:null===D?e.outputColorSpace:!0===D.isXRRenderTarget?D.texture.colorSpace:Oe,alphaToCoverage:!!a.alphaToCoverage,map:k,matcap:U,envMap:F,envMapMode:F&&w.mapping,envMapCubeUVHeight:S,aoMap:z,lightMap:j,bumpMap:B,normalMap:H,displacementMap:V,emissiveMap:G,normalMapObjectSpace:H&&1===a.normalMapType,normalMapTangentSpace:H&&0===a.normalMapType,metalnessMap:W,roughnessMap:X,anisotropy:q,anisotropyMap:Q,clearcoat:Y,clearcoatMap:ee,clearcoatNormalMap:te,clearcoatRoughnessMap:ne,dispersion:K,iridescence:$,iridescenceMap:re,iridescenceThicknessMap:ie,sheen:Z,sheenColorMap:ae,sheenRoughnessMap:oe,specularMap:se,specularColorMap:le,specularIntensityMap:ce,transmission:J,transmissionMap:ue,thicknessMap:de,gradientMap:he,opaque:!1===a.transparent&&1===a.blending&&!1===a.alphaToCoverage,alphaMap:pe,alphaTest:fe,alphaHash:me,combine:a.combine,mapUv:k&&v(a.map.channel),aoMapUv:z&&v(a.aoMap.channel),lightMapUv:j&&v(a.lightMap.channel),bumpMapUv:B&&v(a.bumpMap.channel),normalMapUv:H&&v(a.normalMap.channel),displacementMapUv:V&&v(a.displacementMap.channel),emissiveMapUv:G&&v(a.emissiveMap.channel),metalnessMapUv:W&&v(a.metalnessMap.channel),roughnessMapUv:X&&v(a.roughnessMap.channel),anisotropyMapUv:Q&&v(a.anisotropyMap.channel),clearcoatMapUv:ee&&v(a.clearcoatMap.channel),clearcoatNormalMapUv:te&&v(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ne&&v(a.clearcoatRoughnessMap.channel),iridescenceMapUv:re&&v(a.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&v(a.iridescenceThicknessMap.channel),sheenColorMapUv:ae&&v(a.sheenColorMap.channel),sheenRoughnessMapUv:oe&&v(a.sheenRoughnessMap.channel),specularMapUv:se&&v(a.specularMap.channel),specularColorMapUv:le&&v(a.specularColorMap.channel),specularIntensityMapUv:ce&&v(a.specularIntensityMap.channel),transmissionMapUv:ue&&v(a.transmissionMap.channel),thicknessMapUv:de&&v(a.thicknessMap.channel),alphaMapUv:pe&&v(a.alphaMap.channel),vertexTangents:!!b.attributes.tangent&&(H||q),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,pointsUvs:!0===y.isPoints&&!!b.attributes.uv&&(k||pe),fog:!!x,useFog:!0===a.fog,fogExp2:!!x&&x.isFogExp2,flatShading:!0===a.flatShading&&!1===a.wireframe,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:f,reversedDepthBuffer:I,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:T,morphTextureStride:O,numDirLights:l.directional.length,numPointLights:l.point.length,numSpotLights:l.spot.length,numSpotLightMaps:l.spotLightMap.length,numRectAreaLights:l.rectArea.length,numHemiLights:l.hemi.length,numDirLightShadows:l.directionalShadowMap.length,numPointLightShadows:l.pointShadowMap.length,numSpotLightShadows:l.spotShadowMap.length,numSpotLightShadowsWithMaps:l.numSpotLightShadowsWithMaps,numLightProbes:l.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:ve,decodeVideoTexture:k&&!0===a.map.isVideoTexture&&gt.getTransfer(a.map.colorSpace)===Ie,decodeVideoTextureEmissive:G&&!0===a.emissiveMap.isVideoTexture&&gt.getTransfer(a.emissiveMap.colorSpace)===Ie,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:1===a.side,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionClipCullDistance:ge&&!0===a.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ge&&!0===a.extensions.multiDraw||N)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()};return ye.vertexUv1s=u.has(1),ye.vertexUv2s=u.has(2),ye.vertexUv3s=u.has(3),u.clear(),ye},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){l.disableAll(),t.instancing&&l.enable(0),t.instancingColor&&l.enable(1),t.instancingMorph&&l.enable(2),t.matcap&&l.enable(3),t.envMap&&l.enable(4),t.normalMapObjectSpace&&l.enable(5),t.normalMapTangentSpace&&l.enable(6),t.clearcoat&&l.enable(7),t.iridescence&&l.enable(8),t.alphaTest&&l.enable(9),t.vertexColors&&l.enable(10),t.vertexAlphas&&l.enable(11),t.vertexUv1s&&l.enable(12),t.vertexUv2s&&l.enable(13),t.vertexUv3s&&l.enable(14),t.vertexTangents&&l.enable(15),t.anisotropy&&l.enable(16),t.alphaHash&&l.enable(17),t.batching&&l.enable(18),t.dispersion&&l.enable(19),t.batchingColor&&l.enable(20),t.gradientMap&&l.enable(21),e.push(l.mask),l.disableAll(),t.fog&&l.enable(0),t.useFog&&l.enable(1),t.flatShading&&l.enable(2),t.logarithmicDepthBuffer&&l.enable(3),t.reversedDepthBuffer&&l.enable(4),t.skinning&&l.enable(5),t.morphTargets&&l.enable(6),t.morphNormals&&l.enable(7),t.morphColors&&l.enable(8),t.premultipliedAlpha&&l.enable(9),t.shadowMapEnabled&&l.enable(10),t.doubleSided&&l.enable(11),t.flipSided&&l.enable(12),t.useDepthPacking&&l.enable(13),t.dithering&&l.enable(14),t.transmission&&l.enable(15),t.sheen&&l.enable(16),t.opaque&&l.enable(17),t.pointsUvs&&l.enable(18),t.decodeVideoTexture&&l.enable(19),t.decodeVideoTextureEmissive&&l.enable(20),t.alphaToCoverage&&l.enable(21),e.push(l.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=g[e.type];let n;if(t){const e=Mo[t];n=Nr.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r=p.get(n);return void 0!==r?++r.usedTimes:(r=new Ol(e,n,t,a),d.push(r),p.set(n,r)),r},releaseProgram:function(e){if(0==--e.usedTimes){const t=d.indexOf(e);d[t]=d[d.length-1],d.pop(),p.delete(e.cacheKey),e.destroy()}},releaseShaderCache:function(e){c.remove(e)},programs:d,dispose:function(){c.dispose()}}}function kl(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Ul(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Fl(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function zl(){const e=[];let t=0;const n=[],r=[],i=[];function a(n,r,i,a,o,s){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,o,s,l,c){const u=a(e,t,o,s,l,c);o.transmission>0?r.push(u):!0===o.transparent?i.push(u):n.push(u)},unshift:function(e,t,o,s,l,c){const u=a(e,t,o,s,l,c);o.transmission>0?r.unshift(u):!0===o.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Ul),r.length>1&&r.sort(t||Fl),i.length>1&&i.sort(t||Fl)}}}function jl(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new zl,e.set(t,[i])):n>=r.length?(i=new zl,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function Bl(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new lt,color:new Jn};break;case"SpotLight":n={position:new lt,direction:new lt,color:new Jn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new lt,color:new Jn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new lt,skyColor:new Jn,groundColor:new Jn};break;case"RectAreaLight":n={color:new Jn,position:new lt,halfWidth:new lt,halfHeight:new lt}}return e[t.id]=n,n}}}let Hl=0;function Vl(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Gl(e){const t=new Bl,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)r.probe.push(new lt);const i=new lt,a=new on,o=new on;return{setup:function(i){let a=0,o=0,s=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let l=0,c=0,u=0,d=0,h=0,p=0,f=0,m=0,g=0,v=0,y=0;i.sort(Vl);for(let e=0,x=i.length;e<x;e++){const x=i[e],b=x.color,_=x.intensity,w=x.distance;let S=null;if(x.shadow&&x.shadow.map&&(S=x.shadow.map.texture.format===B?x.shadow.map.texture:x.shadow.map.depthTexture||x.shadow.map.texture),x.isAmbientLight)a+=b.r*_,o+=b.g*_,s+=b.b*_;else if(x.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(x.sh.coefficients[e],_);y++}else if(x.isDirectionalLight){const e=t.get(x);if(e.color.copy(x.color).multiplyScalar(x.intensity),x.castShadow){const e=x.shadow,t=n.get(x);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,r.directionalShadow[l]=t,r.directionalShadowMap[l]=S,r.directionalShadowMatrix[l]=x.shadow.matrix,p++}r.directional[l]=e,l++}else if(x.isSpotLight){const e=t.get(x);e.position.setFromMatrixPosition(x.matrixWorld),e.color.copy(b).multiplyScalar(_),e.distance=w,e.coneCos=Math.cos(x.angle),e.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),e.decay=x.decay,r.spot[u]=e;const i=x.shadow;if(x.map&&(r.spotLightMap[g]=x.map,g++,i.updateMatrices(x),x.castShadow&&v++),r.spotLightMatrix[u]=i.matrix,x.castShadow){const e=n.get(x);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,r.spotShadow[u]=e,r.spotShadowMap[u]=S,m++}u++}else if(x.isRectAreaLight){const e=t.get(x);e.color.copy(b).multiplyScalar(_),e.halfWidth.set(.5*x.width,0,0),e.halfHeight.set(0,.5*x.height,0),r.rectArea[d]=e,d++}else if(x.isPointLight){const e=t.get(x);if(e.color.copy(x.color).multiplyScalar(x.intensity),e.distance=x.distance,e.decay=x.decay,x.castShadow){const e=x.shadow,t=n.get(x);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,r.pointShadow[c]=t,r.pointShadowMap[c]=S,r.pointShadowMatrix[c]=x.shadow.matrix,f++}r.point[c]=e,c++}else if(x.isHemisphereLight){const e=t.get(x);e.skyColor.copy(x.color).multiplyScalar(_),e.groundColor.copy(x.groundColor).multiplyScalar(_),r.hemi[h]=e,h++}}d>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=So.LTC_FLOAT_1,r.rectAreaLTC2=So.LTC_FLOAT_2):(r.rectAreaLTC1=So.LTC_HALF_1,r.rectAreaLTC2=So.LTC_HALF_2)),r.ambient[0]=a,r.ambient[1]=o,r.ambient[2]=s;const x=r.hash;x.directionalLength===l&&x.pointLength===c&&x.spotLength===u&&x.rectAreaLength===d&&x.hemiLength===h&&x.numDirectionalShadows===p&&x.numPointShadows===f&&x.numSpotShadows===m&&x.numSpotMaps===g&&x.numLightProbes===y||(r.directional.length=l,r.spot.length=u,r.rectArea.length=d,r.point.length=c,r.hemi.length=h,r.directionalShadow.length=p,r.directionalShadowMap.length=p,r.pointShadow.length=f,r.pointShadowMap.length=f,r.spotShadow.length=m,r.spotShadowMap.length=m,r.directionalShadowMatrix.length=p,r.pointShadowMatrix.length=f,r.spotLightMatrix.length=m+g-v,r.spotLightMap.length=g,r.numSpotLightShadowsWithMaps=v,r.numLightProbes=y,x.directionalLength=l,x.pointLength=c,x.spotLength=u,x.rectAreaLength=d,x.hemiLength=h,x.numDirectionalShadows=p,x.numPointShadows=f,x.numSpotShadows=m,x.numSpotMaps=g,x.numLightProbes=y,r.version=Hl++)},setupView:function(e,t){let n=0,s=0,l=0,c=0,u=0;const d=t.matrixWorldInverse;for(let t=0,h=e.length;t<h;t++){const h=e[t];if(h.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(h.matrixWorld),i.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(d),n++}else if(h.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(h.matrixWorld),i.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(d),l++}else if(h.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),o.identity(),a.copy(h.matrixWorld),a.premultiply(d),o.extractRotation(a),e.halfWidth.set(.5*h.width,0,0),e.halfHeight.set(0,.5*h.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(h.isPointLight){const e=r.point[s];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),s++}else if(h.isHemisphereLight){const e=r.hemi[u];e.direction.setFromMatrixPosition(h.matrixWorld),e.direction.transformDirection(d),u++}}},state:r}}function Wl(e){const t=new Gl(e),n=[],r=[],i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function Xl(e){let t=new WeakMap;return{get:function(n,r=0){const i=t.get(n);let a;return void 0===i?(a=new Wl(e),t.set(n,[a])):r>=i.length?(a=new Wl(e),i.push(a)):a=i[r],a},dispose:function(){t=new WeakMap}}}const ql=[new lt(1,0,0),new lt(-1,0,0),new lt(0,1,0),new lt(0,-1,0),new lt(0,0,1),new lt(0,0,-1)],Yl=[new lt(0,-1,0),new lt(0,-1,0),new lt(0,0,1),new lt(0,0,-1),new lt(0,-1,0),new lt(0,-1,0)],Kl=new on,$l=new lt,Zl=new lt;function Jl(e,t,n){let r=new Ri;const i=new ot,a=new ot,o=new At,s=new ca,l=new ua,c={},u=n.maxTextureSize,d={0:1,1:0,2:2},h=new kr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ot},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );\n\tgl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );\n}"}),p=h.clone();p.defines.HORIZONTAL_PASS=1;const f=new vr;f.setAttribute("position",new or(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Pr(f,h),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let x=this.type;function b(n,r){const a=t.update(m);h.defines.VSM_SAMPLES!==n.blurSamples&&(h.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Pt(i.x,i.y,{format:B,type:C})),h.uniforms.shadow_pass.value=n.map.depthTexture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,h,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,p,m,null)}function _(t,n,r,i){let a=null;const o=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===r.isPointLight?l:s,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=a.uuid,t=n.uuid;let r=c[e];void 0===r&&(r={},c[e]=r);let i=r[t];void 0===i&&(i=a.clone(),r[t]=i,n.addEventListener("dispose",S)),a=i}return a.visible=n.visible,a.wireframe=n.wireframe,a.side=3===i?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:d[n.side],a.alphaMap=n.alphaMap,a.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial&&(e.properties.get(a).light=r),a}function w(n,i,a,o,s){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const r=t.update(n),l=n.material;if(Array.isArray(l)){const t=r.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],d=l[u.materialIndex];if(d&&d.visible){const t=_(n,d,o,s);n.onBeforeShadow(e,n,i,a,r,t,u),e.renderBufferDirect(a,null,r,t,n,u),n.onAfterShadow(e,n,i,a,r,t,u)}}}else if(l.visible){const t=_(n,l,o,s);n.onBeforeShadow(e,n,i,a,r,t,null),e.renderBufferDirect(a,null,r,t,n,null),n.onAfterShadow(e,n,i,a,r,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)w(l[e],i,a,o,s)}function S(e){e.target.removeEventListener("dispose",S);for(const t in c){const n=c[t],r=e.target.uuid;r in n&&(n[r].dispose(),delete n[r])}}this.render=function(t,n,s){if(!1===v.enabled)return;if(!1===v.autoUpdate&&!1===v.needsUpdate)return;if(0===t.length)return;2===t.type&&(We("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),t.type=1);const l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),!0===h.buffers.depth.getReversed()?h.buffers.color.setClear(0,0,0,0):h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);const p=x!==this.type;p&&n.traverse((function(e){e.material&&(Array.isArray(e.material)?e.material.forEach((e=>e.needsUpdate=!0)):e.material.needsUpdate=!0)}));for(let l=0,c=t.length;l<c;l++){const c=t[l],d=c.shadow;if(void 0===d){We("WebGLShadowMap:",c,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;i.copy(d.mapSize);const f=d.getFrameExtents();if(i.multiply(f),a.copy(d.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(a.x=Math.floor(u/f.x),i.x=a.x*f.x,d.mapSize.x=a.x),i.y>u&&(a.y=Math.floor(u/f.y),i.y=a.y*f.y,d.mapSize.y=a.y)),null===d.map||!0===p){if(null!==d.map&&(null!==d.map.depthTexture&&(d.map.depthTexture.dispose(),d.map.depthTexture=null),d.map.dispose()),3===this.type){if(c.isPointLight){We("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}d.map=new Pt(i.x,i.y,{format:B,type:C,minFilter:y,magFilter:y,generateMipmaps:!1}),d.map.texture.name=c.name+".shadowMap",d.map.depthTexture=new Qi(i.x,i.y,A),d.map.depthTexture.name=c.name+".shadowMapDepth",d.map.depthTexture.format=U,d.map.depthTexture.compareFunction=null,d.map.depthTexture.minFilter=g,d.map.depthTexture.magFilter=g}else{c.isPointLight?(d.map=new Wr(i.x),d.map.depthTexture=new ea(i.x,T)):(d.map=new Pt(i.x,i.y),d.map.depthTexture=new Qi(i.x,i.y,T)),d.map.depthTexture.name=c.name+".shadowMap",d.map.depthTexture.format=U;const t=e.state.buffers.depth.getReversed();1===this.type?(d.map.depthTexture.compareFunction=t?518:515,d.map.depthTexture.minFilter=y,d.map.depthTexture.magFilter=y):(d.map.depthTexture.compareFunction=null,d.map.depthTexture.minFilter=g,d.map.depthTexture.magFilter=g)}d.camera.updateProjectionMatrix()}const m=d.map.isWebGLCubeRenderTarget?6:1;for(let t=0;t<m;t++){if(d.map.isWebGLCubeRenderTarget)e.setRenderTarget(d.map,t),e.clear();else{0===t&&(e.setRenderTarget(d.map),e.clear());const n=d.getViewport(t);o.set(a.x*n.x,a.y*n.y,a.x*n.z,a.y*n.w),h.viewport(o)}if(c.isPointLight){const e=d.camera,n=d.matrix,r=c.distance||e.far;r!==e.far&&(e.far=r,e.updateProjectionMatrix()),$l.setFromMatrixPosition(c.matrixWorld),e.position.copy($l),Zl.copy(e.position),Zl.add(ql[t]),e.up.copy(Yl[t]),e.lookAt(Zl),e.updateMatrixWorld(),n.makeTranslation(-$l.x,-$l.y,-$l.z),Kl.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),d._frustum.setFromProjectionMatrix(Kl,e.coordinateSystem,e.reversedDepth)}else d.updateMatrices(c);r=d.getFrustum(),w(n,s,d.camera,c,this.type)}!0!==d.isPointLightShadow&&3===this.type&&b(d,s),d.needsUpdate=!1}x=this.type,v.needsUpdate=!1,e.setRenderTarget(l,c,d)}}const Ql={0:1,2:6,4:7,3:5,1:0,6:2,7:4,5:3};function ec(e,t){const n=new function(){let t=!1;const n=new At;let r=null;const i=new At(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},r=new function(){let n=!1,r=!1,i=null,a=null,o=null;return{setReversed:function(e){if(r!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),r=e;const i=o;o=null,this.setClear(i)}},getReversed:function(){return r},setTest:function(t){t?B(e.DEPTH_TEST):H(e.DEPTH_TEST)},setMask:function(t){i===t||n||(e.depthMask(t),i=t)},setFunc:function(t){if(r&&(t=Ql[t]),a!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}a=t}},setLocked:function(e){n=e},setClear:function(t){o!==t&&(r&&(t=1-t),e.clearDepth(t),o=t)},reset:function(){n=!1,i=null,a=null,o=null,r=!1}}},i=new function(){let t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(n){t||(n?B(e.STENCIL_TEST):H(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null}}},o=new WeakMap,s=new WeakMap;let l={},c={},u=new WeakMap,d=[],h=null,p=!1,f=null,m=null,g=null,v=null,y=null,x=null,b=null,_=new Jn(0,0,0),w=0,S=!1,M=null,E=null,T=null,A=null,C=null;const P=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,O=0;const D=e.getParameter(e.VERSION);-1!==D.indexOf("WebGL")?(O=parseFloat(/^WebGL (\d)/.exec(D)[1]),R=O>=1):-1!==D.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL ES (\d)/.exec(D)[1]),R=O>=2);let I=null,L={};const N=e.getParameter(e.SCISSOR_BOX),k=e.getParameter(e.VIEWPORT),U=(new At).fromArray(N),F=(new At).fromArray(k);function z(t,n,r,i){const a=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return o}const j={};function B(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function H(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}j[e.TEXTURE_2D]=z(e.TEXTURE_2D,e.TEXTURE_2D,1),j[e.TEXTURE_CUBE_MAP]=z(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),j[e.TEXTURE_2D_ARRAY]=z(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),j[e.TEXTURE_3D]=z(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),r.setClear(1),i.setClear(0),B(e.DEPTH_TEST),r.setFunc(3),X(!1),q(1),B(e.CULL_FACE),W(0);const V={[a]:e.FUNC_ADD,101:e.FUNC_SUBTRACT,102:e.FUNC_REVERSE_SUBTRACT};V[103]=e.MIN,V[104]=e.MAX;const G={200:e.ZERO,201:e.ONE,202:e.SRC_COLOR,204:e.SRC_ALPHA,210:e.SRC_ALPHA_SATURATE,208:e.DST_COLOR,206:e.DST_ALPHA,203:e.ONE_MINUS_SRC_COLOR,205:e.ONE_MINUS_SRC_ALPHA,209:e.ONE_MINUS_DST_COLOR,207:e.ONE_MINUS_DST_ALPHA,211:e.CONSTANT_COLOR,212:e.ONE_MINUS_CONSTANT_COLOR,213:e.CONSTANT_ALPHA,214:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,n,r,i,o,s,l,c,u,d){if(0!==t){if(!1===p&&(B(e.BLEND),p=!0),5===t)o=o||n,s=s||r,l=l||i,n===m&&o===y||(e.blendEquationSeparate(V[n],V[o]),m=n,y=o),r===g&&i===v&&s===x&&l===b||(e.blendFuncSeparate(G[r],G[i],G[s],G[l]),g=r,v=i,x=s,b=l),!1!==c.equals(_)&&u===w||(e.blendColor(c.r,c.g,c.b,u),_.copy(c),w=u),f=t,S=!1;else if(t!==f||d!==S){if(m===a&&y===a||(e.blendEquation(e.FUNC_ADD),m=a,y=a),d)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:Xe("WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case 3:Xe("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:Xe("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Xe("WebGLState: Invalid blending: ",t)}g=null,v=null,x=null,b=null,_.set(0,0,0),w=0,f=t,S=d}}else!0===p&&(H(e.BLEND),p=!1)}function X(t){M!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),M=t)}function q(t){0!==t?(B(e.CULL_FACE),t!==E&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):H(e.CULL_FACE),E=t}function Y(t,n,r){t?(B(e.POLYGON_OFFSET_FILL),A===n&&C===r||(e.polygonOffset(n,r),A=n,C=r)):H(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:r,stencil:i},enable:B,disable:H,bindFramebuffer:function(t,n){return c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=d,i=!1;if(t){r=u.get(n),void 0===r&&(r=[],u.set(n,r));const a=t.textures;if(r.length!==a.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=a.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=a.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:W,setMaterial:function(t,a){2===t.side?H(e.CULL_FACE):B(e.CULL_FACE);let o=1===t.side;a&&(o=!o),X(o),1===t.blending&&!1===t.transparent?W(0):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),r.setFunc(t.depthFunc),r.setTest(t.depthTest),r.setMask(t.depthWrite),n.setMask(t.colorWrite);const s=t.stencilWrite;i.setTest(s),s&&(i.setMask(t.stencilWriteMask),i.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),i.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Y(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?B(e.SAMPLE_ALPHA_TO_COVERAGE):H(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:X,setCullFace:q,setLineWidth:function(t){t!==T&&(R&&e.lineWidth(t),T=t)},setPolygonOffset:Y,setScissorTest:function(t){t?B(e.SCISSOR_TEST):H(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+P-1),I!==t&&(e.activeTexture(t),I=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===I?e.TEXTURE0+P-1:I);let i=L[r];void 0===i&&(i={type:void 0,texture:void 0},L[r]=i),i.type===t&&i.texture===n||(I!==r&&(e.activeTexture(r),I=r),e.bindTexture(t,n||j[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=L[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(e){Xe("WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(e){Xe("WebGLState:",e)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(e){Xe("WebGLState:",e)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(e){Xe("WebGLState:",e)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);o.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),o.set(n,r))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(e){Xe("WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(e){Xe("WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(e){Xe("WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(e){Xe("WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(e){Xe("WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(e){Xe("WebGLState:",e)}},scissor:function(t){!1===U.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),U.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),r.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},I=null,L={},c={},u=new WeakMap,d=[],h=null,p=!1,f=null,m=null,g=null,v=null,y=null,x=null,b=null,_=new Jn(0,0,0),w=0,S=!1,M=null,E=null,T=null,A=null,C=null,U.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),n.reset(),r.reset(),i.reset()}}}function tc(e,t,n,r,i,a,o){const s=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new ot,u=new WeakMap;let d;const h=new WeakMap;let w=!1;try{w="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function S(e,t){return w?new OffscreenCanvas(e,t):je("canvas")}function E(e,t,n){let r=1;const i=ae(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),a=Math.floor(r*i.height);void 0===d&&(d=S(n,a));const o=t?S(n,a):d;return o.width=n,o.height=a,o.getContext("2d").drawImage(e,0,0,n,a),We("WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+a+")."),o}return"data"in e&&We("WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function C(e){return e.generateMipmaps}function P(t){e.generateMipmap(t)}function R(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function D(n,r,i,a,o=!1){if(null!==n){if(void 0!==e[n])return e[n];We("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let s=r;if(r===e.RED&&(i===e.FLOAT&&(s=e.R32F),i===e.HALF_FLOAT&&(s=e.R16F),i===e.UNSIGNED_BYTE&&(s=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.R8UI),i===e.UNSIGNED_SHORT&&(s=e.R16UI),i===e.UNSIGNED_INT&&(s=e.R32UI),i===e.BYTE&&(s=e.R8I),i===e.SHORT&&(s=e.R16I),i===e.INT&&(s=e.R32I)),r===e.RG&&(i===e.FLOAT&&(s=e.RG32F),i===e.HALF_FLOAT&&(s=e.RG16F),i===e.UNSIGNED_BYTE&&(s=e.RG8)),r===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RG8UI),i===e.UNSIGNED_SHORT&&(s=e.RG16UI),i===e.UNSIGNED_INT&&(s=e.RG32UI),i===e.BYTE&&(s=e.RG8I),i===e.SHORT&&(s=e.RG16I),i===e.INT&&(s=e.RG32I)),r===e.RGB_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RGB8UI),i===e.UNSIGNED_SHORT&&(s=e.RGB16UI),i===e.UNSIGNED_INT&&(s=e.RGB32UI),i===e.BYTE&&(s=e.RGB8I),i===e.SHORT&&(s=e.RGB16I),i===e.INT&&(s=e.RGB32I)),r===e.RGBA_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RGBA8UI),i===e.UNSIGNED_SHORT&&(s=e.RGBA16UI),i===e.UNSIGNED_INT&&(s=e.RGBA32UI),i===e.BYTE&&(s=e.RGBA8I),i===e.SHORT&&(s=e.RGBA16I),i===e.INT&&(s=e.RGBA32I)),r===e.RGB&&(i===e.UNSIGNED_INT_5_9_9_9_REV&&(s=e.RGB9_E5),i===e.UNSIGNED_INT_10F_11F_11F_REV&&(s=e.R11F_G11F_B10F)),r===e.RGBA){const t=o?De:gt.getTransfer(a);i===e.FLOAT&&(s=e.RGBA32F),i===e.HALF_FLOAT&&(s=e.RGBA16F),i===e.UNSIGNED_BYTE&&(s=t===Ie?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)}return s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||t.get("EXT_color_buffer_float"),s}function I(t,n){let r;return t?null===n||n===T||n===O?r=e.DEPTH24_STENCIL8:n===A?r=e.DEPTH32F_STENCIL8:n===M&&(r=e.DEPTH24_STENCIL8,We("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===T||n===O?r=e.DEPTH_COMPONENT24:n===A?r=e.DEPTH_COMPONENT32F:n===M&&(r=e.DEPTH_COMPONENT16),r}function L(e,t){return!0===C(e)||e.isFramebufferTexture&&e.minFilter!==g&&e.minFilter!==y?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function N(e){const t=e.target;t.removeEventListener("dispose",N),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=h.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&j(e),0===Object.keys(i).length&&h.delete(n)}r.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function z(t){const n=t.target;n.removeEventListener("dispose",z),function(t){const n=r.get(t);if(t.depthTexture&&(t.depthTexture.dispose(),r.remove(t.depthTexture)),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(n.__webglFramebuffer[t]))for(let r=0;r<n.__webglFramebuffer[t].length;r++)e.deleteFramebuffer(n.__webglFramebuffer[t][r]);else e.deleteFramebuffer(n.__webglFramebuffer[t]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=t.textures;for(let t=0,n=i.length;t<n;t++){const n=r.get(i[t]);n.__webglTexture&&(e.deleteTexture(n.__webglTexture),o.memory.textures--),r.remove(i[t])}r.remove(t)}(n)}function j(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete h.get(i)[n.__cacheKey],o.memory.textures--}let B=0;function H(t,i){const a=r.get(t);if(t.isVideoTexture&&function(e){const t=o.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&a.__version!==t.version){const e=t.image;if(null===e)We("WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void K(a,t,i);We("WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(a.__webglTexture=t.sourceTexture?t.sourceTexture:null);n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}const V={[p]:e.REPEAT,[f]:e.CLAMP_TO_EDGE,[m]:e.MIRRORED_REPEAT},G={[g]:e.NEAREST,1004:e.NEAREST_MIPMAP_NEAREST,[v]:e.NEAREST_MIPMAP_LINEAR,[y]:e.LINEAR,[x]:e.LINEAR_MIPMAP_NEAREST,[b]:e.LINEAR_MIPMAP_LINEAR},W={512:e.NEVER,519:e.ALWAYS,513:e.LESS,515:e.LEQUAL,514:e.EQUAL,518:e.GEQUAL,516:e.GREATER,517:e.NOTEQUAL};function X(n,a){if(a.type!==A||!1!==t.has("OES_texture_float_linear")||a.magFilter!==y&&a.magFilter!==x&&a.magFilter!==v&&a.magFilter!==b&&a.minFilter!==y&&a.minFilter!==x&&a.minFilter!==v&&a.minFilter!==b||We("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,V[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,V[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,V[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,G[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,G[a.minFilter]),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,W[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(a.magFilter===g)return;if(a.minFilter!==v&&a.minFilter!==b)return;if(a.type===A&&!1===t.has("OES_texture_float_linear"))return;if(a.anisotropy>1||r.get(a).__currentAnisotropy){const o=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy}}}function q(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",N));const i=n.source;let a=h.get(i);void 0===a&&(a={},h.set(i,a));const s=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(s!==t.__cacheKey){void 0===a[s]&&(a[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,r=!0),a[s].usedTimes++;const i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&j(n)),t.__cacheKey=s,t.__webglTexture=a[s].texture}return r}function Y(e,t,n){return Math.floor(Math.floor(e/n)/t)}function K(t,o,s){let l=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(l=e.TEXTURE_3D);const c=q(t,o),u=o.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+s);const d=r.get(u);if(u.version!==d.__version||!0===c){n.activeTexture(e.TEXTURE0+s);const t=gt.getPrimaries(gt.workingColorSpace),r=o.colorSpace===Pe?null:gt.getPrimaries(o.colorSpace),h=o.colorSpace===Pe||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);let p=E(o.image,!1,i.maxTextureSize);p=ie(o,p);const f=a.convert(o.format,o.colorSpace),m=a.convert(o.type);let g,v=D(o.internalFormat,f,m,o.colorSpace,o.isVideoTexture);X(l,o);const y=o.mipmaps,x=!0!==o.isVideoTexture,b=void 0===d.__version||!0===c,_=u.dataReady,w=L(o,p);if(o.isDepthTexture)v=I(o.format===F,o.type),b&&(x?n.texStorage2D(e.TEXTURE_2D,1,v,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,v,p.width,p.height,0,f,m,null));else if(o.isDataTexture)if(y.length>0){x&&b&&n.texStorage2D(e.TEXTURE_2D,w,v,y[0].width,y[0].height);for(let t=0,r=y.length;t<r;t++)g=y[t],x?_&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,f,m,g.data):n.texImage2D(e.TEXTURE_2D,t,v,g.width,g.height,0,f,m,g.data);o.generateMipmaps=!1}else x?(b&&n.texStorage2D(e.TEXTURE_2D,w,v,p.width,p.height),_&&function(t,r,i,a){const o=t.updateRanges;if(0===o.length)n.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,i,a,r.data);else{o.sort(((e,t)=>e.start-t.start));let s=0;for(let e=1;e<o.length;e++){const t=o[s],n=o[e],i=t.start+t.count,a=Y(n.start,r.width,4),l=Y(t.start,r.width,4);n.start<=i+1&&a===l&&Y(n.start+n.count-1,r.width,4)===a?t.count=Math.max(t.count,n.start+n.count-t.start):(++s,o[s]=n)}o.length=s+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),u=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,r.width);for(let t=0,s=o.length;t<s;t++){const s=o[t],l=Math.floor(s.start/4),c=Math.ceil(s.count/4),u=l%r.width,d=Math.floor(l/r.width),h=c,p=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,u),e.pixelStorei(e.UNPACK_SKIP_ROWS,d),n.texSubImage2D(e.TEXTURE_2D,0,u,d,h,p,i,a,r.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,u)}}(o,p,f,m)):n.texImage2D(e.TEXTURE_2D,0,v,p.width,p.height,0,f,m,p.data);else if(o.isCompressedTexture)if(o.isCompressedArrayTexture){x&&b&&n.texStorage3D(e.TEXTURE_2D_ARRAY,w,v,y[0].width,y[0].height,p.depth);for(let t=0,r=y.length;t<r;t++)if(g=y[t],o.format!==k)if(null!==f)if(x){if(_)if(o.layerUpdates.size>0){const r=xo(g.width,g.height,o.format,o.type);for(const i of o.layerUpdates){const a=g.data.subarray(i*r/g.data.BYTES_PER_ELEMENT,(i+1)*r/g.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,i,g.width,g.height,1,f,a)}o.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,g.width,g.height,p.depth,f,g.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,v,g.width,g.height,p.depth,0,g.data,0,0);else We("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else x?_&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,g.width,g.height,p.depth,f,m,g.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,v,g.width,g.height,p.depth,0,f,m,g.data)}else{x&&b&&n.texStorage2D(e.TEXTURE_2D,w,v,y[0].width,y[0].height);for(let t=0,r=y.length;t<r;t++)g=y[t],o.format!==k?null!==f?x?_&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,f,g.data):n.compressedTexImage2D(e.TEXTURE_2D,t,v,g.width,g.height,0,g.data):We("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):x?_&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,f,m,g.data):n.texImage2D(e.TEXTURE_2D,t,v,g.width,g.height,0,f,m,g.data)}else if(o.isDataArrayTexture)if(x){if(b&&n.texStorage3D(e.TEXTURE_2D_ARRAY,w,v,p.width,p.height,p.depth),_)if(o.layerUpdates.size>0){const t=xo(p.width,p.height,o.format,o.type);for(const r of o.layerUpdates){const i=p.data.subarray(r*t/p.data.BYTES_PER_ELEMENT,(r+1)*t/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,r,p.width,p.height,1,f,m,i)}o.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,f,m,p.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,v,p.width,p.height,p.depth,0,f,m,p.data);else if(o.isData3DTexture)x?(b&&n.texStorage3D(e.TEXTURE_3D,w,v,p.width,p.height,p.depth),_&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,f,m,p.data)):n.texImage3D(e.TEXTURE_3D,0,v,p.width,p.height,p.depth,0,f,m,p.data);else if(o.isFramebufferTexture){if(b)if(x)n.texStorage2D(e.TEXTURE_2D,w,v,p.width,p.height);else{let t=p.width,r=p.height;for(let i=0;i<w;i++)n.texImage2D(e.TEXTURE_2D,i,v,t,r,0,f,m,null),t>>=1,r>>=1}}else if(y.length>0){if(x&&b){const t=ae(y[0]);n.texStorage2D(e.TEXTURE_2D,w,v,t.width,t.height)}for(let t=0,r=y.length;t<r;t++)g=y[t],x?_&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,f,m,g):n.texImage2D(e.TEXTURE_2D,t,v,f,m,g);o.generateMipmaps=!1}else if(x){if(b){const t=ae(p);n.texStorage2D(e.TEXTURE_2D,w,v,t.width,t.height)}_&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,f,m,p)}else n.texImage2D(e.TEXTURE_2D,0,v,f,m,p);C(o)&&P(l),d.__version=u.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function $(t,i,o,l,c,u){const d=a.convert(o.format,o.colorSpace),h=a.convert(o.type),p=D(o.internalFormat,d,h,o.colorSpace),f=r.get(i),m=r.get(o);if(m.__renderTarget=i,!f.__hasExternalTextures){const t=Math.max(1,i.width>>u),r=Math.max(1,i.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,p,t,r,i.depth,0,d,h,null):n.texImage2D(c,u,p,t,r,0,d,h,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),re(i)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,m.__webglTexture,0,ne(i)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,m.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function Z(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const i=n.depthTexture,a=i&&i.isDepthTexture?i.type:null,o=I(n.stencilBuffer,a),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;re(n)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,ne(n),o,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,ne(n),o,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,o,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const o=t[i],l=a.convert(o.format,o.colorSpace),c=a.convert(o.type),u=D(o.internalFormat,l,c,o.colorSpace);re(n)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,ne(n),u,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,ne(n),u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function J(t,i,o){const l=!0===i.isWebGLCubeRenderTarget;if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const c=r.get(i.depthTexture);if(c.__renderTarget=i,c.__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),l){if(void 0===c.__webglInit&&(c.__webglInit=!0,i.depthTexture.addEventListener("dispose",N)),void 0===c.__webglTexture){c.__webglTexture=e.createTexture(),n.bindTexture(e.TEXTURE_CUBE_MAP,c.__webglTexture),X(e.TEXTURE_CUBE_MAP,i.depthTexture);const t=a.convert(i.depthTexture.format),r=a.convert(i.depthTexture.type);let o;i.depthTexture.format===U?o=e.DEPTH_COMPONENT24:i.depthTexture.format===F&&(o=e.DEPTH24_STENCIL8);for(let n=0;n<6;n++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,o,i.width,i.height,0,t,r,null)}}else H(i.depthTexture,0);const u=c.__webglTexture,d=ne(i),h=l?e.TEXTURE_CUBE_MAP_POSITIVE_X+o:e.TEXTURE_2D,p=i.depthTexture.format===F?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;if(i.depthTexture.format===U)re(i)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,p,h,u,0,d):e.framebufferTexture2D(e.FRAMEBUFFER,p,h,u,0);else{if(i.depthTexture.format!==F)throw new Error("Unknown depthTexture format");re(i)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,p,h,u,0,d):e.framebufferTexture2D(e.FRAMEBUFFER,p,h,u,0)}}function Q(t){const i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(i.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(i.__depthDisposeCallback&&i.__depthDisposeCallback(),e){const t=()=>{delete i.__boundDepthTexture,delete i.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),i.__depthDisposeCallback=t}i.__boundDepthTexture=e}if(t.depthTexture&&!i.__autoAllocateDepthBuffer)if(a)for(let e=0;e<6;e++)J(i.__webglFramebuffer[e],t,e);else{const e=t.texture.mipmaps;e&&e.length>0?J(i.__webglFramebuffer[0],t,0):J(i.__webglFramebuffer,t,0)}else if(a){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)if(n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[r]),void 0===i.__webglDepthbuffer[r])i.__webglDepthbuffer[r]=e.createRenderbuffer(),Z(i.__webglDepthbuffer[r],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,a=i.__webglDepthbuffer[r];e.bindRenderbuffer(e.RENDERBUFFER,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,a)}}else{const r=t.texture.mipmaps;if(r&&r.length>0?n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),void 0===i.__webglDepthbuffer)i.__webglDepthbuffer=e.createRenderbuffer(),Z(i.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,r=i.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,r)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const ee=[],te=[];function ne(e){return Math.min(i.maxSamples,e.samples)}function re(e){const n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function ie(e,t){const n=e.colorSpace,r=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==Oe&&n!==Pe&&(gt.getTransfer(n)===Ie?r===k&&i===_||We("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Xe("WebGLTextures: Unsupported texture color space:",n)),t}function ae(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=B;return e>=i.maxTextures&&We("WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),B+=1,e},this.resetTextureUnits=function(){B=0},this.setTexture2D=H,this.setTexture2DArray=function(t,i){const a=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?K(a,t,i):(t.isExternalTexture&&(a.__webglTexture=t.sourceTexture?t.sourceTexture:null),n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i))},this.setTexture3D=function(t,i){const a=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?K(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,o){const s=r.get(t);!0!==t.isCubeDepthTexture&&t.version>0&&s.__version!==t.version?function(t,o,s){if(6!==o.image.length)return;const l=q(t,o),c=o.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);const u=r.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(e.TEXTURE0+s);const t=gt.getPrimaries(gt.workingColorSpace),r=o.colorSpace===Pe?null:gt.getPrimaries(o.colorSpace),d=o.colorSpace===Pe||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const h=o.isCompressedTexture||o.image[0].isCompressedTexture,p=o.image[0]&&o.image[0].isDataTexture,f=[];for(let e=0;e<6;e++)f[e]=h||p?p?o.image[e].image:o.image[e]:E(o.image[e],!0,i.maxCubemapSize),f[e]=ie(o,f[e]);const m=f[0],g=a.convert(o.format,o.colorSpace),v=a.convert(o.type),y=D(o.internalFormat,g,v,o.colorSpace),x=!0!==o.isVideoTexture,b=void 0===u.__version||!0===l,_=c.dataReady;let w,S=L(o,m);if(X(e.TEXTURE_CUBE_MAP,o),h){x&&b&&n.texStorage2D(e.TEXTURE_CUBE_MAP,S,y,m.width,m.height);for(let t=0;t<6;t++){w=f[t].mipmaps;for(let r=0;r<w.length;r++){const i=w[r];o.format!==k?null!==g?x?_&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,g,i.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,y,i.width,i.height,0,i.data):We("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):x?_&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,g,v,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,y,i.width,i.height,0,g,v,i.data)}}}else{if(w=o.mipmaps,x&&b){w.length>0&&S++;const t=ae(f[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,S,y,t.width,t.height)}for(let t=0;t<6;t++)if(p){x?_&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,f[t].width,f[t].height,g,v,f[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,y,f[t].width,f[t].height,0,g,v,f[t].data);for(let r=0;r<w.length;r++){const i=w[r].image[t].image;x?_&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,g,v,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,y,i.width,i.height,0,g,v,i.data)}}else{x?_&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,g,v,f[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,y,g,v,f[t]);for(let r=0;r<w.length;r++){const i=w[r];x?_&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,g,v,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,y,g,v,i.image[t])}}}C(o)&&P(e.TEXTURE_CUBE_MAP),u.__version=c.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}(s,t,o):n.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+o)},this.rebindTextures=function(t,n,i){const a=r.get(t);void 0!==n&&$(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&Q(t)},this.setupRenderTarget=function(t){const i=t.texture,s=r.get(t),l=r.get(i);t.addEventListener("dispose",z);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,d=c.length>1;if(d||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,o.memory.textures++),u){s.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer[t]=[];for(let n=0;n<i.mipmaps.length;n++)s.__webglFramebuffer[t][n]=e.createFramebuffer()}else s.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)s.__webglFramebuffer[t]=e.createFramebuffer()}else s.__webglFramebuffer=e.createFramebuffer();if(d)for(let t=0,n=c.length;t<n;t++){const n=r.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),o.memory.textures++)}if(t.samples>0&&!1===re(t)){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];s.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer[n]);const i=a.convert(r.format,r.colorSpace),o=a.convert(r.type),l=D(r.internalFormat,i,o,r.colorSpace,!0===t.isXRRenderTarget),u=ne(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,s.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),Z(s.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),X(e.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)$(s.__webglFramebuffer[n][r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else $(s.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);C(i)&&P(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(d){for(let i=0,a=c.length;i<a;i++){const a=c[i],o=r.get(a);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(l,o.__webglTexture),X(l,a),$(s.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+i,l,0),C(a)&&P(l)}n.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),X(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)$(s.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,r,n);else $(s.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,r,0);C(i)&&P(r),n.unbindTexture()}t.depthBuffer&&Q(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let i=0,a=t.length;i<a;i++){const a=t[i];if(C(a)){const t=R(e),i=r.get(a).__webglTexture;n.bindTexture(t,i),P(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===re(t)){const i=t.textures,a=t.width,o=t.height;let s=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=r.get(t),d=i.length>1;if(d)for(let t=0;t<i.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const h=t.texture.mipmaps;h&&h.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<i.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),d){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),!0===l&&(ee.length=0,te.length=0,ee.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(ee.push(c),te.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,te)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,ee))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),d)for(let t=0;t<i.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const a=r.get(i[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=Q,this.setupFrameBufferTexture=$,this.useMultisampledRTT=re,this.isReversedDepthBuffer=function(){return n.buffers.depth.getReversed()}}function nc(e,t){return{convert:function(n,r=""){let i;const a=gt.getTransfer(r);if(n===_)return e.UNSIGNED_BYTE;if(n===P)return e.UNSIGNED_SHORT_4_4_4_4;if(n===R)return e.UNSIGNED_SHORT_5_5_5_1;if(n===D)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===I)return e.UNSIGNED_INT_10F_11F_11F_REV;if(n===w)return e.BYTE;if(n===S)return e.SHORT;if(n===M)return e.UNSIGNED_SHORT;if(n===E)return e.INT;if(n===T)return e.UNSIGNED_INT;if(n===A)return e.FLOAT;if(n===C)return e.HALF_FLOAT;if(n===L)return e.ALPHA;if(n===N)return e.RGB;if(n===k)return e.RGBA;if(n===U)return e.DEPTH_COMPONENT;if(n===F)return e.DEPTH_STENCIL;if(n===z)return e.RED;if(n===j)return e.RED_INTEGER;if(n===B)return e.RG;if(n===H)return e.RG_INTEGER;if(n===V)return e.RGBA_INTEGER;if(n===G||n===W||n===X||n===q)if(a===Ie){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===G)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===W)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===X)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===q)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===G)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===W)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===X)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===q)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Y||n===K||n===$||n===Z){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===Y)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===K)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===$)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Z)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===J||n===Q||n===ee||n===te||n===ne||n===re||n===ie){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===J||n===Q)return a===Ie?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===ee)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC;if(n===te)return i.COMPRESSED_R11_EAC;if(n===ne)return i.COMPRESSED_SIGNED_R11_EAC;if(n===re)return i.COMPRESSED_RG11_EAC;if(n===ie)return i.COMPRESSED_SIGNED_RG11_EAC}if(n===ae||n===oe||n===se||n===le||n===ce||n===ue||n===de||n===he||n===pe||n===fe||n===me||n===ge||n===ve||n===ye){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===ae)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===oe)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===se)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===le)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===ce)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===ue)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===de)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===he)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===pe)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===fe)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===me)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===ge)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===ve)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===ye)return a===Ie?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===xe||n===be||n===_e){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===xe)return a===Ie?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===be)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===_e)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===we||n===Se||n===Me||n===Ee){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===we)return i.COMPRESSED_RED_RGTC1_EXT;if(n===Se)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Me)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Ee)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===O?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class rc{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const n=new ta(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new kr({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Pr(new na(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class ic extends Ye{constructor(e,t){super();const n=this;let r=null,i=1,a=null,o="local-floor",s=1,l=null,c=null,u=null,d=null,h=null,p=null;const f="undefined"!=typeof XRWebGLBinding,m=new rc,g={},v=t.getContextAttributes();let y=null,x=null;const b=[],w=[],S=new ot;let M=null;const E=new Br;E.viewport=new At;const A=new Br;A.viewport=new At;const C=[E,A],P=new no;let R=null,D=null;function I(e){const t=w.indexOf(e.inputSource);if(-1===t)return;const n=b[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||a),n.dispatchEvent({type:e.type,data:e.inputSource}))}function L(){r.removeEventListener("select",I),r.removeEventListener("selectstart",I),r.removeEventListener("selectend",I),r.removeEventListener("squeeze",I),r.removeEventListener("squeezestart",I),r.removeEventListener("squeezeend",I),r.removeEventListener("end",L),r.removeEventListener("inputsourceschange",N);for(let e=0;e<b.length;e++){const t=w[e];null!==t&&(w[e]=null,b[e].disconnect(t))}R=null,D=null,m.reset();for(const e in g)delete g[e];e.setRenderTarget(y),h=null,d=null,u=null,r=null,x=null,V.stop(),n.isPresenting=!1,e.setPixelRatio(M),e.setSize(S.width,S.height,!1),n.dispatchEvent({type:"sessionend"})}function N(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=w.indexOf(n);r>=0&&(w[r]=null,b[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=w.indexOf(n);if(-1===r){for(let e=0;e<b.length;e++){if(e>=w.length){w.push(n),r=e;break}if(null===w[e]){w[e]=n,r=e;break}}if(-1===r)break}const i=b[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=b[e];return void 0===t&&(t=new Yr,b[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=b[e];return void 0===t&&(t=new Yr,b[e]=t),t.getGripSpace()},this.getHand=function(e){let t=b[e];return void 0===t&&(t=new Yr,b[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&We("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&We("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return null===u&&f&&(u=new XRWebGLBinding(r,t)),u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(c){if(r=c,null!==r){if(y=e.getRenderTarget(),r.addEventListener("select",I),r.addEventListener("selectstart",I),r.addEventListener("selectend",I),r.addEventListener("squeeze",I),r.addEventListener("squeezestart",I),r.addEventListener("squeezeend",I),r.addEventListener("end",L),r.addEventListener("inputsourceschange",N),!0!==v.xrCompatible&&await t.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(S),f&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,a=null,o=null;v.depth&&(o=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=v.stencil?F:U,a=v.stencil?O:T);const s={colorFormat:t.RGBA8,depthFormat:o,scaleFactor:i};u=this.getBinding(),d=u.createProjectionLayer(s),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),x=new Pt(d.textureWidth,d.textureHeight,{format:k,type:_,depthTexture:new Qi(d.textureWidth,d.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}else{const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),x=new Pt(h.framebufferWidth,h.framebufferHeight,{format:k,type:_,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}x.isXRRenderTarget=!0,this.setFoveation(s),l=null,a=await r.requestReferenceSpace(o),V.setContext(r),V.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const z=new lt,j=new lt;function B(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;let t=e.near,n=e.far;null!==m.texture&&(m.depthNear>0&&(t=m.depthNear),m.depthFar>0&&(n=m.depthFar)),P.near=A.near=E.near=t,P.far=A.far=E.far=n,R===P.near&&D===P.far||(r.updateRenderState({depthNear:P.near,depthFar:P.far}),R=P.near,D=P.far),P.layers.mask=6|e.layers.mask,E.layers.mask=3&P.layers.mask,A.layers.mask=5&P.layers.mask;const i=e.parent,a=P.cameras;B(P,i);for(let e=0;e<a.length;e++)B(a[e],i);2===a.length?function(e,t,n){z.setFromMatrixPosition(t.matrixWorld),j.setFromMatrixPosition(n.matrixWorld);const r=z.distanceTo(j),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],d=(a[8]+1)/a[0],h=o*u,p=o*d,f=r/(-u+d),m=f*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=o+f,n=s+f,i=h-m,a=p+(r-m),u=l*s/n*t,d=c*s/n*t;e.projectionMatrix.makePerspective(i,a,u,d,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(P,E,A):P.projectionMatrix.copy(E.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld)),e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*Ze*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,P,i)},this.getCamera=function(){return P},this.getFoveation=function(){if(null!==d||null!==h)return s},this.setFoveation=function(e){s=e,null!==d&&(d.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(P)},this.getCameraTexture=function(e){return g[e]};let H=null;const V=new bo;V.setAnimationLoop((function(t,i){if(c=i.getViewerPose(l||a),p=i,null!==c){const t=c.views;null!==h&&(e.setRenderTargetFramebuffer(x,h.framebuffer),e.setRenderTarget(x));let i=!1;t.length!==P.cameras.length&&(P.cameras.length=0,i=!0);for(let n=0;n<t.length;n++){const r=t[n];let a=null;if(null!==h)a=h.getViewport(r);else{const t=u.getViewSubImage(d,r);a=t.viewport,0===n&&(e.setRenderTargetTextures(x,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(x))}let o=C[n];void 0===o&&(o=new Br,o.layers.enable(n),o.viewport=new At,C[n]=o),o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(r.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(a.x,a.y,a.width,a.height),0===n&&(P.matrix.copy(o.matrix),P.matrix.decompose(P.position,P.quaternion,P.scale)),!0===i&&P.cameras.push(o)}const a=r.enabledFeatures;if(a&&a.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&f){u=n.getBinding();const e=u.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&m.init(e,r.renderState)}if(a&&a.includes("camera-access")&&f){e.state.unbindTexture(),u=n.getBinding();for(let e=0;e<t.length;e++){const n=t[e].camera;if(n){let e=g[n];e||(e=new ta,g[n]=e);const t=u.getCameraImage(n);e.sourceTexture=t}}}}for(let e=0;e<b.length;e++){const t=w[e],n=b[e];null!==t&&void 0!==n&&n.update(t,i,l||a)}H&&H(t,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),p=null})),this.setAnimationLoop=function(e){H=e},this.dispose=function(){}}}const ac=new gn,oc=new on;function sc(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,1===r.side&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),1===r.side&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);const i=t.get(r),a=i.envMap,o=i.envMapRotation;a&&(e.envMap.value=a,ac.copy(o),ac.x*=-1,ac.y*=-1,ac.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(ac.y*=-1,ac.z*=-1),e.envMapRotation.value.setFromMatrix4(oc.makeRotationFromEuler(ac)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Lr(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,o,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform)),e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform)),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform))),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate())),t.dispersion>0&&(e.dispersion.value=t.dispersion),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform)),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,s)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function lc(e,t,n,r){let i={},a={},o=[];const s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const i=e.value,a=t+"_"+n;if(void 0===r[a])return r[a]="number"==typeof i||"boolean"==typeof i?i:i.clone(),!0;{const e=r[a];if("number"==typeof i||"boolean"==typeof i){if(e!==i)return r[a]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?We("WebGLRenderer: Texture samplers can not be part of an uniforms group."):We("WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,d){let h=i[n.id];void 0===h&&(function(e){const t=e.uniforms;let n=0;for(let e=0,r=t.length;e<r;e++){const r=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=r.length;e<t;e++){const t=r[e],i=Array.isArray(t.value)?t.value:[t.value];for(let e=0,r=i.length;e<r;e++){const r=c(i[e]),a=n%16,o=a%r.boundary,s=a+o;n+=o,0!==s&&16-s<r.storage&&(n+=16-s),t.__data=new Float32Array(r.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=n,n+=r.storage}}}const r=n%16;r>0&&(n+=16-r),e.__size=n,e.__cache={}}(n),h=function(t){const n=function(){for(let e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return Xe("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=h,n.addEventListener("dispose",u));const p=d.program;r.updateUBOMapping(n,p);const f=t.render.frame;a[n.id]!==f&&(function(t){const n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let t=0,n=r.length;t<n;t++){const n=Array.isArray(r[t])?r[t]:[r[t]];for(let r=0,i=n.length;r<i;r++){const i=n[r];if(!0===l(i,t,r,a)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let a=0;a<n.length;a++){const o=n[a],s=c(o);"number"==typeof o||"boolean"==typeof o?(i.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):o.isMatrix3?(i.__data[0]=o.elements[0],i.__data[1]=o.elements[1],i.__data[2]=o.elements[2],i.__data[3]=0,i.__data[4]=o.elements[3],i.__data[5]=o.elements[4],i.__data[6]=o.elements[5],i.__data[7]=0,i.__data[8]=o.elements[6],i.__data[9]=o.elements[7],i.__data[10]=o.elements[8],i.__data[11]=0):(o.toArray(i.__data,r),r+=s.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=f)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}const cc=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let uc=null;class dc{constructor(e={}){const{canvas:t=Be(),context:n=null,depth:r=!0,stencil:a=!1,alpha:s=!1,antialias:l=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:u=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:h=!1,reversedDepthBuffer:p=!1,outputBufferType:m=_}=e;let g;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=n.getContextAttributes().alpha}else g=s;const v=m,x=new Set([V,H,j]),w=new Set([_,T,M,O,P,R]),S=new Uint32Array(4),E=new Int32Array(4);let A=null,D=null;const I=[],L=[];let N=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=o,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const k=this;let U=!1;this._outputColorSpace=Re;let F=0,z=0,G=null,W=-1,X=null;const q=new At,Y=new At;let K=null;const $=new Jn(0);let Z=0,J=t.width,Q=t.height,ee=1,te=null,ne=null;const re=new At(0,0,J,Q),ie=new At(0,0,J,Q);let ae=!1;const oe=new Ri;let se=!1,le=!1;const ce=new on,ue=new lt,de=new At,he={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let pe=!1;function fe(){return null===G?ee:1}let me,ge,ve,ye,xe,be,_e,we,Se,Me,Ee,Te,Ae,Ce,Pe,De,Ie,Le,Ne,ke,Fe,ze,je,He,Ve=n;function Ye(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:r,stencil:a,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:d,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${i}`),t.addEventListener("webglcontextlost",Ze,!1),t.addEventListener("webglcontextrestored",Je,!1),t.addEventListener("webglcontextcreationerror",Qe,!1),null===Ve){const t="webgl2";if(Ve=Ye(t,e),null===Ve)throw Ye(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(e){throw Xe("WebGLRenderer: "+e.message),e}function Ke(){me=new Yo(Ve),me.init(),ze=new nc(Ve,me),ge=new Oo(Ve,me,e,ze),ve=new ec(Ve,me),ge.reversedDepthBuffer&&p&&ve.buffers.depth.setReversed(!0),ye=new Zo(Ve),xe=new kl,be=new tc(Ve,me,ve,xe,ge,ze,ye),_e=new Io(k),we=new qo(k),Se=new _o(Ve),je=new Po(Ve,Se),Me=new Ko(Ve,Se,ye,je),Ee=new Qo(Ve,Me,Se,ye),Ne=new Jo(Ve,ge,be),De=new Do(xe),Te=new Nl(k,_e,we,me,ge,je,De),Ae=new sc(k,xe),Ce=new jl,Pe=new Xl(me),Le=new Co(k,_e,we,ve,Ee,g,c),Ie=new Jl(k,Ee,ge),He=new lc(Ve,ye,ge,ve),ke=new Ro(Ve,me,ye),Fe=new $o(Ve,me,ye),ye.programs=Te.programs,k.capabilities=ge,k.extensions=me,k.properties=xe,k.renderLists=Ce,k.shadowMap=Ie,k.state=ve,k.info=ye}Ke(),v!==_&&(N=new ts(v,t.width,t.height,r,a));const $e=new ic(k,Ve);function Ze(e){e.preventDefault(),Ge("WebGLRenderer: Context Lost."),U=!0}function Je(){Ge("WebGLRenderer: Context Restored."),U=!1;const e=ye.autoReset,t=Ie.enabled,n=Ie.autoUpdate,r=Ie.needsUpdate,i=Ie.type;Ke(),ye.autoReset=e,Ie.enabled=t,Ie.autoUpdate=n,Ie.needsUpdate=r,Ie.type=i}function Qe(e){Xe("WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function et(e){const t=e.target;t.removeEventListener("dispose",et),function(e){(function(e){const t=xe.get(e).programs;void 0!==t&&(t.forEach((function(e){Te.releaseProgram(e)})),e.isShaderMaterial&&Te.releaseShaderCache(e))})(e),xe.remove(e)}(t)}function tt(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,ht(e,t,n),e.side=0,e.needsUpdate=!0,ht(e,t,n),e.side=2):ht(e,t,n)}this.xr=$e,this.getContext=function(){return Ve},this.getContextAttributes=function(){return Ve.getContextAttributes()},this.forceContextLoss=function(){const e=me.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=me.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return ee},this.setPixelRatio=function(e){void 0!==e&&(ee=e,this.setSize(J,Q,!1))},this.getSize=function(e){return e.set(J,Q)},this.setSize=function(e,n,r=!0){$e.isPresenting?We("WebGLRenderer: Can't change size while VR device is presenting."):(J=e,Q=n,t.width=Math.floor(e*ee),t.height=Math.floor(n*ee),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),null!==N&&N.setSize(t.width,t.height),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(J*ee,Q*ee).floor()},this.setDrawingBufferSize=function(e,n,r){J=e,Q=n,ee=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.setEffects=function(e){if(v!==_){if(e)for(let t=0;t<e.length;t++)if(!0===e[t].isOutputPass){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}N.setEffects(e||[])}else console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.")},this.getCurrentViewport=function(e){return e.copy(q)},this.getViewport=function(e){return e.copy(re)},this.setViewport=function(e,t,n,r){e.isVector4?re.set(e.x,e.y,e.z,e.w):re.set(e,t,n,r),ve.viewport(q.copy(re).multiplyScalar(ee).round())},this.getScissor=function(e){return e.copy(ie)},this.setScissor=function(e,t,n,r){e.isVector4?ie.set(e.x,e.y,e.z,e.w):ie.set(e,t,n,r),ve.scissor(Y.copy(ie).multiplyScalar(ee).round())},this.getScissorTest=function(){return ae},this.setScissorTest=function(e){ve.setScissorTest(ae=e)},this.setOpaqueSort=function(e){te=e},this.setTransparentSort=function(e){ne=e},this.getClearColor=function(e){return e.copy(Le.getClearColor())},this.setClearColor=function(){Le.setClearColor(...arguments)},this.getClearAlpha=function(){return Le.getClearAlpha()},this.setClearAlpha=function(){Le.setClearAlpha(...arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;if(e){let e=!1;if(null!==G){const t=G.texture.format;e=x.has(t)}if(e){const e=G.texture.type,t=w.has(e),n=Le.getClearColor(),r=Le.getClearAlpha(),i=n.r,a=n.g,o=n.b;t?(S[0]=i,S[1]=a,S[2]=o,S[3]=r,Ve.clearBufferuiv(Ve.COLOR,0,S)):(E[0]=i,E[1]=a,E[2]=o,E[3]=r,Ve.clearBufferiv(Ve.COLOR,0,E))}else r|=Ve.COLOR_BUFFER_BIT}t&&(r|=Ve.DEPTH_BUFFER_BIT),n&&(r|=Ve.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ve.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ze,!1),t.removeEventListener("webglcontextrestored",Je,!1),t.removeEventListener("webglcontextcreationerror",Qe,!1),Le.dispose(),Ce.dispose(),Pe.dispose(),xe.dispose(),_e.dispose(),we.dispose(),Ee.dispose(),je.dispose(),He.dispose(),Te.dispose(),$e.dispose(),$e.removeEventListener("sessionstart",rt),$e.removeEventListener("sessionend",it),at.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=he);const s=i.isMesh&&i.matrixWorld.determinant()<0,l=function(e,t,n,r,i){!0!==t.isScene&&(t=he),be.resetTextureUnits();const a=t.fog,s=r.isMeshStandardMaterial?t.environment:null,l=null===G?k.outputColorSpace:!0===G.isXRRenderTarget?G.texture.colorSpace:Oe,c=(r.isMeshStandardMaterial?we:_e).get(r.envMap||s),u=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,d=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,m=!!n.morphAttributes.color;let g=o;r.toneMapped&&(null!==G&&!0!==G.isXRRenderTarget||(g=k.toneMapping));const v=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,x=void 0!==v?v.length:0,b=xe.get(r),_=D.state.lights;if(!0===se&&(!0===le||e!==X)){const t=e===X&&r.id===W;De.setState(r,e,t)}let w=!1;r.version===b.__version?b.needsLights&&b.lightsStateVersion!==_.state.version||b.outputColorSpace!==l||i.isBatchedMesh&&!1===b.batching?w=!0:i.isBatchedMesh||!0!==b.batching?i.isBatchedMesh&&!0===b.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===b.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===b.instancing?w=!0:i.isInstancedMesh||!0!==b.instancing?i.isSkinnedMesh&&!1===b.skinning?w=!0:i.isSkinnedMesh||!0!==b.skinning?i.isInstancedMesh&&!0===b.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===b.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===b.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===b.instancingMorph&&null!==i.morphTexture||b.envMap!==c||!0===r.fog&&b.fog!==a?w=!0:void 0===b.numClippingPlanes||b.numClippingPlanes===De.numPlanes&&b.numIntersection===De.numIntersection?(b.vertexAlphas!==u||b.vertexTangents!==d||b.morphTargets!==h||b.morphNormals!==p||b.morphColors!==m||b.toneMapping!==g||b.morphTargetsCount!==x)&&(w=!0):w=!0:w=!0:w=!0:w=!0:(w=!0,b.__version=r.version);let S=b.currentProgram;!0===w&&(S=ht(r,t,i));let M=!1,E=!1,T=!1;const A=S.getUniforms(),P=b.uniforms;if(ve.useProgram(S.program)&&(M=!0,E=!0,T=!0),r.id!==W&&(W=r.id,E=!0),M||X!==e){ve.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),A.setValue(Ve,"projectionMatrix",e.projectionMatrix),A.setValue(Ve,"viewMatrix",e.matrixWorldInverse);const t=A.map.cameraPosition;void 0!==t&&t.setValue(Ve,ue.setFromMatrixPosition(e.matrixWorld)),ge.logarithmicDepthBuffer&&A.setValue(Ve,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&A.setValue(Ve,"isOrthographic",!0===e.isOrthographicCamera),X!==e&&(X=e,E=!0,T=!0)}if(b.needsLights&&(_.state.directionalShadowMap.length>0&&A.setValue(Ve,"directionalShadowMap",_.state.directionalShadowMap,be),_.state.spotShadowMap.length>0&&A.setValue(Ve,"spotShadowMap",_.state.spotShadowMap,be),_.state.pointShadowMap.length>0&&A.setValue(Ve,"pointShadowMap",_.state.pointShadowMap,be)),i.isSkinnedMesh){A.setOptional(Ve,i,"bindMatrix"),A.setOptional(Ve,i,"bindMatrixInverse");const e=i.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),A.setValue(Ve,"boneTexture",e.boneTexture,be))}i.isBatchedMesh&&(A.setOptional(Ve,i,"batchingTexture"),A.setValue(Ve,"batchingTexture",i._matricesTexture,be),A.setOptional(Ve,i,"batchingIdTexture"),A.setValue(Ve,"batchingIdTexture",i._indirectTexture,be),A.setOptional(Ve,i,"batchingColorTexture"),null!==i._colorsTexture&&A.setValue(Ve,"batchingColorTexture",i._colorsTexture,be));const R=n.morphAttributes;if(void 0===R.position&&void 0===R.normal&&void 0===R.color||Ne.update(i,n,S),(E||b.receiveShadow!==i.receiveShadow)&&(b.receiveShadow=i.receiveShadow,A.setValue(Ve,"receiveShadow",i.receiveShadow)),r.isMeshGouraudMaterial&&null!==r.envMap&&(P.envMap.value=c,P.flipEnvMap.value=c.isCubeTexture&&!1===c.isRenderTargetTexture?-1:1),r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(P.envMapIntensity.value=t.environmentIntensity),void 0!==P.dfgLUT&&(P.dfgLUT.value=(null===uc&&(uc=new ui(cc,16,16,B,C),uc.name="DFG_LUT",uc.minFilter=y,uc.magFilter=y,uc.wrapS=f,uc.wrapT=f,uc.generateMipmaps=!1,uc.needsUpdate=!0),uc)),E&&(A.setValue(Ve,"toneMappingExposure",k.toneMappingExposure),b.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(P,T),a&&!0===r.fog&&Ae.refreshFogUniforms(P,a),Ae.refreshMaterialUniforms(P,r,ee,Q,D.state.transmissionRenderTarget[e.id]),ol.upload(Ve,pt(b),P,be)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(ol.upload(Ve,pt(b),P,be),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&A.setValue(Ve,"center",i.center),A.setValue(Ve,"modelViewMatrix",i.modelViewMatrix),A.setValue(Ve,"normalMatrix",i.normalMatrix),A.setValue(Ve,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];He.update(n,S),He.bind(n,S)}}return S}(e,t,n,r,i);ve.setMaterial(r,s);let c=n.index,u=1;if(!0===r.wireframe){if(c=Me.getWireframeAttribute(n),void 0===c)return;u=2}const d=n.drawRange,h=n.attributes.position;let p=d.start*u,m=(d.start+d.count)*u;null!==a&&(p=Math.max(p,a.start*u),m=Math.min(m,(a.start+a.count)*u)),null!==c?(p=Math.max(p,0),m=Math.min(m,c.count)):null!=h&&(p=Math.max(p,0),m=Math.min(m,h.count));const g=m-p;if(g<0||g===1/0)return;let v;je.setup(i,r,l,n,c);let x=ke;if(null!==c&&(v=Se.get(c),x=Fe,x.setIndex(v)),i.isMesh)!0===r.wireframe?(ve.setLineWidth(r.wireframeLinewidth*fe()),x.setMode(Ve.LINES)):x.setMode(Ve.TRIANGLES);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),ve.setLineWidth(e*fe()),i.isLineSegments?x.setMode(Ve.LINES):i.isLineLoop?x.setMode(Ve.LINE_LOOP):x.setMode(Ve.LINE_STRIP)}else i.isPoints?x.setMode(Ve.POINTS):i.isSprite&&x.setMode(Ve.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)qe("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),x.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if(me.get("WEBGL_multi_draw"))x.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else{const e=i._multiDrawStarts,t=i._multiDrawCounts,n=i._multiDrawCount,a=c?Se.get(c).bytesPerElement:1,o=xe.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)o.setValue(Ve,"_gl_DrawID",r),x.render(e[r]/a,t[r])}else if(i.isInstancedMesh)x.renderInstances(p,g,i.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);x.renderInstances(p,g,t)}else x.render(p,g)},this.compile=function(e,t,n=null){null===n&&(n=e),D=Pe.get(n),D.init(t),L.push(D),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(D.pushLight(e),e.castShadow&&D.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(D.pushLight(e),e.castShadow&&D.pushShadow(e))})),D.setupLights();const r=new Set;return e.traverse((function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];tt(a,n,e),r.add(a)}else tt(t,n,e),r.add(t)})),D=L.pop(),r},this.compileAsync=function(e,t,n=null){const r=this.compile(e,t,n);return new Promise((t=>{function n(){r.forEach((function(e){xe.get(e).currentProgram.isReady()&&r.delete(e)})),0!==r.size?setTimeout(n,10):t(e)}null!==me.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let nt=null;function rt(){at.stop()}function it(){at.start()}const at=new bo;function ot(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)D.pushLight(e),e.castShadow&&D.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||oe.intersectsSprite(e)){r&&de.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ce);const t=Ee.update(e),i=e.material;i.visible&&A.push(e,t,i,n,de.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||oe.intersectsObject(e))){const t=Ee.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),de.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),de.copy(t.boundingSphere.center)),de.applyMatrix4(e.matrixWorld).applyMatrix4(ce)),Array.isArray(i)){const r=t.groups;for(let a=0,o=r.length;a<o;a++){const o=r[a],s=i[o.materialIndex];s&&s.visible&&A.push(e,t,s,n,de.z,o)}}else i.visible&&A.push(e,t,i,n,de.z,null)}const i=e.children;for(let e=0,a=i.length;e<a;e++)ot(i[e],t,n,r)}function st(e,t,n,r){const{opaque:i,transmissive:a,transparent:o}=e;D.setupLightsView(n),!0===se&&De.setGlobalState(k.clippingPlanes,n),r&&ve.viewport(q.copy(r)),i.length>0&&ut(i,t,n),a.length>0&&ut(a,t,n),o.length>0&&ut(o,t,n),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function ct(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;if(void 0===D.state.transmissionRenderTarget[r.id]){const e=me.has("EXT_color_buffer_half_float")||me.has("EXT_color_buffer_float");D.state.transmissionRenderTarget[r.id]=new Pt(1,1,{generateMipmaps:!0,type:e?C:_,minFilter:b,samples:ge.samples,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:gt.workingColorSpace})}const i=D.state.transmissionRenderTarget[r.id],s=r.viewport||q;i.setSize(s.z*k.transmissionResolutionScale,s.w*k.transmissionResolutionScale);const l=k.getRenderTarget(),c=k.getActiveCubeFace(),u=k.getActiveMipmapLevel();k.setRenderTarget(i),k.getClearColor($),Z=k.getClearAlpha(),Z<1&&k.setClearColor(16777215,.5),k.clear(),pe&&Le.render(n);const d=k.toneMapping;k.toneMapping=o;const h=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),D.setupLightsView(r),!0===se&&De.setGlobalState(k.clippingPlanes,r),ut(e,n,r),be.updateMultisampleRenderTarget(i),be.updateRenderTargetMipmap(i),!1===me.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let i=0,a=t.length;i<a;i++){const a=t[i],{object:o,geometry:s,material:l,group:c}=a;if(2===l.side&&o.layers.test(r.layers)){const t=l.side;l.side=1,l.needsUpdate=!0,dt(o,n,r,s,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(be.updateMultisampleRenderTarget(i),be.updateRenderTargetMipmap(i))}k.setRenderTarget(l,c,u),k.setClearColor($,Z),void 0!==h&&(r.viewport=h),k.toneMapping=d}function ut(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],{object:o,geometry:s,group:l}=a;let c=a.material;!0===c.allowOverride&&null!==r&&(c=r),o.layers.test(n.layers)&&dt(o,t,n,s,c,l)}}function dt(e,t,n,r,i,a){e.onBeforeRender(k,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(k,t,n,r,e,a),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,k.renderBufferDirect(n,t,r,i,e,a),i.side=0,i.needsUpdate=!0,k.renderBufferDirect(n,t,r,i,e,a),i.side=2):k.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(k,t,n,r,i,a)}function ht(e,t,n){!0!==t.isScene&&(t=he);const r=xe.get(e),i=D.state.lights,a=D.state.shadowsArray,o=i.state.version,s=Te.getParameters(e,i.state,a,t,n),l=Te.getProgramCacheKey(s);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?we:_e).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",et),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===o)return ft(e,s),u}else s.uniforms=Te.getUniforms(e),e.onBeforeCompile(s,k),u=Te.acquireProgram(s,l),c.set(l,u),r.uniforms=s.uniforms;const d=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=De.uniform),ft(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.ltc_1.value=i.state.rectAreaLTC1,d.ltc_2.value=i.state.rectAreaLTC2,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotLightMatrix.value=i.state.spotLightMatrix,d.spotLightMap.value=i.state.spotLightMap,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=u,r.uniformsList=null,u}function pt(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=ol.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function ft(e,t){const n=xe.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}at.setAnimationLoop((function(e){nt&&nt(e)})),"undefined"!=typeof self&&at.setContext(self),this.setAnimationLoop=function(e){nt=e,$e.setAnimationLoop(e),null===e?at.stop():at.start()},$e.addEventListener("sessionstart",rt),$e.addEventListener("sessionend",it),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void Xe("WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===U)return;const n=!0===$e.enabled&&!0===$e.isPresenting,r=null!==N&&(null===G||n)&&N.begin(k,G);if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0!==$e.enabled||!0!==$e.isPresenting||null!==N&&!1!==N.isCompositing()||(!0===$e.cameraAutoUpdate&&$e.updateCamera(t),t=$e.getCamera()),!0===e.isScene&&e.onBeforeRender(k,e,t,G),D=Pe.get(e,L.length),D.init(t),L.push(D),ce.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),oe.setFromProjectionMatrix(ce,Ue,t.reversedDepth),le=this.localClippingEnabled,se=De.init(this.clippingPlanes,le),A=Ce.get(e,I.length),A.init(),I.push(A),!0===$e.enabled&&!0===$e.isPresenting){const e=k.xr.getDepthSensingMesh();null!==e&&ot(e,t,-1/0,k.sortObjects)}ot(e,t,0,k.sortObjects),A.finish(),!0===k.sortObjects&&A.sort(te,ne),pe=!1===$e.enabled||!1===$e.isPresenting||!1===$e.hasDepthSensing(),pe&&Le.addToRenderList(A,e),this.info.render.frame++,!0===se&&De.beginShadows();const i=D.state.shadowsArray;if(Ie.render(i,e,t),!0===se&&De.endShadows(),!0===this.info.autoReset&&this.info.reset(),!1===(r&&N.hasRenderPass())){const n=A.opaque,r=A.transmissive;if(D.setupLights(),t.isArrayCamera){const i=t.cameras;if(r.length>0)for(let t=0,a=i.length;t<a;t++)ct(n,r,e,i[t]);pe&&Le.render(e);for(let t=0,n=i.length;t<n;t++){const n=i[t];st(A,e,n,n.viewport)}}else r.length>0&&ct(n,r,e,t),pe&&Le.render(e),st(A,e,t)}null!==G&&0===z&&(be.updateMultisampleRenderTarget(G),be.updateRenderTargetMipmap(G)),r&&N.end(k),!0===e.isScene&&e.onAfterRender(k,e,t),je.resetDefaultState(),W=-1,X=null,L.pop(),L.length>0?(D=L[L.length-1],!0===se&&De.setGlobalState(k.clippingPlanes,D.state.camera)):D=null,I.pop(),A=I.length>0?I[I.length-1]:null},this.getActiveCubeFace=function(){return F},this.getActiveMipmapLevel=function(){return z},this.getRenderTarget=function(){return G},this.setRenderTargetTextures=function(e,t,n){const r=xe.get(e);r.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),xe.get(e.texture).__webglTexture=t,xe.get(e.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=xe.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const mt=Ve.createFramebuffer();this.setRenderTarget=function(e,t=0,n=0){G=e,F=t,z=n;let r=null,i=!1,a=!1;if(e){const o=xe.get(e);if(void 0!==o.__useDefaultFramebuffer)return ve.bindFramebuffer(Ve.FRAMEBUFFER,o.__webglFramebuffer),q.copy(e.viewport),Y.copy(e.scissor),K=e.scissorTest,ve.viewport(q),ve.scissor(Y),ve.setScissorTest(K),void(W=-1);if(void 0===o.__webglFramebuffer)be.setupRenderTarget(e);else if(o.__hasExternalTextures)be.rebindTextures(e,xe.get(e.texture).__webglTexture,xe.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(o.__boundDepthTexture!==t){if(null!==t&&xe.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");be.setupDepthRenderbuffer(e)}}const s=e.texture;(s.isData3DTexture||s.isDataArrayTexture||s.isCompressedArrayTexture)&&(a=!0);const l=xe.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(l[t])?l[t][n]:l[t],i=!0):r=e.samples>0&&!1===be.useMultisampledRTT(e)?xe.get(e).__webglMultisampledFramebuffer:Array.isArray(l)?l[n]:l,q.copy(e.viewport),Y.copy(e.scissor),K=e.scissorTest}else q.copy(re).multiplyScalar(ee).floor(),Y.copy(ie).multiplyScalar(ee).floor(),K=ae;if(0!==n&&(r=mt),ve.bindFramebuffer(Ve.FRAMEBUFFER,r)&&ve.drawBuffers(e,r),ve.viewport(q),ve.scissor(Y),ve.setScissorTest(K),i){const r=xe.get(e.texture);Ve.framebufferTexture2D(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Ve.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(a){const r=t;for(let t=0;t<e.textures.length;t++){const i=xe.get(e.textures[t]);Ve.framebufferTextureLayer(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0+t,i.__webglTexture,n,r)}}else if(null!==e&&0!==n){const t=xe.get(e.texture);Ve.framebufferTexture2D(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Ve.TEXTURE_2D,t.__webglTexture,n)}W=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o,s=0){if(!e||!e.isWebGLRenderTarget)return void Xe("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=xe.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(l=l[o]),l){ve.bindFramebuffer(Ve.FRAMEBUFFER,l);try{const o=e.textures[s],l=o.format,c=o.type;if(!ge.textureFormatReadable(l))return void Xe("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!ge.textureTypeReadable(c))return void Xe("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&(e.textures.length>1&&Ve.readBuffer(Ve.COLOR_ATTACHMENT0+s),Ve.readPixels(t,n,r,i,ze.convert(l),ze.convert(c),a))}finally{const e=null!==G?xe.get(G).__webglFramebuffer:null;ve.bindFramebuffer(Ve.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,r,i,a,o,s=0){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=xe.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(l=l[o]),l){if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i){ve.bindFramebuffer(Ve.FRAMEBUFFER,l);const o=e.textures[s],c=o.format,u=o.type;if(!ge.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ge.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const d=Ve.createBuffer();Ve.bindBuffer(Ve.PIXEL_PACK_BUFFER,d),Ve.bufferData(Ve.PIXEL_PACK_BUFFER,a.byteLength,Ve.STREAM_READ),e.textures.length>1&&Ve.readBuffer(Ve.COLOR_ATTACHMENT0+s),Ve.readPixels(t,n,r,i,ze.convert(c),ze.convert(u),0);const h=null!==G?xe.get(G).__webglFramebuffer:null;ve.bindFramebuffer(Ve.FRAMEBUFFER,h);const p=Ve.fenceSync(Ve.SYNC_GPU_COMMANDS_COMPLETE,0);return Ve.flush(),await function(e,t,n){return new Promise((function(n,r){setTimeout((function i(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(i,4);break;default:n()}}),4)}))}(Ve,p),Ve.bindBuffer(Ve.PIXEL_PACK_BUFFER,d),Ve.getBufferSubData(Ve.PIXEL_PACK_BUFFER,0,a),Ve.deleteBuffer(d),Ve.deleteSync(p),a}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t=null,n=0){const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),o=null!==t?t.x:0,s=null!==t?t.y:0;be.setTexture2D(e,0),Ve.copyTexSubImage2D(Ve.TEXTURE_2D,n,0,0,o,s,i,a),ve.unbindTexture()};const vt=Ve.createFramebuffer(),yt=Ve.createFramebuffer();this.copyTextureToTexture=function(e,t,n=null,r=null,i=0,a=null){let o,s,l,c,u,d,h,p,f;null===a&&(0!==i?(qe("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),a=i,i=0):a=0);const m=e.isCompressedTexture?e.mipmaps[a]:e.image;if(null!==n)o=n.max.x-n.min.x,s=n.max.y-n.min.y,l=n.isBox3?n.max.z-n.min.z:1,c=n.min.x,u=n.min.y,d=n.isBox3?n.min.z:0;else{const t=Math.pow(2,-i);o=Math.floor(m.width*t),s=Math.floor(m.height*t),l=e.isDataArrayTexture?m.depth:e.isData3DTexture?Math.floor(m.depth*t):1,c=0,u=0,d=0}null!==r?(h=r.x,p=r.y,f=r.z):(h=0,p=0,f=0);const g=ze.convert(t.format),v=ze.convert(t.type);let y;t.isData3DTexture?(be.setTexture3D(t,0),y=Ve.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(be.setTexture2DArray(t,0),y=Ve.TEXTURE_2D_ARRAY):(be.setTexture2D(t,0),y=Ve.TEXTURE_2D),Ve.pixelStorei(Ve.UNPACK_FLIP_Y_WEBGL,t.flipY),Ve.pixelStorei(Ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ve.pixelStorei(Ve.UNPACK_ALIGNMENT,t.unpackAlignment);const x=Ve.getParameter(Ve.UNPACK_ROW_LENGTH),b=Ve.getParameter(Ve.UNPACK_IMAGE_HEIGHT),_=Ve.getParameter(Ve.UNPACK_SKIP_PIXELS),w=Ve.getParameter(Ve.UNPACK_SKIP_ROWS),S=Ve.getParameter(Ve.UNPACK_SKIP_IMAGES);Ve.pixelStorei(Ve.UNPACK_ROW_LENGTH,m.width),Ve.pixelStorei(Ve.UNPACK_IMAGE_HEIGHT,m.height),Ve.pixelStorei(Ve.UNPACK_SKIP_PIXELS,c),Ve.pixelStorei(Ve.UNPACK_SKIP_ROWS,u),Ve.pixelStorei(Ve.UNPACK_SKIP_IMAGES,d);const M=e.isDataArrayTexture||e.isData3DTexture,E=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const n=xe.get(e),r=xe.get(t),m=xe.get(n.__renderTarget),g=xe.get(r.__renderTarget);ve.bindFramebuffer(Ve.READ_FRAMEBUFFER,m.__webglFramebuffer),ve.bindFramebuffer(Ve.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let n=0;n<l;n++)M&&(Ve.framebufferTextureLayer(Ve.READ_FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,xe.get(e).__webglTexture,i,d+n),Ve.framebufferTextureLayer(Ve.DRAW_FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,xe.get(t).__webglTexture,a,f+n)),Ve.blitFramebuffer(c,u,o,s,h,p,o,s,Ve.DEPTH_BUFFER_BIT,Ve.NEAREST);ve.bindFramebuffer(Ve.READ_FRAMEBUFFER,null),ve.bindFramebuffer(Ve.DRAW_FRAMEBUFFER,null)}else if(0!==i||e.isRenderTargetTexture||xe.has(e)){const n=xe.get(e),r=xe.get(t);ve.bindFramebuffer(Ve.READ_FRAMEBUFFER,vt),ve.bindFramebuffer(Ve.DRAW_FRAMEBUFFER,yt);for(let e=0;e<l;e++)M?Ve.framebufferTextureLayer(Ve.READ_FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,n.__webglTexture,i,d+e):Ve.framebufferTexture2D(Ve.READ_FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Ve.TEXTURE_2D,n.__webglTexture,i),E?Ve.framebufferTextureLayer(Ve.DRAW_FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,r.__webglTexture,a,f+e):Ve.framebufferTexture2D(Ve.DRAW_FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Ve.TEXTURE_2D,r.__webglTexture,a),0!==i?Ve.blitFramebuffer(c,u,o,s,h,p,o,s,Ve.COLOR_BUFFER_BIT,Ve.NEAREST):E?Ve.copyTexSubImage3D(y,a,h,p,f+e,c,u,o,s):Ve.copyTexSubImage2D(y,a,h,p,c,u,o,s);ve.bindFramebuffer(Ve.READ_FRAMEBUFFER,null),ve.bindFramebuffer(Ve.DRAW_FRAMEBUFFER,null)}else E?e.isDataTexture||e.isData3DTexture?Ve.texSubImage3D(y,a,h,p,f,o,s,l,g,v,m.data):t.isCompressedArrayTexture?Ve.compressedTexSubImage3D(y,a,h,p,f,o,s,l,g,m.data):Ve.texSubImage3D(y,a,h,p,f,o,s,l,g,v,m):e.isDataTexture?Ve.texSubImage2D(Ve.TEXTURE_2D,a,h,p,o,s,g,v,m.data):e.isCompressedTexture?Ve.compressedTexSubImage2D(Ve.TEXTURE_2D,a,h,p,m.width,m.height,g,m.data):Ve.texSubImage2D(Ve.TEXTURE_2D,a,h,p,o,s,g,v,m);Ve.pixelStorei(Ve.UNPACK_ROW_LENGTH,x),Ve.pixelStorei(Ve.UNPACK_IMAGE_HEIGHT,b),Ve.pixelStorei(Ve.UNPACK_SKIP_PIXELS,_),Ve.pixelStorei(Ve.UNPACK_SKIP_ROWS,w),Ve.pixelStorei(Ve.UNPACK_SKIP_IMAGES,S),0===a&&t.generateMipmaps&&Ve.generateMipmap(y),ve.unbindTexture()},this.initRenderTarget=function(e){void 0===xe.get(e).__webglFramebuffer&&be.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?be.setTextureCube(e,0):e.isData3DTexture?be.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?be.setTexture2DArray(e,0):be.setTexture2D(e,0),ve.unbindTexture()},this.resetState=function(){F=0,z=0,G=null,ve.reset(),je.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ue}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=gt._getDrawingBufferColorSpace(e),t.unpackColorSpace=gt._getUnpackColorSpace()}}function hc(e,t){if(0===t)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(2===t||1===t){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const r=n.count-2,i=[];if(2===t)for(let e=1;e<=r;e++)i.push(n.getX(0)),i.push(n.getX(e)),i.push(n.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(i.push(n.getX(e)),i.push(n.getX(e+1)),i.push(n.getX(e+2))):(i.push(n.getX(e+2)),i.push(n.getX(e+1)),i.push(n.getX(e)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=e.clone();return a.setIndex(i),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}class pc extends Da{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new xc(e)})),this.register((function(e){return new bc(e)})),this.register((function(e){return new Pc(e)})),this.register((function(e){return new Rc(e)})),this.register((function(e){return new Oc(e)})),this.register((function(e){return new wc(e)})),this.register((function(e){return new Sc(e)})),this.register((function(e){return new Mc(e)})),this.register((function(e){return new Ec(e)})),this.register((function(e){return new yc(e)})),this.register((function(e){return new Tc(e)})),this.register((function(e){return new _c(e)})),this.register((function(e){return new Cc(e)})),this.register((function(e){return new Ac(e)})),this.register((function(e){return new gc(e)})),this.register((function(e){return new Dc(e)})),this.register((function(e){return new Ic(e)}))}load(e,t,n,r){const i=this;let a;if(""!==this.resourcePath)a=this.resourcePath;else if(""!==this.path){const t=Qa.extractUrlBase(e);a=Qa.resolveURL(t,this.path)}else a=Qa.extractUrlBase(e);this.manager.itemStart(e);const o=function(t){r?r(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},s=new Na(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{i.parse(n,a,(function(n){t(n),i.manager.itemEnd(e)}),o)}catch(e){o(e)}}),n,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let i;const a={},o={},s=new TextDecoder;if("string"==typeof e)i=JSON.parse(e);else if(e instanceof ArrayBuffer)if(s.decode(new Uint8Array(e,0,4))===Lc){try{a[mc.KHR_BINARY_GLTF]=new Nc(e)}catch(e){return void(r&&r(e))}i=JSON.parse(a[mc.KHR_BINARY_GLTF].content)}else i=JSON.parse(s.decode(e));else i=e;if(void 0===i.asset||i.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new ru(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](l);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[t.name]=t,a[t.name]=!0}if(i.extensionsUsed)for(let e=0;e<i.extensionsUsed.length;++e){const t=i.extensionsUsed[e],n=i.extensionsRequired||[];switch(t){case mc.KHR_MATERIALS_UNLIT:a[t]=new vc;break;case mc.KHR_DRACO_MESH_COMPRESSION:a[t]=new kc(i,this.dracoLoader);break;case mc.KHR_TEXTURE_TRANSFORM:a[t]=new Uc;break;case mc.KHR_MESH_QUANTIZATION:a[t]=new Fc;break;default:n.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(a),l.setPlugins(o),l.parse(n,r)}parseAsync(e,t){const n=this;return new Promise((function(r,i){n.parse(e,t,r,i)}))}}function fc(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const mc={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class gc{constructor(e){this.parser=e,this.name=mc.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const i=t.json,a=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let o;const s=new Jn(16777215);void 0!==a.color&&s.setRGB(a.color[0],a.color[1],a.color[2],Oe);const l=void 0!==a.range?a.range:0;switch(a.type){case"directional":o=new Za(s),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new Ya(s),o.distance=l;break;case"spot":o=new Xa(s),o.distance=l,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,o.angle=a.spot.outerConeAngle,o.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return o.position.set(0,0,0),Zc(o,a),void 0!==a.intensity&&(o.intensity=a.intensity),o.name=t.createUniqueName(a.name||"light_"+e),r=Promise.resolve(o),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return n._getNodeRef(t.cache,i,e)}))}}class vc{constructor(){this.name=mc.KHR_MATERIALS_UNLIT}getMaterialType(){return nr}extendParams(e,t,n){const r=[];e.color=new Jn(1,1,1),e.opacity=1;const i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const t=i.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],Oe),e.opacity=t[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture,Re))}return Promise.all(r)}}class yc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class xc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ot(e,e)}return Promise.all(i)}}class bc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.dispersion=void 0!==r.dispersion?r.dispersion:0,Promise.resolve()}}class _c{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&i.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&i.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(i)}}class wc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[];t.sheenColor=new Jn(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=r.extensions[this.name];if(void 0!==a.sheenColorFactor){const e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],Oe)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,Re)),void 0!==a.sheenRoughnessTexture&&i.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}class Sc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)}}class Mc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=(new Jn).setRGB(o[0],o[1],o[2],Oe),Promise.all(i)}}class Ec{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class Tc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=(new Jn).setRGB(o[0],o[1],o[2],Oe),void 0!==a.specularColorTexture&&i.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,Re)),Promise.all(i)}}class Ac{constructor(e){this.parser=e,this.name=mc.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return t.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&i.push(n.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(i)}}class Cc{constructor(e){this.parser=e,this.name=mc.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?oa:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&i.push(n.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(i)}}class Pc{constructor(e){this.parser=e,this.name=mc.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const i=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i.source,a)}}class Rc{constructor(e){this.parser=e,this.name=mc.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const a=i.extensions[t],o=r.images[a.source];let s=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(s=e)}return n.loadTextureImage(e,a.source,s)}}class Oc{constructor(e){this.parser=e,this.name=mc.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const a=i.extensions[t],o=r.images[a.source];let s=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(s=e)}return n.loadTextureImage(e,a.source,s)}}class Dc{constructor(e){this.name=mc.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then((function(t){const n=e.byteOffset||0,r=e.byteLength||0,a=e.count,o=e.byteStride,s=new Uint8Array(t,n,r);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(a,o,s,e.mode,e.filter).then((function(e){return e.buffer})):i.ready.then((function(){const t=new ArrayBuffer(a*o);return i.decodeGltfBuffer(new Uint8Array(t),a,o,s,e.mode,e.filter),t}))}))}return null}}class Ic{constructor(e){this.name=mc.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const e of r.primitives)if(e.mode!==Hc.TRIANGLES&&e.mode!==Hc.TRIANGLE_STRIP&&e.mode!==Hc.TRIANGLE_FAN&&void 0!==e.mode)return null;const i=n.extensions[this.name].attributes,a=[],o={};for(const e in i)a.push(this.parser.getDependency("accessor",i[e]).then((t=>(o[e]=t,o[e]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then((e=>{const t=e.pop(),n=t.isGroup?t.children:[t],r=e[0].count,i=[];for(const e of n){const t=new on,n=new lt,a=new st,s=new lt(1,1,1),l=new wi(e.geometry,e.material,r);for(let e=0;e<r;e++)o.TRANSLATION&&n.fromBufferAttribute(o.TRANSLATION,e),o.ROTATION&&a.fromBufferAttribute(o.ROTATION,e),o.SCALE&&s.fromBufferAttribute(o.SCALE,e),l.setMatrixAt(e,t.compose(n,a,s));for(const t in o)if("_COLOR_0"===t){const e=o[t];l.instanceColor=new fi(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,o[t]);In.prototype.copy.call(l,e),this.parser.assignFinalMaterial(l),i.push(l)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]})))}}const Lc="glTF";class Nc{constructor(e){this.name=mc.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Lc)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,i=new DataView(e,12);let a=0;for(;a<r;){const t=i.getUint32(a,!0);a+=4;const r=i.getUint32(a,!0);if(a+=4,1313821514===r){const r=new Uint8Array(e,12+a,t);this.content=n.decode(r)}else if(5130562===r){const n=12+a;this.body=e.slice(n,n+t)}a+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class kc{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=mc.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},l={};for(const e in a){const t=qc[e]||e.toLowerCase();o[t]=a[e]}for(const t in e.attributes){const r=qc[t]||t.toLowerCase();if(void 0!==a[t]){const i=n.accessors[e.attributes[t]],a=Vc[i.componentType];l[r]=a.name,s[r]=!0===i.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t,n){r.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],r=s[t];void 0!==r&&(n.normalized=r)}t(e)}),o,l,Oe,n)}))}))}}class Uc{constructor(){this.name=mc.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class Fc{constructor(){this.name=mc.KHR_MESH_QUANTIZATION}}class zc extends ma{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r;for(let e=0;e!==r;e++)t[e]=n[i+e];return t}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,c=r-t,u=(n-t)/c,d=u*u,h=d*u,p=e*l,f=p-l,m=-2*h+3*d,g=h-d,v=1-m,y=g-d+u;for(let e=0;e!==o;e++){const t=a[f+e+o],n=a[f+e+s]*c,r=a[p+e+o],l=a[p+e]*c;i[e]=v*t+y*n+m*r+g*l}return i}}const jc=new st;class Bc extends zc{interpolate_(e,t,n,r){const i=super.interpolate_(e,t,n,r);return jc.fromArray(i).normalize().toArray(i),i}}const Hc={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Vc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Gc={9728:g,9729:y,9984:1004,9985:x,9986:v,9987:b},Wc={33071:f,33648:m,10497:p},Xc={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},qc={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Yc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Kc={CUBICSPLINE:void 0,LINEAR:Ae,STEP:Te};function $c(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function Zc(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function Jc(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Qc(e){let t;const n=e.extensions&&e.extensions[mc.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+eu(n.attributes):e.indices+":"+eu(e.attributes)+":"+e.mode,void 0!==e.targets)for(let n=0,r=e.targets.length;n<r;n++)t+=":"+eu(e.targets[n]);return t}function eu(e){let t="";const n=Object.keys(e).sort();for(let r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function tu(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const nu=new on;class ru{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new fc,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,i=!1,a=-1;if("undefined"!=typeof navigator){const e=navigator.userAgent;n=!0===/^((?!chrome|android).)*safari/i.test(e);const t=e.match(/Version\/(\d+)/);r=n&&t?parseInt(t[1],10):-1,i=e.indexOf("Firefox")>-1,a=i?e.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||n&&r<17||i&&a<98?this.textureLoader=new Fa(this.options.manager):this.textureLoader=new to(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Na(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};return $c(i,a,r),Zc(a,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){for(const e of a.scenes)e.updateMatrixWorld();e(a)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n].joints;for(let t=0,n=r.length;t<n;t++)e[r[t]].isBone=!0}for(let t=0,r=e.length;t<r;t++){const r=e[t];void 0!==r.mesh&&(this._addNodeRef(this.meshCache,r.mesh),void 0!==r.skin&&(n[r.mesh].isSkinnedMesh=!0)),void 0!==r.camera&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),i=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[n,r]of e.children.entries())i(r,t.children[n])};return i(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const i=e(t[r]);i&&n.push(i)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[mc.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(e,i){n.load(Qa.resolveURL(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const e=Xc[r.type],t=Vc[r.componentType],n=!0===r.normalized,i=new t(r.count*e);return Promise.resolve(new or(i,e,n))}const i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(e){const i=e[0],a=Xc[r.type],o=Vc[r.componentType],s=o.BYTES_PER_ELEMENT,l=s*a,c=r.byteOffset||0,u=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,d=!0===r.normalized;let h,p;if(u&&u!==l){const e=Math.floor(c/u),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+e+":"+r.count;let l=t.cache.get(n);l||(h=new o(i,e*u,r.count*u/s),l=new $r(h,u/s),t.cache.add(n,l)),p=new Jr(l,a,c%u/s,d)}else h=null===i?new o(r.count*a):new o(i,c,r.count*a),p=new or(h,a,d);if(void 0!==r.sparse){const t=Xc.SCALAR,n=Vc[r.sparse.indices.componentType],s=r.sparse.indices.byteOffset||0,l=r.sparse.values.byteOffset||0,c=new n(e[1],s,r.sparse.count*t),u=new o(e[2],l,r.sparse.count*a);null!==i&&(p=new or(p.array.slice(),p.itemSize,p.normalized)),p.normalized=!1;for(let e=0,t=c.length;e<t;e++){const t=c[e];if(p.setX(t,u[e*a]),a>=2&&p.setY(t,u[e*a+1]),a>=3&&p.setZ(t,u[e*a+2]),a>=4&&p.setW(t,u[e*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}p.normalized=d}return p}))}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,i=t.images[r];let a=this.textureLoader;if(i.uri){const e=n.manager.getHandler(i.uri);null!==e&&(a=e)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,t,n){const r=this,i=this.json,a=i.textures[e],o=i.images[t],s=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[s])return this.textureCache[s];const l=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);const n=(i.samplers||{})[a.sampler]||{};return t.magFilter=Gc[n.magFilter]||y,t.minFilter=Gc[n.minFilter]||b,t.wrapS=Wc[n.wrapS]||p,t.wrapT=Wc[n.wrapT]||p,t.generateMipmaps=!t.isCompressedTexture&&t.minFilter!==g&&t.minFilter!==y,r.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[s]=l,l}loadImageSource(e,t){const n=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const i=n.images[e],a=self.URL||self.webkitURL;let o=i.uri||"",s=!1;if(void 0!==i.bufferView)o=this.getDependency("bufferView",i.bufferView).then((function(e){s=!0;const t=new Blob([e],{type:i.mimeType});return o=a.createObjectURL(t),o}));else if(void 0===i.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const l=Promise.resolve(o).then((function(e){return new Promise((function(n,i){let a=n;!0===t.isImageBitmapLoader&&(a=function(e){const t=new Tt(e);t.needsUpdate=!0,n(t)}),t.load(Qa.resolveURL(e,r.path),a,void 0,i)}))})).then((function(e){var t;return!0===s&&a.revokeObjectURL(o),Zc(e,i),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":t.search(/\.ktx2($|\?)/i)>0||0===t.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e}));return this.sourceCache[e]=l,l}assignTexture(e,t,n,r){const i=this;return this.getDependency("texture",n.index).then((function(a){if(!a)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((a=a.clone()).channel=n.texCoord),i.extensions[mc.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[mc.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=i.associations.get(a);a=i.extensions[mc.KHR_TEXTURE_TRANSFORM].extendTexture(a,e),i.associations.set(a,t)}}return void 0!==r&&(a.colorSpace=r),e[t]=a,a}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new Wi,tr.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new Oi,tr.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(r||i||a){let e="ClonedMaterial:"+n.uuid+":";r&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),i&&(t.vertexColors=!0),a&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return aa}loadMaterial(e){const t=this,n=this.json,r=this.extensions,i=n.materials[e];let a;const o={},s=[];if((i.extensions||{})[mc.KHR_MATERIALS_UNLIT]){const e=r[mc.KHR_MATERIALS_UNLIT];a=e.getMaterialType(),s.push(e.extendParams(o,i,t))}else{const n=i.pbrMetallicRoughness||{};if(o.color=new Jn(1,1,1),o.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],Oe),o.opacity=e[3]}void 0!==n.baseColorTexture&&s.push(t.assignTexture(o,"map",n.baseColorTexture,Re)),o.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,o.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(s.push(t.assignTexture(o,"metalnessMap",n.metallicRoughnessTexture)),s.push(t.assignTexture(o,"roughnessMap",n.metallicRoughnessTexture))),a=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),s.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===i.doubleSided&&(o.side=2);const l=i.alphaMode||"OPAQUE";if("BLEND"===l?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,"MASK"===l&&(o.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&a!==nr&&(s.push(t.assignTexture(o,"normalMap",i.normalTexture)),o.normalScale=new ot(1,1),void 0!==i.normalTexture.scale)){const e=i.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==i.occlusionTexture&&a!==nr&&(s.push(t.assignTexture(o,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(o.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&a!==nr){const e=i.emissiveFactor;o.emissive=(new Jn).setRGB(e[0],e[1],e[2],Oe)}return void 0!==i.emissiveTexture&&a!==nr&&s.push(t.assignTexture(o,"emissiveMap",i.emissiveTexture,Re)),Promise.all(s).then((function(){const n=new a(o);return i.name&&(n.name=i.name),Zc(n,i),t.associations.set(n,{materials:e}),i.extensions&&$c(r,n,i),n}))}createUniqueName(e){const t=co.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function i(e){return n[mc.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return iu(n,e,t)}))}const a=[];for(let n=0,o=e.length;n<o;n++){const o=e[n],s=Qc(o),l=r[s];if(l)a.push(l.promise);else{let e;e=o.extensions&&o.extensions[mc.KHR_DRACO_MESH_COMPRESSION]?i(o):iu(new vr,o,t),r[s]={primitive:o,promise:e},a.push(e)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.json,r=this.extensions,i=n.meshes[e],a=i.primitives,o=[];for(let e=0,t=a.length;e<t;e++){const t=void 0===a[e].material?(void 0===(s=this.cache).DefaultMaterial&&(s.DefaultMaterial=new aa({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),s.DefaultMaterial):this.getDependency("material",a[e].material);o.push(t)}var s;return o.push(t.loadGeometries(a)),Promise.all(o).then((function(n){const o=n.slice(0,n.length-1),s=n[n.length-1],l=[];for(let n=0,c=s.length;n<c;n++){const c=s[n],u=a[n];let d;const h=o[n];if(u.mode===Hc.TRIANGLES||u.mode===Hc.TRIANGLE_STRIP||u.mode===Hc.TRIANGLE_FAN||void 0===u.mode)d=!0===i.isSkinnedMesh?new li(c,h):new Pr(c,h),!0===d.isSkinnedMesh&&d.normalizeSkinWeights(),u.mode===Hc.TRIANGLE_STRIP?d.geometry=hc(d.geometry,1):u.mode===Hc.TRIANGLE_FAN&&(d.geometry=hc(d.geometry,2));else if(u.mode===Hc.LINES)d=new Vi(c,h);else if(u.mode===Hc.LINE_STRIP)d=new zi(c,h);else if(u.mode===Hc.LINE_LOOP)d=new Gi(c,h);else{if(u.mode!==Hc.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);d=new $i(c,h)}Object.keys(d.geometry.morphAttributes).length>0&&Jc(d,i),d.name=t.createUniqueName(i.name||"mesh_"+e),Zc(d,i),u.extensions&&$c(r,d,u),t.assignFinalMaterial(d),l.push(d)}for(let n=0,r=l.length;n<r;n++)t.associations.set(l[n],{meshes:e,primitives:n});if(1===l.length)return i.extensions&&$c(r,l[0],i),l[0];const c=new Xr;i.extensions&&$c(r,c,i),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c}))}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new Br(at(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new Ka(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Zc(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let e=0,r=t.joints.length;e<r;e++)n.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){const n=e.pop(),r=e,i=[],a=[];for(let e=0,o=r.length;e<o;e++){const o=r[e];if(o){i.push(o);const t=new on;null!==n&&t.fromArray(n.array,16*e),a.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[e])}return new pi(i,a)}))}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],i=r.name?r.name:"animation_"+e,a=[],o=[],s=[],l=[],c=[];for(let e=0,t=r.channels.length;e<t;e++){const t=r.channels[e],n=r.samplers[t.sampler],i=t.target,u=i.node,d=void 0!==r.parameters?r.parameters[n.input]:n.input,h=void 0!==r.parameters?r.parameters[n.output]:n.output;void 0!==i.node&&(a.push(this.getDependency("node",u)),o.push(this.getDependency("accessor",d)),s.push(this.getDependency("accessor",h)),l.push(n),c.push(i))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(s),Promise.all(l),Promise.all(c)]).then((function(e){const t=e[0],a=e[1],o=e[2],s=e[3],l=e[4],c=[];for(let e=0,r=t.length;e<r;e++){const r=t[e],i=a[e],u=o[e],d=s[e],h=l[e];if(void 0===r)continue;r.updateMatrix&&r.updateMatrix();const p=n._createAnimationTracks(r,i,u,d,h);if(p)for(let e=0;e<p.length;e++)c.push(p[e])}const u=new Aa(i,void 0,c);return Zc(u,r),u}))}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),i=[],a=n.children||[];for(let e=0,n=a.length;e<n;e++)i.push(t.getDependency("node",a[e]));const o=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(i),o]).then((function(e){const t=e[0],n=e[1],r=e[2];null!==r&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(r,nu)}));for(let e=0,r=n.length;e<r;e++)t.add(n[e]);return t}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const i=t.nodes[e],a=i.name?r.createUniqueName(i.name):"",o=[],s=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return s&&o.push(s),void 0!==i.camera&&o.push(r.getDependency("camera",i.camera).then((function(e){return r._getNodeRef(r.cameraCache,i.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){o.push(e)})),this.nodeCache[e]=Promise.all(o).then((function(t){let o;if(o=!0===i.isBone?new ci:t.length>1?new Xr:1===t.length?t[0]:new In,o!==t[0])for(let e=0,n=t.length;e<n;e++)o.add(t[e]);if(i.name&&(o.userData.name=i.name,o.name=a),Zc(o,i),i.extensions&&$c(n,o,i),void 0!==i.matrix){const e=new on;e.fromArray(i.matrix),o.applyMatrix4(e)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);if(r.associations.has(o)){if(void 0!==i.mesh&&r.meshCache.refs[i.mesh]>1){const e=r.associations.get(o);r.associations.set(o,{...e})}}else r.associations.set(o,{});return r.associations.get(o).nodes=e,o})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,i=new Xr;n.name&&(i.name=r.createUniqueName(n.name)),Zc(i,n),n.extensions&&$c(t,i,n);const a=n.nodes||[],o=[];for(let e=0,t=a.length;e<t;e++)o.push(r.getDependency("node",a[e]));return Promise.all(o).then((function(e){for(let t=0,n=e.length;t<n;t++)i.add(e[t]);return r.associations=(e=>{const t=new Map;for(const[e,n]of r.associations)(e instanceof tr||e instanceof Tt)&&t.set(e,n);return e.traverse((e=>{const n=r.associations.get(e);null!=n&&t.set(e,n)})),t})(i),i}))}_createAnimationTracks(e,t,n,r,i){const a=[],o=e.name?e.name:e.uuid,s=[];let l;switch(Yc[i.path]===Yc.weights?e.traverse((function(e){e.morphTargetInfluences&&s.push(e.name?e.name:e.uuid)})):s.push(o),Yc[i.path]){case Yc.weights:l=wa;break;case Yc.rotation:l=Ma;break;case Yc.translation:case Yc.scale:l=Ta;break;default:l=1===n.itemSize?wa:Ta}const c=void 0!==r.interpolation?Kc[r.interpolation]:Ae,u=this._getArrayFromAccessor(n);for(let e=0,n=s.length;e<n;e++){const n=new l(s[e]+"."+Yc[i.path],t.array,u,c);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(n),a.push(n)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=tu(t.constructor),n=new Float32Array(t.length);for(let r=0,i=t.length;r<i;r++)n[r]=t[r]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof Ma?Bc:zc)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function iu(e,t,n){const r=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(const t in r){const n=qc[t]||t.toLowerCase();n in e.attributes||i.push(a(r[t],n))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(r)}return gt.workingColorSpace!==Oe&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${gt.workingColorSpace}" not supported.`),Zc(e,t),function(e,t,n){const r=t.attributes,i=new Dt;if(void 0===r.POSITION)return;{const e=n.json.accessors[r.POSITION],t=e.min,a=e.max;if(void 0===t||void 0===a)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new lt(t[0],t[1],t[2]),new lt(a[0],a[1],a[2])),e.normalized){const t=tu(Vc[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}const a=t.targets;if(void 0!==a){const e=new lt,t=new lt;for(let r=0,i=a.length;r<i;r++){const i=a[r];if(void 0!==i.POSITION){const r=n.json.accessors[i.POSITION],a=r.min,o=r.max;if(void 0!==a&&void 0!==o){if(t.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),r.normalized){const e=tu(Vc[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;const o=new $t;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=o}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){let r=!1,i=!1,a=!1;for(let e=0,n=t.length;e<n;e++){const n=t[e];if(void 0!==n.POSITION&&(r=!0),void 0!==n.NORMAL&&(i=!0),void 0!==n.COLOR_0&&(a=!0),r&&i&&a)break}if(!r&&!i&&!a)return Promise.resolve(e);const o=[],s=[],l=[];for(let c=0,u=t.length;c<u;c++){const u=t[c];if(r){const t=void 0!==u.POSITION?n.getDependency("accessor",u.POSITION):e.attributes.position;o.push(t)}if(i){const t=void 0!==u.NORMAL?n.getDependency("accessor",u.NORMAL):e.attributes.normal;s.push(t)}if(a){const t=void 0!==u.COLOR_0?n.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(s),Promise.all(l)]).then((function(t){const n=t[0],o=t[1],s=t[2];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=o),a&&(e.morphAttributes.color=s),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}const au={type:"change"},ou={type:"start"},su={type:"end"},lu=new an,cu=new Ti,uu=Math.cos(70*it),du=new lt,hu=2*Math.PI,pu=-1,fu=1e-6;class mu extends yo{constructor(e,t=null){super(e,t),this.state=pu,this.target=new lt,this.cursor=new lt,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new lt,this._lastQuaternion=new st,this._lastTargetPosition=new lt,this._quat=(new st).setFromUnitVectors(e.up,new lt(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new mo,this._sphericalDelta=new mo,this._scale=1,this._panOffset=new lt,this._rotateStart=new ot,this._rotateEnd=new ot,this._rotateDelta=new ot,this._panStart=new ot,this._panEnd=new ot,this._panDelta=new ot,this._dollyStart=new ot,this._dollyEnd=new ot,this._dollyDelta=new ot,this._dollyDirection=new lt,this._mouse=new ot,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=vu.bind(this),this._onPointerDown=gu.bind(this),this._onPointerUp=yu.bind(this),this._onContextMenu=Eu.bind(this),this._onMouseWheel=_u.bind(this),this._onKeyDown=wu.bind(this),this._onTouchStart=Su.bind(this),this._onTouchMove=Mu.bind(this),this._onMouseDown=xu.bind(this),this._onMouseMove=bu.bind(this),this._interceptControlDown=Tu.bind(this),this._interceptControlUp=Au.bind(this),null!==this.domElement&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(au),this.update(),this.state=pu}update(e=null){const t=this.object.position;du.copy(t).sub(this.target),du.applyQuaternion(this._quat),this._spherical.setFromVector3(du),this.autoRotate&&this.state===pu&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=hu:n>Math.PI&&(n-=hu),r<-Math.PI?r+=hu:r>Math.PI&&(r-=hu),this._spherical.theta=n<=r?Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const e=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=e!=this._spherical.radius}if(du.setFromSpherical(this._spherical),du.applyQuaternion(this._quatInverse),t.copy(this.target).add(du),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let e=null;if(this.object.isPerspectiveCamera){const t=du.length();e=this._clampDistance(t*this._scale);const n=t-e;this.object.position.addScaledVector(this._dollyDirection,n),this.object.updateMatrixWorld(),i=!!n}else if(this.object.isOrthographicCamera){const t=new lt(this._mouse.x,this._mouse.y,0);t.unproject(this.object);const n=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=n!==this.object.zoom;const r=new lt(this._mouse.x,this._mouse.y,0);r.unproject(this.object),this.object.position.sub(r).add(t),this.object.updateMatrixWorld(),e=du.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==e&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(e).add(this.object.position):(lu.origin.copy(this.object.position),lu.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(lu.direction))<uu?this.object.lookAt(this.target):(cu.setFromNormalAndCoplanarPoint(this.object.up,this.target),lu.intersectPlane(cu,this.target))))}else if(this.object.isOrthographicCamera){const e=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),e!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,!!(i||this._lastPosition.distanceToSquared(this.object.position)>fu||8*(1-this._lastQuaternion.dot(this.object.quaternion))>fu||this._lastTargetPosition.distanceToSquared(this.target)>fu)&&(this.dispatchEvent(au),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?hu/60*this.autoRotateSpeed*e:hu/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){du.setFromMatrixColumn(t,0),du.multiplyScalar(-e),this._panOffset.add(du)}_panUp(e,t){!0===this.screenSpacePanning?du.setFromMatrixColumn(t,1):(du.setFromMatrixColumn(t,0),du.crossVectors(this.object.up,du)),du.multiplyScalar(e),this._panOffset.add(du)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;du.copy(r).sub(this.target);let i=du.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/n.clientHeight,this.object.matrix),this._panUp(2*t*i/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,i=t-n.top,a=n.width,o=n.height;this._mouse.x=r/a*2-1,this._mouse.y=-i/o*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(hu*this._rotateDelta.x/t.clientHeight),this._rotateUp(hu*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(hu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-hu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(hu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-hu*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateEnd.set(n,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(hu*this._rotateDelta.x/t.clientHeight),this._rotateUp(hu*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);this._updateZoomParameters(a,o)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new ot,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function gu(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),this._isTrackingPointer(e)||(this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e)))}function vu(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function yu(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(su),this.state=pu;break;case 1:const t=this._pointers[0],n=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:n.x,pageY:n.y})}}function xu(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case 1:if(!1===this.enableZoom)return;this._handleMouseDownDolly(e),this.state=1;break;case 0:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=2}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=0}break;case 2:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=0}else{if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=2}break;default:this.state=pu}this.state!==pu&&this.dispatchEvent(ou)}function bu(e){switch(this.state){case 0:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(e);break;case 1:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(e);break;case 2:if(!1===this.enablePan)return;this._handleMouseMovePan(e)}}function _u(e){!1!==this.enabled&&!1!==this.enableZoom&&this.state===pu&&(e.preventDefault(),this.dispatchEvent(ou),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(su))}function wu(e){!1!==this.enabled&&this._handleKeyDown(e)}function Su(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case 0:if(!1===this.enableRotate)return;this._handleTouchStartRotate(e),this.state=3;break;case 1:if(!1===this.enablePan)return;this._handleTouchStartPan(e),this.state=4;break;default:this.state=pu}break;case 2:switch(this.touches.TWO){case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(e),this.state=5;break;case 3:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(e),this.state=6;break;default:this.state=pu}break;default:this.state=pu}this.state!==pu&&this.dispatchEvent(ou)}function Mu(e){switch(this._trackPointer(e),this.state){case 3:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(e),this.update();break;case 4:if(!1===this.enablePan)return;this._handleTouchMovePan(e),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(e),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=pu}}function Eu(e){!1!==this.enabled&&e.preventDefault()}function Tu(e){"Control"===e.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Au(e){"Control"===e.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Cu(e,t){return function(){return e.apply(t,arguments)}}const{toString:Pu}=Object.prototype,{getPrototypeOf:Ru}=Object,{iterator:Ou,toStringTag:Du}=Symbol,Iu=(Lu=Object.create(null),e=>{const t=Pu.call(e);return Lu[t]||(Lu[t]=t.slice(8,-1).toLowerCase())});var Lu;const Nu=e=>(e=e.toLowerCase(),t=>Iu(t)===e),ku=e=>t=>typeof t===e,{isArray:Uu}=Array,Fu=ku("undefined");function zu(e){return null!==e&&!Fu(e)&&null!==e.constructor&&!Fu(e.constructor)&&Hu(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ju=Nu("ArrayBuffer"),Bu=ku("string"),Hu=ku("function"),Vu=ku("number"),Gu=e=>null!==e&&"object"==typeof e,Wu=e=>{if("object"!==Iu(e))return!1;const t=Ru(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Du in e||Ou in e)},Xu=Nu("Date"),qu=Nu("File"),Yu=Nu("Blob"),Ku=Nu("FileList"),$u=Nu("URLSearchParams"),[Zu,Ju,Qu,ed]=["ReadableStream","Request","Response","Headers"].map(Nu);function td(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,i;if("object"!=typeof e&&(e=[e]),Uu(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{if(zu(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),a=i.length;let o;for(r=0;r<a;r++)o=i[r],t.call(null,e[o],o,e)}}function nd(e,t){if(zu(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const rd="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,id=e=>!Fu(e)&&e!==rd,ad=(od="undefined"!=typeof Uint8Array&&Ru(Uint8Array),e=>od&&e instanceof od);var od;const sd=Nu("HTMLFormElement"),ld=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),cd=Nu("RegExp"),ud=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};td(n,((n,i)=>{let a;!1!==(a=t(n,i,e))&&(r[i]=a||n)})),Object.defineProperties(e,r)},dd=Nu("AsyncFunction"),hd=(pd="function"==typeof setImmediate,fd=Hu(rd.postMessage),pd?setImmediate:fd?(md=`axios@${Math.random()}`,gd=[],rd.addEventListener("message",(({source:e,data:t})=>{e===rd&&t===md&&gd.length&&gd.shift()()}),!1),e=>{gd.push(e),rd.postMessage(md,"*")}):e=>setTimeout(e));var pd,fd,md,gd;const vd="undefined"!=typeof queueMicrotask?queueMicrotask.bind(rd):"undefined"!=typeof process&&process.nextTick||hd,yd={isArray:Uu,isArrayBuffer:ju,isBuffer:zu,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Hu(e.append)&&("formdata"===(t=Iu(e))||"object"===t&&Hu(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&ju(e.buffer),t},isString:Bu,isNumber:Vu,isBoolean:e=>!0===e||!1===e,isObject:Gu,isPlainObject:Wu,isEmptyObject:e=>{if(!Gu(e)||zu(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(e){return!1}},isReadableStream:Zu,isRequest:Ju,isResponse:Qu,isHeaders:ed,isUndefined:Fu,isDate:Xu,isFile:qu,isBlob:Yu,isRegExp:cd,isFunction:Hu,isStream:e=>Gu(e)&&Hu(e.pipe),isURLSearchParams:$u,isTypedArray:ad,isFileList:Ku,forEach:td,merge:function e(){const{caseless:t,skipUndefined:n}=id(this)&&this||{},r={},i=(i,a)=>{const o=t&&nd(r,a)||a;Wu(r[o])&&Wu(i)?r[o]=e(r[o],i):Wu(i)?r[o]=e({},i):Uu(i)?r[o]=i.slice():n&&Fu(i)||(r[o]=i)};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&td(arguments[e],i);return r},extend:(e,t,n,{allOwnKeys:r}={})=>(td(t,((t,r)=>{n&&Hu(t)?Object.defineProperty(e,r,{value:Cu(t,n),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,r,{value:t,writable:!0,enumerable:!0,configurable:!0})}),{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,a,o;const s={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)o=i[a],r&&!r(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==n&&Ru(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Iu,kindOfTest:Nu,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(Uu(e))return e;let t=e.length;if(!Vu(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Ou]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:sd,hasOwnProperty:ld,hasOwnProp:ld,reduceDescriptors:ud,freezeMethods:e=>{ud(e,((t,n)=>{if(Hu(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Hu(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return Uu(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:nd,global:rd,isContextDefined:id,isSpecCompliantForm:function(e){return!!(e&&Hu(e.append)&&"FormData"===e[Du]&&e[Ou])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Gu(e)){if(t.indexOf(e)>=0)return;if(zu(e))return e;if(!("toJSON"in e)){t[r]=e;const i=Uu(e)?[]:{};return td(e,((e,t)=>{const a=n(e,r+1);!Fu(a)&&(i[t]=a)})),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:dd,isThenable:e=>e&&(Gu(e)||Hu(e))&&Hu(e.then)&&Hu(e.catch),setImmediate:hd,asap:vd,isIterable:e=>null!=e&&Hu(e[Ou])};class xd extends Error{static from(e,t,n,r,i,a){const o=new xd(e.message,t||e.code,n,r,i);return o.cause=e,o.name=e.name,a&&Object.assign(o,a),o}constructor(e,t,n,r,i){super(e),this.name="AxiosError",this.isAxiosError=!0,t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:yd.toJSONObject(this.config),code:this.code,status:this.status}}}xd.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE",xd.ERR_BAD_OPTION="ERR_BAD_OPTION",xd.ECONNABORTED="ECONNABORTED",xd.ETIMEDOUT="ETIMEDOUT",xd.ERR_NETWORK="ERR_NETWORK",xd.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS",xd.ERR_DEPRECATED="ERR_DEPRECATED",xd.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE",xd.ERR_BAD_REQUEST="ERR_BAD_REQUEST",xd.ERR_CANCELED="ERR_CANCELED",xd.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT",xd.ERR_INVALID_URL="ERR_INVALID_URL";const bd=xd;function _d(e){return yd.isPlainObject(e)||yd.isArray(e)}function wd(e){return yd.endsWith(e,"[]")?e.slice(0,-2):e}function Sd(e,t,n){return e?e.concat(t).map((function(e,t){return e=wd(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const Md=yd.toFlatObject(yd,{},null,(function(e){return/^is[A-Z]/.test(e)})),Ed=function(e,t,n){if(!yd.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=yd.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!yd.isUndefined(t[e])}))).metaTokens,i=n.visitor||c,a=n.dots,o=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&yd.isSpecCompliantForm(t);if(!yd.isFunction(i))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(yd.isDate(e))return e.toISOString();if(yd.isBoolean(e))return e.toString();if(!s&&yd.isBlob(e))throw new bd("Blob is not supported. Use a Buffer instead.");return yd.isArrayBuffer(e)||yd.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,i){let s=e;if(e&&!i&&"object"==typeof e)if(yd.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(yd.isArray(e)&&function(e){return yd.isArray(e)&&!e.some(_d)}(e)||(yd.isFileList(e)||yd.endsWith(n,"[]"))&&(s=yd.toArray(e)))return n=wd(n),s.forEach((function(e,r){!yd.isUndefined(e)&&null!==e&&t.append(!0===o?Sd([n],r,a):null===o?n:n+"[]",l(e))})),!1;return!!_d(e)||(t.append(Sd(i,n,a),l(e)),!1)}const u=[],d=Object.assign(Md,{defaultVisitor:c,convertValue:l,isVisitable:_d});if(!yd.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!yd.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),yd.forEach(n,(function(n,a){!0===(!(yd.isUndefined(n)||null===n)&&i.call(t,n,yd.isString(a)?a.trim():a,r,d))&&e(n,r?r.concat(a):[a])})),u.pop()}}(e),t};function Td(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Ad(e,t){this._pairs=[],e&&Ed(e,this,t)}const Cd=Ad.prototype;Cd.append=function(e,t){this._pairs.push([e,t])},Cd.toString=function(e){const t=e?function(t){return e.call(this,t,Td)}:Td;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const Pd=Ad;function Rd(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Od(e,t,n){if(!t)return e;const r=n&&n.encode||Rd,i=yd.isFunction(n)?{serialize:n}:n,a=i&&i.serialize;let o;if(o=a?a(t,i):yd.isURLSearchParams(t)?t.toString():new Pd(t,i).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const Dd=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){yd.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},Id={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ld={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Pd,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Nd="undefined"!=typeof window&&"undefined"!=typeof document,kd="object"==typeof navigator&&navigator||void 0,Ud=Nd&&(!kd||["ReactNative","NativeScript","NS"].indexOf(kd.product)<0),Fd="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,zd=Nd&&window.location.href||"http://localhost",jd={...e,...Ld},Bd=function(e){function t(e,n,r,i){let a=e[i++];if("__proto__"===a)return!0;const o=Number.isFinite(+a),s=i>=e.length;return a=!a&&yd.isArray(r)?r.length:a,s?(yd.hasOwnProp(r,a)?r[a]=[r[a],n]:r[a]=n,!o):(r[a]&&yd.isObject(r[a])||(r[a]=[]),t(e,n,r[a],i)&&yd.isArray(r[a])&&(r[a]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],t[a]=e[a];return t}(r[a])),!o)}if(yd.isFormData(e)&&yd.isFunction(e.entries)){const n={};return yd.forEachEntry(e,((e,r)=>{t(function(e){return yd.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null},Hd={transitional:Id,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=yd.isObject(e);if(i&&yd.isHTMLForm(e)&&(e=new FormData(e)),yd.isFormData(e))return r?JSON.stringify(Bd(e)):e;if(yd.isArrayBuffer(e)||yd.isBuffer(e)||yd.isStream(e)||yd.isFile(e)||yd.isBlob(e)||yd.isReadableStream(e))return e;if(yd.isArrayBufferView(e))return e.buffer;if(yd.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ed(e,new jd.classes.URLSearchParams,{visitor:function(e,t,n,r){return jd.isNode&&yd.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...t})}(e,this.formSerializer).toString();if((a=yd.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ed(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(yd.isString(e))try{return(0,JSON.parse)(e),yd.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Hd.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(yd.isResponse(e)||yd.isReadableStream(e))return e;if(e&&yd.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(e){if(n){if("SyntaxError"===e.name)throw bd.from(e,bd.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jd.classes.FormData,Blob:jd.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};yd.forEach(["delete","get","head","post","put","patch"],(e=>{Hd.headers[e]={}}));const Vd=Hd,Gd=yd.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Wd=Symbol("internals");function Xd(e){return e&&String(e).trim().toLowerCase()}function qd(e){return!1===e||null==e?e:yd.isArray(e)?e.map(qd):String(e)}function Yd(e,t,n,r,i){return yd.isFunction(r)?r.call(this,t,n):(i&&(t=n),yd.isString(t)?yd.isString(r)?-1!==t.indexOf(r):yd.isRegExp(r)?r.test(t):void 0:void 0)}class Kd{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=Xd(t);if(!i)throw new Error("header name must be a non-empty string");const a=yd.findKey(r,i);(!a||void 0===r[a]||!0===n||void 0===n&&!1!==r[a])&&(r[a||t]=qd(e))}const a=(e,t)=>yd.forEach(e,((e,n)=>i(e,n,t)));if(yd.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(yd.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))a((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!n||t[n]&&Gd[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t);else if(yd.isObject(e)&&yd.isIterable(e)){let n,r,i={};for(const t of e){if(!yd.isArray(t))throw TypeError("Object iterator must return a key-value pair");i[r=t[0]]=(n=i[r])?yd.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}a(i,t)}else null!=e&&i(t,e,n);return this}get(e,t){if(e=Xd(e)){const n=yd.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(yd.isFunction(t))return t.call(this,e,n);if(yd.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Xd(e)){const n=yd.findKey(this,e);return!(!n||void 0===this[n]||t&&!Yd(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=Xd(e)){const i=yd.findKey(n,e);!i||t&&!Yd(0,n[i],i,t)||(delete n[i],r=!0)}}return yd.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!Yd(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return yd.forEach(this,((r,i)=>{const a=yd.findKey(n,i);if(a)return t[a]=qd(r),void delete t[i];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(i):String(i).trim();o!==i&&delete t[i],t[o]=qd(r),n[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return yd.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&yd.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[Wd]=this[Wd]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Xd(e);t[r]||(function(e,t){const n=yd.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})}))}(n,e),t[r]=!0)}return yd.isArray(e)?e.forEach(r):r(e),this}}Kd.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),yd.reduceDescriptors(Kd.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),yd.freezeMethods(Kd);const $d=Kd;function Zd(e,t){const n=this||Vd,r=t||n,i=$d.from(r.headers);let a=r.data;return yd.forEach(e,(function(e){a=e.call(n,a,i.normalize(),t?t.status:void 0)})),i.normalize(),a}function Jd(e){return!(!e||!e.__CANCEL__)}const Qd=class extends bd{constructor(e,t,n){super(null==e?"canceled":e,bd.ERR_CANCELED,t,n),this.name="CanceledError",this.__CANCEL__=!0}};function eh(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new bd("Request failed with status code "+n.status,[bd.ERR_BAD_REQUEST,bd.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const th=(e,t,n=3)=>{let r=0;const i=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,a=0,o=0;return t=void 0!==t?t:1e3,function(s){const l=Date.now(),c=r[o];i||(i=l),n[a]=s,r[a]=l;let u=o,d=0;for(;u!==a;)d+=n[u++],u%=e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),l-i<t)return;const h=c&&l-c;return h?Math.round(1e3*d/h):void 0}}(50,250);return function(e,t){let n,r,i=0,a=1e3/t;const o=(t,a=Date.now())=>{i=a,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[(...e)=>{const t=Date.now(),s=t-i;s>=a?o(e,t):(n=e,r||(r=setTimeout((()=>{r=null,o(n)}),a-s)))},()=>n&&o(n)]}((n=>{const a=n.loaded,o=n.lengthComputable?n.total:void 0,s=a-r,l=i(s);r=a,e({loaded:a,total:o,progress:o?a/o:void 0,bytes:s,rate:l||void 0,estimated:l&&o&&a<=o?(o-a)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})}),n)},nh=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},rh=e=>(...t)=>yd.asap((()=>e(...t))),ih=jd.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,jd.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(jd.origin),jd.navigator&&/(msie|trident)/i.test(jd.navigator.userAgent)):()=>!0,ah=jd.hasStandardBrowserEnv?{write(e,t,n,r,i,a,o){if("undefined"==typeof document)return;const s=[`${e}=${encodeURIComponent(t)}`];yd.isNumber(n)&&s.push(`expires=${new Date(n).toUTCString()}`),yd.isString(r)&&s.push(`path=${r}`),yd.isString(i)&&s.push(`domain=${i}`),!0===a&&s.push("secure"),yd.isString(o)&&s.push(`SameSite=${o}`),document.cookie=s.join("; ")},read(e){if("undefined"==typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function oh(e,t,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const sh=e=>e instanceof $d?{...e}:e;function lh(e,t){t=t||{};const n={};function r(e,t,n,r){return yd.isPlainObject(e)&&yd.isPlainObject(t)?yd.merge.call({caseless:r},e,t):yd.isPlainObject(t)?yd.merge({},t):yd.isArray(t)?t.slice():t}function i(e,t,n,i){return yd.isUndefined(t)?yd.isUndefined(e)?void 0:r(void 0,e,0,i):r(e,t,0,i)}function a(e,t){if(!yd.isUndefined(t))return r(void 0,t)}function o(e,t){return yd.isUndefined(t)?yd.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,a){return a in t?r(n,i):a in e?r(void 0,n):void 0}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(e,t,n)=>i(sh(e),sh(t),0,!0)};return yd.forEach(Object.keys({...e,...t}),(function(r){const a=l[r]||i,o=a(e[r],t[r],r);yd.isUndefined(o)&&a!==s||(n[r]=o)})),n}const ch=e=>{const t=lh({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:s}=t;if(t.headers=o=$d.from(o),t.url=Od(oh(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&o.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),yd.isFormData(n))if(jd.hasStandardBrowserEnv||jd.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(yd.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach((([e,n])=>{t.includes(e.toLowerCase())&&o.set(e,n)}))}if(jd.hasStandardBrowserEnv&&(r&&yd.isFunction(r)&&(r=r(t)),r||!1!==r&&ih(t.url))){const e=i&&a&&ah.read(a);e&&o.set(i,e)}return t},uh="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const r=ch(e);let i=r.data;const a=$d.from(r.headers).normalize();let o,s,l,c,u,{responseType:d,onUploadProgress:h,onDownloadProgress:p}=r;function f(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=$d.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());eh((function(e){t(e),f()}),(function(e){n(e),f()}),{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new bd("Request aborted",bd.ECONNABORTED,e,m)),m=null)},m.onerror=function(t){const r=t&&t.message?t.message:"Network Error",i=new bd(r,bd.ERR_NETWORK,e,m);i.event=t||null,n(i),m=null},m.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||Id;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new bd(t,i.clarifyTimeoutError?bd.ETIMEDOUT:bd.ECONNABORTED,e,m)),m=null},void 0===i&&a.setContentType(null),"setRequestHeader"in m&&yd.forEach(a.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),yd.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),d&&"json"!==d&&(m.responseType=r.responseType),p&&([l,u]=th(p,!0),m.addEventListener("progress",l)),h&&m.upload&&([s,c]=th(h),m.upload.addEventListener("progress",s),m.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(o=t=>{m&&(n(!t||t.type?new Qd(null,e,m):t),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);v&&-1===jd.protocols.indexOf(v)?n(new bd("Unsupported protocol "+v+":",bd.ERR_BAD_REQUEST,e)):m.send(i||null)}))},dh=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const i=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;r.abort(t instanceof bd?t:new Qd(t instanceof Error?t.message:t))}};let a=t&&setTimeout((()=>{a=null,i(new bd(`timeout of ${t}ms exceeded`,bd.ETIMEDOUT))}),t);const o=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(i):e.removeEventListener("abort",i)})),e=null)};e.forEach((e=>e.addEventListener("abort",i)));const{signal:s}=r;return s.unsubscribe=()=>yd.asap(o),s}},hh=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,i=0;for(;i<n;)r=i+t,yield e.slice(i,r),i=r},ph=(e,t,n,r)=>{const i=async function*(e,t){for await(const n of async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}}(e))yield*hh(n,t)}(e,t);let a,o=0,s=e=>{a||(a=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await i.next();if(t)return s(),void e.close();let a=r.byteLength;if(n){let e=o+=a;n(e)}e.enqueue(new Uint8Array(r))}catch(e){throw s(e),e}},cancel:e=>(s(e),i.return())},{highWaterMark:2})},{isFunction:fh}=yd,mh=(({Request:e,Response:t})=>({Request:e,Response:t}))(yd.global),{ReadableStream:gh,TextEncoder:vh}=yd.global,yh=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},xh=e=>{e=yd.merge.call({skipUndefined:!0},mh,e);const{fetch:t,Request:n,Response:r}=e,i=t?fh(t):"function"==typeof fetch,a=fh(n),o=fh(r);if(!i)return!1;const s=i&&fh(gh),l=i&&("function"==typeof vh?(c=new vh,e=>c.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var c;const u=a&&s&&yh((()=>{let e=!1;const t=new n(jd.origin,{body:new gh,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),d=o&&s&&yh((()=>yd.isReadableStream(new r("").body))),h={stream:d&&(e=>e.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!h[e]&&(h[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new bd(`Response type '${e}' is not supported`,bd.ERR_NOT_SUPPORT,n)})}));return async e=>{let{url:i,method:o,data:s,signal:c,cancelToken:p,timeout:f,onDownloadProgress:m,onUploadProgress:g,responseType:v,headers:y,withCredentials:x="same-origin",fetchOptions:b}=ch(e),_=t||fetch;v=v?(v+"").toLowerCase():"text";let w=dh([c,p&&p.toAbortSignal()],f),S=null;const M=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let E;try{if(g&&u&&"get"!==o&&"head"!==o&&0!==(E=await(async(e,t)=>{const r=yd.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(yd.isBlob(e))return e.size;if(yd.isSpecCompliantForm(e)){const t=new n(jd.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return yd.isArrayBufferView(e)||yd.isArrayBuffer(e)?e.byteLength:(yd.isURLSearchParams(e)&&(e+=""),yd.isString(e)?(await l(e)).byteLength:void 0)})(t):r})(y,s))){let e,t=new n(i,{method:"POST",body:s,duplex:"half"});if(yd.isFormData(s)&&(e=t.headers.get("content-type"))&&y.setContentType(e),t.body){const[e,n]=nh(E,th(rh(g)));s=ph(t.body,65536,e,n)}}yd.isString(x)||(x=x?"include":"omit");const t=a&&"credentials"in n.prototype,c={...b,signal:w,method:o.toUpperCase(),headers:y.normalize().toJSON(),body:s,duplex:"half",credentials:t?x:void 0};S=a&&new n(i,c);let p=await(a?_(S,b):_(i,c));const f=d&&("stream"===v||"response"===v);if(d&&(m||f&&M)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=p[t]}));const t=yd.toFiniteNumber(p.headers.get("content-length")),[n,i]=m&&nh(t,th(rh(m),!0))||[];p=new r(ph(p.body,65536,n,(()=>{i&&i(),M&&M()})),e)}v=v||"text";let T=await h[yd.findKey(h,v)||"text"](p,e);return!f&&M&&M(),await new Promise(((t,n)=>{eh(t,n,{data:T,headers:$d.from(p.headers),status:p.status,statusText:p.statusText,config:e,request:S})}))}catch(t){if(M&&M(),t&&"TypeError"===t.name&&/Load failed|fetch/i.test(t.message))throw Object.assign(new bd("Network Error",bd.ERR_NETWORK,e,S),{cause:t.cause||t});throw bd.from(t,t&&t.code,e,S)}}},bh=new Map,_h=e=>{let t=e&&e.env||{};const{fetch:n,Request:r,Response:i}=t,a=[r,i,n];let o,s,l=a.length,c=bh;for(;l--;)o=a[l],s=c.get(o),void 0===s&&c.set(o,s=l?new Map:xh(t)),c=s;return s},wh=(_h(),{http:null,xhr:uh,fetch:{get:_h}});yd.forEach(wh,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const Sh=e=>`- ${e}`,Mh=e=>yd.isFunction(e)||null===e||!1===e,Eh=function(e,t){e=yd.isArray(e)?e:[e];const{length:n}=e;let r,i;const a={};for(let o=0;o<n;o++){let n;if(r=e[o],i=r,!Mh(r)&&(i=wh[(n=String(r)).toLowerCase()],void 0===i))throw new bd(`Unknown adapter '${n}'`);if(i&&(yd.isFunction(i)||(i=i.get(t))))break;a[n||"#"+o]=i}if(!i){const e=Object.entries(a).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let t=n?e.length>1?"since :\n"+e.map(Sh).join("\n"):" "+Sh(e[0]):"as no adapter specified";throw new bd("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return i};function Th(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Qd(null,e)}function Ah(e){return Th(e),e.headers=$d.from(e.headers),e.data=Zd.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Eh(e.adapter||Vd.adapter,e)(e).then((function(t){return Th(e),t.data=Zd.call(e,e.transformResponse,t),t.headers=$d.from(t.headers),t}),(function(t){return Jd(t)||(Th(e),t&&t.response&&(t.response.data=Zd.call(e,e.transformResponse,t.response),t.response.headers=$d.from(t.response.headers))),Promise.reject(t)}))}const Ch="1.13.3",Ph={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Ph[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Rh={};Ph.transitional=function(e,t,n){function r(e,t){return"[Axios v"+Ch+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,a)=>{if(!1===e)throw new bd(r(i," has been removed"+(t?" in "+t:"")),bd.ERR_DEPRECATED);return t&&!Rh[i]&&(Rh[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,a)}},Ph.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};const Oh={assertOptions:function(e,t,n){if("object"!=typeof e)throw new bd("options must be an object",bd.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const a=r[i],o=t[a];if(o){const t=e[a],n=void 0===t||o(t,a,e);if(!0!==n)throw new bd("option "+a+" must be "+n,bd.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new bd("Unknown option "+a,bd.ERR_BAD_OPTION)}},validators:Ph},Dh=Oh.validators;class Ih{constructor(e){this.defaults=e||{},this.interceptors={request:new Dd,response:new Dd}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=lh(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;void 0!==n&&Oh.assertOptions(n,{silentJSONParsing:Dh.transitional(Dh.boolean),forcedJSONParsing:Dh.transitional(Dh.boolean),clarifyTimeoutError:Dh.transitional(Dh.boolean)},!1),null!=r&&(yd.isFunction(r)?t.paramsSerializer={serialize:r}:Oh.assertOptions(r,{encode:Dh.function,serialize:Dh.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Oh.assertOptions(t,{baseUrl:Dh.spelling("baseURL"),withXsrfToken:Dh.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&yd.merge(i.common,i[t.method]);i&&yd.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete i[e]})),t.headers=$d.concat(a,i);const o=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let u,d=0;if(!s){const e=[Ah.bind(this),void 0];e.unshift(...o),e.push(...l),u=e.length,c=Promise.resolve(t);let n=t;for(;d<u;)c=c.then(e[d++]).then((e=>{n=void 0!==e?e:n})).catch(e[d++]).then((()=>n));return c}u=o.length;let h=t;for(;d<u;){const e=o[d++],t=o[d++];try{h=e(h)}catch(e){t.call(this,e);break}}try{c=Ah.call(this,h)}catch(e){return Promise.reject(e)}for(d=0,u=l.length;d<u;)c=c.then(l[d++]).catch(l[d++]);return c}getUri(e){return Od(oh((e=lh(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}yd.forEach(["delete","get","head","options"],(function(e){Ih.prototype[e]=function(t,n){return this.request(lh(n||{},{method:e,url:t,data:(n||{}).data}))}})),yd.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(lh(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Ih.prototype[e]=t(),Ih.prototype[e+"Form"]=t(!0)}));const Lh=Ih;class Nh{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,i){n.reason||(n.reason=new Qd(e,r,i),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Nh((function(t){e=t})),cancel:e}}}const kh=Nh,Uh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Uh).forEach((([e,t])=>{Uh[t]=e}));const Fh=Uh,zh=function e(t){const n=new Lh(t),r=Cu(Lh.prototype.request,n);return yd.extend(r,Lh.prototype,n,{allOwnKeys:!0}),yd.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(lh(t,n))},r}(Vd);zh.Axios=Lh,zh.CanceledError=Qd,zh.CancelToken=kh,zh.isCancel=Jd,zh.VERSION=Ch,zh.toFormData=Ed,zh.AxiosError=bd,zh.Cancel=zh.CanceledError,zh.all=function(e){return Promise.all(e)},zh.spread=function(e){return function(t){return e.apply(null,t)}},zh.isAxiosError=function(e){return yd.isObject(e)&&!0===e.isAxiosError},zh.mergeConfig=lh,zh.AxiosHeaders=$d,zh.formToJSON=e=>Bd(yd.isHTMLForm(e)?new FormData(e):e),zh.getAdapter=Eh,zh.HttpStatusCode=Fh,zh.default=zh;const jh=zh;function Bh(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Bh(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Hh(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Bh(e))&&(r&&(r+=" "),r+=t);return r}var Vh=s(3356),Gh=s.n(Vh),Wh=s(1903),Xh=s.n(Wh),qh=4;function Yh(e){var t=10**(arguments.length>1&&void 0!==arguments[1]?arguments[1]:qh),n=Math.round(e*t)/t;return Object.is(n,-0)?0:n}function Kh(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.reduce(((e,t,r)=>{var i=n[r-1];return"string"==typeof i?e+i+t:void 0!==i?e+Yh(i)+t:e+t}),"")}var $h=e=>0===e?0:e>0?1:-1,Zh=e=>"number"==typeof e&&e!=+e,Jh=e=>"string"==typeof e&&e.indexOf("%")===e.length-1,Qh=e=>("number"==typeof e||e instanceof Number)&&!Zh(e),ep=e=>Qh(e)||"string"==typeof e,tp=0,np=e=>{var t=++tp;return"".concat(e||"").concat(t)},rp=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Qh(e)&&"string"!=typeof e)return r;if(Jh(e)){if(null==t)return r;var a=e.indexOf("%");n=t*parseFloat(e.slice(0,a))/100}else n=+e;return Zh(n)&&(n=r),i&&null!=t&&n>t&&(n=t),n},ip=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[String(e[r])])return!0;n[String(e[r])]=!0}return!1};function ap(e,t,n){return Qh(e)&&Qh(t)?Yh(e+n*(t-e)):t}function op(e,t,n){if(e&&e.length)return e.find((e=>e&&("function"==typeof t?t(e):Xh()(e,t))===n))}var sp=e=>null==e,lp=e=>sp(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function cp(e){return null!=e}function up(){}var dp=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if("undefined"!=typeof console&&console.warn&&(void 0===t&&console.warn("LogUtils requires an error message argument"),!e))if(void 0===t)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var a=0;console.warn(t.replace(/%s/g,(()=>r[a++])))}},hp={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},pp=(e,t,n)=>{var{width:r=hp.width,height:i=hp.height,aspect:a,maxHeight:o}=n,s=Jh(r)?e:Number(r),l=Jh(i)?t:Number(i);return a&&a>0&&(s?l=s/a:l&&(s=l*a),o&&null!=l&&l>o&&(l=o)),{calculatedWidth:s,calculatedHeight:l}},fp={width:0,height:0,overflow:"visible"},mp={width:0,overflowX:"visible"},gp={height:0,overflowY:"visible"},vp={},yp=e=>{var{width:t,height:n}=e,r=Jh(t),i=Jh(n);return r&&i?fp:r?mp:i?gp:vp};function xp(e){return Number.isFinite(e)}function bp(e){return"number"==typeof e&&e>0&&Number.isFinite(e)}function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_p.apply(null,arguments)}function wp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wp(Object(n),!0).forEach((function(t){Mp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mp(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ep=(0,r.createContext)(hp.initialDimension);function Tp(e){var{children:t,width:n,height:i}=e,a=(0,r.useMemo)((()=>({width:n,height:i})),[n,i]);return function(e){return bp(e.width)&&bp(e.height)}(a)?r.createElement(Ep.Provider,{value:a},t):null}var Ap=()=>(0,r.useContext)(Ep),Cp=(0,r.forwardRef)(((e,t)=>{var{aspect:n,initialDimension:i=hp.initialDimension,width:a,height:o,minWidth:s=hp.minWidth,minHeight:l,maxHeight:c,children:u,debounce:d=hp.debounce,id:h,className:p,onResize:f,style:m={}}=e,g=(0,r.useRef)(null),v=(0,r.useRef)();v.current=f,(0,r.useImperativeHandle)(t,(()=>g.current));var[y,x]=(0,r.useState)({containerWidth:i.width,containerHeight:i.height}),b=(0,r.useCallback)(((e,t)=>{x((n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}}))}),[]);(0,r.useEffect)((()=>{if(null==g.current||"undefined"==typeof ResizeObserver)return up;var e=e=>{var t,n=e[0];if(null!=n){var{width:r,height:i}=n.contentRect;b(r,i),null===(t=v.current)||void 0===t||t.call(v,r,i)}};d>0&&(e=Gh()(e,d,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:n,height:r}=g.current.getBoundingClientRect();return b(n,r),t.observe(g.current),()=>{t.disconnect()}}),[b,d]);var{containerWidth:_,containerHeight:w}=y;dp(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:S,calculatedHeight:M}=pp(_,w,{width:a,height:o,aspect:n,maxHeight:c});return dp(null!=S&&S>0||null!=M&&M>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",S,M,a,o,s,l,n),r.createElement("div",{id:h?"".concat(h):void 0,className:Hh("recharts-responsive-container",p),style:Sp(Sp({},m),{},{width:a,height:o,minWidth:s,minHeight:l,maxHeight:c}),ref:g},r.createElement("div",{style:yp({width:a,height:o})},r.createElement(Tp,{width:S,height:M},u)))})),Pp=(0,r.forwardRef)(((e,t)=>{var n=Ap();if(bp(n.width)&&bp(n.height))return e.children;var{width:i,height:a}=function(e){var{width:t,height:n,aspect:r}=e,i=t,a=n;return void 0===i&&void 0===a?(i=hp.width,a=hp.height):void 0===i?i=r&&r>0?void 0:hp.width:void 0===a&&(a=r&&r>0?void 0:hp.height),{width:i,height:a}}({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:o,calculatedHeight:s}=pp(void 0,void 0,{width:i,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Qh(o)&&Qh(s)?r.createElement(Tp,{width:o,height:s},e.children):r.createElement(Cp,_p({},e,{width:i,height:a,ref:t}))})),Rp=Symbol.for("immer-nothing"),Op=Symbol.for("immer-draftable"),Dp=Symbol.for("immer-state");function Ip(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Lp=Object,Np=Lp.getPrototypeOf,kp="constructor",Up="prototype",Fp="configurable",zp="enumerable",jp="writable",Bp="value",Hp=e=>!!e&&!!e[Dp];function Vp(e){return!!e&&(Xp(e)||Jp(e)||!!e[Op]||!!e[kp]?.[Op]||Qp(e)||ef(e))}var Gp=Lp[Up][kp].toString(),Wp=new WeakMap;function Xp(e){if(!e||!tf(e))return!1;const t=Np(e);if(null===t||t===Lp[Up])return!0;const n=Lp.hasOwnProperty.call(t,kp)&&t[kp];if(n===Object)return!0;if(!nf(n))return!1;let r=Wp.get(n);return void 0===r&&(r=Function.toString.call(n),Wp.set(n,r)),r===Gp}function qp(e,t,n=!0){0===Yp(e)?(n?Reflect.ownKeys(e):Lp.keys(e)).forEach((n=>{t(n,e[n],e)})):e.forEach(((n,r)=>t(r,n,e)))}function Yp(e){const t=e[Dp];return t?t.type_:Jp(e)?1:Qp(e)?2:ef(e)?3:0}var Kp=(e,t,n=Yp(e))=>2===n?e.has(t):Lp[Up].hasOwnProperty.call(e,t),$p=(e,t,n=Yp(e))=>2===n?e.get(t):e[t],Zp=(e,t,n,r=Yp(e))=>{2===r?e.set(t,n):3===r?e.add(n):e[t]=n},Jp=Array.isArray,Qp=e=>e instanceof Map,ef=e=>e instanceof Set,tf=e=>"object"==typeof e,nf=e=>"function"==typeof e,rf=e=>"boolean"==typeof e,af=e=>e.copy_||e.base_,of=e=>e.modified_?e.copy_:e.base_;function sf(e,t){if(Qp(e))return new Map(e);if(ef(e))return new Set(e);if(Jp(e))return Array[Up].slice.call(e);const n=Xp(e);if(!0===t||"class_only"===t&&!n){const t=Lp.getOwnPropertyDescriptors(e);delete t[Dp];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],a=t[i];!1===a[jp]&&(a[jp]=!0,a[Fp]=!0),(a.get||a.set)&&(t[i]={[Fp]:!0,[jp]:!0,[zp]:a[zp],[Bp]:e[i]})}return Lp.create(Np(e),t)}{const t=Np(e);if(null!==t&&n)return{...e};const r=Lp.create(t);return Lp.assign(r,e)}}function lf(e,t=!1){return uf(e)||Hp(e)||!Vp(e)||(Yp(e)>1&&Lp.defineProperties(e,{set:cf,add:cf,clear:cf,delete:cf}),Lp.freeze(e),t&&qp(e,((e,t)=>{lf(t,!0)}),!1)),e}var cf={[Bp]:function(){Ip(2)}};function uf(e){return null===e||!tf(e)||Lp.isFrozen(e)}var df="MapSet",hf="Patches",pf="ArrayMethods",ff={};function mf(e){const t=ff[e];return t||Ip(0),t}var gf,vf=e=>!!ff[e],yf=()=>gf;function xf(e,t){t&&(e.patchPlugin_=mf(hf),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function bf(e){_f(e),e.drafts_.forEach(Sf),e.drafts_=null}function _f(e){e===gf&&(gf=e.parent_)}var wf=e=>gf={drafts_:[],parent_:gf,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:vf(df)?mf(df):void 0,arrayMethodsPlugin_:vf(pf)?mf(pf):void 0};function Sf(e){const t=e[Dp];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Mf(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];if(void 0!==e&&e!==n){n[Dp].modified_&&(bf(t),Ip(4)),Vp(e)&&(e=Ef(t,e));const{patchPlugin_:r}=t;r&&r.generateReplacementPatches_(n[Dp].base_,e,t)}else e=Ef(t,n);return function(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&lf(t,n)}(t,e,!0),bf(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Rp?e:void 0}function Ef(e,t){if(uf(t))return t;const n=t[Dp];if(!n)return Of(t,e.handledSet_,e);if(!Af(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:t}=n;if(t)for(;t.length>0;)t.pop()(e);Rf(n,e)}return n.copy_}function Tf(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var Af=(e,t)=>e.scope_===t,Cf=[];function Pf(e,t,n,r){const i=af(e),a=e.type_;if(void 0!==r&&$p(i,r,a)===t)return void Zp(i,r,n,a);if(!e.draftLocations_){const t=e.draftLocations_=new Map;qp(i,((e,n)=>{if(Hp(n)){const r=t.get(n)||[];r.push(e),t.set(n,r)}}))}const o=e.draftLocations_.get(t)??Cf;for(const e of o)Zp(i,e,n,a)}function Rf(e,t){if(e.modified_&&!e.finalized_&&(3===e.type_||1===e.type_&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=t;if(n){const r=n.getPath(e);r&&n.generatePatches_(e,r,t)}Tf(e)}}function Of(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||Hp(e)||t.has(e)||!Vp(e)||uf(e)||(t.add(e),qp(e,((r,i)=>{if(Hp(i)){const t=i[Dp];if(Af(t,n)){const n=of(t);Zp(e,r,n,e.type_),Tf(t)}}else Vp(i)&&Of(i,t,n)}))),e}var Df={get(e,t){if(t===Dp)return e;let n=e.scope_.arrayMethodsPlugin_;const r=1===e.type_&&"string"==typeof t;if(r&&n?.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);const i=af(e);if(!Kp(i,t,e.type_))return function(e,t,n){const r=Nf(t,n);return r?Bp in r?r[Bp]:r.get?.call(e.draft_):void 0}(e,i,t);const a=i[t];if(e.finalized_||!Vp(a))return a;if(r&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&function(e){const t=+e;return Number.isInteger(t)&&String(t)===e}(t))return a;if(a===Lf(e.base_,t)){Uf(e);const n=1===e.type_?+t:t,r=Ff(e.scope_,a,e,n);return e.copy_[n]=r}return a},has:(e,t)=>t in af(e),ownKeys:e=>Reflect.ownKeys(af(e)),set(e,t,n){const r=Nf(af(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=Lf(af(e),t),o=r?.[Dp];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(((i=n)===(a=r)?0!==i||1/i==1/a:i!=i&&a!=a)&&(void 0!==n||Kp(e.base_,t,e.type_)))return!0;Uf(e),kf(e)}var i,a;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),function(e,t,n){const{scope_:r}=e;if(Hp(n)){const i=n[Dp];Af(i,r)&&i.callbacks_.push((function(){Uf(e);const r=of(i);Pf(e,n,r,t)}))}else Vp(n)&&e.callbacks_.push((function(){const i=af(e);3===e.type_?i.has(n)&&Of(n,r.handledSet_,r):$p(i,t,e.type_)===n&&r.drafts_.length>1&&!0===(e.assigned_.get(t)??!1)&&e.copy_&&Of($p(e.copy_,t,e.type_),r.handledSet_,r)}))}(e,t,n)),!0},deleteProperty:(e,t)=>(Uf(e),void 0!==Lf(e.base_,t)||t in e.base_?(e.assigned_.set(t,!1),kf(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=af(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{[jp]:!0,[Fp]:1!==e.type_||"length"!==t,[zp]:r[zp],[Bp]:n[t]}:r},defineProperty(){Ip(11)},getPrototypeOf:e=>Np(e.base_),setPrototypeOf(){Ip(12)}},If={};for(let e in Df){let t=Df[e];If[e]=function(){const e=arguments;return e[0]=e[0][0],t.apply(this,e)}}function Lf(e,t){const n=e[Dp];return(n?af(n):e)[t]}function Nf(e,t){if(!(t in e))return;let n=Np(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Np(n)}}function kf(e){e.modified_||(e.modified_=!0,e.parent_&&kf(e.parent_))}function Uf(e){e.copy_||(e.assigned_=new Map,e.copy_=sf(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function Ff(e,t,n,r){const[i,a]=Qp(t)?mf(df).proxyMap_(t,n):ef(t)?mf(df).proxySet_(t,n):function(e,t){const n=Jp(e),r={type_:n?1:0,scope_:t?t.scope_:yf(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=r,a=Df;n&&(i=[r],a=If);const{revoke:o,proxy:s}=Proxy.revocable(i,a);return r.draft_=s,r.revoke_=o,[s,r]}(t,n);return(n?.scope_??yf()).drafts_.push(i),a.callbacks_=n?.callbacks_??[],a.key_=r,n&&void 0!==r?function(e,t,n){e.callbacks_.push((function(r){const i=t;if(!i||!Af(i,r))return;r.mapSetPlugin_?.fixSetContents(i);const a=of(i);Pf(e,i.draft_??i,a,n),Rf(i,r)}))}(n,a,r):a.callbacks_.push((function(e){e.mapSetPlugin_?.fixSetContents(a);const{patchPlugin_:t}=e;a.modified_&&t&&t.generatePatches_(a,[],e)})),i}function zf(e){return Hp(e)||Ip(10),jf(e)}function jf(e){if(!Vp(e)||uf(e))return e;const t=e[Dp];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=sf(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=sf(e,!0);return qp(n,((e,t)=>{Zp(n,e,jf(t))}),r),t&&(t.finalized_=!1),n}If.deleteProperty=function(e,t){return If.set.call(this,e,t,void 0)},If.set=function(e,t,n){return Df.set.call(this,e[0],t,n,e[0])};var Bf=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(e,t,n)=>{if(nf(e)&&!nf(t)){const n=t;t=e;const r=this;return function(e=n,...i){return r.produce(e,(e=>t.call(this,e,...i)))}}let r;if(nf(t)||Ip(6),void 0===n||nf(n)||Ip(7),Vp(e)){const i=wf(this),a=Ff(0,e,void 0);let o=!0;try{r=t(a),o=!1}finally{o?bf(i):_f(i)}return xf(i,n),Mf(r,i)}if(!e||!tf(e)){if(r=t(e),void 0===r&&(r=e),r===Rp&&(r=void 0),this.autoFreeze_&&lf(r,!0),n){const t=[],i=[];mf(hf).generateReplacementPatches_(e,r,{patches_:t,inversePatches_:i}),n(t,i)}return r}Ip(1)},this.produceWithPatches=(e,t)=>{if(nf(e))return(t,...n)=>this.produceWithPatches(t,(t=>e(t,...n)));let n,r;return[this.produce(e,t,((e,t)=>{n=e,r=t})),n,r]},rf(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),rf(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),rf(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Vp(e)||Ip(8),Hp(e)&&(e=zf(e));const t=wf(this),n=Ff(0,e,void 0);return n[Dp].isManual_=!0,_f(t),n}finishDraft(e,t){const n=e&&e[Dp];n&&n.isManual_||Ip(9);const{scope_:r}=n;return xf(r,t),Mf(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=mf(hf).applyPatches_;return Hp(e)?r(e,t):this.produce(e,(e=>r(e,t)))}},Hf=Bf.produce;function Vf(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Gf=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),Wf=()=>Math.random().toString(36).substring(7).split("").join("."),Xf={INIT:`@@redux/INIT${Wf()}`,REPLACE:`@@redux/REPLACE${Wf()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Wf()}`};function qf(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function Yf(e,t,n){if("function"!=typeof e)throw new Error(Vf(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(Vf(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(Vf(1));return n(Yf)(e,t)}let r=e,i=t,a=new Map,o=a,s=0,l=!1;function c(){o===a&&(o=new Map,a.forEach(((e,t)=>{o.set(t,e)})))}function u(){if(l)throw new Error(Vf(3));return i}function d(e){if("function"!=typeof e)throw new Error(Vf(4));if(l)throw new Error(Vf(5));let t=!0;c();const n=s++;return o.set(n,e),function(){if(t){if(l)throw new Error(Vf(6));t=!1,c(),o.delete(n),a=null}}}function h(e){if(!qf(e))throw new Error(Vf(7));if(void 0===e.type)throw new Error(Vf(8));if("string"!=typeof e.type)throw new Error(Vf(17));if(l)throw new Error(Vf(9));try{l=!0,i=r(i,e)}finally{l=!1}return(a=o).forEach((e=>{e()})),e}return h({type:Xf.INIT}),{dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(Vf(10));r=e,h({type:Xf.REPLACE})},[Gf]:function(){const e=d;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(Vf(11));function n(){const e=t;e.next&&e.next(u())}return n(),{unsubscribe:e(n)}},[Gf](){return this}}}}}function Kf(e){const t=Object.keys(e),n={};for(let r=0;r<t.length;r++){const i=t[r];"function"==typeof e[i]&&(n[i]=e[i])}const r=Object.keys(n);let i;try{!function(e){Object.keys(e).forEach((t=>{const n=e[t];if(void 0===n(void 0,{type:Xf.INIT}))throw new Error(Vf(12));if(void 0===n(void 0,{type:Xf.PROBE_UNKNOWN_ACTION()}))throw new Error(Vf(13))}))}(n)}catch(e){i=e}return function(e={},t){if(i)throw i;let a=!1;const o={};for(let i=0;i<r.length;i++){const s=r[i],l=n[s],c=e[s],u=l(c,t);if(void 0===u)throw t&&t.type,new Error(Vf(14));o[s]=u,a=a||u!==c}return a=a||r.length!==Object.keys(e).length,a?o:e}}function $f(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...n)=>e(t(...n))))}function Zf(e){return qf(e)&&"type"in e&&"string"==typeof e.type}function Jf(e){return({dispatch:t,getState:n})=>r=>i=>"function"==typeof i?i(t,n,e):r(i)}var Qf=Jf(),em=Jf,tm="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?$f:$f.apply(null,arguments)};function nm(e,t){function n(...n){if(t){let r=t(...n);if(!r)throw new Error(Ym(0));return{type:e,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:e,payload:n[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=t=>Zf(t)&&t.type===e,n}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var rm=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function im(e){return Vp(e)?Hf(e,(()=>{})):e}function am(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var om="RTK_autoBatch",sm=()=>e=>({payload:e,meta:{[om]:!0}}),lm=e=>t=>{setTimeout(t,e)},cm=(e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let i=!0,a=!1,o=!1;const s=new Set,l="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:lm(10):"callback"===e.type?e.queueNotification:lm(e.timeout),c=()=>{o=!1,a&&(a=!1,s.forEach((e=>e())))};return Object.assign({},r,{subscribe(e){const t=r.subscribe((()=>i&&e()));return s.add(e),()=>{t(),s.delete(e)}},dispatch(e){try{return i=!e?.meta?.[om],a=!i,a&&(o||(o=!0,l(c))),r.dispatch(e)}finally{i=!0}}})};function um(e){const t={},n=[];let r;const i={addCase(e,n){const r="string"==typeof e?e:e.type;if(!r)throw new Error(Ym(28));if(r in t)throw new Error(Ym(29));return t[r]=n,i},addAsyncThunk:(e,r)=>(r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),i),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),i),addDefaultCase:e=>(r=e,i)};return e(i),[t,n,r]}var dm=(e=21)=>{let t="",n=e;for(;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},hm=Symbol.for("rtk-slice-createasyncthunk");function pm(e,t){return`${e}/${t}`}function fm({creators:e}={}){const t=e?.asyncThunk?.[hm];return function(e){const{name:n,reducerPath:r=n}=e;if(!n)throw new Error(Ym(11));const i=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name]:(...t)=>e(...t)}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},a=Object.keys(i),o={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},s={addCase(e,t){const n="string"==typeof e?e:e.type;if(!n)throw new Error(Ym(12));if(n in o.sliceCaseReducersByType)throw new Error(Ym(13));return o.sliceCaseReducersByType[n]=t,s},addMatcher:(e,t)=>(o.sliceMatchers.push({matcher:e,reducer:t}),s),exposeAction:(e,t)=>(o.actionCreators[e]=t,s),exposeCaseReducer:(e,t)=>(o.sliceCaseReducersByName[e]=t,s)};function l(){const[t={},n=[],r]="function"==typeof e.extraReducers?um(e.extraReducers):[e.extraReducers],i={...t,...o.sliceCaseReducersByType};return function(e,t){let a,[s,l,c]=um((e=>{for(let t in i)e.addCase(t,i[t]);for(let t of o.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)}));if("function"==typeof e)a=()=>im(e());else{const t=im(e);a=()=>t}function u(e=a(),t){let n=[s[t.type],...l.filter((({matcher:e})=>e(t))).map((({reducer:e})=>e))];return 0===n.filter((e=>!!e)).length&&(n=[c]),n.reduce(((e,n)=>{if(n){if(Hp(e)){const r=n(e,t);return void 0===r?e:r}if(Vp(e))return Hf(e,(e=>n(e,t)));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e}),e)}return u.getInitialState=a,u}(e.initialState)}a.forEach((r=>{const a=i[r],o={reducerName:r,type:pm(n,r),createNotation:"function"==typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(a)?function({type:e,reducerName:t,createNotation:n},r,i){let a,o;if("reducer"in r){if(n&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(r))throw new Error(Ym(17));a=r.reducer,o=r.prepare}else a=r;i.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,o?nm(e,o):nm(e))}(o,a,s):function({type:e,reducerName:t},n,r,i){if(!i)throw new Error(Ym(18));const{payloadCreator:a,fulfilled:o,pending:s,rejected:l,settled:c,options:u}=n,d=i(e,a,u);r.exposeAction(t,d),o&&r.addCase(d.fulfilled,o),s&&r.addCase(d.pending,s),l&&r.addCase(d.rejected,l),c&&r.addMatcher(d.settled,c),r.exposeCaseReducer(t,{fulfilled:o||vm,pending:s||vm,rejected:l||vm,settled:c||vm})}(o,a,s,t)}));const c=e=>e,u=new Map,d=new WeakMap;let h;function p(e,t){return h||(h=l()),h(e,t)}function f(){return h||(h=l()),h.getInitialState()}function m(t,n=!1){function r(e){let i=e[t];return void 0===i&&n&&(i=am(d,r,f)),i}function i(t=c){const r=am(u,n,(()=>new WeakMap));return am(r,t,(()=>{const r={};for(const[i,a]of Object.entries(e.selectors??{}))r[i]=mm(a,t,(()=>am(d,t,f)),n);return r}))}return{reducerPath:t,getSelectors:i,get selectors(){return i(r)},selectSlice:r}}const g={name:n,reducer:p,actions:o.actionCreators,caseReducers:o.sliceCaseReducersByName,getInitialState:f,...m(r),injectInto(e,{reducerPath:t,...n}={}){const i=t??r;return e.inject({reducerPath:i,reducer:p},n),{...g,...m(i,!0)}}};return g}}function mm(e,t,n,r){function i(i,...a){let o=t(i);return void 0===o&&r&&(o=n()),e(o,...a)}return i.unwrapped=e,i}var gm=fm();function vm(){}var ym="listener",xm="completed",bm="cancelled",_m=`task-${bm}`,wm=`task-${xm}`,Sm=`${ym}-${bm}`,Mm=`${ym}-${xm}`,Em=class{constructor(e){this.code=e,this.message=`task ${bm} (reason: ${e})`}name="TaskAbortError";message},Tm=(e,t)=>{if("function"!=typeof e)throw new TypeError(Ym(32))},Am=()=>{},Cm=(e,t=Am)=>(e.catch(t),e),Pm=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Rm=e=>{if(e.aborted)throw new Em(e.reason)};function Om(e,t){let n=Am;return new Promise(((r,i)=>{const a=()=>i(new Em(e.reason));e.aborted?a():(n=Pm(e,a),t.finally((()=>n())).then(r,i))})).finally((()=>{n=Am}))}var Dm=e=>t=>Cm(Om(e,t).then((t=>(Rm(e),t)))),Im=e=>{const t=Dm(e);return e=>t(new Promise((t=>setTimeout(t,e))))},{assign:Lm}=Object,Nm={},km="listenerMiddleware",Um=(e,t)=>(n,r)=>{Tm(n);const i=new AbortController;var a;a=i,Pm(e,(()=>a.abort(e.reason)));const o=(async(t,r)=>{try{return await Promise.resolve(),{status:"ok",value:await(async()=>{Rm(e),Rm(i.signal);const t=await n({pause:Dm(i.signal),delay:Im(i.signal),signal:i.signal});return Rm(i.signal),t})()}}catch(e){return{status:e instanceof Em?"cancelled":"rejected",error:e}}finally{i.abort(wm)}})();return r?.autoJoin&&t.push(o.catch(Am)),{result:Dm(e)(o),cancel(){i.abort(_m)}}},Fm=e=>{let{type:t,actionCreator:n,matcher:r,predicate:i,effect:a}=e;if(t)i=nm(t).match;else if(n)t=n.type,i=n.match;else if(r)i=r;else if(!i)throw new Error(Ym(21));return Tm(a),{predicate:i,type:t,effect:a}},zm=Lm((e=>{const{type:t,predicate:n,effect:r}=Fm(e);return{id:dm(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Ym(22))}}}),{withTypes:()=>zm}),jm=(e,t)=>{const{type:n,effect:r,predicate:i}=Fm(t);return Array.from(e.values()).find((e=>("string"==typeof n?e.type===n:e.predicate===i)&&e.effect===r))},Bm=e=>{e.pending.forEach((e=>{e.abort(Sm)}))},Hm=(e,t,n)=>{try{e(t,n)}catch(e){setTimeout((()=>{throw e}),0)}},Vm=Lm(nm(`${km}/add`),{withTypes:()=>Vm}),Gm=nm(`${km}/removeAll`),Wm=Lm(nm(`${km}/remove`),{withTypes:()=>Wm}),Xm=(...e)=>{console.error(`${km}/error`,...e)},qm=(e={})=>{const t=new Map,n=new Map,{extra:r,onError:i=Xm}=e;Tm(i);const a=e=>{return(n=jm(t,e)??zm(e)).unsubscribe=()=>t.delete(n.id),t.set(n.id,n),e=>{n.unsubscribe(),e?.cancelActive&&Bm(n)};var n};Lm(a,{withTypes:()=>a});const o=e=>{const n=jm(t,e);return n&&(n.unsubscribe(),e.cancelActive&&Bm(n)),!!n};Lm(o,{withTypes:()=>o});const s=async(e,o,s,l)=>{const c=new AbortController,u=((e,t)=>(n,r)=>Cm((async(n,r)=>{Rm(t);let i=()=>{};const a=[new Promise(((t,r)=>{let a=e({predicate:n,effect:(e,n)=>{n.unsubscribe(),t([e,n.getState(),n.getOriginalState()])}});i=()=>{a(),r()}}))];null!=r&&a.push(new Promise((e=>setTimeout(e,r,null))));try{const e=await Om(t,Promise.race(a));return Rm(t),e}finally{i()}})(n,r)))(a,c.signal),d=[];try{e.pending.add(c),(e=>{const t=n.get(e)??0;n.set(e,t+1)})(e),await Promise.resolve(e.effect(o,Lm({},s,{getOriginalState:l,condition:(e,t)=>u(e,t).then(Boolean),take:u,delay:Im(c.signal),pause:Dm(c.signal),extra:r,signal:c.signal,fork:Um(c.signal,d),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach(((e,t,n)=>{e!==c&&(e.abort(Sm),n.delete(e))}))},cancel:()=>{c.abort(Sm),e.pending.delete(c)},throwIfCancelled:()=>{Rm(c.signal)}})))}catch(e){e instanceof Em||Hm(i,e,{raisedBy:"effect"})}finally{await Promise.all(d),c.abort(Mm),(e=>{const t=n.get(e)??1;1===t?n.delete(e):n.set(e,t-1)})(e),e.pending.delete(c)}},l=((e,t)=>()=>{for(const e of t.keys())Bm(e);e.clear()})(t,n);return{middleware:e=>n=>r=>{if(!Zf(r))return n(r);if(Vm.match(r))return a(r.payload);if(Gm.match(r))return void l();if(Wm.match(r))return o(r.payload);let c=e.getState();const u=()=>{if(c===Nm)throw new Error(Ym(23));return c};let d;try{if(d=n(r),t.size>0){const n=e.getState(),a=Array.from(t.values());for(const t of a){let a=!1;try{a=t.predicate(r,n,c)}catch(e){a=!1,Hm(i,e,{raisedBy:"predicate"})}a&&s(t,r,e,u)}}}finally{c=Nm}return d},startListening:a,stopListening:o,clearListeners:l}};function Ym(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}Symbol.for("rtk-state-proxy-original");var Km=(e,t)=>{if(t&&Array.isArray(e)){var n=Number.parseInt(t,10);if(!Zh(n))return e[n]}},$m=gm({name:"options",initialState:{chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},reducers:{createEventEmitter:e=>{null==e.eventEmitter&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Zm=$m.reducer,{createEventEmitter:Jm}=$m.actions,Qm=s(1688),eg=s(2798),tg=s(800);let ng=function(e){e()};const rg=()=>ng,ig=Symbol.for("react-redux-context"),ag="undefined"!=typeof globalThis?globalThis:{};function og(){var e;if(!r.createContext)return{};const t=null!=(e=ag[ig])?e:ag[ig]=new Map;let n=t.get(r.createContext);return n||(n=r.createContext(null),t.set(r.createContext,n)),n}const sg=og();let lg=null;s(8679),s(2973);const cg={notify(){},get:()=>[]};const ug="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect;let dg=null;const hg=function({store:e,context:t,children:n,serverState:i,stabilityCheck:a="once",noopCheck:o="once"}){const s=r.useMemo((()=>{const t=function(e,t){let n,r=cg,i=0,a=!1;function o(){c.onStateChange&&c.onStateChange()}function s(){i++,n||(n=t?t.addNestedSub(o):e.subscribe(o),r=function(){const e=rg();let t=null,n=null;return{clear(){t=null,n=null},notify(){e((()=>{let e=t;for(;e;)e.callback(),e=e.next}))},get(){let e=[],n=t;for(;n;)e.push(n),n=n.next;return e},subscribe(e){let r=!0,i=n={callback:e,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){r&&null!==t&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}())}function l(){i--,n&&0===i&&(n(),n=void 0,r.clear(),r=cg)}const c={addNestedSub:function(e){s();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),l())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return a},trySubscribe:function(){a||(a=!0,s())},tryUnsubscribe:function(){a&&(a=!1,l())},getListeners:()=>r};return c}(e);return{store:e,subscription:t,getServerState:i?()=>i:void 0,stabilityCheck:a,noopCheck:o}}),[e,i,a,o]),l=r.useMemo((()=>e.getState()),[e]);ug((()=>{const{subscription:t}=s;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),l!==e.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}}),[s,l]);const c=t||sg;return r.createElement(c.Provider,{value:s},n)};function pg(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function fg(e,t){if(pg(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!pg(e[n[r]],t[n[r]]))return!1;return!0}var mg;lg=eg.useSyncExternalStoreWithSelector,(e=>{dg=e})(Qm.useSyncExternalStore),mg=tg.unstable_batchedUpdates,ng=mg;var gg=Symbol.for("immer-nothing"),vg=Symbol.for("immer-draftable"),yg=Symbol.for("immer-state");function xg(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var bg=Object.getPrototypeOf;function _g(e){return!!e&&!!e[yg]}function wg(e){return!!e&&(Eg(e)||Array.isArray(e)||!!e[vg]||!!e.constructor?.[vg]||Rg(e)||Og(e))}var Sg=Object.prototype.constructor.toString(),Mg=new WeakMap;function Eg(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if("function"!=typeof n)return!1;let r=Mg.get(n);return void 0===r&&(r=Function.toString.call(n),Mg.set(n,r)),r===Sg}function Tg(e,t,n=!0){0===Ag(e)?(n?Reflect.ownKeys(e):Object.keys(e)).forEach((n=>{t(n,e[n],e)})):e.forEach(((n,r)=>t(r,n,e)))}function Ag(e){const t=e[yg];return t?t.type_:Array.isArray(e)?1:Rg(e)?2:Og(e)?3:0}function Cg(e,t){return 2===Ag(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Pg(e,t,n){const r=Ag(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Rg(e){return e instanceof Map}function Og(e){return e instanceof Set}function Dg(e){return e.copy_||e.base_}function Ig(e,t){if(Rg(e))return new Map(e);if(Og(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Eg(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[yg];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(bg(e),t)}{const t=bg(e);if(null!==t&&n)return{...e};const r=Object.create(t);return Object.assign(r,e)}}function Lg(e,t=!1){return kg(e)||_g(e)||!wg(e)||(Ag(e)>1&&Object.defineProperties(e,{set:Ng,add:Ng,clear:Ng,delete:Ng}),Object.freeze(e),t&&Object.values(e).forEach((e=>Lg(e,!0)))),e}var Ng={value:function(){xg(2)}};function kg(e){return null===e||"object"!=typeof e||Object.isFrozen(e)}var Ug,Fg={};function zg(e){const t=Fg[e];return t||xg(0),t}function jg(){return Ug}function Bg(e,t){t&&(zg("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Hg(e){Vg(e),e.drafts_.forEach(Wg),e.drafts_=null}function Vg(e){e===Ug&&(Ug=e.parent_)}function Gg(e){return Ug={drafts_:[],parent_:Ug,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Wg(e){const t=e[yg];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Xg(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[yg].modified_&&(Hg(t),xg(4)),wg(e)&&(e=qg(t,e),t.parent_||Kg(t,e)),t.patches_&&zg("Patches").generateReplacementPatches_(n[yg].base_,e,t.patches_,t.inversePatches_)):e=qg(t,n,[]),Hg(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==gg?e:void 0}function qg(e,t,n){if(kg(t))return t;const r=e.immer_.shouldUseStrictIteration(),i=t[yg];if(!i)return Tg(t,((r,a)=>Yg(e,i,t,r,a,n)),r),t;if(i.scope_!==e)return t;if(!i.modified_)return Kg(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const t=i.copy_;let a=t,o=!1;3===i.type_&&(a=new Set(t),t.clear(),o=!0),Tg(a,((r,a)=>Yg(e,i,t,r,a,n,o)),r),Kg(e,t,!1),n&&e.patches_&&zg("Patches").generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function Yg(e,t,n,r,i,a,o){if(null==i)return;if("object"!=typeof i&&!o)return;const s=kg(i);if(!s||o){if(_g(i)){const o=qg(e,i,a&&t&&3!==t.type_&&!Cg(t.assigned_,r)?a.concat(r):void 0);if(Pg(n,r,o),!_g(o))return;e.canAutoFreeze_=!1}else o&&n.add(i);if(wg(i)&&!s){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;if(t&&t.base_&&t.base_[r]===i&&s)return;qg(e,i),t&&t.scope_.parent_||"symbol"==typeof r||!(Rg(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||Kg(e,i)}}}function Kg(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Lg(t,n)}var $g={get(e,t){if(t===yg)return e;const n=Dg(e);if(!Cg(n,t))return function(e,t,n){const r=Qg(t,n);return r?"value"in r?r.value:r.get?.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!wg(r)?r:r===Jg(e.base_,t)?(tv(e),e.copy_[t]=nv(r,e)):r},has:(e,t)=>t in Dg(e),ownKeys:e=>Reflect.ownKeys(Dg(e)),set(e,t,n){const r=Qg(Dg(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=Jg(Dg(e),t),o=r?.[yg];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((i=n)===(a=r)?0!==i||1/i==1/a:i!=i&&a!=a)&&(void 0!==n||Cg(e.base_,t)))return!0;tv(e),ev(e)}var i,a;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==Jg(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,tv(e),ev(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Dg(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){xg(11)},getPrototypeOf:e=>bg(e.base_),setPrototypeOf(){xg(12)}},Zg={};function Jg(e,t){const n=e[yg];return(n?Dg(n):e)[t]}function Qg(e,t){if(!(t in e))return;let n=bg(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=bg(n)}}function ev(e){e.modified_||(e.modified_=!0,e.parent_&&ev(e.parent_))}function tv(e){e.copy_||(e.copy_=Ig(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function nv(e,t){const n=Rg(e)?zg("MapSet").proxyMap_(e,t):Og(e)?zg("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:jg(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,a=$g;n&&(i=[r],a=Zg);const{revoke:o,proxy:s}=Proxy.revocable(i,a);return r.draft_=s,r.revoke_=o,s}(e,t);return(t?t.scope_:jg()).drafts_.push(n),n}function rv(e){if(!wg(e)||kg(e))return e;const t=e[yg];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Ig(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=Ig(e,!0);return Tg(n,((e,t)=>{Pg(n,e,rv(t))}),r),t&&(t.finalized_=!1),n}Tg($g,((e,t)=>{Zg[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Zg.deleteProperty=function(e,t){return Zg.set.call(this,e,t,void 0)},Zg.set=function(e,t,n){return $g.set.call(this,e[0],t,n,e[0])};var iv=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const r=this;return function(e=n,...i){return r.produce(e,(e=>t.call(this,e,...i)))}}let r;if("function"!=typeof t&&xg(6),void 0!==n&&"function"!=typeof n&&xg(7),wg(e)){const i=Gg(this),a=nv(e,void 0);let o=!0;try{r=t(a),o=!1}finally{o?Hg(i):Vg(i)}return Bg(i,n),Xg(r,i)}if(!e||"object"!=typeof e){if(r=t(e),void 0===r&&(r=e),r===gg&&(r=void 0),this.autoFreeze_&&Lg(r,!0),n){const t=[],i=[];zg("Patches").generateReplacementPatches_(e,r,t,i),n(t,i)}return r}xg(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,(t=>e(t,...n)));let n,r;return[this.produce(e,t,((e,t)=>{n=e,r=t})),n,r]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"==typeof e?.useStrictIteration&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){wg(e)||xg(8),_g(e)&&(e=function(e){return _g(e)||xg(10),rv(e)}(e));const t=Gg(this),n=nv(e,void 0);return n[yg].isManual_=!0,Vg(t),n}finishDraft(e,t){const n=e&&e[yg];n&&n.isManual_||xg(9);const{scope_:r}=n;return Bg(r,t),Xg(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=zg("Patches").applyPatches_;return _g(e)?r(e,t):this.produce(e,(e=>r(e,t)))}};iv.produce;var av={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},ov=gm({name:"tooltip",initialState:{itemInteraction:{click:av,hover:av},axisInteraction:{click:av,hover:av},keyboardInteraction:av,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:sm()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:n,next:r}=t.payload,i=zf(e).tooltipItemPayloads.indexOf(n);i>-1&&(e.tooltipItemPayloads[i]=r)},prepare:sm()},removeTooltipEntrySettings:{reducer(e,t){var n=zf(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:sm()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:sv,replaceTooltipEntrySettings:lv,removeTooltipEntrySettings:cv,setTooltipSettingsState:uv,setActiveMouseOverItemIndex:dv,mouseLeaveItem:hv,mouseLeaveChart:pv,setActiveClickItemIndex:fv,setMouseOverAxisIndex:mv,setMouseClickAxisIndex:gv,setSyncInteraction:vv,setKeyboardInteraction:yv}=ov.actions,xv=ov.reducer,bv=gm({name:"chartData",initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,null==t.payload)return e.dataStartIndex=0,void(e.dataEndIndex=0);t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;null!=n&&(e.dataStartIndex=n),null!=r&&(e.dataEndIndex=r)}}}),{setChartData:_v,setDataStartEndIndexes:wv,setComputedData:Sv}=bv.actions,Mv=bv.reducer,Ev=gm({name:"chartLayout",initialState:{layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,r,i,a;e.margin.top=null!==(n=t.payload.top)&&void 0!==n?n:0,e.margin.right=null!==(r=t.payload.right)&&void 0!==r?r:0,e.margin.bottom=null!==(i=t.payload.bottom)&&void 0!==i?i:0,e.margin.left=null!==(a=t.payload.left)&&void 0!==a?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Tv,setLayout:Av,setChartSize:Cv,setScale:Pv}=Ev.actions,Rv=Ev.reducer;var Ov=e=>Array.isArray(e)?e:[e];Symbol(),Object.getPrototypeOf({});var Dv="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}},Iv=0,Lv=1;function Nv(){return{s:Iv,v:void 0,o:null,p:null}}function kv(e,t={}){let n=Nv();const{resultEqualityCheck:r}=t;let i,a=0;function o(){let t=n;const{length:o}=arguments;for(let e=0,n=o;e<n;e++){const n=arguments[e];if("function"==typeof n||"object"==typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=Nv(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=Nv(),e.set(n,t)):t=r}}const s=t;let l;if(t.s===Lv)l=t.v;else if(l=e.apply(null,arguments),a++,r){const e=i?.deref?.()??i;null!=e&&r(e,l)&&(l=e,0!==a&&a--),i="object"==typeof l&&null!==l||"function"==typeof l?new Dv(l):l}return s.s=Lv,s.v=l,l}return o.clearCache=()=>{n=Nv(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function Uv(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t,r=0,i=0,a={},o=e.pop();"object"==typeof o&&(a=o,o=e.pop()),function(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}(o,`createSelector expects an output function after the inputs, but received: [${typeof o}]`);const s={...n,...a},{memoize:l,memoizeOptions:c=[],argsMemoize:u=kv,argsMemoizeOptions:d=[],devModeChecks:h={}}=s,p=Ov(c),f=Ov(d),m=function(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const n=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}(e),g=l((function(){return r++,o.apply(null,arguments)}),...p),v=u((function(){i++;const e=function(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}(m,arguments);return t=g.apply(null,e),t}),...f);return Object.assign(v,{resultFunc:o,memoizedResultFunc:g,dependencies:m,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>t,recomputations:()=>r,resetRecomputations:()=>{r=0},memoize:l,argsMemoize:u})};return Object.assign(r,{withTypes:()=>r}),r}var Fv=Uv(kv),zv=Object.assign(((e,t=Fv)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e),r=t(n.map((t=>e[t])),((...e)=>e.reduce(((e,t,r)=>(e[n[r]]=t,e)),{})));return r}),{withTypes:()=>zv}),jv=(0,r.createContext)(null),Bv=e=>e,Hv=()=>{var e=(0,r.useContext)(jv);return e?e.store.dispatch:Bv},Vv=()=>{},Gv=()=>Vv,Wv=(e,t)=>e===t;function Xv(e){var t=(0,r.useContext)(jv),n=(0,r.useMemo)((()=>t?t=>{if(null!=t)return e(t)}:Vv),[t,e]);return(0,eg.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:Gv,t?t.store.getState:Vv,t?t.store.getState:Vv,n,Wv)}var qv=s(5211),Yv=s.n(qv),Kv=e=>e.legend.settings;function $v(e,t){if((i=e.length)>1)for(var n,r,i,a=1,o=e[t[0]],s=o.length;a<i;++a)for(r=o,o=e[t[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function Zv(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Jv(e){return function(){return e}}function Qv(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function ey(e,t){return e[t]}function ty(e){const t=[];return t.key=e,t}function ny(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function ry(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ry(Object(n),!0).forEach((function(t){ay(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ry(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ay(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oy(e,t,n){return sp(e)||sp(t)?n:ep(t)?Xh()(e,t,n):"function"==typeof t?t(e):n}Fv([e=>e.legend.payload,Kv],((e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?Yv()(r,n):r})),Array.prototype.slice;var sy=(e,t)=>"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t,ly=(e,t,n,r)=>{if(r)return e.map((e=>e.coordinate));var i,a,o=e.map((e=>(e.coordinate===t&&(i=!0),e.coordinate===n&&(a=!0),e.coordinate)));return i||o.push(t),a||o.push(n),o},cy=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:i,range:a,scale:o,realScaleType:s,isCategorical:l,categoricalDomain:c,tickCount:u,ticks:d,niceTicks:h,axisType:p}=e;if(!o)return null;var f="scaleBand"===s&&o.bandwidth?o.bandwidth()/2:2,m=(t||n)&&"category"===i&&o.bandwidth?o.bandwidth()/f:0;return m="angleAxis"===p&&a&&a.length>=2?2*$h(a[0]-a[1])*m:m,t&&(d||h)?(d||h||[]).map(((e,t)=>{var n=r?r.indexOf(e):e,i=o.map(n);return xp(i)?{coordinate:i+m,value:e,offset:m,index:t}:null})).filter(cp):l&&c?c.map(((e,t)=>{var n=o.map(e);return xp(n)?{coordinate:n+m,value:e,index:t,offset:m}:null})).filter(cp):o.ticks&&!n&&null!=u?o.ticks(u).map(((e,t)=>{var n=o.map(e);return xp(n)?{coordinate:n+m,value:e,index:t,offset:m}:null})).filter(cp):o.domain().map(((e,t)=>{var n=o.map(e);return xp(n)?{coordinate:n+m,value:r?r[e]:e,index:t,offset:m}:null})).filter(cp)},uy={sign:e=>{var t,n=e.length;if(!(n<=0)){var r=null===(t=e[0])||void 0===t?void 0:t.length;if(!(null==r||r<=0))for(var i=0;i<r;++i)for(var a=0,o=0,s=0;s<n;++s){var l=e[s],c=null==l?void 0:l[i];if(null!=c){var u=c[1],d=c[0],h=Zh(u)?d:u;h>=0?(c[0]=a,a+=h,c[1]=a):(c[0]=o,o+=h,c[1]=o)}}}},expand:function(e,t){if((r=e.length)>0){for(var n,r,i,a=0,o=e[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}$v(e,t)}},none:$v,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,i=e[t[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=e[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}$v(e,t)}},wiggle:function(e,t){if((i=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,l=0,c=0;s<i;++s){for(var u=e[t[s]],d=u[o][1]||0,h=(d-(u[o-1][1]||0))/2,p=0;p<s;++p){var f=e[t[p]];h+=(f[o][1]||0)-(f[o-1][1]||0)}l+=d,c+=h*d}n[o-1][1]+=n[o-1][0]=a,l&&(a-=c/l)}n[o-1][1]+=n[o-1][0]=a,$v(e,t)}},positive:e=>{var t,n=e.length;if(!(n<=0)){var r=null===(t=e[0])||void 0===t?void 0:t.length;if(!(null==r||r<=0))for(var i=0;i<r;++i)for(var a=0,o=0;o<n;++o){var s=e[o],l=null==s?void 0:s[i];if(null!=l){var c=Zh(l[1])?l[0]:l[1];c>=0?(l[0]=a,a+=c,l[1]=a):(l[0]=0,l[1]=0)}}}}},dy=(e,t,n)=>{var r,i=null!==(r=uy[n])&&void 0!==r?r:$v,a=function(){var e=Jv([]),t=Qv,n=$v,r=ey;function i(i){var a,o,s=Array.from(e.apply(this,arguments),ty),l=s.length,c=-1;for(const e of i)for(a=0,++c;a<l;++a)(s[a][c]=[0,+r(e,s[a].key,c,i)]).data=e;for(a=0,o=Zv(t(s));a<l;++a)s[o[a]].index=a;return n(s,o),s}return i.keys=function(t){return arguments.length?(e="function"==typeof t?t:Jv(Array.from(t)),i):e},i.value=function(e){return arguments.length?(r="function"==typeof e?e:Jv(+e),i):r},i.order=function(e){return arguments.length?(t=null==e?Qv:"function"==typeof e?e:Jv(Array.from(e)),i):t},i.offset=function(e){return arguments.length?(n=null==e?$v:e,i):n},i}().keys(t).value(((e,t)=>Number(oy(e,t,0)))).order(Qv).offset(i),o=a(e);return o.forEach(((n,r)=>{n.forEach(((n,i)=>{var a=oy(e[i],t[r],0);Array.isArray(a)&&2===a.length&&Qh(a[0])&&Qh(a[1])&&(n[0]=a[0],n[1]=a[1])}))})),o};function hy(e){var{axis:t,ticks:n,bandSize:r,entry:i,index:a,dataKey:o}=e;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!sp(i[t.dataKey])){var s=op(n,"value",i[t.dataKey]);if(s)return s.coordinate+r/2}return null!=n&&n[a]?n[a].coordinate+r/2:null}var l=oy(i,sp(o)?t.dataKey:o),c=t.scale.map(l);return Qh(c)?c:null}var py=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,fy=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,my=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var i=Yv()(t,(e=>e.coordinate)),a=1/0,o=1,s=i.length;o<s;o++){var l=i[o],c=i[o-1];a=Math.min(((null==l?void 0:l.coordinate)||0)-((null==c?void 0:c.coordinate)||0),a)}return a===1/0?0:a}return n?void 0:0};function gy(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:i,name:a}=e;return iy(iy({},t),{},{dataKey:n,payload:r,value:i,name:a})}function vy(e,t){return e?String(e):"string"==typeof t?t:void 0}var yy=e=>e.layout.width,xy=e=>e.layout.height,by=e=>e.layout.scale,_y=e=>e.layout.margin,wy=Fv((e=>e.cartesianAxis.xAxis),(e=>Object.values(e))),Sy=Fv((e=>e.cartesianAxis.yAxis),(e=>Object.values(e)));function My(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ey(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?My(Object(n),!0).forEach((function(t){Ty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):My(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ty(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ay=Fv([yy,xy,_y,e=>e.brush.height,function(e){return Sy(e).reduce(((e,t)=>"left"!==t.orientation||t.mirror||t.hide?e:e+("number"==typeof t.width?t.width:60)),0)},function(e){return Sy(e).reduce(((e,t)=>"right"!==t.orientation||t.mirror||t.hide?e:e+("number"==typeof t.width?t.width:60)),0)},function(e){return wy(e).reduce(((e,t)=>"top"!==t.orientation||t.mirror||t.hide?e:e+t.height),0)},function(e){return wy(e).reduce(((e,t)=>"bottom"!==t.orientation||t.mirror||t.hide?e:e+t.height),0)},Kv,e=>e.legend.size],((e,t,n,r,i,a,o,s,l,c)=>{var u={left:(n.left||0)+i,right:(n.right||0)+a},d=Ey(Ey({},{top:(n.top||0)+o,bottom:(n.bottom||0)+s}),u),h=d.bottom;d.bottom+=r,d=((e,t,n)=>{if(t&&n){var{width:r,height:i}=n,{align:a,verticalAlign:o,layout:s}=t;if(("vertical"===s||"horizontal"===s&&"middle"===o)&&"center"!==a&&Qh(e[a]))return iy(iy({},e),{},{[a]:e[a]+(r||0)});if(("horizontal"===s||"vertical"===s&&"center"===a)&&"middle"!==o&&Qh(e[o]))return iy(iy({},e),{},{[o]:e[o]+(i||0)})}return e})(d,l,c);var p=e-d.left-d.right,f=t-d.top-d.bottom;return Ey(Ey({brushBottom:h},d),{},{width:Math.max(p,0),height:Math.max(f,0)})})),Cy=Fv(Ay,(e=>({x:e.left,y:e.top,width:e.width,height:e.height}))),Py=Fv(yy,xy,((e,t)=>({x:0,y:0,width:e,height:t}))),Ry=(0,r.createContext)(null),Oy=()=>null!=(0,r.useContext)(Ry),Dy=e=>e.brush,Iy=Fv([Dy,Ay,_y],((e,t,n)=>({height:e.height,x:Qh(e.x)?e.x:t.left,y:Qh(e.y)?e.y:t.top+t.height+t.brushBottom-((null==n?void 0:n.bottom)||0),width:Qh(e.width)?e.width:t.width})));function Ly(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Ny=()=>{var e,t=Oy(),n=Xv(Cy),r=Xv(Iy),i=null===(e=Xv(Dy))||void 0===e?void 0:e.padding;return t&&r&&i?{width:r.width-i.left-i.right,height:r.height-i.top-i.bottom,x:i.left,y:i.top}:n},ky={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Uy=()=>{var e;return null!==(e=Xv(Ay))&&void 0!==e?e:ky},Fy=()=>Xv(yy),zy=()=>Xv(xy),jy=e=>e.layout.layoutType,By=()=>Xv(jy),Hy=()=>{var e=By();if("horizontal"===e||"vertical"===e)return e},Vy=e=>{var t=e.layout.layoutType;if("centric"===t||"radial"===t)return t},Gy=()=>void 0!==By(),Wy=e=>{var t=Hv(),n=Oy(),{width:i,height:a}=e,o=Ap(),s=i,l=a;return o&&(s=o.width>0?o.width:i,l=o.height>0?o.height:a),(0,r.useEffect)((()=>{!n&&bp(s)&&bp(l)&&t(Cv({width:s,height:l}))}),[t,n,s,l]),null},Xy=s(157),qy=s.n(Xy);function Yy(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Ky(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}class $y extends Map{constructor(e,t=Jy){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(Zy(this,e))}has(e){return super.has(Zy(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}(this,e))}}function Zy({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Jy(e){return null!==e&&"object"==typeof e?e.valueOf():e}const Qy=Symbol("implicit");function ex(){var e=new $y,t=[],n=[],r=Qy;function i(i){let a=e.get(i);if(void 0===a){if(r!==Qy)return r;e.set(i,a=t.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new $y;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return ex(t,n).unknown(r)},Yy.apply(i,arguments),i}function tx(){var e,t,n=ex().unknown(void 0),r=n.domain,i=n.range,a=0,o=1,s=!1,l=0,c=0,u=.5;function d(){var n=r().length,d=o<a,h=d?o:a,p=d?a:o;e=(p-h)/Math.max(1,n-l+2*c),s&&(e=Math.floor(e)),h+=(p-h-e*(n-l))*u,t=e*(1-l),s&&(h=Math.round(h),t=Math.round(t));var f=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a}(n).map((function(t){return h+e*t}));return i(d?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),d()):r()},n.range=function(e){return arguments.length?([a,o]=e,a=+a,o=+o,d()):[a,o]},n.rangeRound=function(e){return[a,o]=e,a=+a,o=+o,s=!0,d()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,d()):s},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),d()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),d()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,d()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},n.copy=function(){return tx(r(),[a,o]).round(s).paddingInner(l).paddingOuter(c).align(u)},Yy.apply(d(),arguments)}function nx(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return nx(t())},e}function rx(){return nx(tx.apply(null,arguments).paddingInner(1))}const ix=Math.sqrt(50),ax=Math.sqrt(10),ox=Math.sqrt(2);function sx(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=ix?10:a>=ax?5:a>=ox?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?sx(e,t,2*n):[s,l,c]}function lx(e,t,n){if(!((n=+n)>0))return[];if((e=+e)==(t=+t))return[e];const r=t<e,[i,a,o]=r?sx(t,e,n):sx(e,t,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let e=0;e<s;++e)l[e]=(a-e)/-o;else for(let e=0;e<s;++e)l[e]=(a-e)*o;else if(o<0)for(let e=0;e<s;++e)l[e]=(i+e)/-o;else for(let e=0;e<s;++e)l[e]=(i+e)*o;return l}function cx(e,t,n){return sx(e=+e,t=+t,n=+n)[2]}function ux(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?cx(t,e,n):cx(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function dx(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hx(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function px(e){let t,n,r;function i(e,r,i=0,a=e.length){if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<0?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=dx,n=(t,n)=>dx(e(t),n),r=(t,n)=>e(t)-n):(t=e===dx||e===hx?e:fx,n=e,r=e),{left:i,center:function(e,t,n=0,a=e.length){const o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r,i=0,a=e.length){if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<=0?i=t+1:a=t}while(i<a)}return i}}}function fx(){return 0}function mx(e){return null===e?NaN:+e}const gx=px(dx),vx=gx.right,yx=(gx.left,px(mx).center,vx);function xx(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function bx(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _x(){}var wx=.7,Sx=1/wx,Mx="\\s*([+-]?\\d+)\\s*",Ex="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ax=/^#([0-9a-f]{3,8})$/,Cx=new RegExp(`^rgb\\(${Mx},${Mx},${Mx}\\)$`),Px=new RegExp(`^rgb\\(${Tx},${Tx},${Tx}\\)$`),Rx=new RegExp(`^rgba\\(${Mx},${Mx},${Mx},${Ex}\\)$`),Ox=new RegExp(`^rgba\\(${Tx},${Tx},${Tx},${Ex}\\)$`),Dx=new RegExp(`^hsl\\(${Ex},${Tx},${Tx}\\)$`),Ix=new RegExp(`^hsla\\(${Ex},${Tx},${Tx},${Ex}\\)$`),Lx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Nx(){return this.rgb().formatHex()}function kx(){return this.rgb().formatRgb()}function Ux(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ax.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Fx(t):3===n?new Bx(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?zx(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?zx(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Cx.exec(e))?new Bx(t[1],t[2],t[3],1):(t=Px.exec(e))?new Bx(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Rx.exec(e))?zx(t[1],t[2],t[3],t[4]):(t=Ox.exec(e))?zx(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Dx.exec(e))?qx(t[1],t[2]/100,t[3]/100,1):(t=Ix.exec(e))?qx(t[1],t[2]/100,t[3]/100,t[4]):Lx.hasOwnProperty(e)?Fx(Lx[e]):"transparent"===e?new Bx(NaN,NaN,NaN,0):null}function Fx(e){return new Bx(e>>16&255,e>>8&255,255&e,1)}function zx(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bx(e,t,n,r)}function jx(e,t,n,r){return 1===arguments.length?((i=e)instanceof _x||(i=Ux(i)),i?new Bx((i=i.rgb()).r,i.g,i.b,i.opacity):new Bx):new Bx(e,t,n,null==r?1:r);var i}function Bx(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Hx(){return`#${Xx(this.r)}${Xx(this.g)}${Xx(this.b)}`}function Vx(){const e=Gx(this.opacity);return`${1===e?"rgb(":"rgba("}${Wx(this.r)}, ${Wx(this.g)}, ${Wx(this.b)}${1===e?")":`, ${e})`}`}function Gx(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Wx(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Xx(e){return((e=Wx(e))<16?"0":"")+e.toString(16)}function qx(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Kx(e,t,n,r)}function Yx(e){if(e instanceof Kx)return new Kx(e.h,e.s,e.l,e.opacity);if(e instanceof _x||(e=Ux(e)),!e)return new Kx;if(e instanceof Kx)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Kx(o,s,l,e.opacity)}function Kx(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function $x(e){return(e=(e||0)%360)<0?e+360:e}function Zx(e){return Math.max(0,Math.min(1,e||0))}function Jx(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Qx(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}xx(_x,Ux,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Nx,formatHex:Nx,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Yx(this).formatHsl()},formatRgb:kx,toString:kx}),xx(Bx,jx,bx(_x,{brighter(e){return e=null==e?Sx:Math.pow(Sx,e),new Bx(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?wx:Math.pow(wx,e),new Bx(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bx(Wx(this.r),Wx(this.g),Wx(this.b),Gx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Hx,formatHex:Hx,formatHex8:function(){return`#${Xx(this.r)}${Xx(this.g)}${Xx(this.b)}${Xx(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Vx,toString:Vx})),xx(Kx,(function(e,t,n,r){return 1===arguments.length?Yx(e):new Kx(e,t,n,null==r?1:r)}),bx(_x,{brighter(e){return e=null==e?Sx:Math.pow(Sx,e),new Kx(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?wx:Math.pow(wx,e),new Kx(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Bx(Jx(e>=240?e-240:e+120,i,r),Jx(e,i,r),Jx(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Kx($x(this.h),Zx(this.s),Zx(this.l),Gx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Gx(this.opacity);return`${1===e?"hsl(":"hsla("}${$x(this.h)}, ${100*Zx(this.s)}%, ${100*Zx(this.l)}%${1===e?")":`, ${e})`}`}}));const eb=e=>()=>e;function tb(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):eb(isNaN(e)?t:e)}const nb=function e(t){var n=function(e){return 1==(e=+e)?tb:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):eb(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=jx(e)).r,(t=jx(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=tb(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function rb(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=jx(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}function ib(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=hb(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function ab(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ob(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function sb(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=hb(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}rb((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return Qx((n-r/t)*t,o,i,a,s)}})),rb((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Qx((n-r/t)*t,i,a,o,s)}}));var lb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cb=new RegExp(lb.source,"g");function ub(e,t){var n,r,i,a=lb.lastIndex=cb.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=lb.exec(e))&&(r=cb.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:ob(n,r)})),a=cb.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function db(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function hb(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?eb(t):("number"===i?ob:"string"===i?(n=Ux(t))?(t=n,nb):ub:t instanceof Ux?nb:t instanceof Date?ab:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?ib:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?sb:ob:db))(e,t)}function pb(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function fb(e){return+e}var mb=[0,1];function gb(e){return e}function vb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function yb(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=vb(i,r),a=n(o,a)):(r=vb(r,i),a=n(a,o)),function(e){return a(r(e))}}function xb(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=vb(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=yx(e,t,1,r)-1;return a[n](i[n](t))}}function bb(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function _b(){var e,t,n,r,i,a,o=mb,s=mb,l=hb,c=gb;function u(){var e,t,n,l=Math.min(o.length,s.length);return c!==gb&&(e=o[0],t=o[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=l>2?xb:yb,i=a=null,d}function d(t){return null==t||isNaN(t=+t)?n:(i||(i=r(o.map(e),s,l)))(e(c(t)))}return d.invert=function(n){return c(t((a||(a=r(s,o.map(e),ob)))(n)))},d.domain=function(e){return arguments.length?(o=Array.from(e,fb),u()):o.slice()},d.range=function(e){return arguments.length?(s=Array.from(e),u()):s.slice()},d.rangeRound=function(e){return s=Array.from(e),l=pb,u()},d.clamp=function(e){return arguments.length?(c=!!e||gb,u()):c!==gb},d.interpolate=function(e){return arguments.length?(l=e,u()):l},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,r){return e=n,t=r,u()}}function wb(){return _b()(gb,gb)}var Sb,Mb=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Eb(e){if(!(t=Mb.exec(e)))throw new Error("invalid format: "+e);var t;return new Tb({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Tb(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ab(e,t){if(!isFinite(e)||0===e)return null;var n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Cb(e){return(e=Ab(Math.abs(e)))?e[1]:NaN}function Pb(e,t){var n=Ab(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Eb.prototype=Tb.prototype,Tb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Rb={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Pb(100*e,t),r:Pb,s:function(e,t){var n=Ab(e,t);if(!n)return Sb=void 0,e.toPrecision(t);var r=n[0],i=n[1],a=i-(Sb=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ab(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Ob(e){return e}var Db,Ib,Lb,Nb=Array.prototype.map,kb=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ub(e,t,n,r){var i,a=ux(e,t,n);switch((r=Eb(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Cb(t)/3)))-Cb(Math.abs(e)))}(a,o))||(r.precision=i),Lb(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Cb(t)-Cb(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-Cb(Math.abs(e)))}(a))||(r.precision=i-2*("%"===r.type))}return Ib(r)}function Fb(e){var t=e.domain;return e.ticks=function(e){var n=t();return lx(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Ub(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,a=t(),o=0,s=a.length-1,l=a[o],c=a[s],u=10;for(c<l&&(i=l,l=c,c=i,i=o,o=s,s=i);u-- >0;){if((i=cx(l,c,n))===r)return a[o]=l,a[s]=c,t(a);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return e},e}function zb(){var e=wb();return e.copy=function(){return bb(e,zb())},Yy.apply(e,arguments),Fb(e)}function jb(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,fb),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return jb(e).unknown(t)},e=arguments.length?Array.from(e,fb):[0,1],Fb(n)}function Bb(e,t){var n,r=0,i=(e=e.slice()).length-1,a=e[r],o=e[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),e[r]=t.floor(a),e[i]=t.ceil(o),e}function Hb(e){return Math.log(e)}function Vb(e){return Math.exp(e)}function Gb(e){return-Math.log(-e)}function Wb(e){return-Math.exp(-e)}function Xb(e){return isFinite(e)?+("1e"+e):e<0?0:e}function qb(e){return(t,n)=>-e(-t,n)}function Yb(e){const t=e(Hb,Vb),n=t.domain;let r,i,a=10;function o(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(a),i=function(e){return 10===e?Xb:e===Math.E?Math.exp:t=>Math.pow(e,t)}(a),n()[0]<0?(r=qb(r),i=qb(i),e(Gb,Wb)):e(Hb,Vb),t}return t.base=function(e){return arguments.length?(a=+e,o()):a},t.domain=function(e){return arguments.length?(n(e),o()):n()},t.ticks=e=>{const t=n();let o=t[0],s=t[t.length-1];const l=s<o;l&&([o,s]=[s,o]);let c,u,d=r(o),h=r(s);const p=null==e?10:+e;let f=[];if(!(a%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),o>0){for(;d<=h;++d)for(c=1;c<a;++c)if(u=d<0?c/i(-d):c*i(d),!(u<o)){if(u>s)break;f.push(u)}}else for(;d<=h;++d)for(c=a-1;c>=1;--c)if(u=d>0?c/i(-d):c*i(d),!(u<o)){if(u>s)break;f.push(u)}2*f.length<p&&(f=lx(o,s,p))}else f=lx(d,h,Math.min(h-d,p)).map(i);return l?f.reverse():f},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===a?"s":","),"function"!=typeof n&&(a%1||null!=(n=Eb(n)).precision||(n.trim=!0),n=Ib(n)),e===1/0)return n;const o=Math.max(1,a*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*a<a-.5&&(t*=a),t<=o?n(e):""}},t.nice=()=>n(Bb(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function Kb(){const e=Yb(_b()).domain([1,10]);return e.copy=()=>bb(e,Kb()).base(e.base()),Yy.apply(e,arguments),e}function $b(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Zb(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Jb(e){var t=1,n=e($b(t),Zb(t));return n.constant=function(n){return arguments.length?e($b(t=+n),Zb(t)):t},Fb(n)}function Qb(){var e=Jb(_b());return e.copy=function(){return bb(e,Qb()).constant(e.constant())},Yy.apply(e,arguments)}function e_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function t_(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function n_(e){return e<0?-e*e:e*e}function r_(e){var t=e(gb,gb),n=1;return t.exponent=function(t){return arguments.length?1==(n=+t)?e(gb,gb):.5===n?e(t_,n_):e(e_(n),e_(1/n)):n},Fb(t)}function i_(){var e=r_(_b());return e.copy=function(){return bb(e,i_()).exponent(e.exponent())},Yy.apply(e,arguments),e}function a_(){return i_.apply(null,arguments).exponent(.5)}function o_(e){return Math.sign(e)*e*e}function s_(){var e,t=wb(),n=[0,1],r=!1;function i(n){var i=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(i)?e:r?Math.round(i):i}return i.invert=function(e){return t.invert(o_(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain()},i.range=function(e){return arguments.length?(t.range((n=Array.from(e,fb)).map(o_)),i):n.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(r=!!e,i):r},i.clamp=function(e){return arguments.length?(t.clamp(e),i):t.clamp()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return s_(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},Yy.apply(i,arguments),Fb(i)}function l_(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function c_(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function u_(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function d_(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=void 0===i?u_:function(e=dx){if(e===dx)return u_;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}(i);r>n;){if(r-n>600){const a=r-n+1,o=t-n+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);d_(e,t,Math.max(n,Math.floor(t-o*l/a+c)),Math.min(r,Math.floor(t+(a-o)*l/a+c)),i)}const a=e[t];let o=n,s=r;for(h_(e,n,t),i(e[r],a)>0&&h_(e,n,r);o<s;){for(h_(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}0===i(e[n],a)?h_(e,n,s):(++s,h_(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function h_(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function p_(e,t,n=mx){if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e);return o+(+n(e[a+1],a+1,e)-o)*(i-a)}}function f_(){var e,t=[],n=[],r=[];function i(){var e=0,i=Math.max(1,n.length);for(r=new Array(i-1);++e<i;)r[e-1]=p_(t,e/i);return a}function a(t){return null==t||isNaN(t=+t)?e:n[yx(r,t)]}return a.invertExtent=function(e){var i=n.indexOf(e);return i<0?[NaN,NaN]:[i>0?r[i-1]:t[0],i<r.length?r[i]:t[t.length-1]]},a.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(dx),i()},a.range=function(e){return arguments.length?(n=Array.from(e),i()):n.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return r.slice()},a.copy=function(){return f_().domain(t).range(n).unknown(e)},Yy.apply(a,arguments)}function m_(){var e,t=0,n=1,r=1,i=[.5],a=[0,1];function o(t){return null!=t&&t<=t?a[yx(i,t,0,r)]:e}function s(){var e=-1;for(i=new Array(r);++e<r;)i[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,s()):[t,n]},o.range=function(e){return arguments.length?(r=(a=Array.from(e)).length-1,s()):a.slice()},o.invertExtent=function(e){var o=a.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return m_().domain([t,n]).range(a).unknown(e)},Yy.apply(Fb(o),arguments)}function g_(){var e,t=[.5],n=[0,1],r=1;function i(i){return null!=i&&i<=i?n[yx(t,i,0,r)]:e}return i.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return g_().domain(t).range(n).unknown(e)},Yy.apply(i,arguments)}Db=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Ob:(t=Nb.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Ob:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Nb.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"−":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e,t){var n=(e=Eb(e)).fill,d=e.align,h=e.sign,p=e.symbol,f=e.zero,m=e.width,g=e.comma,v=e.precision,y=e.trim,x=e.type;"n"===x?(g=!0,x="g"):Rb[x]||(void 0===v&&(v=12),y=!0,x="g"),(f||"0"===n&&"="===d)&&(f=!0,n="0",d="=");var b=(t&&void 0!==t.prefix?t.prefix:"")+("$"===p?i:"#"===p&&/[boxX]/.test(x)?"0"+x.toLowerCase():""),_=("$"===p?a:/[%p]/.test(x)?l:"")+(t&&void 0!==t.suffix?t.suffix:""),w=Rb[x],S=/[defgprs%]/.test(x);function M(e){var t,i,a,l=b,p=_;if("c"===x)p=w(e)+p,e="";else{var M=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:w(Math.abs(e),v),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),M&&0==+e&&"+"!==h&&(M=!1),l=(M?"("===h?h:c:"-"===h||"("===h?"":h)+l,p=("s"!==x||isNaN(e)||void 0===Sb?"":kb[8+Sb/3])+p+(M&&"("===h?")":""),S)for(t=-1,i=e.length;++t<i;)if(48>(a=e.charCodeAt(t))||a>57){p=(46===a?o+e.slice(t+1):e.slice(t))+p,e=e.slice(0,t);break}}g&&!f&&(e=r(e,1/0));var E=l.length+e.length+p.length,T=E<m?new Array(m-E+1).join(n):"";switch(g&&f&&(e=r(T+e,T.length?m-p.length:1/0),T=""),d){case"<":e=l+e+p+T;break;case"=":e=l+T+e+p;break;case"^":e=T.slice(0,E=T.length>>1)+l+e+p+T.slice(E);break;default:e=T+l+e+p}return s(e)}return v=void 0===v?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return e+""},M}return{format:d,formatPrefix:function(e,t){var n=3*Math.max(-8,Math.min(8,Math.floor(Cb(t)/3))),r=Math.pow(10,-n),i=d(((e=Eb(e)).type="f",e),{suffix:kb[8+n/3]});return function(e){return i(r*e)}}}}({thousands:",",grouping:[3],currency:["$",""]}),Ib=Db.format,Lb=Db.formatPrefix;const v_=1e3,y_=6e4,x_=36e5,b_=864e5,__=6048e5,w_=31536e6,S_=new Date,M_=new Date;function E_(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,a)=>{const o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return o;let s;do{o.push(s=new Date(+n)),t(n,a),e(n)}while(s<n&&n<r);return o},i.filter=n=>E_((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(S_.setTime(+t),M_.setTime(+r),e(S_),e(M_),Math.floor(n(S_,M_))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const T_=E_((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));T_.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?E_((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):T_:null),T_.range;const A_=E_((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*v_)}),((e,t)=>(t-e)/v_),(e=>e.getUTCSeconds())),C_=(A_.range,E_((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*v_)}),((e,t)=>{e.setTime(+e+t*y_)}),((e,t)=>(t-e)/y_),(e=>e.getMinutes()))),P_=(C_.range,E_((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*y_)}),((e,t)=>(t-e)/y_),(e=>e.getUTCMinutes()))),R_=(P_.range,E_((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*v_-e.getMinutes()*y_)}),((e,t)=>{e.setTime(+e+t*x_)}),((e,t)=>(t-e)/x_),(e=>e.getHours()))),O_=(R_.range,E_((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*x_)}),((e,t)=>(t-e)/x_),(e=>e.getUTCHours()))),D_=(O_.range,E_((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*y_)/b_),(e=>e.getDate()-1))),I_=(D_.range,E_((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/b_),(e=>e.getUTCDate()-1))),L_=(I_.range,E_((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/b_),(e=>Math.floor(e/b_))));function N_(e){return E_((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*y_)/__))}L_.range;const k_=N_(0),U_=N_(1),F_=N_(2),z_=N_(3),j_=N_(4),B_=N_(5),H_=N_(6);function V_(e){return E_((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/__))}k_.range,U_.range,F_.range,z_.range,j_.range,B_.range,H_.range;const G_=V_(0),W_=V_(1),X_=V_(2),q_=V_(3),Y_=V_(4),K_=V_(5),$_=V_(6),Z_=(G_.range,W_.range,X_.range,q_.range,Y_.range,K_.range,$_.range,E_((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth()))),J_=(Z_.range,E_((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),Q_=(J_.range,E_((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));Q_.every=e=>isFinite(e=Math.floor(e))&&e>0?E_((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,Q_.range;const ew=E_((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function tw(e,t,n,r,i,a){const o=[[A_,1,v_],[A_,5,5e3],[A_,15,15e3],[A_,30,3e4],[a,1,y_],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,x_],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,b_],[r,2,1728e5],[n,1,__],[t,1,2592e6],[t,3,7776e6],[e,1,w_]];function s(t,n,r){const i=Math.abs(n-t)/r,a=px((([,,e])=>e)).right(o,i);if(a===o.length)return e.every(ux(t/w_,n/w_,r));if(0===a)return T_.every(Math.max(ux(t,n,r),1));const[s,l]=o[i/o[a-1][2]<o[a][2]/i?a-1:a];return s.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),a=i?i.range(e,+t+1):[];return r?a.reverse():a},s]}ew.every=e=>isFinite(e=Math.floor(e))&&e>0?E_((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,ew.range;const[nw,rw]=tw(ew,J_,G_,L_,O_,P_),[iw,aw]=tw(Q_,Z_,k_,D_,R_,C_);function ow(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function sw(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function lw(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var cw,uw,dw,hw={"-":"",_:" ",0:"0"},pw=/^\s*\d+/,fw=/^%/,mw=/[\\^$*+?|[\]().{}]/g;function gw(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function vw(e){return e.replace(mw,"\\$&")}function yw(e){return new RegExp("^(?:"+e.map(vw).join("|")+")","i")}function xw(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function bw(e,t,n){var r=pw.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function _w(e,t,n){var r=pw.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ww(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Sw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Mw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Ew(e,t,n){var r=pw.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Tw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Aw(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Cw(e,t,n){var r=pw.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Pw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Rw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Ow(e,t,n){var r=pw.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Dw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Iw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Lw(e,t,n){var r=pw.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Nw(e,t,n){var r=pw.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function kw(e,t,n){var r=pw.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Uw(e,t,n){var r=fw.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Fw(e,t,n){var r=pw.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function zw(e,t,n){var r=pw.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function jw(e,t){return gw(e.getDate(),t,2)}function Bw(e,t){return gw(e.getHours(),t,2)}function Hw(e,t){return gw(e.getHours()%12||12,t,2)}function Vw(e,t){return gw(1+D_.count(Q_(e),e),t,3)}function Gw(e,t){return gw(e.getMilliseconds(),t,3)}function Ww(e,t){return Gw(e,t)+"000"}function Xw(e,t){return gw(e.getMonth()+1,t,2)}function qw(e,t){return gw(e.getMinutes(),t,2)}function Yw(e,t){return gw(e.getSeconds(),t,2)}function Kw(e){var t=e.getDay();return 0===t?7:t}function $w(e,t){return gw(k_.count(Q_(e)-1,e),t,2)}function Zw(e){var t=e.getDay();return t>=4||0===t?j_(e):j_.ceil(e)}function Jw(e,t){return e=Zw(e),gw(j_.count(Q_(e),e)+(4===Q_(e).getDay()),t,2)}function Qw(e){return e.getDay()}function eS(e,t){return gw(U_.count(Q_(e)-1,e),t,2)}function tS(e,t){return gw(e.getFullYear()%100,t,2)}function nS(e,t){return gw((e=Zw(e)).getFullYear()%100,t,2)}function rS(e,t){return gw(e.getFullYear()%1e4,t,4)}function iS(e,t){var n=e.getDay();return gw((e=n>=4||0===n?j_(e):j_.ceil(e)).getFullYear()%1e4,t,4)}function aS(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+gw(t/60|0,"0",2)+gw(t%60,"0",2)}function oS(e,t){return gw(e.getUTCDate(),t,2)}function sS(e,t){return gw(e.getUTCHours(),t,2)}function lS(e,t){return gw(e.getUTCHours()%12||12,t,2)}function cS(e,t){return gw(1+I_.count(ew(e),e),t,3)}function uS(e,t){return gw(e.getUTCMilliseconds(),t,3)}function dS(e,t){return uS(e,t)+"000"}function hS(e,t){return gw(e.getUTCMonth()+1,t,2)}function pS(e,t){return gw(e.getUTCMinutes(),t,2)}function fS(e,t){return gw(e.getUTCSeconds(),t,2)}function mS(e){var t=e.getUTCDay();return 0===t?7:t}function gS(e,t){return gw(G_.count(ew(e)-1,e),t,2)}function vS(e){var t=e.getUTCDay();return t>=4||0===t?Y_(e):Y_.ceil(e)}function yS(e,t){return e=vS(e),gw(Y_.count(ew(e),e)+(4===ew(e).getUTCDay()),t,2)}function xS(e){return e.getUTCDay()}function bS(e,t){return gw(W_.count(ew(e)-1,e),t,2)}function _S(e,t){return gw(e.getUTCFullYear()%100,t,2)}function wS(e,t){return gw((e=vS(e)).getUTCFullYear()%100,t,2)}function SS(e,t){return gw(e.getUTCFullYear()%1e4,t,4)}function MS(e,t){var n=e.getUTCDay();return gw((e=n>=4||0===n?Y_(e):Y_.ceil(e)).getUTCFullYear()%1e4,t,4)}function ES(){return"+0000"}function TS(){return"%"}function AS(e){return+e}function CS(e){return Math.floor(+e/1e3)}function PS(e){return new Date(e)}function RS(e){return e instanceof Date?+e:+new Date(+e)}function OS(e,t,n,r,i,a,o,s,l,c){var u=wb(),d=u.invert,h=u.domain,p=c(".%L"),f=c(":%S"),m=c("%I:%M"),g=c("%I %p"),v=c("%a %d"),y=c("%b %d"),x=c("%B"),b=c("%Y");function _(e){return(l(e)<e?p:s(e)<e?f:o(e)<e?m:a(e)<e?g:r(e)<e?i(e)<e?v:y:n(e)<e?x:b)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?h(Array.from(e,RS)):h().map(PS)},u.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?_:c(t)},u.nice=function(e){var n=h();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(Bb(n,e)):u},u.copy=function(){return bb(u,OS(e,t,n,r,i,a,o,s,l,c))},u}function DS(){return Yy.apply(OS(iw,aw,Q_,Z_,k_,D_,R_,C_,A_,uw).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IS(){return Yy.apply(OS(nw,rw,ew,J_,G_,I_,O_,P_,A_,dw).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function LS(){var e,t,n,r,i,a=0,o=1,s=gb,l=!1;function c(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),c):[s(0),s(1)]}}return c.domain=function(i){return arguments.length?([a,o]=i,e=r(a=+a),t=r(o=+o),n=e===t?0:1/(t-e),c):[a,o]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=u(hb),c.rangeRound=u(pb),c.unknown=function(e){return arguments.length?(i=e,c):i},function(i){return r=i,e=i(a),t=i(o),n=e===t?0:1/(t-e),c}}function NS(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function kS(){var e=Fb(LS()(gb));return e.copy=function(){return NS(e,kS())},Ky.apply(e,arguments)}function US(){var e=Yb(LS()).domain([1,10]);return e.copy=function(){return NS(e,US()).base(e.base())},Ky.apply(e,arguments)}function FS(){var e=Jb(LS());return e.copy=function(){return NS(e,FS()).constant(e.constant())},Ky.apply(e,arguments)}function zS(){var e=r_(LS());return e.copy=function(){return NS(e,zS()).exponent(e.exponent())},Ky.apply(e,arguments)}function jS(){return zS.apply(null,arguments).exponent(.5)}function BS(){var e=[],t=gb;function n(n){if(null!=n&&!isNaN(n=+n))return t((yx(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(dx),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map(((n,r)=>t(r/(e.length-1))))},n.quantiles=function(t){return Array.from({length:t+1},((n,r)=>function(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return c_(e);if(t>=1)return l_(e);var r,i=(r-1)*t,a=Math.floor(i),o=l_(d_(e,a).subarray(0,a+1));return o+(c_(e.subarray(a+1))-o)*(i-a)}}(e,r/t)))},n.copy=function(){return BS(t).domain(e)},Ky.apply(n,arguments)}function HS(){var e,t,n,r,i,a,o,s=0,l=.5,c=1,u=1,d=gb,h=!1;function p(e){return isNaN(e=+e)?o:(e=.5+((e=+a(e))-t)*(u*e<u*t?r:i),d(h?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,d=function(e,t){void 0===t&&(t=e,e=hb);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}(e,[n,r,i]),p):[d(0),d(.5),d(1)]}}return p.domain=function(o){return arguments.length?([s,l,c]=o,e=a(s=+s),t=a(l=+l),n=a(c=+c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),u=t<e?-1:1,p):[s,l,c]},p.clamp=function(e){return arguments.length?(h=!!e,p):h},p.interpolator=function(e){return arguments.length?(d=e,p):d},p.range=f(hb),p.rangeRound=f(pb),p.unknown=function(e){return arguments.length?(o=e,p):o},function(o){return a=o,e=o(s),t=o(l),n=o(c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),u=t<e?-1:1,p}}function VS(){var e=Fb(HS()(gb));return e.copy=function(){return NS(e,VS())},Ky.apply(e,arguments)}function GS(){var e=Yb(HS()).domain([.1,1,10]);return e.copy=function(){return NS(e,GS()).base(e.base())},Ky.apply(e,arguments)}function WS(){var e=Jb(HS());return e.copy=function(){return NS(e,WS()).constant(e.constant())},Ky.apply(e,arguments)}function XS(){var e=r_(HS());return e.copy=function(){return NS(e,XS()).exponent(e.exponent())},Ky.apply(e,arguments)}function qS(){return XS.apply(null,arguments).exponent(.5)}cw=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=yw(i),u=xw(i),d=yw(a),h=xw(a),p=yw(o),f=xw(o),m=yw(s),g=xw(s),v=yw(l),y=xw(l),x={a:function(e){return o[e.getDay()]},A:function(e){return a[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:jw,e:jw,f:Ww,g:nS,G:iS,H:Bw,I:Hw,j:Vw,L:Gw,m:Xw,M:qw,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:AS,s:CS,S:Yw,u:Kw,U:$w,V:Jw,w:Qw,W:eS,x:null,X:null,y:tS,Y:rS,Z:aS,"%":TS},b={a:function(e){return o[e.getUTCDay()]},A:function(e){return a[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:oS,e:oS,f:dS,g:wS,G:MS,H:sS,I:lS,j:cS,L:uS,m:hS,M:pS,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:AS,s:CS,S:fS,u:mS,U:gS,V:yS,w:xS,W:bS,x:null,X:null,y:_S,Y:SS,Z:ES,"%":TS},_={a:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return M(e,t,n,r)},d:Rw,e:Rw,f:kw,g:Tw,G:Ew,H:Dw,I:Dw,j:Ow,L:Nw,m:Pw,M:Iw,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:Cw,Q:Fw,s:zw,S:Lw,u:_w,U:ww,V:Sw,w:bw,W:Mw,x:function(e,t,r){return M(e,n,t,r)},X:function(e,t,n){return M(e,r,t,n)},y:Tw,Y:Ew,Z:Aw,"%":Uw};function w(e,t){return function(n){var r,i,a,o=[],s=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(o.push(e.slice(l,s)),null!=(i=hw[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(a=t[r])&&(r=a(n,i)),o.push(r),l=s+1);return o.push(e.slice(l,s)),o.join("")}}function S(e,t){return function(n){var r,i,a=lw(1900,void 0,1);if(M(a,e,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(t&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=sw(lw(a.y,0,1))).getUTCDay(),r=i>4||0===i?W_.ceil(r):W_(r),r=I_.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=ow(lw(a.y,0,1))).getDay(),r=i>4||0===i?U_.ceil(r):U_(r),r=D_.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?sw(lw(a.y,0,1)).getUTCDay():ow(lw(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,sw(a)):ow(a)}}function M(e,t,n,r){for(var i,a,o=0,s=t.length,l=n.length;o<s;){if(r>=l)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(a=_[i in hw?t.charAt(o++):i])||(r=a(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),{format:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),uw=cw.format,cw.parse,dw=cw.utcFormat,cw.utcParse;var YS=e=>e.chartData,KS=Fv([YS],(e=>{var t=null!=e.chartData?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}})),$S=(e,t,n,r)=>r?KS(e):YS(e);function ZS(e){if(Array.isArray(e)&&2===e.length){var[t,n]=e;if(xp(t)&&xp(n))return!0}return!1}function JS(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function QS(e,t){if(t&&"function"!=typeof e&&Array.isArray(e)&&2===e.length){var n,r,[i,a]=e;if(xp(i))n=i;else if("function"==typeof i)return;if(xp(a))r=a;else if("function"==typeof a)return;var o=[n,r];if(ZS(o))return o}}var eM,tM=1e9,nM=!0,rM="[DecimalError] ",iM=rM+"Invalid argument: ",aM=rM+"Exponent out of range: ",oM=Math.floor,sM=Math.pow,lM=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,cM=1e7,uM=7,dM=9007199254740991,hM=oM(dM/uM),pM={};function fM(e,t){var n,r,i,a,o,s,l,c,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),nM?MM(t,d):t;if(l=e.d,c=t.d,o=e.e,i=t.e,l=l.slice(),a=o-i){for(a<0?(r=l,a=-a,s=c.length):(r=c,i=o,s=l.length),a>(s=(o=Math.ceil(d/uM))>s?o+1:s+1)&&(a=s,r.length=1),r.reverse();a--;)r.push(0);r.reverse()}for((s=l.length)-(a=c.length)<0&&(a=s,r=c,c=l,l=r),n=0;a;)n=(l[--a]=l[a]+c[a]+n)/cM|0,l[a]%=cM;for(n&&(l.unshift(n),++i),s=l.length;0==l[--s];)l.pop();return t.d=l,t.e=i,nM?MM(t,d):t}function mM(e,t,n){if(e!==~~e||e<t||e>n)throw Error(iM+e)}function gM(e){var t,n,r,i=e.length-1,a="",o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)r=e[t]+"",(n=uM-r.length)&&(a+=_M(n)),a+=r;o=e[t],(n=uM-(r=o+"").length)&&(a+=_M(n))}else if(0===o)return"0";for(;o%10==0;)o/=10;return a+o}pM.absoluteValue=pM.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},pM.comparedTo=pM.cmp=function(e){var t,n,r,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(t=0,n=(r=a.d.length)<(i=e.d.length)?r:i;t<n;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return r===i?0:r>i^a.s<0?1:-1},pM.decimalPlaces=pM.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*uM;if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},pM.dividedBy=pM.div=function(e){return vM(this,new this.constructor(e))},pM.dividedToIntegerBy=pM.idiv=function(e){var t=this.constructor;return MM(vM(this,new t(e),0,1),t.precision)},pM.equals=pM.eq=function(e){return!this.cmp(e)},pM.exponent=function(){return xM(this)},pM.greaterThan=pM.gt=function(e){return this.cmp(e)>0},pM.greaterThanOrEqualTo=pM.gte=function(e){return this.cmp(e)>=0},pM.isInteger=pM.isint=function(){return this.e>this.d.length-2},pM.isNegative=pM.isneg=function(){return this.s<0},pM.isPositive=pM.ispos=function(){return this.s>0},pM.isZero=function(){return 0===this.s},pM.lessThan=pM.lt=function(e){return this.cmp(e)<0},pM.lessThanOrEqualTo=pM.lte=function(e){return this.cmp(e)<1},pM.logarithm=pM.log=function(e){var t,n=this,r=n.constructor,i=r.precision,a=i+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(eM))throw Error(rM+"NaN");if(n.s<1)throw Error(rM+(n.s?"NaN":"-Infinity"));return n.eq(eM)?new r(0):(nM=!1,t=vM(wM(n,a),wM(e,a),a),nM=!0,MM(t,i))},pM.minus=pM.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?EM(t,e):fM(t,(e.s=-e.s,e))},pM.modulo=pM.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(!(e=new r(e)).s)throw Error(rM+"NaN");return n.s?(nM=!1,t=vM(n,e,0,1).times(e),nM=!0,n.minus(t)):MM(new r(n),i)},pM.naturalExponential=pM.exp=function(){return yM(this)},pM.naturalLogarithm=pM.ln=function(){return wM(this)},pM.negated=pM.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},pM.plus=pM.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?fM(t,e):EM(t,(e.s=-e.s,e))},pM.precision=pM.sd=function(e){var t,n,r,i=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(iM+e);if(t=xM(i)+1,n=(r=i.d.length-1)*uM+1,r=i.d[r]){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},pM.squareRoot=pM.sqrt=function(){var e,t,n,r,i,a,o,s=this,l=s.constructor;if(s.s<1){if(!s.s)return new l(0);throw Error(rM+"NaN")}for(e=xM(s),nM=!1,0==(i=Math.sqrt(+s))||i==1/0?(((t=gM(s.d)).length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=oM((e+1)/2)-(e<0||e%2),r=new l(t=i==1/0?"5e"+e:(t=i.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new l(i.toString()),i=o=(n=l.precision)+3;;)if(r=(a=r).plus(vM(s,a,o+2)).times(.5),gM(a.d).slice(0,o)===(t=gM(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&"4999"==t){if(MM(a,n+1,0),a.times(a).eq(s)){r=a;break}}else if("9999"!=t)break;o+=4}return nM=!0,MM(r,n)},pM.times=pM.mul=function(e){var t,n,r,i,a,o,s,l,c,u=this,d=u.constructor,h=u.d,p=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,(l=h.length)<(c=p.length)&&(a=h,h=p,p=a,o=l,l=c,c=o),a=[],r=o=l+c;r--;)a.push(0);for(r=c;--r>=0;){for(t=0,i=l+r;i>r;)s=a[i]+p[r]*h[i-r-1]+t,a[i--]=s%cM|0,t=s/cM|0;a[i]=(a[i]+t)%cM|0}for(;!a[--o];)a.pop();return t?++n:a.shift(),e.d=a,e.e=n,nM?MM(e,d.precision):e},pM.toDecimalPlaces=pM.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(mM(e,0,tM),void 0===t?t=r.rounding:mM(t,0,8),MM(n,e+xM(n)+1,t))},pM.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=TM(r,!0):(mM(e,0,tM),void 0===t?t=i.rounding:mM(t,0,8),n=TM(r=MM(new i(r),e+1,t),!0,e+1)),n},pM.toFixed=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?TM(i):(mM(e,0,tM),void 0===t?t=a.rounding:mM(t,0,8),n=TM((r=MM(new a(i),e+xM(i)+1,t)).abs(),!1,e+xM(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)},pM.toInteger=pM.toint=function(){var e=this,t=e.constructor;return MM(new t(e),xM(e)+1,t.rounding)},pM.toNumber=function(){return+this},pM.toPower=pM.pow=function(e){var t,n,r,i,a,o,s=this,l=s.constructor,c=+(e=new l(e));if(!e.s)return new l(eM);if(!(s=new l(s)).s){if(e.s<1)throw Error(rM+"Infinity");return s}if(s.eq(eM))return s;if(r=l.precision,e.eq(eM))return MM(s,r);if(o=(t=e.e)>=(n=e.d.length-1),a=s.s,o){if((n=c<0?-c:c)<=dM){for(i=new l(eM),t=Math.ceil(r/uM+4),nM=!1;n%2&&AM((i=i.times(s)).d,t),0!==(n=oM(n/2));)AM((s=s.times(s)).d,t);return nM=!0,e.s<0?new l(eM).div(i):MM(i,r)}}else if(a<0)throw Error(rM+"NaN");return a=a<0&&1&e.d[Math.max(t,n)]?-1:1,s.s=1,nM=!1,i=e.times(wM(s,r+12)),nM=!0,(i=yM(i)).s=a,i},pM.toPrecision=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?r=TM(i,(n=xM(i))<=a.toExpNeg||n>=a.toExpPos):(mM(e,1,tM),void 0===t?t=a.rounding:mM(t,0,8),r=TM(i=MM(new a(i),e,t),e<=(n=xM(i))||n<=a.toExpNeg,e)),r},pM.toSignificantDigits=pM.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(mM(e,1,tM),void 0===t?t=n.rounding:mM(t,0,8)),MM(new n(this),e,t)},pM.toString=pM.valueOf=pM.val=pM.toJSON=pM[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=xM(e),n=e.constructor;return TM(e,t<=n.toExpNeg||t>=n.toExpPos)};var vM=function(){function e(e,t){var n,r=0,i=e.length;for(e=e.slice();i--;)n=e[i]*t+r,e[i]=n%cM|0,r=n/cM|0;return r&&e.unshift(r),e}function t(e,t,n,r){var i,a;if(n!=r)a=n>r?1:-1;else for(i=a=0;i<n;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*cM+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,a,o){var s,l,c,u,d,h,p,f,m,g,v,y,x,b,_,w,S,M,E=r.constructor,T=r.s==i.s?1:-1,A=r.d,C=i.d;if(!r.s)return new E(r);if(!i.s)throw Error(rM+"Division by zero");for(l=r.e-i.e,S=C.length,_=A.length,f=(p=new E(T)).d=[],c=0;C[c]==(A[c]||0);)++c;if(C[c]>(A[c]||0)&&--l,(y=null==a?a=E.precision:o?a+(xM(r)-xM(i))+1:a)<0)return new E(0);if(y=y/uM+2|0,c=0,1==S)for(u=0,C=C[0],y++;(c<_||u)&&y--;c++)x=u*cM+(A[c]||0),f[c]=x/C|0,u=x%C|0;else{for((u=cM/(C[0]+1)|0)>1&&(C=e(C,u),A=e(A,u),S=C.length,_=A.length),b=S,g=(m=A.slice(0,S)).length;g<S;)m[g++]=0;(M=C.slice()).unshift(0),w=C[0],C[1]>=cM/2&&++w;do{u=0,(s=t(C,m,S,g))<0?(v=m[0],S!=g&&(v=v*cM+(m[1]||0)),(u=v/w|0)>1?(u>=cM&&(u=cM-1),1==(s=t(d=e(C,u),m,h=d.length,g=m.length))&&(u--,n(d,S<h?M:C,h))):(0==u&&(s=u=1),d=C.slice()),(h=d.length)<g&&d.unshift(0),n(m,d,g),-1==s&&(s=t(C,m,S,g=m.length))<1&&(u++,n(m,S<g?M:C,g)),g=m.length):0===s&&(u++,m=[0]),f[c++]=u,s&&m[0]?m[g++]=A[b]||0:(m=[A[b]],g=1)}while((b++<_||void 0!==m[0])&&y--)}return f[0]||f.shift(),p.e=l,MM(p,o?a+xM(p)+1:a)}}();function yM(e,t){var n,r,i,a,o,s=0,l=0,c=e.constructor,u=c.precision;if(xM(e)>16)throw Error(aM+xM(e));if(!e.s)return new c(eM);for(null==t?(nM=!1,o=u):o=t,a=new c(.03125);e.abs().gte(.1);)e=e.times(a),l+=5;for(o+=Math.log(sM(2,l))/Math.LN10*2+5|0,n=r=i=new c(eM),c.precision=o;;){if(r=MM(r.times(e),o),n=n.times(++s),gM((a=i.plus(vM(r,n,o))).d).slice(0,o)===gM(i.d).slice(0,o)){for(;l--;)i=MM(i.times(i),o);return c.precision=u,null==t?(nM=!0,MM(i,u)):i}i=a}}function xM(e){for(var t=e.e*uM,n=e.d[0];n>=10;n/=10)t++;return t}function bM(e,t,n){if(t>e.LN10.sd())throw nM=!0,n&&(e.precision=n),Error(rM+"LN10 precision limit exceeded");return MM(new e(e.LN10),t)}function _M(e){for(var t="";e--;)t+="0";return t}function wM(e,t){var n,r,i,a,o,s,l,c,u,d=1,h=e,p=h.d,f=h.constructor,m=f.precision;if(h.s<1)throw Error(rM+(h.s?"NaN":"-Infinity"));if(h.eq(eM))return new f(0);if(null==t?(nM=!1,c=m):c=t,h.eq(10))return null==t&&(nM=!0),bM(f,c);if(c+=10,f.precision=c,r=(n=gM(p)).charAt(0),a=xM(h),!(Math.abs(a)<15e14))return l=bM(f,c+2,m).times(a+""),h=wM(new f(r+"."+n.slice(1)),c-10).plus(l),f.precision=m,null==t?(nM=!0,MM(h,m)):h;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=gM((h=h.times(e)).d)).charAt(0),d++;for(a=xM(h),r>1?(h=new f("0."+n),a++):h=new f(r+"."+n.slice(1)),s=o=h=vM(h.minus(eM),h.plus(eM),c),u=MM(h.times(h),c),i=3;;){if(o=MM(o.times(u),c),gM((l=s.plus(vM(o,new f(i),c))).d).slice(0,c)===gM(s.d).slice(0,c))return s=s.times(2),0!==a&&(s=s.plus(bM(f,c+2,m).times(a+""))),s=vM(s,new f(d),c),f.precision=m,null==t?(nM=!0,MM(s,m)):s;s=l,i+=2}}function SM(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(i=t.length;48===t.charCodeAt(i-1);)--i;if(t=t.slice(r,i)){if(i-=r,n=n-r-1,e.e=oM(n/uM),e.d=[],r=(n+1)%uM,n<0&&(r+=uM),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=uM;r<i;)e.d.push(+t.slice(r,r+=uM));t=t.slice(r),r=uM-t.length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),nM&&(e.e>hM||e.e<-hM))throw Error(aM+n)}else e.s=0,e.e=0,e.d=[0];return e}function MM(e,t,n){var r,i,a,o,s,l,c,u,d=e.d;for(o=1,a=d[0];a>=10;a/=10)o++;if((r=t-o)<0)r+=uM,i=t,c=d[u=0];else{if((u=Math.ceil((r+1)/uM))>=(a=d.length))return e;for(c=a=d[u],o=1;a>=10;a/=10)o++;i=(r%=uM)-uM+o}if(void 0!==n&&(s=c/(a=sM(10,o-i-1))%10|0,l=t<0||void 0!==d[u+1]||c%a,l=n<4?(s||l)&&(0==n||n==(e.s<0?3:2)):s>5||5==s&&(4==n||l||6==n&&(r>0?i>0?c/sM(10,o-i):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return l?(a=xM(e),d.length=1,t=t-a-1,d[0]=sM(10,(uM-t%uM)%uM),e.e=oM(-t/uM)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(0==r?(d.length=u,a=1,u--):(d.length=u+1,a=sM(10,uM-r),d[u]=i>0?(c/sM(10,o-i)%sM(10,i)|0)*a:0),l)for(;;){if(0==u){(d[0]+=a)==cM&&(d[0]=1,++e.e);break}if(d[u]+=a,d[u]!=cM)break;d[u--]=0,a=1}for(r=d.length;0===d[--r];)d.pop();if(nM&&(e.e>hM||e.e<-hM))throw Error(aM+xM(e));return e}function EM(e,t){var n,r,i,a,o,s,l,c,u,d,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),nM?MM(t,p):t;if(l=e.d,d=t.d,r=t.e,c=e.e,l=l.slice(),o=c-r){for((u=o<0)?(n=l,o=-o,s=d.length):(n=d,r=c,s=l.length),o>(i=Math.max(Math.ceil(p/uM),s)+2)&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for((u=(i=l.length)<(s=d.length))&&(s=i),i=0;i<s;i++)if(l[i]!=d[i]){u=l[i]<d[i];break}o=0}for(u&&(n=l,l=d,d=n,t.s=-t.s),s=l.length,i=d.length-s;i>0;--i)l[s++]=0;for(i=d.length;i>o;){if(l[--i]<d[i]){for(a=i;a&&0===l[--a];)l[a]=cM-1;--l[a],l[i]+=cM}l[i]-=d[i]}for(;0===l[--s];)l.pop();for(;0===l[0];l.shift())--r;return l[0]?(t.d=l,t.e=r,nM?MM(t,p):t):new h(0)}function TM(e,t,n){var r,i=xM(e),a=gM(e.d),o=a.length;return t?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+_M(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+_M(-i-1)+a,n&&(r=n-o)>0&&(a+=_M(r))):i>=o?(a+=_M(i+1-o),n&&(r=n-i-1)>0&&(a=a+"."+_M(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+="."),a+=_M(r))),e.s<0?"-"+a:a}function AM(e,t){if(e.length>t)return e.length=t,!0}function CM(e){if(!e||"object"!=typeof e)throw Error(rM+"Object expected");var t,n,r,i=["precision",1,tM,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if(void 0!==(r=e[n=i[t]])){if(!(oM(r)===r&&r>=i[t+1]&&r<=i[t+2]))throw Error(iM+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(iM+n+": "+r);this[n]=new this(r)}return this}var PM=function e(t){var n,r,i;function a(e){var t=this;if(!(t instanceof a))return new a(e);if(t.constructor=a,e instanceof a)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"==typeof e){if(0*e!=0)throw Error(iM+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):SM(t,e.toString())}if("string"!=typeof e)throw Error(iM+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!lM.test(e))throw Error(iM+e);SM(t,e)}if(a.prototype=pM,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=e,a.config=a.set=CM,void 0===t&&(t={}),t)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return a.config(t),a}({precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"});eM=new PM(1);const RM=PM;function OM(e){return 0===e?1:Math.floor(new RM(e).abs().log(10).toNumber())+1}function DM(e,t,n){for(var r=new RM(e),i=0,a=[];r.lt(t)&&i<1e5;)a.push(r.toNumber()),r=r.add(n),i++;return a}var IM=e=>{var[t,n]=e,[r,i]=[t,n];return t>n&&([r,i]=[n,t]),[r,i]},LM=(e,t,n)=>{if(e.lte(0))return new RM(0);var r=OM(e.toNumber()),i=new RM(10).pow(r),a=e.div(i),o=1!==r?.05:.1,s=new RM(Math.ceil(a.div(o).toNumber())).add(n).mul(o).mul(i);return new RM(t?s.toNumber():Math.ceil(s.toNumber()))},NM=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new RM(0),tickMin:new RM(0),tickMax:new RM(0)};var a,o=LM(new RM(t).sub(e).div(n-1),r,i);a=e<=0&&t>=0?new RM(0):(a=new RM(e).add(t).div(2)).sub(new RM(a).mod(o));var s=Math.ceil(a.sub(e).div(o).toNumber()),l=Math.ceil(new RM(t).sub(a).div(o).toNumber()),c=s+l+1;return c>n?NM(e,t,n,r,i+1):(c<n&&(l=t>0?l+(n-c):l,s=t>0?s:s+(n-c)),{step:o,tickMin:a.sub(new RM(s).mul(o)),tickMax:a.add(new RM(l).mul(o))})},kM=e=>e.rootProps.stackOffset,UM=e=>e.rootProps.reverseStackOrder,FM=e=>e.options.chartName,zM=e=>e.rootProps.syncId,jM=e=>e.rootProps.syncMethod,BM=e=>e.options.eventEmitter;function HM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function VM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HM(Object(n),!0).forEach((function(t){GM(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function GM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var WM=Math.PI/180,XM=e=>180*e/Math.PI,qM=(e,t,n,r)=>({x:e+Math.cos(-WM*r)*n,y:t+Math.sin(-WM*r)*n}),YM=(e,t)=>{var{startAngle:n,endAngle:r}=t,i=Math.floor(n/360),a=Math.floor(r/360);return e+360*Math.min(i,a)},KM=(e,t)=>{var{chartX:n,chartY:r}=e,{radius:i,angle:a}=((e,t)=>{var{x:n,y:r}=e,{cx:i,cy:a}=t,o=((e,t)=>{var{x:n,y:r}=e,{x:i,y:a}=t;return Math.sqrt((n-i)**2+(r-a)**2)})({x:n,y:r},{x:i,y:a});if(o<=0)return{radius:o,angle:0};var s=(n-i)/o,l=Math.acos(s);return r>a&&(l=2*Math.PI-l),{radius:o,angle:XM(l),angleInRadian:l}})({x:n,y:r},t),{innerRadius:o,outerRadius:s}=t;if(i<o||i>s)return null;if(0===i)return null;var l,{startAngle:c,endAngle:u}=(e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),i=Math.floor(n/360),a=Math.min(r,i);return{startAngle:t-360*a,endAngle:n-360*a}})(t),d=a;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;l=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;l=d>=u&&d<=c}return l?VM(VM({},t),{},{radius:i,angle:YM(d,t)}):null},$M={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},ZM=($M.axis,!1),JM=($M.axis,(e,t)=>{if(e&&t)return null!=e&&e.reversed?[t[1],t[0]]:t});function QM(e,t,n){return"auto"!==n?n:null!=e?sy(e,t)?"category":"number":void 0}function eE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eE(Object(n),!0).forEach((function(t){nE(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rE={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:0,includeHidden:!1,name:void 0,reversed:!1,scale:"auto",tick:!0,tickCount:void 0,ticks:void 0,type:"auto",unit:void 0},iE={allowDataOverflow:ZM,allowDecimals:!1,allowDuplicatedCategory:!0,dataKey:void 0,domain:void 0,id:0,includeHidden:!1,name:void 0,reversed:!1,scale:"auto",tick:!0,tickCount:5,ticks:void 0,type:"auto",unit:void 0},aE=Fv([(e,t)=>{if(null!=t)return e.polarAxis.angleAxis[t]},Vy],((e,t)=>{var n;if(null!=e)return e;var r=null!==(n=QM(t,"angleAxis",rE.type))&&void 0!==n?n:"category";return tE(tE({},rE),{},{type:r})})),oE=Fv([(e,t)=>e.polarAxis.radiusAxis[t],Vy],((e,t)=>{var n;if(null!=e)return e;var r=null!==(n=QM(t,"radiusAxis",iE.type))&&void 0!==n?n:"category";return tE(tE({},iE),{},{type:r})})),sE=e=>e.polarOptions,lE=Fv([yy,xy,Ay],(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2})),cE=Fv([sE,lE],((e,t)=>{if(null!=e)return rp(e.innerRadius,t,0)})),uE=Fv([sE,lE],((e,t)=>{if(null!=e)return rp(e.outerRadius,t,.8*t)})),dE=Fv([sE],(e=>{if(null==e)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]})),hE=(Fv([aE,dE],JM),Fv([lE,cE,uE],((e,t,n)=>{if(null!=e&&null!=t&&null!=n)return[t,n]}))),pE=(Fv([oE,hE],JM),Fv([jy,sE,cE,uE,yy,xy],((e,t,n,r,i,a)=>{if(("centric"===e||"radial"===e)&&null!=t&&null!=n&&null!=r){var{cx:o,cy:s,startAngle:l,endAngle:c}=t;return{cx:rp(o,i,i/2),cy:rp(s,a,a/2),innerRadius:n,outerRadius:r,startAngle:l,endAngle:c,clockWise:!1}}}))),fE=(e,t)=>t,mE=(e,t,n)=>n;function gE(e){return null==e?void 0:e.id}function vE(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:i,dataKey:a}=n,o=new Map;return e.forEach((e=>{var t,n=null!==(t=e.data)&&void 0!==t?t:r;if(null!=n&&0!==n.length){var s=gE(e);n.forEach(((t,n)=>{var r,l=null==a||i?n:String(oy(t,a,null)),c=oy(t,e.dataKey,0);r=o.has(l)?o.get(l):{},Object.assign(r,{[s]:c}),o.set(l,r)}))}})),Array.from(o.values())}function yE(e){return"stackId"in e&&null!=e.stackId&&null!=e.dataKey}var xE=(e,t)=>e===t||null!=e&&null!=t&&e[0]===t[0]&&e[1]===t[1];function bE(e,t){return!(!Array.isArray(e)||!Array.isArray(t)||0!==e.length||0!==t.length)||e===t}var _E=e=>{var t=jy(e);return"horizontal"===t?"xAxis":"vertical"===t?"yAxis":"centric"===t?"angleAxis":"radiusAxis"},wE=e=>e.tooltip.settings.axisId;function SE(e){var t=e.ticks,n=e.bandwidth,r=e.range(),i=[Math.min(...r),Math.max(...r)];return{domain:()=>e.domain(),range:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((()=>i)),rangeMin:()=>i[0],rangeMax:()=>i[1],isInRange(e){var t=i[0],n=i[1];return t<=n?e>=t&&e<=n:e>=n&&e<=t},bandwidth:n?()=>n.call(e):void 0,ticks:t?n=>t.call(e,n):void 0,map:(t,n)=>{var r=e(t);if(null!=r){if(e.bandwidth&&null!=n&&n.position){var i=e.bandwidth();switch(n.position){case"middle":r+=i/2;break;case"end":r+=i}}return r}}}}function ME(e,n,r){if("function"==typeof e)return SE(e.copy().domain(n).range(r));if(null!=e){var i=function(e){if(e in t)return t[e]();var n="scale".concat(lp(e));return n in t?t[n]():void 0}(e);if(null!=i)return i.domain(n).range(r),SE(i)}}function EE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?EE(Object(n),!0).forEach((function(t){AE(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function AE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var CE=[0,"auto"],PE={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},RE=(e,t)=>e.cartesianAxis.xAxis[t],OE=(e,t)=>{var n=RE(e,t);return null==n?PE:n},DE={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:CE,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:60},IE=(e,t)=>e.cartesianAxis.yAxis[t],LE=(e,t)=>{var n=IE(e,t);return null==n?DE:n},NE={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},kE=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return null==n?NE:n},UE=(e,t,n)=>{switch(t){case"xAxis":return OE(e,n);case"yAxis":return LE(e,n);case"zAxis":return kE(e,n);case"angleAxis":return aE(e,n);case"radiusAxis":return oE(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},FE=(e,t,n)=>{switch(t){case"xAxis":return OE(e,n);case"yAxis":return LE(e,n);case"angleAxis":return aE(e,n);case"radiusAxis":return oE(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},zE=e=>e.graphicalItems.cartesianItems.some((e=>"bar"===e.type))||e.graphicalItems.polarItems.some((e=>"radialBar"===e.type));function jE(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var BE=e=>e.graphicalItems.cartesianItems,HE=Fv([fE,mE],jE),VE=(e,t,n)=>e.filter(n).filter((e=>!0===(null==t?void 0:t.includeHidden)||!e.hide)),GE=Fv([BE,UE,HE],VE,{memoizeOptions:{resultEqualityCheck:bE}}),WE=Fv([GE],(e=>e.filter((e=>"area"===e.type||"bar"===e.type)).filter(yE))),XE=e=>e.filter((e=>!("stackId"in e)||void 0===e.stackId)),qE=Fv([GE],XE),YE=e=>e.map((e=>e.data)).filter(Boolean).flat(1),KE=Fv([GE],YE,{memoizeOptions:{resultEqualityCheck:bE}}),$E=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:i}=t;return e.length>0?e:n.slice(r,i+1)},ZE=Fv([KE,$S],$E),JE=(e,t,n)=>null!=(null==t?void 0:t.dataKey)?e.map((e=>({value:oy(e,t.dataKey)}))):n.length>0?n.map((e=>e.dataKey)).flatMap((t=>e.map((e=>({value:oy(e,t)}))))):e.map((e=>({value:e}))),QE=Fv([ZE,UE,GE],JE);function eT(e,t){switch(e){case"xAxis":return"x"===t.direction;case"yAxis":return"y"===t.direction;default:return!1}}function tT(e){if(ep(e)||e instanceof Date){var t=Number(e);if(xp(t))return t}}function nT(e){if(Array.isArray(e)){var t=[tT(e[0]),tT(e[1])];return ZS(t)?t:void 0}var n=tT(e);if(null!=n)return[n,n]}function rT(e){return e.map(tT).filter(cp)}var iT=e=>{var t=_E(e),n=wE(e);return FE(e,t,n)},aT=Fv([iT],(e=>null==e?void 0:e.dataKey)),oT=Fv([WE,$S,iT],vE),sT=(e,t,n,r)=>{var i=t.reduce(((e,t)=>{if(null==t.stackId)return e;var n=e[t.stackId];return null==n&&(n=[]),n.push(t),e[t.stackId]=n,e}),{});return Object.fromEntries(Object.entries(i).map((t=>{var[i,a]=t,o=r?[...a].reverse():a,s=o.map(gE);return[i,{stackedData:dy(e,s,n),graphicalItems:o}]})))},lT=Fv([oT,WE,kM,UM],sT),cT=(e,t,n,r)=>{var{dataStartIndex:i,dataEndIndex:a}=t;if(null==r&&"zAxis"!==n){var o=((e,t,n)=>{var r;if(null!=e)return[(r=Object.keys(e).reduce(((r,i)=>{var a=e[i];if(!a)return r;var{stackedData:o}=a,s=o.reduce(((e,r)=>{var i,a=(i=ny(r,t,n).flat(2).filter(Qh),[Math.min(...i),Math.max(...i)]);return xp(a[0])&&xp(a[1])?[Math.min(e[0],a[0]),Math.max(e[1],a[1])]:e}),[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]}),[1/0,-1/0]))[0]===1/0?0:r[0],r[1]===-1/0?0:r[1]]})(e,i,a);if(null==o||0!==o[0]||0!==o[1])return o}},uT=Fv([UE],(e=>e.allowDataOverflow)),dT=e=>{var t;if(null==e||!("domain"in e))return CE;if(null!=e.domain)return e.domain;if("ticks"in e&&null!=e.ticks){if("number"===e.type){var n=rT(e.ticks);return[Math.min(...n),Math.max(...n)]}if("category"===e.type)return e.ticks.map(String)}return null!==(t=null==e?void 0:e.domain)&&void 0!==t?t:CE},hT=Fv([UE],dT),pT=Fv([hT,uT],QS),fT=Fv([lT,YS,fE,pT],cT,{memoizeOptions:{resultEqualityCheck:xE}}),mT=e=>e.errorBars,gT=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);if(0!==r.length){var i=r.flat();return[Math.min(...i),Math.max(...i)]}},vT=(e,t,n,r,i)=>{var a,o;if(n.length>0&&e.forEach((e=>{n.forEach((n=>{var s,l,c=null===(s=r[n.id])||void 0===s?void 0:s.filter((e=>eT(i,e))),u=oy(e,null!==(l=t.dataKey)&&void 0!==l?l:n.dataKey),d=function(e,t,n){return!n||"number"!=typeof t||Zh(t)?[]:n.length?rT(n.flatMap((n=>{var r,i,a=oy(e,n.dataKey);if(Array.isArray(a)?[r,i]=a:r=i=a,xp(r)&&xp(i))return[t-r,t+i]}))):[]}(e,u,c);if(d.length>=2){var h=Math.min(...d),p=Math.max(...d);(null==a||h<a)&&(a=h),(null==o||p>o)&&(o=p)}var f=nT(u);null!=f&&(a=null==a?f[0]:Math.min(a,f[0]),o=null==o?f[1]:Math.max(o,f[1]))}))})),null!=(null==t?void 0:t.dataKey)&&e.forEach((e=>{var n=nT(oy(e,t.dataKey));null!=n&&(a=null==a?n[0]:Math.min(a,n[0]),o=null==o?n[1]:Math.max(o,n[1]))})),xp(a)&&xp(o))return[a,o]},yT=Fv([ZE,UE,qE,mT,fE],vT,{memoizeOptions:{resultEqualityCheck:xE}});function xT(e){var{value:t}=e;if(ep(t)||t instanceof Date)return t}var bT=e=>e.referenceElements.dots,_T=(e,t,n)=>e.filter((e=>"extendDomain"===e.ifOverflow)).filter((e=>"xAxis"===t?e.xAxisId===n:e.yAxisId===n)),wT=Fv([bT,fE,mE],_T),ST=e=>e.referenceElements.areas,MT=Fv([ST,fE,mE],_T),ET=e=>e.referenceElements.lines,TT=Fv([ET,fE,mE],_T),AT=(e,t)=>{if(null!=e){var n=rT(e.map((e=>"xAxis"===t?e.x:e.y)));if(0!==n.length)return[Math.min(...n),Math.max(...n)]}},CT=Fv(wT,fE,AT),PT=(e,t)=>{if(null!=e){var n=rT(e.flatMap((e=>["xAxis"===t?e.x1:e.y1,"xAxis"===t?e.x2:e.y2])));if(0!==n.length)return[Math.min(...n),Math.max(...n)]}},RT=Fv([MT,fE],PT),OT=(e,t)=>{if(null!=e){var n=e.flatMap((e=>"xAxis"===t?function(e){var t;if(null!=e.x)return rT([e.x]);var n=null===(t=e.segment)||void 0===t?void 0:t.map((e=>e.x));return null==n||0===n.length?[]:rT(n)}(e):function(e){var t;if(null!=e.y)return rT([e.y]);var n=null===(t=e.segment)||void 0===t?void 0:t.map((e=>e.y));return null==n||0===n.length?[]:rT(n)}(e)));if(0!==n.length)return[Math.min(...n),Math.max(...n)]}},DT=Fv([TT,fE],OT),IT=Fv(CT,DT,RT,((e,t,n)=>gT(e,n,t))),LT=(e,t,n,r,i,a,o,s)=>null!=n?n:function(e,t,n){if(n||null!=t){if("function"==typeof e&&null!=t)try{var r=e(t,n);if(ZS(r))return JS(r,t,n)}catch(e){}if(Array.isArray(e)&&2===e.length){var i,a,[o,s]=e;if("auto"===o)null!=t&&(i=Math.min(...t));else if(Qh(o))i=o;else if("function"==typeof o)try{null!=t&&(i=o(null==t?void 0:t[0]))}catch(e){}else if("string"==typeof o&&py.test(o)){var l=py.exec(o);if(null==l||null==l[1]||null==t)i=void 0;else{var c=+l[1];i=t[0]-c}}else i=null==t?void 0:t[0];if("auto"===s)null!=t&&(a=Math.max(...t));else if(Qh(s))a=s;else if("function"==typeof s)try{null!=t&&(a=s(null==t?void 0:t[1]))}catch(e){}else if("string"==typeof s&&fy.test(s)){var u=fy.exec(s);if(null==u||null==u[1]||null==t)a=void 0;else{var d=+u[1];a=t[1]+d}}else a=null==t?void 0:t[1];var h=[i,a];if(ZS(h))return null==t?h:JS(h,t,n)}}}(t,"vertical"===o&&"xAxis"===s||"horizontal"===o&&"yAxis"===s?gT(r,a,i):gT(a,i),e.allowDataOverflow),NT=Fv([UE,hT,pT,fT,yT,IT,jy,fE],LT,{memoizeOptions:{resultEqualityCheck:xE}}),kT=[0,1],UT=(e,t,n,r,i,a,o)=>{if(null!=e&&null!=n&&0!==n.length||void 0!==o){var s,{dataKey:l,type:c}=e,u=sy(t,a);return u&&null==l?qy()(0,null!==(s=null==n?void 0:n.length)&&void 0!==s?s:0):"category"===c?((e,t,n)=>{var r=e.map(xT).filter((e=>null!=e));return n&&(null==t.dataKey||t.allowDuplicatedCategory&&ip(r))?qy()(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))})(r,e,u):"expand"===i?kT:o}},FT=Fv([UE,jy,ZE,QE,kM,fE,NT],UT),zT=(e,n,r)=>{if(null!=e){var{scale:i,type:a}=e;if("auto"===i)return"category"===a&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?"point":"category"===a?"band":"linear";if("string"==typeof i){var o="scale".concat(lp(i));return function(e){return e in t}(o)?o:"point"}}},jT=Fv([UE,zE,FM],zT);function BT(e,t,n,r){if(null!=n&&null!=r)return"function"==typeof e.scale?ME(e.scale,n,r):ME(t,n,r)}var HT=(e,t,n)=>{var r=dT(t);if("auto"===n||"linear"===n)return null!=t&&t.tickCount&&Array.isArray(r)&&("auto"===r[0]||"auto"===r[1])&&ZS(e)?function(e){var[t,n]=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Math.max(r,2),[o,s]=IM([t,n]);if(o===-1/0||s===1/0){var l=s===1/0?[o,...Array(r-1).fill(1/0)]:[...Array(r-1).fill(-1/0),s];return t>n?l.reverse():l}if(o===s)return((e,t,n)=>{var r=new RM(1),i=new RM(e);if(!i.isint()&&n){var a=Math.abs(e);a<1?(r=new RM(10).pow(OM(e)-1),i=new RM(Math.floor(i.div(r).toNumber())).mul(r)):a>1&&(i=new RM(Math.floor(e)))}else 0===e?i=new RM(Math.floor((t-1)/2)):n||(i=new RM(Math.floor(e)));for(var o=Math.floor((t-1)/2),s=[],l=0;l<t;l++)s.push(i.add(new RM(l-o).mul(r)).toNumber());return s})(o,r,i);var{step:c,tickMin:u,tickMax:d}=NM(o,s,a,i,0),h=DM(u,d.add(new RM(.1).mul(c)),c);return t>n?h.reverse():h}(e,t.tickCount,t.allowDecimals):null!=t&&t.tickCount&&"number"===t.type&&ZS(e)?function(e,t){var[n,r]=e,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[a,o]=IM([n,r]);if(a===-1/0||o===1/0)return[n,r];if(a===o)return[a];var s=Math.max(t,2),l=LM(new RM(o).sub(a).div(s-1),i,0),c=[...DM(new RM(a),new RM(o),l),o];return!1===i&&(c=c.map((e=>Math.round(e)))),n>r?c.reverse():c}(e,t.tickCount,t.allowDecimals):void 0},VT=Fv([FT,FE,jT],HT),GT=(e,t,n,r)=>{if("angleAxis"!==r&&"number"===(null==e?void 0:e.type)&&ZS(t)&&Array.isArray(n)&&n.length>0){var i,a,o=t[0],s=null!==(i=n[0])&&void 0!==i?i:0,l=t[1],c=null!==(a=n[n.length-1])&&void 0!==a?a:0;return[Math.min(o,s),Math.max(l,c)]}return t},WT=Fv([UE,FT,VT,fE],GT),XT=Fv(QE,UE,((e,t)=>{if(t&&"number"===t.type){var n=1/0,r=Array.from(rT(e.map((e=>e.value)))).sort(((e,t)=>e-t)),i=r[0],a=r[r.length-1];if(null==i||null==a)return 1/0;var o=a-i;if(0===o)return 1/0;for(var s=0;s<r.length-1;s++){var l=r[s],c=r[s+1];if(null!=l&&null!=c){var u=c-l;n=Math.min(n,u)}}return n/o}})),qT=Fv(XT,jy,(e=>e.rootProps.barCategoryGap),Ay,((e,t,n,r,i)=>i),((e,t,n,r,i)=>{if(!xp(e))return 0;var a="vertical"===t?r.height:r.width;if("gap"===i)return e*a/2;if("no-gap"===i){var o=rp(n,e*a),s=e*a/2;return s-o-(s-o)/a*o}return 0})),YT=Fv(OE,((e,t,n)=>{var r=OE(e,t);return null==r||"string"!=typeof r.padding?0:qT(e,"xAxis",t,n,r.padding)}),((e,t)=>{var n,r;if(null==e)return{left:0,right:0};var{padding:i}=e;return"string"==typeof i?{left:t,right:t}:{left:(null!==(n=i.left)&&void 0!==n?n:0)+t,right:(null!==(r=i.right)&&void 0!==r?r:0)+t}})),KT=Fv(LE,((e,t,n)=>{var r=LE(e,t);return null==r||"string"!=typeof r.padding?0:qT(e,"yAxis",t,n,r.padding)}),((e,t)=>{var n,r;if(null==e)return{top:0,bottom:0};var{padding:i}=e;return"string"==typeof i?{top:t,bottom:t}:{top:(null!==(n=i.top)&&void 0!==n?n:0)+t,bottom:(null!==(r=i.bottom)&&void 0!==r?r:0)+t}})),$T=Fv([Ay,YT,Iy,Dy,(e,t,n)=>n],((e,t,n,r,i)=>{var{padding:a}=r;return i?[a.left,n.width-a.right]:[e.left+t.left,e.left+e.width-t.right]})),ZT=Fv([Ay,jy,KT,Iy,Dy,(e,t,n)=>n],((e,t,n,r,i,a)=>{var{padding:o}=i;return a?[r.height-o.bottom,o.top]:"horizontal"===t?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]})),JT=(e,t,n,r)=>{var i;switch(t){case"xAxis":return $T(e,n,r);case"yAxis":return ZT(e,n,r);case"zAxis":return null===(i=kE(e,n))||void 0===i?void 0:i.range;case"angleAxis":return dE(e);case"radiusAxis":return hE(e,n);default:return}},QT=Fv([UE,JT],JM),eA=Fv([jT,WT],((e,t)=>{if(null!=t){if("linear"===e){if(!ZS(t)){for(var n,r,i=0;i<t.length;i++){var a=t[i];xp(a)&&((void 0===n||a<n)&&(n=a),(void 0===r||a>r)&&(r=a))}return void 0!==n&&void 0!==r?[n,r]:void 0}return t}return t}})),tA=Fv([UE,jT,eA,QT],BT);function nA(e,t){return e.id<t.id?-1:e.id>t.id?1:0}Fv([GE,mT,fE],((e,t,n)=>e.flatMap((e=>t[e.id])).filter(Boolean).filter((e=>eT(n,e)))));var rA=(e,t)=>t,iA=(e,t,n)=>n,aA=Fv(wy,rA,iA,((e,t,n)=>e.filter((e=>e.orientation===t)).filter((e=>e.mirror===n)).sort(nA))),oA=Fv(Sy,rA,iA,((e,t,n)=>e.filter((e=>e.orientation===t)).filter((e=>e.mirror===n)).sort(nA))),sA=(e,t)=>({width:e.width,height:t.height}),lA=Fv(Ay,OE,sA),cA=Fv(xy,Ay,aA,rA,iA,((e,t,n,r,i)=>{var a,o={};return n.forEach((n=>{var s=sA(t,n);null==a&&(a=((e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}})(t,r,e));var l="top"===r&&!i||"bottom"===r&&i;o[n.id]=a-Number(l)*s.height,a+=(l?-1:1)*s.height})),o})),uA=Fv(yy,Ay,oA,rA,iA,((e,t,n,r,i)=>{var a,o={};return n.forEach((n=>{var s=((e,t)=>({width:"number"==typeof t.width?t.width:60,height:e.height}))(t,n);null==a&&(a=((e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}})(t,r,e));var l="left"===r&&!i||"right"===r&&i;o[n.id]=a-Number(l)*s.width,a+=(l?-1:1)*s.width})),o})),dA=Fv([Ay,OE,(e,t)=>{var n=OE(e,t);if(null!=n)return cA(e,n.orientation,n.mirror)},(e,t)=>t],((e,t,n,r)=>{if(null!=t){var i=null==n?void 0:n[r];return null==i?{x:e.left,y:0}:{x:e.left,y:i}}})),hA=Fv([Ay,LE,(e,t)=>{var n=LE(e,t);if(null!=n)return uA(e,n.orientation,n.mirror)},(e,t)=>t],((e,t,n,r)=>{if(null!=t){var i=null==n?void 0:n[r];return null==i?{x:0,y:e.top}:{x:i,y:e.top}}})),pA=Fv(Ay,LE,((e,t)=>({width:"number"==typeof t.width?t.width:60,height:e.height}))),fA=(e,t,n,r)=>{if(null!=n){var{allowDuplicatedCategory:i,type:a,dataKey:o}=n,s=sy(e,r),l=t.map((e=>e.value));return o&&s&&"category"===a&&i&&ip(l)?l:void 0}},mA=Fv([jy,QE,UE,fE],fA),gA=(e,t,n,r)=>{if(null!=n&&null!=n.dataKey){var{type:i,scale:a}=n;return!sy(e,r)||"number"!==i&&"auto"===a?void 0:t.map((e=>e.value))}},vA=Fv([jy,QE,FE,fE],gA),yA=Fv([jy,(e,t,n)=>{switch(t){case"xAxis":return OE(e,n);case"yAxis":return LE(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},jT,tA,mA,vA,JT,VT,fE],((e,t,n,r,i,a,o,s,l)=>{if(null!=t){var c=sy(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:a,duplicateDomain:i,isCategorical:c,niceTicks:s,range:o,realScaleType:n,scale:r}}})),xA=Fv([jy,FE,jT,tA,VT,JT,mA,vA,fE],((e,t,n,r,i,a,o,s,l)=>{if(null!=t&&null!=r){var c=sy(e,l),{type:u,ticks:d,tickCount:h}=t,p="scaleBand"===n&&"function"==typeof r.bandwidth?r.bandwidth()/2:2,f="category"===u&&r.bandwidth?r.bandwidth()/p:0;f="angleAxis"===l&&null!=a&&a.length>=2?2*$h(a[0]-a[1])*f:f;var m=d||i;return m?m.map(((e,t)=>{var n=o?o.indexOf(e):e,i=r.map(n);return xp(i)?{index:t,coordinate:i+f,value:e,offset:f}:null})).filter(cp):c&&s?s.map(((e,t)=>{var n=r.map(e);return xp(n)?{coordinate:n+f,value:e,index:t,offset:f}:null})).filter(cp):r.ticks?r.ticks(h).map(((e,t)=>{var n=r.map(e);return xp(n)?{coordinate:n+f,value:e,index:t,offset:f}:null})).filter(cp):r.domain().map(((e,t)=>{var n=r.map(e);return xp(n)?{coordinate:n+f,value:o?o[e]:e,index:t,offset:f}:null})).filter(cp)}})),bA=Fv([jy,FE,tA,JT,mA,vA,fE],((e,t,n,r,i,a,o)=>{if(null!=t&&null!=n&&null!=r&&r[0]!==r[1]){var s=sy(e,o),{tickCount:l}=t,c=0;return c="angleAxis"===o&&(null==r?void 0:r.length)>=2?2*$h(r[0]-r[1])*c:c,s&&a?a.map(((e,t)=>{var r=n.map(e);return xp(r)?{coordinate:r+c,value:e,index:t,offset:c}:null})).filter(cp):n.ticks?n.ticks(l).map(((e,t)=>{var r=n.map(e);return xp(r)?{coordinate:r+c,value:e,index:t,offset:c}:null})).filter(cp):n.domain().map(((e,t)=>{var r=n.map(e);return xp(r)?{coordinate:r+c,value:i?i[e]:e,index:t,offset:c}:null})).filter(cp)}})),_A=Fv(UE,tA,((e,t)=>{if(null!=e&&null!=t)return TE(TE({},e),{},{scale:t})})),wA=Fv([UE,jT,FT,QT],BT),SA=(Fv(((e,t,n)=>kE(e,n)),wA,((e,t)=>{if(null!=e&&null!=t)return TE(TE({},e),{},{scale:t})})),Fv([jy,wy,Sy],((e,t,n)=>{switch(e){case"horizontal":return t.some((e=>e.reversed))?"right-to-left":"left-to-right";case"vertical":return n.some((e=>e.reversed))?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}))),MA=e=>e.options.defaultTooltipEventType,EA=e=>e.options.validateTooltipEventTypes;function TA(e,t,n){if(null==e)return t;var r=e?"axis":"item";return null==n?t:n.includes(r)?r:t}function AA(e,t){return TA(t,MA(e),EA(e))}var CA=(e,t)=>{var n,r=Number(t);if(!Zh(r)&&null!=t)return r>=0?null==e||null===(n=e[r])||void 0===n?void 0:n.value:void 0};function PA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function RA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PA(Object(n),!0).forEach((function(t){OA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function OA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var DA=(e,t,n,r)=>{if(null==t)return av;var i=function(e,t,n){return"axis"===t?"click"===n?e.axisInteraction.click:e.axisInteraction.hover:"click"===n?e.itemInteraction.click:e.itemInteraction.hover}(e,t,n);if(null==i)return av;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&null!=e.syncInteraction.index)return e.syncInteraction;var a=!0===e.settings.active;if(null!=i.index){if(a)return RA(RA({},i),{},{active:!0})}else if(null!=r)return{active:!0,coordinate:void 0,dataKey:void 0,index:r,graphicalItemId:void 0};return RA(RA({},av),{},{coordinate:i.coordinate})};var IA=(e,t,n,r)=>{var i=null==e?void 0:e.index;if(null==i)return null;var a=Number(i);if(!xp(a))return i;var o=1/0;t.length>0&&(o=t.length-1);var s=Math.max(0,Math.min(a,o)),l=t[s];return null==l||function(e,t,n){if(null==n||null==t)return!0;var r=oy(e,t);return null==r||!ZS(n)||function(e,t){var n=function(e){if("number"==typeof e)return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}(e),r=t[0],i=t[1];if(void 0===n)return!1;var a=Math.min(r,i),o=Math.max(r,i);return n>=a&&n<=o}(r,n)}(l,n,r)?String(s):null},LA=(e,t,n,r,i,a,o)=>{if(null!=a){var s=o[0],l=null==s?void 0:s.getPosition(a);if(null!=l)return l;var c=null==i?void 0:i[Number(a)];if(c)return"horizontal"===n?{x:c.coordinate,y:(r.top+t)/2}:{x:(r.left+e)/2,y:c.coordinate}}},NA=(e,t,n,r)=>{if("axis"===t)return e.tooltipItemPayloads;if(0===e.tooltipItemPayloads.length)return[];var i;if(null==(i="hover"===n?e.itemInteraction.hover.graphicalItemId:e.itemInteraction.click.graphicalItemId)&&null!=r){var a=e.tooltipItemPayloads[0];return null!=a?[a]:[]}return e.tooltipItemPayloads.filter((e=>{var t;return(null===(t=e.settings)||void 0===t?void 0:t.graphicalItemId)===i}))},kA=e=>e.options.tooltipPayloadSearcher,UA=e=>e.tooltip;function FA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?FA(Object(n),!0).forEach((function(t){jA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var BA=(e,t,n,r,i,a,o)=>{if(null!=t&&null!=a){var{chartData:s,computedData:l,dataStartIndex:c,dataEndIndex:u}=n;return e.reduce(((e,n)=>{var d,h,p,{dataDefinedOnItem:f,settings:m}=n,g=function(e,t){return null!=e?e:t}(f,s),v=Array.isArray(g)?ny(g,c,u):g,y=null!==(d=null==m?void 0:m.dataKey)&&void 0!==d?d:r,x=null==m?void 0:m.nameKey;return h=r&&Array.isArray(v)&&!Array.isArray(v[0])&&"axis"===o?op(v,r,i):a(v,t,l,x),Array.isArray(h)?h.forEach((t=>{var n=zA(zA({},m),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(gy({tooltipEntrySettings:n,dataKey:t.dataKey,payload:t.payload,value:oy(t.payload,t.dataKey),name:t.name}))})):e.push(gy({tooltipEntrySettings:m,dataKey:y,payload:h,value:oy(h,y),name:null!==(p=oy(h,x))&&void 0!==p?p:null==m?void 0:m.name})),e}),[])}},HA=Fv([iT,zE,FM],zT),VA=Fv([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],((e,t)=>[...e,...t])),GA=Fv([_E,wE],jE),WA=Fv([VA,iT,GA],VE,{memoizeOptions:{resultEqualityCheck:bE}}),XA=Fv([WA],(e=>e.filter(yE))),qA=Fv([WA],YE,{memoizeOptions:{resultEqualityCheck:bE}}),YA=Fv([qA,YS],$E),KA=Fv([XA,YS,iT],vE),$A=Fv([YA,iT,WA],JE),ZA=Fv([iT],dT),JA=Fv([iT],(e=>e.allowDataOverflow)),QA=Fv([ZA,JA],QS),eC=Fv([WA],(e=>e.filter(yE))),tC=Fv([KA,eC,kM,UM],sT),nC=Fv([tC,YS,_E,QA],cT),rC=Fv([WA],XE),iC=Fv([YA,iT,rC,mT,_E],vT,{memoizeOptions:{resultEqualityCheck:xE}}),aC=Fv([bT,_E,wE],_T),oC=Fv([aC,_E],AT),sC=Fv([ST,_E,wE],_T),lC=Fv([sC,_E],PT),cC=Fv([ET,_E,wE],_T),uC=Fv([cC,_E],OT),dC=Fv([oC,uC,lC],gT),hC=Fv([iT,ZA,QA,nC,iC,dC,jy,_E],LT),pC=Fv([iT,jy,YA,$A,kM,_E,hC],UT),fC=Fv([pC,iT,HA],HT),mC=Fv([iT,pC,fC,_E],GT),gC=e=>{var t=_E(e),n=wE(e);return JT(e,t,n,!1)},vC=Fv([iT,gC],JM),yC=Fv([iT,HA,mC,vC],BT),xC=Fv([jy,$A,iT,_E],fA),bC=Fv([jy,$A,iT,_E],gA),_C=Fv([jy,iT,HA,yC,gC,xC,bC,_E],((e,t,n,r,i,a,o,s)=>{if(t){var{type:l}=t,c=sy(e,s);if(r){var u="scaleBand"===n&&r.bandwidth?r.bandwidth()/2:2,d="category"===l&&r.bandwidth?r.bandwidth()/u:0;return d="angleAxis"===s&&null!=i&&(null==i?void 0:i.length)>=2?2*$h(i[0]-i[1])*d:d,c&&o?o.map(((e,t)=>{var n=r.map(e);return xp(n)?{coordinate:n+d,value:e,index:t,offset:d}:null})).filter(cp):r.domain().map(((e,t)=>{var n=r.map(e);return xp(n)?{coordinate:n+d,value:a?a[e]:e,index:t,offset:d}:null})).filter(cp)}}})),wC=Fv([MA,EA,e=>e.tooltip.settings],((e,t,n)=>TA(n.shared,e,t))),SC=e=>e.tooltip.settings.trigger,MC=e=>e.tooltip.settings.defaultIndex,EC=Fv([UA,wC,SC,MC],DA),TC=Fv([EC,YA,aT,pC],IA),AC=Fv([_C,TC],CA),CC=Fv([EC],(e=>{if(e)return e.dataKey})),PC=(Fv([EC],(e=>{if(e)return e.graphicalItemId})),Fv([UA,wC,SC,MC],NA)),RC=Fv([yy,xy,jy,Ay,_C,MC,PC],LA),OC=Fv([EC,RC],((e,t)=>null!=e&&e.coordinate?e.coordinate:t)),DC=Fv([EC],(e=>{var t;return null!==(t=null==e?void 0:e.active)&&void 0!==t&&t})),IC=Fv([PC,TC,YS,aT,AC,kA,wC],BA),LC=Fv([IC],(e=>{if(null!=e){var t=e.map((e=>e.payload)).filter((e=>null!=e));return Array.from(new Set(t))}}));function NC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NC(Object(n),!0).forEach((function(t){UC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function UC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var FC=(e,t,n,r,i)=>{var a,o=null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0;if(o<=1||null==e)return 0;if("angleAxis"===r&&null!=i&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var s=0;s<o;s++){var l,c,u,d,h,p=s>0?null===(l=n[s-1])||void 0===l?void 0:l.coordinate:null===(c=n[o-1])||void 0===c?void 0:c.coordinate,f=null===(u=n[s])||void 0===u?void 0:u.coordinate,m=s>=o-1?null===(d=n[0])||void 0===d?void 0:d.coordinate:null===(h=n[s+1])||void 0===h?void 0:h.coordinate,g=void 0;if(null!=p&&null!=f&&null!=m)if($h(f-p)!==$h(m-f)){var v=[];if($h(m-f)===$h(i[1]-i[0])){g=m;var y=f+i[1]-i[0];v[0]=Math.min(y,(y+p)/2),v[1]=Math.max(y,(y+p)/2)}else{g=p;var x=m+i[1]-i[0];v[0]=Math.min(f,(x+f)/2),v[1]=Math.max(f,(x+f)/2)}var b,_=[Math.min(f,(g+f)/2),Math.max(f,(g+f)/2)];if(e>_[0]&&e<=_[1]||e>=v[0]&&e<=v[1])return null===(b=n[s])||void 0===b?void 0:b.index}else{var w,S=Math.min(p,m),M=Math.max(p,m);if(e>(S+f)/2&&e<=(M+f)/2)return null===(w=n[s])||void 0===w?void 0:w.index}}else if(t)for(var E=0;E<o;E++){var T=t[E];if(null!=T){var A=t[E+1],C=t[E-1];if(0===E&&null!=A&&e<=(T.coordinate+A.coordinate)/2)return T.index;if(E===o-1&&null!=C&&e>(T.coordinate+C.coordinate)/2)return T.index;if(E>0&&E<o-1&&null!=C&&null!=A&&e>(T.coordinate+C.coordinate)/2&&e<=(T.coordinate+A.coordinate)/2)return T.index}}return-1},zC=()=>Xv(FM),jC=(e,t)=>t,BC=(e,t,n)=>n,HC=(e,t,n,r)=>r,VC=Fv(_C,(e=>Yv()(e,(e=>e.coordinate)))),GC=Fv([UA,jC,BC,HC],DA),WC=Fv([GC,YA,aT,pC],IA),XC=Fv([UA,jC,BC,HC],NA),qC=Fv([yy,xy,jy,Ay,_C,HC,XC],LA),YC=Fv([GC,qC],((e,t)=>{var n;return null!==(n=e.coordinate)&&void 0!==n?n:t})),KC=Fv([_C,WC],CA),$C=Fv([XC,WC,YS,aT,KC,kA,jC],BA),ZC=Fv([GC,WC],((e,t)=>({isActive:e.active&&null!=t,activeIndex:t}))),JC=Fv([(e,t)=>t,jy,pE,_E,vC,_C,VC,Ay],((e,t,n,r,i,a,o,s)=>{if(e&&t&&r&&i&&a)return"horizontal"===t||"vertical"===t?((e,t,n,r,i,a,o)=>{if(e&&n&&r&&i&&function(e,t){var{chartX:n,chartY:r}=e;return n>=t.left&&n<=t.left+t.width&&r>=t.top&&r<=t.top+t.height}(e,o)){var s=((e,t)=>"horizontal"===t?e.chartX:"vertical"===t?e.chartY:void 0)(e,t),l=FC(s,a,i,n,r),c=((e,t,n,r)=>{var i=t.find((e=>e&&e.index===n));if(i){if("horizontal"===e)return{x:i.coordinate,y:r.chartY};if("vertical"===e)return{x:r.chartX,y:i.coordinate}}return{x:0,y:0}})(t,i,l,e);return{activeIndex:String(l),activeCoordinate:c}}})(e,t,r,i,a,o,s):((e,t,n,r,i,a,o)=>{if(e&&r&&i&&a&&n){var s=KM(e,n);if(s){var l=((e,t)=>"centric"===t?e.angle:e.radius)(s,t),c=FC(l,o,a,r,i),u=((e,t,n,r)=>{var i=t.find((e=>e&&e.index===n));if(i){if("centric"===e){var a=i.coordinate,{radius:o}=r;return kC(kC(kC({},r),qM(r.cx,r.cy,o,a)),{},{angle:a,radius:o})}var s=i.coordinate,{angle:l}=r;return kC(kC(kC({},r),qM(r.cx,r.cy,s,l)),{},{angle:l,radius:s})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}})(t,a,c,s);return{activeIndex:String(c),activeCoordinate:u}}}})(e,t,n,r,i,a,o)})),QC=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},eP=nm("mouseClick"),tP=qm();tP.startListening({actionCreator:eP,effect:(e,t)=>{var n=e.payload,r=JC(t.getState(),QC(n));null!=(null==r?void 0:r.activeIndex)&&t.dispatch(gv({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var nP=nm("mouseMove"),rP=qm(),iP=null;function aP(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":"children"===e&&"object"==typeof t&&null!==t?"<<CHILDREN>>":t}function oP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oP(Object(n),!0).forEach((function(t){lP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}rP.startListening({actionCreator:nP,effect:(e,t)=>{var n=e.payload;null!==iP&&cancelAnimationFrame(iP);var r=QC(n);iP=requestAnimationFrame((()=>{var e=t.getState();if("axis"===AA(e,e.tooltip.settings.shared)){var n=JC(e,r);null!=(null==n?void 0:n.activeIndex)?t.dispatch(mv({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate})):t.dispatch(pv())}iP=null}))}});var cP=gm({name:"cartesianAxis",initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:sm()},replaceXAxis:{reducer(e,t){var{prev:n,next:r}=t.payload;void 0!==e.xAxis[n.id]&&(n.id!==r.id&&delete e.xAxis[n.id],e.xAxis[r.id]=r)},prepare:sm()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:sm()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:sm()},replaceYAxis:{reducer(e,t){var{prev:n,next:r}=t.payload;void 0!==e.yAxis[n.id]&&(n.id!==r.id&&delete e.yAxis[n.id],e.yAxis[r.id]=r)},prepare:sm()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:sm()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:sm()},replaceZAxis:{reducer(e,t){var{prev:n,next:r}=t.payload;void 0!==e.zAxis[n.id]&&(n.id!==r.id&&delete e.zAxis[n.id],e.zAxis[r.id]=r)},prepare:sm()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:sm()},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload,i=e.yAxis[n];if(i){var a,o=i.widthHistory||[];if(3===o.length&&o[0]===o[2]&&r===o[1]&&r!==i.width&&Math.abs(r-(null!==(a=o[0])&&void 0!==a?a:0))<=1)return;var s=[...o,r].slice(-3);e.yAxis[n]=sP(sP({},i),{},{width:r,widthHistory:s})}}}}),{addXAxis:uP,replaceXAxis:dP,removeXAxis:hP,addYAxis:pP,replaceYAxis:fP,removeYAxis:mP,addZAxis:gP,replaceZAxis:vP,removeZAxis:yP,updateYAxisWidth:xP}=cP.actions,bP=cP.reducer,_P=gm({name:"graphicalItems",initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:sm()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:r}=t.payload,i=zf(e).cartesianItems.indexOf(n);i>-1&&(e.cartesianItems[i]=r)},prepare:sm()},removeCartesianGraphicalItem:{reducer(e,t){var n=zf(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:sm()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:sm()},removePolarGraphicalItem:{reducer(e,t){var n=zf(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:sm()}}}),{addCartesianGraphicalItem:wP,replaceCartesianGraphicalItem:SP,removeCartesianGraphicalItem:MP,addPolarGraphicalItem:EP,removePolarGraphicalItem:TP}=_P.actions,AP=_P.reducer,CP=gm({name:"referenceElements",initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=zf(e).dots.findIndex((e=>e===t.payload));-1!==n&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=zf(e).areas.findIndex((e=>e===t.payload));-1!==n&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=zf(e).lines.findIndex((e=>e===t.payload));-1!==n&&e.lines.splice(n,1)}}}),{addDot:PP,removeDot:RP,addArea:OP,removeArea:DP,addLine:IP,removeLine:LP}=CP.actions,NP=CP.reducer,kP={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},UP=gm({name:"brush",initialState:kP,reducers:{setBrushSettings:(e,t)=>null==t.payload?kP:t.payload}}),{setBrushSettings:FP}=UP.actions,zP=UP.reducer,jP=gm({name:"legend",initialState:{settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:sm()},replaceLegendPayload:{reducer(e,t){var{prev:n,next:r}=t.payload,i=zf(e).payload.indexOf(n);i>-1&&(e.payload[i]=r)},prepare:sm()},removeLegendPayload:{reducer(e,t){var n=zf(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:sm()}}}),{setLegendSize:BP,setLegendSettings:HP,addLegendPayload:VP,replaceLegendPayload:GP,removeLegendPayload:WP}=jP.actions,XP=jP.reducer,qP={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},YP=gm({name:"rootProps",initialState:qP,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=null!==(n=t.payload.barGap)&&void 0!==n?n:qP.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),KP=YP.reducer,{updateOptions:$P}=YP.actions,ZP=gm({name:"polarAxis",initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:JP,removeRadiusAxis:QP,addAngleAxis:eR,removeAngleAxis:tR}=ZP.actions,nR=ZP.reducer,rR=gm({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:iR}=rR.actions,aR=rR.reducer,oR=nm("keyDown"),sR=nm("focus"),lR=qm();lR.startListening({actionCreator:oR,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip,i=e.payload;if("ArrowRight"===i||"ArrowLeft"===i||"Enter"===i){var a=IA(r,YA(n),aT(n),pC(n)),o=null==a?-1:Number(a);if(Number.isFinite(o)&&!(o<0)){var s=_C(n);if("Enter"!==i){var l=o+("ArrowRight"===i?1:-1)*("left-to-right"===SA(n)?1:-1);if(!(null==s||l>=s.length||l<0)){var c=qC(n,"axis","hover",String(l));t.dispatch(yv({active:!0,activeIndex:l.toString(),activeCoordinate:c}))}}else{var u=qC(n,"axis","hover",String(r.index));t.dispatch(yv({active:!r.active,activeIndex:r.index,activeCoordinate:u}))}}}}}}),lR.startListening({actionCreator:sR,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&null==r.index){var i=qC(n,"axis","hover",String("0"));t.dispatch(yv({active:!0,activeIndex:"0",activeCoordinate:i}))}}}});var cR=nm("externalEvent"),uR=qm(),dR=new Map;uR.startListening({actionCreator:cR,effect:(e,t)=>{var{handler:n,reactEvent:r}=e.payload;if(null!=n){r.persist();var i=r.type,a=dR.get(i);void 0!==a&&cancelAnimationFrame(a);var o=requestAnimationFrame((()=>{try{var e=t.getState(),a={activeCoordinate:OC(e),activeDataKey:CC(e),activeIndex:TC(e),activeLabel:AC(e),activeTooltipIndex:TC(e),isTooltipActive:DC(e)};n(a,r)}finally{dR.delete(i)}}));dR.set(i,o)}}});var hR=Fv([UA],(e=>e.tooltipItemPayloads)),pR=Fv([hR,(e,t)=>t,(e,t,n)=>n],((e,t,n)=>{if(null!=t){var r=e.find((e=>e.settings.graphicalItemId===n));if(null!=r){var{getPosition:i}=r;if(null!=i)return i(t)}}})),fR=nm("touchMove"),mR=qm();mR.startListening({actionCreator:fR,effect:(e,t)=>{var n=e.payload;if(null!=n.touches&&0!==n.touches.length){var r=t.getState(),i=AA(r,r.tooltip.settings.shared);if("axis"===i){var a=n.touches[0];if(null==a)return;var o=JC(r,QC({clientX:a.clientX,clientY:a.clientY,currentTarget:n.currentTarget}));null!=(null==o?void 0:o.activeIndex)&&t.dispatch(mv({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if("item"===i){var s,l=n.touches[0];if(null==document.elementFromPoint||null==l)return;var c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute("data-recharts-item-index"),d=null!==(s=c.getAttribute("data-recharts-item-id"))&&void 0!==s?s:void 0,h=WA(r).find((e=>e.id===d));if(null==u||null==h||null==d)return;var{dataKey:p}=h,f=pR(r,u,d);t.dispatch(dv({activeDataKey:p,activeIndex:u,activeCoordinate:f,activeGraphicalItemId:d}))}}}});var gR=gm({name:"errorBars",initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:i}=t.payload;e[n]&&(e[n]=e[n].map((e=>e.dataKey===r.dataKey&&e.direction===r.direction?i:e)))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter((e=>e.dataKey!==r.dataKey||e.direction!==r.direction)))}}}),{addErrorBar:vR,replaceErrorBar:yR,removeErrorBar:xR}=gR.actions,bR=gR.reducer,_R={devToolsEnabled:!0,isSsr:!("undefined"!=typeof window&&window.document&&Boolean(window.document.createElement)&&window.setTimeout)};function wR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wR(Object(n),!0).forEach((function(t){MR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function MR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ER={zIndexMap:Object.values($M).reduce(((e,t)=>SR(SR({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}})),{})},TR=new Set(Object.values($M)),AR=gm({name:"zIndex",initialState:ER,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:sm()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!function(e){return TR.has(e)}(n)&&delete e.zIndexMap[n])},prepare:sm()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n,element:r,isPanorama:i}=t.payload;e.zIndexMap[n]?i?e.zIndexMap[n].panoramaElement=r:e.zIndexMap[n].element=r:e.zIndexMap[n]={consumers:0,element:i?void 0:r,panoramaElement:i?r:void 0}},prepare:sm()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(t.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:sm()}}}),{registerZIndexPortal:CR,unregisterZIndexPortal:PR,registerZIndexPortalElement:RR,unregisterZIndexPortalElement:OR}=AR.actions,DR=Kf({brush:zP,cartesianAxis:bP,chartData:Mv,errorBars:bR,graphicalItems:AP,layout:Rv,legend:XP,options:Zm,polarAxis:nR,polarOptions:aR,referenceElements:NP,rootProps:KP,tooltip:xv,zIndex:AR.reducer});function IR(e){var{preloadedState:t,children:n,reduxStoreName:i}=e,a=Oy(),o=(0,r.useRef)(null);if(a)return n;null==o.current&&(o.current=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Chart";return function(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=e??{};let a=new rm;return t&&("boolean"==typeof t?a.push(Qf):a.push(em(t.extraArgument))),a},{reducer:n,middleware:r,devTools:i=!0,duplicateMiddlewareCheck:a=!0,preloadedState:o,enhancers:s}=e||{};let l,c;if("function"==typeof n)l=n;else{if(!qf(n))throw new Error(Ym(1));l=Kf(n)}c="function"==typeof r?r(t):t();let u=$f;i&&(u=tm({trace:!1,..."object"==typeof i&&i}));const d=function(...e){return t=>(n,r)=>{const i=t(n,r);let a=()=>{throw new Error(Vf(15))};const o={getState:i.getState,dispatch:(e,...t)=>a(e,...t)},s=e.map((e=>e(o)));return a=$f(...s)(i.dispatch),{...i,dispatch:a}}}(...c),h=(e=>function(t){const{autoBatch:n=!0}=t??{};let r=new rm(e);return n&&r.push(cm("object"==typeof n?n:void 0)),r})(d);return Yf(l,o,u(..."function"==typeof s?s(h):h()))}({reducer:DR,preloadedState:e,middleware:e=>e({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes("es6")}).concat([tP.middleware,rP.middleware,lR.middleware,uR.middleware,mR.middleware]),enhancers:e=>{var t=e;return"function"==typeof e&&(t=e()),t.concat(cm({type:"raf"}))},devTools:_R.devToolsEnabled&&{serialize:{replacer:aP},name:"recharts-".concat(t)}})}(t,i));var s=jv;return r.createElement(hg,{context:s,store:o.current},n)}var LR=e=>{var{chartData:t}=e,n=Hv(),i=Oy();return(0,r.useEffect)((()=>i?()=>{}:(n(_v(t)),()=>{n(_v(void 0))})),[t,n,i]),null},NR=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function kR(e,t){var n,r,i=new Set([...Object.keys(e),...Object.keys(t)]);for(var a of i)if(NR.has(a)){if(null==e[a]&&null==t[a])continue;if(!fg(e[a],t[a]))return!1}else if(n=e[a],r=t[a],!(null==n&&null==r||("number"==typeof n&&"number"==typeof r?n===r||n!=n&&r!=r:n===r)))return!1;return!0}function UR(e){var{layout:t,margin:n}=e,i=Hv(),a=Oy();return(0,r.useEffect)((()=>{a||(i(Av(t)),i(Tv(n)))}),[i,a,t,n]),null}var FR=(0,r.memo)(UR,kR);function zR(e){var t=Hv();return(0,r.useEffect)((()=>{t($P(e))}),[t,e]),null}var jR=()=>{var e;return null===(e=Xv((e=>e.rootProps.accessibilityLayer)))||void 0===e||e},BR=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function HR(e){return"string"==typeof e&&BR.includes(e)}var VR=new Set(["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"]);function GR(e){return"string"==typeof e&&VR.has(e)}function WR(e){return"string"==typeof e&&e.startsWith("data-")}function XR(e){if("object"!=typeof e||null===e)return{};var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(GR(n)||WR(n))&&(t[n]=e[n]);return t}function qR(e){return null==e?null:(0,r.isValidElement)(e)&&"object"==typeof e.props&&null!==e.props?XR(e.props):"object"!=typeof e||Array.isArray(e)?null:XR(e)}function YR(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(GR(n)||WR(n)||HR(n))&&(t[n]=e[n]);return t}var KR=["children","width","height","viewBox","className","style","title","desc"];function $R(){return $R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$R.apply(null,arguments)}var ZR=(0,r.forwardRef)(((e,t)=>{var{children:n,width:i,height:a,viewBox:o,className:s,style:l,title:c,desc:u}=e,d=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,KR),h=o||{width:i,height:a,x:0,y:0},p=Hh("recharts-surface",s);return r.createElement("svg",$R({},YR(d),{className:p,width:i,height:a,style:l,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),r.createElement("title",null,c),r.createElement("desc",null,u),n)})),JR=Fv((e=>e.zIndex.zIndexMap),((e,t)=>t),((e,t,n)=>n),((e,t,n)=>{if(null!=t){var r=e[t];if(null!=r)return n?r.panoramaElement:r.element}})),QR=Fv((e=>e.zIndex.zIndexMap),(e=>{var t=Object.keys(e).map((e=>parseInt(e,10))).concat(Object.values($M));return Array.from(new Set(t)).sort(((e,t)=>e-t))}),{memoizeOptions:{resultEqualityCheck:function(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}}});function eO(e){var{zIndex:t,isPanorama:n}=e,i=(0,r.useRef)(null),a=Hv();return(0,r.useLayoutEffect)((()=>(i.current&&a(RR({zIndex:t,element:i.current,isPanorama:n})),()=>{a(OR({zIndex:t,isPanorama:n}))})),[a,t,n]),r.createElement("g",{tabIndex:-1,ref:i})}function tO(e){var{children:t,isPanorama:n}=e,i=Xv(QR);if(!i||0===i.length)return t;var a=i.filter((e=>e<0)),o=i.filter((e=>e>0));return r.createElement(r.Fragment,null,a.map((e=>r.createElement(eO,{key:e,zIndex:e,isPanorama:n}))),t,o.map((e=>r.createElement(eO,{key:e,zIndex:e,isPanorama:n}))))}var nO=["children"];function rO(){return rO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rO.apply(null,arguments)}var iO={width:"100%",height:"100%",display:"block"},aO=(0,r.forwardRef)(((e,t)=>{var n=Fy(),i=zy(),a=jR();if(!bp(n)||!bp(i))return null;var o,s,{children:l,otherAttributes:c,title:u,desc:d}=e;return null!=c&&(o="number"==typeof c.tabIndex?c.tabIndex:a?0:void 0,s="string"==typeof c.role?c.role:a?"application":void 0),r.createElement(ZR,rO({},c,{title:u,desc:d,role:s,tabIndex:o,width:n,height:i,style:iO,ref:t}),l)})),oO=e=>{var{children:t}=e,n=Xv(Iy);if(!n)return null;var{width:i,height:a,y:o,x:s}=n;return r.createElement(ZR,{width:i,height:a,x:s,y:o},t)},sO=(0,r.forwardRef)(((e,t)=>{var{children:n}=e,i=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,nO);return Oy()?r.createElement(oO,null,r.createElement(tO,{isPanorama:!0},n)):r.createElement(aO,rO({ref:t},i),r.createElement(tO,{isPanorama:!1},n))})),lO=new(s(6729)),cO="recharts.syncEvent.tooltip",uO="recharts.syncEvent.brush";function dO(e){return e.tooltip.syncInteraction}var hO=["x","y"];function pO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pO(Object(n),!0).forEach((function(t){mO(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gO(){var e=Hv();(0,r.useEffect)((()=>{e(Jm())}),[e]),function(){var e=Xv(zM),t=Xv(BM),n=Hv(),i=Xv(jM),a=Xv(_C),o=By(),s=Ny(),l=Xv((e=>e.rootProps.className));(0,r.useEffect)((()=>{if(null==e)return up;var r=(r,l,c)=>{var u;if(t!==c&&e===r)if("index"!==i){if(null!=a){var d;if("function"==typeof i){var h={activeTooltipIndex:null==l.payload.index?void 0:Number(l.payload.index),isTooltipActive:l.payload.active,activeIndex:null==l.payload.index?void 0:Number(l.payload.index),activeLabel:l.payload.label,activeDataKey:l.payload.dataKey,activeCoordinate:l.payload.coordinate},p=i(a,h);d=a[p]}else"value"===i&&(d=a.find((e=>String(e.value)===l.payload.label)));var{coordinate:f}=l.payload;if(null!=d&&!1!==l.payload.active&&null!=f&&null!=s){var{x:m,y:g}=f,v=Math.min(m,s.x+s.width),y=Math.min(g,s.y+s.height),x={x:"horizontal"===o?d.coordinate:v,y:"horizontal"===o?y:d.coordinate},b=vv({active:l.payload.active,coordinate:x,dataKey:l.payload.dataKey,index:String(d.index),label:l.payload.label,sourceViewBox:l.payload.sourceViewBox,graphicalItemId:l.payload.graphicalItemId});n(b)}else n(vv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}))}}else if(s&&null!=l&&null!==(u=l.payload)&&void 0!==u&&u.coordinate&&l.payload.sourceViewBox){var _=l.payload.coordinate,{x:w,y:S}=_,M=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(_,hO),{x:E,y:T,width:A,height:C}=l.payload.sourceViewBox,P=fO(fO({},M),{},{x:s.x+(A?(w-E)/A:0)*s.width,y:s.y+(C?(S-T)/C:0)*s.height});n(fO(fO({},l),{},{payload:fO(fO({},l.payload),{},{coordinate:P})}))}else n(l)};return lO.on(cO,r),()=>{lO.off(cO,r)}}),[l,n,t,e,i,a,o,s])}(),function(){var e=Xv(zM),t=Xv(BM),n=Hv();(0,r.useEffect)((()=>{if(null==e)return up;var r=(r,i,a)=>{t!==a&&e===r&&n(wv(i))};return lO.on(uO,r),()=>{lO.off(uO,r)}}),[n,t,e])}()}var vO=(0,r.createContext)(null),yO=(0,r.createContext)(null);function xO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xO(Object(n),!0).forEach((function(t){_O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _O(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wO(){return wO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wO.apply(null,arguments)}var SO=()=>(gO(),null);function MO(e){if("number"==typeof e)return e;if("string"==typeof e){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var EO=(0,r.forwardRef)(((e,t)=>{var n,i,a=(0,r.useRef)(null),[o,s]=(0,r.useState)({containerWidth:MO(null===(n=e.style)||void 0===n?void 0:n.width),containerHeight:MO(null===(i=e.style)||void 0===i?void 0:i.height)}),l=(0,r.useCallback)(((e,t)=>{s((n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}}))}),[]),c=(0,r.useCallback)((e=>{if("function"==typeof t&&t(e),null!=e&&"undefined"!=typeof ResizeObserver){var{width:n,height:r}=e.getBoundingClientRect();l(n,r);var i=new ResizeObserver((e=>{var t=e[0];if(null!=t){var{width:n,height:r}=t.contentRect;l(n,r)}}));i.observe(e),a.current=i}}),[t,l]);return(0,r.useEffect)((()=>()=>{var e=a.current;null!=e&&e.disconnect()}),[l]),r.createElement(r.Fragment,null,r.createElement(Wy,{width:o.containerWidth,height:o.containerHeight}),r.createElement("div",wO({ref:c},e)))})),TO=(0,r.forwardRef)(((e,t)=>{var{width:n,height:i}=e,[a,o]=(0,r.useState)({containerWidth:MO(n),containerHeight:MO(i)}),s=(0,r.useCallback)(((e,t)=>{o((n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}}))}),[]),l=(0,r.useCallback)((e=>{if("function"==typeof t&&t(e),null!=e){var{width:n,height:r}=e.getBoundingClientRect();s(n,r)}}),[t,s]);return r.createElement(r.Fragment,null,r.createElement(Wy,{width:a.containerWidth,height:a.containerHeight}),r.createElement("div",wO({ref:l},e)))})),AO=(0,r.forwardRef)(((e,t)=>{var{width:n,height:i}=e;return r.createElement(r.Fragment,null,r.createElement(Wy,{width:n,height:i}),r.createElement("div",wO({ref:t},e)))})),CO=(0,r.forwardRef)(((e,t)=>{var{width:n,height:i}=e;return"string"==typeof n||"string"==typeof i?r.createElement(TO,wO({},e,{ref:t})):"number"==typeof n&&"number"==typeof i?r.createElement(AO,wO({},e,{width:n,height:i,ref:t})):r.createElement(r.Fragment,null,r.createElement(Wy,{width:n,height:i}),r.createElement("div",wO({ref:t},e)))})),PO=(0,r.forwardRef)(((e,t)=>{var{children:n,className:i,height:a,onClick:o,onContextMenu:s,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:h,onMouseUp:p,onTouchEnd:f,onTouchMove:m,onTouchStart:g,style:v,width:y,responsive:x,dispatchTouchEvents:b=!0}=e,_=(0,r.useRef)(null),w=Hv(),[S,M]=(0,r.useState)(null),[E,T]=(0,r.useState)(null),A=function(){var e=Hv(),[t,n]=(0,r.useState)(null),i=Xv(by);return(0,r.useEffect)((()=>{if(null!=t){var n=t.getBoundingClientRect().width/t.offsetWidth;xp(n)&&n!==i&&e(Pv(n))}}),[t,e,i]),n}(),C=Ap(),P=(null==C?void 0:C.width)>0?C.width:y,R=(null==C?void 0:C.height)>0?C.height:a,O=(0,r.useCallback)((e=>{A(e),"function"==typeof t&&t(e),M(e),T(e),null!=e&&(_.current=e)}),[A,t,M,T]),D=(0,r.useCallback)((e=>{w(eP(e)),w(cR({handler:o,reactEvent:e}))}),[w,o]),I=(0,r.useCallback)((e=>{w(nP(e)),w(cR({handler:u,reactEvent:e}))}),[w,u]),L=(0,r.useCallback)((e=>{w(pv()),w(cR({handler:d,reactEvent:e}))}),[w,d]),N=(0,r.useCallback)((e=>{w(nP(e)),w(cR({handler:h,reactEvent:e}))}),[w,h]),k=(0,r.useCallback)((()=>{w(sR())}),[w]),U=(0,r.useCallback)((e=>{w(oR(e.key))}),[w]),F=(0,r.useCallback)((e=>{w(cR({handler:s,reactEvent:e}))}),[w,s]),z=(0,r.useCallback)((e=>{w(cR({handler:l,reactEvent:e}))}),[w,l]),j=(0,r.useCallback)((e=>{w(cR({handler:c,reactEvent:e}))}),[w,c]),B=(0,r.useCallback)((e=>{w(cR({handler:p,reactEvent:e}))}),[w,p]),H=(0,r.useCallback)((e=>{w(cR({handler:g,reactEvent:e}))}),[w,g]),V=(0,r.useCallback)((e=>{b&&w(fR(e)),w(cR({handler:m,reactEvent:e}))}),[w,b,m]),G=(0,r.useCallback)((e=>{w(cR({handler:f,reactEvent:e}))}),[w,f]),W=function(e){return e?EO:CO}(x);return r.createElement(vO.Provider,{value:S},r.createElement(yO.Provider,{value:E},r.createElement(W,{width:null!=P?P:null==v?void 0:v.width,height:null!=R?R:null==v?void 0:v.height,className:Hh("recharts-wrapper",i),style:bO({position:"relative",cursor:"default",width:P,height:R},v),onClick:D,onContextMenu:F,onDoubleClick:z,onFocus:k,onKeyDown:U,onMouseDown:j,onMouseEnter:I,onMouseLeave:L,onMouseMove:N,onMouseUp:B,onTouchEnd:G,onTouchMove:V,onTouchStart:H,ref:O},r.createElement(SO,null),n)))})),RO=Fv([Ay],(e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right}))),OO=Fv([RO,yy,xy],((e,t,n)=>{if(e&&null!=t&&null!=n)return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}})),DO=()=>Xv(OO),IO=(0,r.createContext)(void 0),LO=e=>{var{children:t}=e,[n]=(0,r.useState)("".concat(np("recharts"),"-clip")),i=DO();if(null==i)return null;var{x:a,y:o,width:s,height:l}=i;return r.createElement(IO.Provider,{value:n},r.createElement("defs",null,r.createElement("clipPath",{id:n},r.createElement("rect",{x:a,y:o,height:l,width:s}))),t)},NO=["width","height","responsive","children","className","style","compact","title","desc"],kO=(0,r.forwardRef)(((e,t)=>{var{width:n,height:i,responsive:a,children:o,className:s,style:l,compact:c,title:u,desc:d}=e,h=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,NO),p=XR(h);return c?r.createElement(r.Fragment,null,r.createElement(Wy,{width:n,height:i}),r.createElement(sO,{otherAttributes:p,title:u,desc:d},o)):r.createElement(PO,{className:s,style:l,width:n,height:i,responsive:null!=a&&a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},r.createElement(sO,{otherAttributes:p,title:u,desc:d,ref:t},r.createElement(LO,null,o)))}));function UO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function FO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zO(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UO(Object(n),!0).forEach((function(t){FO(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),r=t;return Object.keys(t).reduce(((e,t)=>(void 0===e[t]&&void 0!==r[t]&&(e[t]=r[t]),e)),n)}function jO(){return jO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jO.apply(null,arguments)}var BO={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:{top:5,right:5,bottom:5,left:5},responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},HO=(0,r.forwardRef)((function(e,t){var n,i=zO(e.categoricalChartProps,BO),{chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:s,tooltipPayloadSearcher:l,categoricalChartProps:c}=e,u={chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:s,tooltipPayloadSearcher:l,eventEmitter:void 0};return r.createElement(IR,{preloadedState:{options:u},reduxStoreName:null!==(n=c.id)&&void 0!==n?n:a},r.createElement(LR,{chartData:c.data}),r.createElement(FR,{layout:i.layout,margin:i.margin}),r.createElement(zR,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),r.createElement(kO,jO({},i,{ref:t})))})),VO=["axis"],GO=(0,r.forwardRef)(((e,t)=>r.createElement(HO,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:VO,tooltipPayloadSearcher:Km,categoricalChartProps:e,ref:t})));function WO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function XO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qO=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WO(Object(n),!0).forEach((function(t){XO(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WO(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},{cacheSize:2e3,enableCache:!0}),YO=new class{constructor(e){(function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})(this,"cache",new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return void 0!==t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;null!=n&&this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}(qO.cacheSize),KO={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},$O="recharts_measurement_span",ZO=(e,t)=>{try{var n=document.getElementById($O);n||((n=document.createElement("span")).setAttribute("id",$O),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,KO,t),n.textContent="".concat(e);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch(e){return{width:0,height:0}}},JO=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e||_R.isSsr)return{width:0,height:0};if(!qO.enableCache)return ZO(e,t);var n=function(e,t){var n=t.fontSize||"",r=t.fontFamily||"",i=t.fontWeight||"",a=t.fontStyle||"",o=t.letterSpacing||"",s=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(r,"|").concat(i,"|").concat(a,"|").concat(o,"|").concat(s)}(e,t),r=YO.get(n);if(r)return r;var i=ZO(e,t);return YO.set(n,i),i};function QO(e,t){if(t<1)return[];if(1===t)return e;for(var n=[],r=0;r<e.length;r+=t){var i=e[r];void 0!==i&&n.push(i)}return n}function eD(e,t,n,r,i){if(e*t<e*r||e*t>e*i)return!1;var a=n();return e*(t-e*a/2-r)>=0&&e*(t+e*a/2-i)<=0}function tD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tD(Object(n),!0).forEach((function(t){rD(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iD(e,t,n){var r,{tick:i,ticks:a,viewBox:o,minTickGap:s,orientation:l,interval:c,tickFormatter:u,unit:d,angle:h}=e;if(!a||!a.length||!i)return[];if(Qh(c)||_R.isSsr)return null!==(r=function(e,t){return QO(e,t+1)}(a,Qh(c)?c:0))&&void 0!==r?r:[];var p=[],f="top"===l||"bottom"===l?"width":"height",m=d&&"width"===f?JO(d,{fontSize:t,letterSpacing:n}):{width:0,height:0},g=(e,r)=>{var i="function"==typeof u?u(e.value,r):e.value;return"width"===f?function(e,t,n){return function(e){var{width:t,height:n}=e,r=((arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)%180+180)%180*Math.PI/180,i=Math.atan(n/t),a=r>i&&r<Math.PI-i?n/Math.sin(r):t/Math.cos(r);return Math.abs(a)}({width:e.width+t.width,height:e.height+t.height},n)}(JO(i,{fontSize:t,letterSpacing:n}),m,h):JO(i,{fontSize:t,letterSpacing:n})[f]},v=a[0],y=a[1],x=a.length>=2&&null!=v&&null!=y?$h(y.coordinate-v.coordinate):1,b=function(e,t,n){var r="width"===n,{x:i,y:a,width:o,height:s}=e;return 1===t?{start:r?i:a,end:r?i+o:a+s}:{start:r?i+o:a+s,end:r?i:a}}(o,x,f);return"equidistantPreserveStart"===c?function(e,t,n,r,i){for(var a,o=(r||[]).slice(),{start:s,end:l}=t,c=0,u=1,d=s,h=function(){var t=null==r?void 0:r[c];if(void 0===t)return{v:QO(r,u)};var a,o=c,h=()=>(void 0===a&&(a=n(t,o)),a),p=t.coordinate,f=0===c||eD(e,p,h,d,l);f||(c=0,d=s,u+=1),f&&(d=p+e*(h()/2+i),c+=u)};u<=o.length;)if(a=h())return a.v;return[]}(x,b,g,a,s):"equidistantPreserveEnd"===c?function(e,t,n,r,i){var a=(r||[]).slice().length;if(0===a)return[];for(var{start:o,end:s}=t,l=1;l<=a;l++){for(var c,u=(a-1)%l,d=o,h=!0,p=function(){var t=r[f];if(null==t)return 0;var a,o=f,l=()=>(void 0===a&&(a=n(t,o)),a),c=t.coordinate,p=f===u||eD(e,c,l,d,s);if(!p)return h=!1,1;p&&(d=c+e*(l()/2+i))},f=u;f<a&&(0===(c=p())||1!==c);f+=l);if(h){for(var m=[],g=u;g<a;g+=l){var v=r[g];null!=v&&m.push(v)}return m}}return[]}(x,b,g,a,s):(p="preserveStart"===c||"preserveStartEnd"===c?function(e,t,n,r,i,a){var o=(r||[]).slice(),s=o.length,{start:l,end:c}=t;if(a){var u=r[s-1];if(null!=u){var d=n(u,s-1),h=e*(u.coordinate+e*d/2-c);o[s-1]=u=nD(nD({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate}),null!=u.tickCoord&&eD(e,u.tickCoord,(()=>d),l,c)&&(c=u.tickCoord-e*(d/2+i),o[s-1]=nD(nD({},u),{},{isShow:!0}))}}for(var p=a?s-1:s,f=function(t){var r=o[t];if(null==r)return 1;var a,s=r,u=()=>(void 0===a&&(a=n(r,t)),a);if(0===t){var d=e*(s.coordinate-e*u()/2-l);o[t]=s=nD(nD({},s),{},{tickCoord:d<0?s.coordinate-d*e:s.coordinate})}else o[t]=s=nD(nD({},s),{},{tickCoord:s.coordinate});null!=s.tickCoord&&eD(e,s.tickCoord,u,l,c)&&(l=s.tickCoord+e*(u()/2+i),o[t]=nD(nD({},s),{},{isShow:!0}))},m=0;m<p;m++)f(m);return o}(x,b,g,a,s,"preserveStartEnd"===c):function(e,t,n,r,i){for(var a=(r||[]).slice(),o=a.length,{start:s}=t,{end:l}=t,c=function(t){var r=a[t];if(null==r)return 1;var c,u=r,d=()=>(void 0===c&&(c=n(r,t)),c);if(t===o-1){var h=e*(u.coordinate+e*d()/2-l);a[t]=u=nD(nD({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate})}else a[t]=u=nD(nD({},u),{},{tickCoord:u.coordinate});null!=u.tickCoord&&eD(e,u.tickCoord,d,s,l)&&(l=u.tickCoord-e*(d()/2+i),a[t]=nD(nD({},u),{},{isShow:!0}))},u=o-1;u>=0;u--)c(u);return a}(x,b,g,a,s),p.filter((e=>e.isShow)))}var aD=["children","className"];function oD(){return oD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oD.apply(null,arguments)}var sD=r.forwardRef(((e,t)=>{var{children:n,className:i}=e,a=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,aD),o=Hh("recharts-layer",i);return r.createElement("g",oD({className:o},YR(a),{ref:t}),n)})),lD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,uD=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,dD=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,hD={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},pD=["cm","mm","pt","pc","in","Q","px"],fD="NaN";class mD{static parse(e){var t,[,n,r]=null!==(t=dD.exec(e))&&void 0!==t?t:[];return null==n?mD.NaN:new mD(parseFloat(n),null!=r?r:"")}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,Zh(e)&&(this.unit=""),""===t||uD.test(t)||(this.num=NaN,this.unit=""),function(e){return pD.includes(e)}(t)&&(this.num=function(e,t){return e*hD[t]}(e,t),this.unit="px")}add(e){return this.unit!==e.unit?new mD(NaN,""):new mD(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new mD(NaN,""):new mD(this.num-e.num,this.unit)}multiply(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new mD(NaN,""):new mD(this.num*e.num,this.unit||e.unit)}divide(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new mD(NaN,""):new mD(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Zh(this.num)}}function gD(e){if(null==e||e.includes(fD))return fD;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,i,a]=null!==(n=lD.exec(t))&&void 0!==n?n:[],o=mD.parse(null!=r?r:""),s=mD.parse(null!=a?a:""),l="*"===i?o.multiply(s):o.divide(s);if(l.isNaN())return fD;t=t.replace(lD,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,u,d,h]=null!==(c=cD.exec(t))&&void 0!==c?c:[],p=mD.parse(null!=u?u:""),f=mD.parse(null!=h?h:""),m="+"===d?p.add(f):p.subtract(f);if(m.isNaN())return fD;t=t.replace(cD,m.toString())}return t}!function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(mD,"NaN",new mD(NaN,""));var vD=/\(([^()]*)\)/;function yD(e){var t=function(e){try{return function(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t,n=e;null!=(t=vD.exec(n));){var[,r]=t;n=n.replace(vD,gD(r))}return n}(t),gD(t)}(e)}catch(e){return fD}}(e.slice(5,-1));return t===fD?"":t}var xD=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],bD=["dx","dy","angle","className","breakAll"];function _D(){return _D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_D.apply(null,arguments)}function wD(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var SD=/[ \f\n\r\t\v\u2028\u2029]+/,MD=e=>{var{children:t,breakAll:n,style:r}=e;try{var i=[];return sp(t)||(i=n?t.toString().split(""):t.toString().split(SD)),{wordsWithComputedWidth:i.map((e=>({word:e,width:JO(e,r).width}))),spaceWidth:n?0:JO(" ",r).width}}catch(e){return null}};function ED(e){return"start"===e||"middle"===e||"end"===e||"inherit"===e}var TD=(e,t,n,r)=>e.reduce(((e,i)=>{var{word:a,width:o}=i,s=e[e.length-1];if(s&&null!=o&&(null==t||r||s.width+o+n<Number(t)))s.words.push(a),s.width+=o+n;else{var l={words:[a],width:o};e.push(l)}return e}),[]),AD=e=>e.reduce(((e,t)=>e.width>t.width?e:t)),CD=(e,t,n,r,i,a,o,s)=>{var l=e.slice(0,t),c=MD({breakAll:n,style:r,children:l+"…"});if(!c)return[!1,[]];var u=TD(c.wordsWithComputedWidth,a,o,s);return[u.length>i||AD(u).width>Number(a),u]},PD=e=>[{words:sp(e)?[]:e.toString().split(SD),width:void 0}],RD="#808080",OD={angle:0,breakAll:!1,capHeight:"0.71em",fill:RD,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},DD=(0,r.forwardRef)(((e,t)=>{var n=zO(e,OD),{x:i,y:a,lineHeight:o,capHeight:s,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=n,h=wD(n,xD),p=(0,r.useMemo)((()=>(e=>{var{width:t,scaleToFit:n,children:r,style:i,breakAll:a,maxLines:o}=e;if((t||n)&&!_R.isSsr){var s=MD({breakAll:a,children:r,style:i});if(!s)return PD(r);var{wordsWithComputedWidth:l,spaceWidth:c}=s;return((e,t,n,r,i)=>{var{maxLines:a,children:o,style:s,breakAll:l}=e,c=Qh(a),u=String(o),d=TD(t,r,n,i);if(!c||i)return d;if(!(d.length>a||AD(d).width>Number(r)))return d;for(var h,p=0,f=u.length-1,m=0;p<=f&&m<=u.length-1;){var g=Math.floor((p+f)/2),v=g-1,[y,x]=CD(u,v,l,s,a,r,n,i),[b]=CD(u,g,l,s,a,r,n,i);if(y||b||(p=g+1),y&&b&&(f=g-1),!y&&b){h=x;break}m++}return h||d})({breakAll:a,children:r,maxLines:o,style:i},l,c,t,Boolean(n))}return PD(r)})({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:c,style:h.style,width:h.width})),[h.breakAll,h.children,h.maxLines,c,h.style,h.width]),{dx:f,dy:m,angle:g,className:v,breakAll:y}=h,x=wD(h,bD);if(!ep(i)||!ep(a)||0===p.length)return null;var b,_=Number(i)+(Qh(f)?f:0),w=Number(a)+(Qh(m)?m:0);if(!xp(_)||!xp(w))return null;switch(d){case"start":b=yD("calc(".concat(s,")"));break;case"middle":b=yD("calc(".concat((p.length-1)/2," * -").concat(o," + (").concat(s," / 2))"));break;default:b=yD("calc(".concat(p.length-1," * -").concat(o,")"))}var S=[],M=p[0];if(c&&null!=M){var E=M.width,{width:T}=h;S.push("scale(".concat(Qh(T)&&Qh(E)?T/E:1,")"))}return g&&S.push("rotate(".concat(g,", ").concat(_,", ").concat(w,")")),S.length&&(x.transform=S.join(" ")),r.createElement("text",_D({},YR(x),{ref:t,x:_,y:w,className:Hh("recharts-text",v),textAnchor:u,fill:l.includes("url")?RD:l}),p.map(((e,t)=>{var n=e.words.join(y?"":" ");return r.createElement("tspan",{x:_,dy:0===t?b:o,key:"".concat(n,"-").concat(t)},n)})))}));function ID(e){var{zIndex:t,children:n}=e,i=Gy()&&void 0!==t&&0!==t,a=Oy(),o=Hv();(0,r.useLayoutEffect)((()=>i?(o(CR({zIndex:t})),()=>{o(PR({zIndex:t}))}):up),[o,t,i]);var s=Xv((e=>JR(e,t,a)));return i?s?(0,tg.createPortal)(n,s):null:n}function LD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ND(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?LD(Object(n),!0).forEach((function(t){kD(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}DD.displayName="Text";var UD=e=>{var{viewBox:t,position:n,offset:r=0,parentViewBox:i,clamp:a}=e,{x:o,y:s,height:l,upperWidth:c,lowerWidth:u}=Ly(t),d=o,h=o+(c-u)/2,p=(d+h)/2,f=(c+u)/2,m=d+c/2,g=l>=0?1:-1,v=g*r,y=g>0?"end":"start",x=g>0?"start":"end",b=c>=0?1:-1,_=b*r,w=b>0?"end":"start",S=b>0?"start":"end",M=i;if("top"===n){var E={x:d+c/2,y:s-v,horizontalAnchor:"middle",verticalAnchor:y};return a&&M&&(E.height=Math.max(s-M.y,0),E.width=c),E}if("bottom"===n){var T={x:h+u/2,y:s+l+v,horizontalAnchor:"middle",verticalAnchor:x};return a&&M&&(T.height=Math.max(M.y+M.height-(s+l),0),T.width=u),T}if("left"===n){var A={x:p-_,y:s+l/2,horizontalAnchor:w,verticalAnchor:"middle"};return a&&M&&(A.width=Math.max(A.x-M.x,0),A.height=l),A}if("right"===n){var C={x:p+f+_,y:s+l/2,horizontalAnchor:S,verticalAnchor:"middle"};return a&&M&&(C.width=Math.max(M.x+M.width-C.x,0),C.height=l),C}var P=a&&M?{width:f,height:l}:{};return"insideLeft"===n?ND({x:p+_,y:s+l/2,horizontalAnchor:S,verticalAnchor:"middle"},P):"insideRight"===n?ND({x:p+f-_,y:s+l/2,horizontalAnchor:w,verticalAnchor:"middle"},P):"insideTop"===n?ND({x:d+c/2,y:s+v,horizontalAnchor:"middle",verticalAnchor:x},P):"insideBottom"===n?ND({x:h+u/2,y:s+l-v,horizontalAnchor:"middle",verticalAnchor:y},P):"insideTopLeft"===n?ND({x:d+_,y:s+v,horizontalAnchor:S,verticalAnchor:x},P):"insideTopRight"===n?ND({x:d+c-_,y:s+v,horizontalAnchor:w,verticalAnchor:x},P):"insideBottomLeft"===n?ND({x:h+_,y:s+l-v,horizontalAnchor:S,verticalAnchor:y},P):"insideBottomRight"===n?ND({x:h+u-_,y:s+l-v,horizontalAnchor:w,verticalAnchor:y},P):n&&"object"==typeof n&&(Qh(n.x)||Jh(n.x))&&(Qh(n.y)||Jh(n.y))?ND({x:o+rp(n.x,f),y:s+rp(n.y,l),horizontalAnchor:"end",verticalAnchor:"end"},P):ND({x:m,y:s+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},P)},FD=["labelRef"],zD=["content"];function jD(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function BD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BD(Object(n),!0).forEach((function(t){VD(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function VD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GD(){return GD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GD.apply(null,arguments)}var WD=(0,r.createContext)(null),XD=e=>{var{x:t,y:n,upperWidth:i,lowerWidth:a,width:o,height:s,children:l}=e,c=(0,r.useMemo)((()=>({x:t,y:n,upperWidth:i,lowerWidth:a,width:o,height:s})),[t,n,i,a,o,s]);return r.createElement(WD.Provider,{value:c},l)},qD=()=>{var e=(0,r.useContext)(WD),t=Ny();return e||(t?Ly(t):void 0)},YD=(0,r.createContext)(null),KD=()=>{var e=(0,r.useContext)(YD),t=Xv(pE);return e||t},$D=e=>{var{value:t,formatter:n}=e,r=sp(e.children)?t:e.children;return"function"==typeof n?n(r):r},ZD=e=>null!=e&&"function"==typeof e,JD=(e,t,n,i,a)=>{var o,s,{offset:l,className:c}=e,{cx:u,cy:d,innerRadius:h,outerRadius:p,startAngle:f,endAngle:m,clockWise:g}=a,v=(h+p)/2,y=((e,t)=>$h(t-e)*Math.min(Math.abs(t-e),360))(f,m),x=y>=0?1:-1;switch(t){case"insideStart":o=f+x*l,s=g;break;case"insideEnd":o=m-x*l,s=!g;break;case"end":o=m+x*l,s=g;break;default:throw new Error("Unsupported position ".concat(t))}s=y<=0?s:!s;var b=qM(u,d,v,o),_=qM(u,d,v,o+359*(s?1:-1)),w="M".concat(b.x,",").concat(b.y,"\n    A").concat(v,",").concat(v,",0,1,").concat(s?0:1,",\n    ").concat(_.x,",").concat(_.y),S=sp(e.id)?np("recharts-radial-line-"):e.id;return r.createElement("text",GD({},i,{dominantBaseline:"central",className:Hh("recharts-radial-bar-label",c)}),r.createElement("defs",null,r.createElement("path",{id:S,d:w})),r.createElement("textPath",{xlinkHref:"#".concat(S)},n))},QD=(e,t,n)=>{var{cx:r,cy:i,innerRadius:a,outerRadius:o,startAngle:s,endAngle:l}=e,c=(s+l)/2;if("outside"===n){var{x:u,y:d}=qM(r,i,o+t,c);return{x:u,y:d,textAnchor:u>=r?"start":"end",verticalAnchor:"middle"}}if("center"===n)return{x:r,y:i,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===n)return{x:r,y:i,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===n)return{x:r,y:i,textAnchor:"middle",verticalAnchor:"end"};var h=(a+o)/2,{x:p,y:f}=qM(r,i,h,c);return{x:p,y:f,textAnchor:"middle",verticalAnchor:"middle"}},eI=e=>null!=e&&"cx"in e&&Qh(e.cx),tI={angle:0,offset:5,zIndex:$M.label,position:"middle",textBreakAll:!1};function nI(e){var t,n,i,a=zO(e,tI),{viewBox:o,parentViewBox:s,position:l,value:c,children:u,content:d,className:h="",textBreakAll:p,labelRef:f}=a,m=KD(),g=qD(),v=function(e){if(!eI(e))return e;var{cx:t,cy:n,outerRadius:r}=e,i=2*r;return{x:t-r,y:n-r,width:i,upperWidth:i,lowerWidth:i,height:i}}(t=null==o?"center"===l?g:null!=m?m:g:eI(o)?o:Ly(o));if(!t||sp(c)&&sp(u)&&!(0,r.isValidElement)(d)&&"function"!=typeof d)return null;var y=HD(HD({},a),{},{viewBox:t});if((0,r.isValidElement)(d)){var{labelRef:x}=y,b=jD(y,FD);return(0,r.cloneElement)(d,b)}if("function"==typeof d){var{content:_}=y,w=jD(y,zD);if(n=(0,r.createElement)(d,w),(0,r.isValidElement)(n))return n}else n=$D(a);var S=YR(a);if(eI(t)){if("insideStart"===l||"insideEnd"===l||"end"===l)return JD(a,l,n,S,t);i=QD(t,a.offset,a.position)}else{if(!v)return null;var M=UD({viewBox:v,position:l,offset:a.offset,parentViewBox:eI(s)?void 0:s,clamp:!0});i=HD(HD({x:M.x,y:M.y,textAnchor:M.horizontalAnchor,verticalAnchor:M.verticalAnchor},void 0!==M.width?{width:M.width}:{}),void 0!==M.height?{height:M.height}:{})}return r.createElement(ID,{zIndex:a.zIndex},r.createElement(DD,GD({ref:f,className:Hh("recharts-label",h)},S,i,{textAnchor:ED(S.textAnchor)?S.textAnchor:i.textAnchor,breakAll:p}),n))}nI.displayName="Label";function rI(e){var{label:t,labelRef:n}=e;return((e,t,n)=>{if(!e)return null;var i={viewBox:t,labelRef:n};return!0===e?r.createElement(nI,GD({key:"label-implicit"},i)):ep(e)?r.createElement(nI,GD({key:"label-implicit",value:e},i)):(0,r.isValidElement)(e)?e.type===nI?(0,r.cloneElement)(e,HD({key:"label-implicit"},i)):r.createElement(nI,GD({key:"label-implicit",content:e},i)):ZD(e)?r.createElement(nI,GD({key:"label-implicit",content:e},i)):e&&"object"==typeof e?r.createElement(nI,GD({},e,{key:"label-implicit"},i)):null})(t,qD(),n)||null}var iI=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,aI=(e,t)=>{if(!e||"function"==typeof e||"boolean"==typeof e)return null;var n=e;if((0,r.isValidElement)(e)&&(n=e.props),"object"!=typeof n&&"function"!=typeof n)return null;var i={};return Object.keys(n).forEach((e=>{HR(e)&&(i[e]=t||(t=>n[e](n,t)))})),i},oI=["axisLine","width","height","className","hide","ticks","axisType"];function sI(){return sI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sI.apply(null,arguments)}function lI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lI(Object(n),!0).forEach((function(t){uI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dI={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:$M.axis};function hI(e){var{x:t,y:n,width:i,height:a,orientation:o,mirror:s,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=cI(cI(cI({},c),XR(l)),{},{fill:"none"});if("top"===o||"bottom"===o){var d=+("top"===o&&!s||"bottom"===o&&s);u=cI(cI({},u),{},{x1:t,y1:n+d*a,x2:t+i,y2:n+d*a})}else{var h=+("left"===o&&!s||"right"===o&&s);u=cI(cI({},u),{},{x1:t+h*i,y1:n,x2:t+h*i,y2:n+a})}return r.createElement("line",sI({},u,{className:Hh("recharts-cartesian-axis-line",Xh()(l,"className"))}))}function pI(e){var t,n,{option:i,tickProps:a,value:o}=e,s=Hh(a.className,"recharts-cartesian-axis-tick-value");if(r.isValidElement(i))t=r.cloneElement(i,cI(cI({},a),{},{className:s}));else if("function"==typeof i)t=i(cI(cI({},a),{},{className:s}));else{var l="recharts-cartesian-axis-tick-value";"boolean"!=typeof i&&(l=Hh(l,(n=i)&&"object"==typeof n&&"className"in n&&"string"==typeof n.className?n.className:"")),t=r.createElement(DD,sI({},a,{className:l}),o)}return t}var fI=(0,r.forwardRef)(((e,t)=>{var{ticks:n=[],tick:i,tickLine:a,stroke:o,tickFormatter:s,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:h,x:p,y:f,width:m,height:g,tickSize:v,tickMargin:y,fontSize:x,letterSpacing:b,getTicksConfig:_,events:w,axisType:S}=e,M=iD(cI(cI({},_),{},{ticks:n}),x,b),E=function(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}(d,h),T=function(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}(d,h),A=XR(_),C=qR(i),P={};"object"==typeof a&&(P=a);var R=cI(cI({},A),{},{fill:"none"},P),O=M.map((e=>cI({entry:e},function(e,t,n,r,i,a,o,s,l){var c,u,d,h,p,f,m=s?-1:1,g=e.tickSize||o,v=Qh(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":c=u=e.coordinate,f=(d=(h=n+ +!s*i)-m*g)-m*l,p=v;break;case"left":d=h=e.coordinate,p=(c=(u=t+ +!s*r)-m*g)-m*l,f=v;break;case"right":d=h=e.coordinate,p=(c=(u=t+ +s*r)+m*g)+m*l,f=v;break;default:c=u=e.coordinate,f=(d=(h=n+ +s*i)+m*g)+m*l,p=v}return{line:{x1:c,y1:d,x2:u,y2:h},tick:{x:p,y:f}}}(e,p,f,m,g,d,v,h,y)))),D=O.map((e=>{var{entry:t,line:n}=e;return r.createElement(sD,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(t.value,"-").concat(t.coordinate,"-").concat(t.tickCoord)},a&&r.createElement("line",sI({},R,n,{className:Hh("recharts-cartesian-axis-tick-line",Xh()(a,"className"))})))})),I=O.map(((e,t)=>{var n,a,{entry:d,tick:h}=e,p=cI(cI(cI(cI({verticalAnchor:T},A),{},{textAnchor:E,stroke:"none",fill:o},h),{},{index:t,payload:d,visibleTicksCount:M.length,tickFormatter:s,padding:c},u),{},{angle:null!==(n=null!==(a=null==u?void 0:u.angle)&&void 0!==a?a:A.angle)&&void 0!==n?n:0}),f=cI(cI({},p),C);return r.createElement(sD,sI({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(d.value,"-").concat(d.coordinate,"-").concat(d.tickCoord)},((e,t,n)=>{if(null===e||"object"!=typeof e&&"function"!=typeof e)return null;var r=null;return Object.keys(e).forEach((i=>{var a=e[i];HR(i)&&"function"==typeof a&&(r||(r={}),r[i]=((e,t,n)=>r=>(e(t,n,r),null))(a,t,n))})),r})(w,d,t)),i&&r.createElement(pI,{option:i,tickProps:f,value:"".concat("function"==typeof s?s(d.value,t):d.value).concat(l||"")}))}));return r.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(S,"-ticks")},I.length>0&&r.createElement(ID,{zIndex:$M.label},r.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(S,"-tick-labels"),ref:t},I)),D.length>0&&r.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(S,"-tick-lines")},D))})),mI=(0,r.forwardRef)(((e,t)=>{var{axisLine:n,width:i,height:a,className:o,hide:s,ticks:l,axisType:c}=e,u=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,oI),[d,h]=(0,r.useState)(""),[p,f]=(0,r.useState)(""),m=(0,r.useRef)(null);(0,r.useImperativeHandle)(t,(()=>({getCalculatedWidth:()=>{var t;return(e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:i=0,tickMargin:a=0}=e,o=0;if(t){Array.from(t).forEach((e=>{if(e){var t=e.getBoundingClientRect();t.width>o&&(o=t.width)}}));var s=n?n.getBoundingClientRect().width:0,l=o+(i+a)+s+(n?r:0);return Math.round(l)}return 0})({ticks:m.current,label:null===(t=e.labelRef)||void 0===t?void 0:t.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}})));var g=(0,r.useCallback)((e=>{if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=t;var n=t[0];if(n){var r=window.getComputedStyle(n),i=r.fontSize,a=r.letterSpacing;i===d&&a===p||(h(i),f(a))}}}),[d,p]);return s||null!=i&&i<=0||null!=a&&a<=0?null:r.createElement(ID,{zIndex:e.zIndex},r.createElement(sD,{className:Hh("recharts-cartesian-axis",o)},r.createElement(hI,{x:e.x,y:e.y,width:i,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:XR(e)}),r.createElement(fI,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),r.createElement(XD,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},r.createElement(rI,{label:e.label,labelRef:e.labelRef}),e.children)))})),gI=r.forwardRef(((e,t)=>{var n=zO(e,dI);return r.createElement(mI,sI({},n,{ref:t}))}));gI.displayName="CartesianAxis";var vI=["x1","y1","x2","y2","key"],yI=["offset"],xI=["xAxisId","yAxisId"],bI=["xAxisId","yAxisId"];function _I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_I(Object(n),!0).forEach((function(t){SI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function SI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MI(){return MI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},MI.apply(null,arguments)}function EI(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var TI=e=>{var{fill:t}=e;if(!t||"none"===t)return null;var{fillOpacity:n,x:i,y:a,width:o,height:s,ry:l}=e;return r.createElement("rect",{x:i,y:a,ry:l,width:o,height:s,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function AI(e){var t,{option:n,lineItemProps:i}=e;if(r.isValidElement(n))t=r.cloneElement(n,i);else if("function"==typeof n)t=n(i);else{var a,{x1:o,y1:s,x2:l,y2:c,key:u}=i,d=null!==(a=XR(EI(i,vI)))&&void 0!==a?a:{},{offset:h}=d,p=EI(d,yI);t=r.createElement("line",MI({},p,{x1:o,y1:s,x2:l,y2:c,fill:"none",key:u}))}return t}function CI(e){var{x:t,width:n,horizontal:i=!0,horizontalPoints:a}=e;if(!i||!a||!a.length)return null;var{xAxisId:o,yAxisId:s}=e,l=EI(e,xI),c=a.map(((e,a)=>{var o=wI(wI({},l),{},{x1:t,y1:e,x2:t+n,y2:e,key:"line-".concat(a),index:a});return r.createElement(AI,{key:"line-".concat(a),option:i,lineItemProps:o})}));return r.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function PI(e){var{y:t,height:n,vertical:i=!0,verticalPoints:a}=e;if(!i||!a||!a.length)return null;var{xAxisId:o,yAxisId:s}=e,l=EI(e,bI),c=a.map(((e,a)=>{var o=wI(wI({},l),{},{x1:e,y1:t,x2:e,y2:t+n,key:"line-".concat(a),index:a});return r.createElement(AI,{option:i,lineItemProps:o,key:"line-".concat(a)})}));return r.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function RI(e){var{horizontalFill:t,fillOpacity:n,x:i,y:a,width:o,height:s,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||null==l)return null;var u=l.map((e=>Math.round(e+a-a))).sort(((e,t)=>e-t));a!==u[0]&&u.unshift(0);var d=u.map(((e,l)=>{var c=u[l+1],d=null==c?a+s-e:c-e;if(d<=0)return null;var h=l%t.length;return r.createElement("rect",{key:"react-".concat(l),y:e,x:i,height:d,width:o,stroke:"none",fill:t[h],fillOpacity:n,className:"recharts-cartesian-grid-bg"})}));return r.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function OI(e){var{vertical:t=!0,verticalFill:n,fillOpacity:i,x:a,y:o,width:s,height:l,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var u=c.map((e=>Math.round(e+a-a))).sort(((e,t)=>e-t));a!==u[0]&&u.unshift(0);var d=u.map(((e,t)=>{var c=u[t+1],d=null==c?a+s-e:c-e;if(d<=0)return null;var h=t%n.length;return r.createElement("rect",{key:"react-".concat(t),x:e,y:o,width:d,height:l,stroke:"none",fill:n[h],fillOpacity:i,className:"recharts-cartesian-grid-bg"})}));return r.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var DI=(e,t)=>{var{xAxis:n,width:r,height:i,offset:a}=e;return ly(iD(wI(wI(wI({},dI),n),{},{ticks:cy(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),a.left,a.left+a.width,t)},II=(e,t)=>{var{yAxis:n,width:r,height:i,offset:a}=e;return ly(iD(wI(wI(wI({},dI),n),{},{ticks:cy(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),a.top,a.top+a.height,t)},LI={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:$M.grid};function NI(e){var t=Fy(),n=zy(),i=Uy(),a=wI(wI({},zO(e,LI)),{},{x:Qh(e.x)?e.x:i.left,y:Qh(e.y)?e.y:i.top,width:Qh(e.width)?e.width:i.width,height:Qh(e.height)?e.height:i.height}),{xAxisId:o,yAxisId:s,x:l,y:c,width:u,height:d,syncWithTicks:h,horizontalValues:p,verticalValues:f}=a,m=Oy(),g=Xv((e=>yA(e,"xAxis",o,m))),v=Xv((e=>yA(e,"yAxis",s,m)));if(!(bp(u)&&bp(d)&&Qh(l)&&Qh(c)))return null;var y=a.verticalCoordinatesGenerator||DI,x=a.horizontalCoordinatesGenerator||II,{horizontalPoints:b,verticalPoints:_}=a;if(!(b&&b.length||"function"!=typeof x)){var w=p&&p.length,S=x({yAxis:v?wI(wI({},v),{},{ticks:w?p:v.ticks}):void 0,width:null!=t?t:u,height:null!=n?n:d,offset:i},!!w||h);dp(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(b=S)}if(!(_&&_.length||"function"!=typeof y)){var M=f&&f.length,E=y({xAxis:g?wI(wI({},g),{},{ticks:M?f:g.ticks}):void 0,width:null!=t?t:u,height:null!=n?n:d,offset:i},!!M||h);dp(Array.isArray(E),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(_=E)}return r.createElement(ID,{zIndex:a.zIndex},r.createElement("g",{className:"recharts-cartesian-grid"},r.createElement(TI,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),r.createElement(RI,MI({},a,{horizontalPoints:b})),r.createElement(OI,MI({},a,{verticalPoints:_})),r.createElement(CI,MI({},a,{offset:i,horizontalPoints:b,xAxis:g,yAxis:v})),r.createElement(PI,MI({},a,{offset:i,verticalPoints:_,xAxis:g,yAxis:v}))))}NI.displayName="CartesianGrid";var kI=["domain","range"],UI=["domain","range"];function FI(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function zI(e,t){return e===t||!(!Array.isArray(e)||2!==e.length||!Array.isArray(t)||2!==t.length)&&e[0]===t[0]&&e[1]===t[1]}function jI(e,t){if(e===t)return!0;var{domain:n,range:r}=e,i=FI(e,kI),{domain:a,range:o}=t,s=FI(t,UI);return!!zI(n,a)&&!!zI(r,o)&&kR(i,s)}var BI=["type"],HI=["dangerouslySetInnerHTML","ticks","scale"],VI=["id","scale"];function GI(){return GI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GI.apply(null,arguments)}function WI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function XI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WI(Object(n),!0).forEach((function(t){qI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YI(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function KI(e){var t=Hv(),n=(0,r.useRef)(null),i=Hy(),{type:a}=e,o=YI(e,BI),s=QM(i,"xAxis",a),l=(0,r.useMemo)((()=>{if(null!=s)return XI(XI({},o),{},{type:s})}),[o,s]);return(0,r.useLayoutEffect)((()=>{null!=l&&(null===n.current?t(uP(l)):n.current!==l&&t(dP({prev:n.current,next:l})),n.current=l)}),[l,t]),(0,r.useLayoutEffect)((()=>()=>{n.current&&(t(hP(n.current)),n.current=null)}),[t]),null}var $I=e=>{var{xAxisId:t,className:n}=e,i=Xv(Py),a=Oy(),o="xAxis",s=Xv((e=>xA(e,o,t,a))),l=Xv((e=>lA(e,t))),c=Xv((e=>dA(e,t))),u=Xv((e=>RE(e,t)));if(null==l||null==c||null==u)return null;var{dangerouslySetInnerHTML:d,ticks:h,scale:p}=e,f=YI(e,HI),{id:m,scale:g}=u,v=YI(u,VI);return r.createElement(gI,GI({},f,v,{x:c.x,y:c.y,width:l.width,height:l.height,className:Hh("recharts-".concat(o," ").concat(o),n),viewBox:i,ticks:s,axisType:o}))},ZI={allowDataOverflow:PE.allowDataOverflow,allowDecimals:PE.allowDecimals,allowDuplicatedCategory:PE.allowDuplicatedCategory,angle:PE.angle,axisLine:dI.axisLine,height:PE.height,hide:!1,includeHidden:PE.includeHidden,interval:PE.interval,label:!1,minTickGap:PE.minTickGap,mirror:PE.mirror,orientation:PE.orientation,padding:PE.padding,reversed:PE.reversed,scale:PE.scale,tick:PE.tick,tickCount:PE.tickCount,tickLine:dI.tickLine,tickSize:dI.tickSize,type:PE.type,xAxisId:0},JI=e=>{var t=zO(e,ZI);return r.createElement(r.Fragment,null,r.createElement(KI,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),r.createElement($I,t))},QI=r.memo(JI,jI);QI.displayName="XAxis";var eL=["type"],tL=["dangerouslySetInnerHTML","ticks","scale"],nL=["id","scale"];function rL(){return rL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rL.apply(null,arguments)}function iL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iL(Object(n),!0).forEach((function(t){oL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sL(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function lL(e){var t=Hv(),n=(0,r.useRef)(null),i=Hy(),{type:a}=e,o=sL(e,eL),s=QM(i,"yAxis",a),l=(0,r.useMemo)((()=>{if(null!=s)return aL(aL({},o),{},{type:s})}),[s,o]);return(0,r.useLayoutEffect)((()=>{null!=l&&(null===n.current?t(pP(l)):n.current!==l&&t(fP({prev:n.current,next:l})),n.current=l)}),[l,t]),(0,r.useLayoutEffect)((()=>()=>{n.current&&(t(mP(n.current)),n.current=null)}),[t]),null}function cL(e){var{yAxisId:t,className:n,width:i,label:a}=e,o=(0,r.useRef)(null),s=(0,r.useRef)(null),l=Xv(Py),c=Oy(),u=Hv(),d="yAxis",h=Xv((e=>pA(e,t))),p=Xv((e=>hA(e,t))),f=Xv((e=>xA(e,d,t,c))),m=Xv((e=>IE(e,t)));if((0,r.useLayoutEffect)((()=>{if("auto"===i&&h&&!ZD(a)&&!(0,r.isValidElement)(a)&&null!=m){var e=o.current;if(e){var n=e.getCalculatedWidth();Math.round(h.width)!==Math.round(n)&&u(xP({id:t,width:n}))}}}),[f,h,u,a,t,i,m]),null==h||null==p||null==m)return null;var{dangerouslySetInnerHTML:g,ticks:v,scale:y}=e,x=sL(e,tL),{id:b,scale:_}=m,w=sL(m,nL);return r.createElement(gI,rL({},x,w,{ref:o,labelRef:s,x:p.x,y:p.y,tickTextProps:"auto"===i?{width:void 0}:{width:i},width:h.width,height:h.height,className:Hh("recharts-".concat(d," ").concat(d),n),viewBox:l,ticks:f,axisType:d}))}var uL={allowDataOverflow:DE.allowDataOverflow,allowDecimals:DE.allowDecimals,allowDuplicatedCategory:DE.allowDuplicatedCategory,angle:DE.angle,axisLine:dI.axisLine,hide:!1,includeHidden:DE.includeHidden,interval:DE.interval,label:!1,minTickGap:DE.minTickGap,mirror:DE.mirror,orientation:DE.orientation,padding:DE.padding,reversed:DE.reversed,scale:DE.scale,tick:DE.tick,tickCount:DE.tickCount,tickLine:dI.tickLine,tickSize:dI.tickSize,type:DE.type,width:DE.width,yAxisId:0},dL=e=>{var t=zO(e,uL);return r.createElement(r.Fragment,null,r.createElement(lL,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),r.createElement(cL,t))},hL=r.memo(dL,jI);function pL(){return pL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pL.apply(null,arguments)}function fL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fL(Object(n),!0).forEach((function(t){gL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vL(e){return Array.isArray(e)&&ep(e[0])&&ep(e[1])?e.join(" ~ "):e}hL.displayName="YAxis";var yL={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},xL=e=>{var{separator:t=yL.separator,contentStyle:n,itemStyle:i,labelStyle:a=yL.labelStyle,payload:o,formatter:s,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:h,accessibilityLayer:p=yL.accessibilityLayer}=e,f=mL(mL({},yL.contentStyle),n),m=mL({margin:0},a),g=!sp(d),v=g?d:"",y=Hh("recharts-default-tooltip",c),x=Hh("recharts-tooltip-label",u);g&&h&&null!=o&&(v=h(d,o));var b=p?{role:"status","aria-live":"assertive"}:{};return r.createElement("div",pL({className:y,style:f},b),r.createElement("p",{className:x,style:m},r.isValidElement(v)?v:"".concat(v)),(()=>{if(o&&o.length){var e=(l?Yv()(o,l):o).map(((e,n)=>{if("none"===e.type)return null;var a=e.formatter||s||vL,{value:l,name:c}=e,u=l,d=c;if(a){var h=a(l,c,e,n,o);if(Array.isArray(h))[u,d]=h;else{if(null==h)return null;u=h}}var p=mL(mL({},yL.itemStyle),{},{color:e.color||yL.itemStyle.color},i);return r.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(n),style:p},ep(d)?r.createElement("span",{className:"recharts-tooltip-item-name"},d):null,ep(d)?r.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,r.createElement("span",{className:"recharts-tooltip-item-value"},u),r.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))}));return r.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null})())},bL="recharts-tooltip-wrapper",_L={visibility:"hidden"};function wL(e){var{coordinate:t,translateX:n,translateY:r}=e;return Hh(bL,{["".concat(bL,"-right")]:Qh(n)&&t&&Qh(t.x)&&n>=t.x,["".concat(bL,"-left")]:Qh(n)&&t&&Qh(t.x)&&n<t.x,["".concat(bL,"-bottom")]:Qh(r)&&t&&Qh(t.y)&&r>=t.y,["".concat(bL,"-top")]:Qh(r)&&t&&Qh(t.y)&&r<t.y})}function SL(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offset:i,position:a,reverseDirection:o,tooltipDimension:s,viewBox:l,viewBoxDimension:c}=e;if(a&&Qh(a[r]))return a[r];var u=n[r]-s-(i>0?i:0),d=n[r]+i;if(t[r])return o[r]?u:d;var h=l[r];return null==h?0:o[r]?u<h?Math.max(d,h):Math.max(u,h):null==c?0:d+s>h+c?Math.max(u,h):Math.max(d,h)}function ML(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function EL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ML(Object(n),!0).forEach((function(t){TL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ML(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function TL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class AL extends r.PureComponent{constructor(){super(...arguments),TL(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),TL(this,"handleKeyDown",(e=>{var t,n,r,i;"Escape"===e.key&&this.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(t=null===(n=this.props.coordinate)||void 0===n?void 0:n.x)&&void 0!==t?t:0,y:null!==(r=null===(i=this.props.coordinate)||void 0===i?void 0:i.y)&&void 0!==r?r:0}})}))}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,t;this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}render(){var{active:e,allowEscapeViewBox:t,animationDuration:n,animationEasing:i,children:a,coordinate:o,hasPayload:s,isAnimationActive:l,offset:c,position:u,reverseDirection:d,useTranslate3d:h,viewBox:p,wrapperStyle:f,lastBoundingBox:m,innerRef:g,hasPortalFromProps:v}=this.props,y="number"==typeof c?c:c.x,x="number"==typeof c?c:c.y,{cssClasses:b,cssProperties:_}=function(e){var t,n,r,{allowEscapeViewBox:i,coordinate:a,offsetTop:o,offsetLeft:s,position:l,reverseDirection:c,tooltipBox:u,useTranslate3d:d,viewBox:h}=e;return t=u.height>0&&u.width>0&&a?function(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:n=SL({allowEscapeViewBox:i,coordinate:a,key:"x",offset:s,position:l,reverseDirection:c,tooltipDimension:u.width,viewBox:h,viewBoxDimension:h.width}),translateY:r=SL({allowEscapeViewBox:i,coordinate:a,key:"y",offset:o,position:l,reverseDirection:c,tooltipDimension:u.height,viewBox:h,viewBoxDimension:h.height}),useTranslate3d:d}):_L,{cssProperties:t,cssClasses:wL({translateX:n,translateY:r,coordinate:a})}}({allowEscapeViewBox:t,coordinate:o,offsetLeft:y,offsetTop:x,position:u,reverseDirection:d,tooltipBox:{height:m.height,width:m.width},useTranslate3d:h,viewBox:p}),w=v?{}:EL(EL({transition:l&&e?"transform ".concat(n,"ms ").concat(i):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&s?"visible":"hidden",position:"absolute",top:0,left:0}),S=EL(EL({},w),{},{visibility:!this.state.dismissed&&e&&s?"visible":"hidden"},f);return r.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:b,style:S,ref:g},a)}}var CL=s(2996),PL=s.n(CL);function RL(){}function OL(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function DL(e){this._context=e}function IL(e){this._context=e}function LL(e){this._context=e}DL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:OL(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:OL(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},IL.prototype={areaStart:RL,areaEnd:RL,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:OL(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},LL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:OL(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class NL{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function kL(e){this._context=e}function UL(e){this._context=e}function FL(e){return new UL(e)}function zL(e){return e<0?-1:1}function jL(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(zL(a)+zL(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function BL(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function HL(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function VL(e){this._context=e}function GL(e){this._context=new WL(e)}function WL(e){this._context=e}function XL(e){this._context=e}function qL(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function YL(e,t){this._context=e,this._t=t}kL.prototype={areaStart:RL,areaEnd:RL,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},UL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},VL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:HL(this,this._t0,BL(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,HL(this,BL(this,n=jL(this,e,t)),n);break;default:HL(this,this._t0,n=jL(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(GL.prototype=Object.create(VL.prototype)).point=function(e,t){VL.prototype.point.call(this,t,e)},WL.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},XL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=qL(e),i=qL(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},YL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const KL=Math.PI,$L=2*KL,ZL=1e-6,JL=$L-ZL;function QL(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class eN{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?QL:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return QL;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,a){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+a}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,s=n-e,l=r-t,c=a-e,u=o-t,d=c*c+u*u;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(d>ZL)if(Math.abs(u*s-l*c)>ZL&&i){let h=n-a,p=r-o,f=s*s+l*l,m=h*h+p*p,g=Math.sqrt(f),v=Math.sqrt(d),y=i*Math.tan((KL-Math.acos((f+d-m)/(2*g*v)))/2),x=y/v,b=y/g;Math.abs(x-1)>ZL&&this._append`L${e+x*c},${t+x*u}`,this._append`A${i},${i},0,0,${+(u*h>c*p)},${this._x1=e+b*s},${this._y1=t+b*l}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,n,r,i,a){if(e=+e,t=+t,a=!!a,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(r),s=n*Math.sin(r),l=e+o,c=t+s,u=1^a,d=a?r-i:i-r;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>ZL||Math.abs(this._y1-c)>ZL)&&this._append`L${l},${c}`,n&&(d<0&&(d=d%$L+$L),d>JL?this._append`A${n},${n},0,1,${u},${e-o},${t-s}A${n},${n},0,1,${u},${this._x1=l},${this._y1=c}`:d>ZL&&this._append`A${n},${n},0,${+(d>=KL)},${u},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function tN(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new eN(t)}function nN(e){return e[0]}function rN(e){return e[1]}function iN(e,t){var n=Jv(!0),r=null,i=FL,a=null,o=tN(s);function s(s){var l,c,u,d=(s=Zv(s)).length,h=!1;for(null==r&&(a=i(u=o())),l=0;l<=d;++l)!(l<d&&n(c=s[l],l,s))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+e(c,l,s),+t(c,l,s));if(u)return a=null,u+""||null}return e="function"==typeof e?e:void 0===e?nN:Jv(e),t="function"==typeof t?t:void 0===t?rN:Jv(t),s.x=function(t){return arguments.length?(e="function"==typeof t?t:Jv(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:Jv(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:Jv(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(a=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=a=null:a=i(r=e),s):r},s}function aN(e,t,n){var r=null,i=Jv(!0),a=null,o=FL,s=null,l=tN(c);function c(c){var u,d,h,p,f,m=(c=Zv(c)).length,g=!1,v=new Array(m),y=new Array(m);for(null==a&&(s=o(f=l())),u=0;u<=m;++u){if(!(u<m&&i(p=c[u],u,c))===g)if(g=!g)d=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=d;--h)s.point(v[h],y[h]);s.lineEnd(),s.areaEnd()}g&&(v[u]=+e(p,u,c),y[u]=+t(p,u,c),s.point(r?+r(p,u,c):v[u],n?+n(p,u,c):y[u]))}if(f)return s=null,f+""||null}function u(){return iN().defined(i).curve(o).context(a)}return e="function"==typeof e?e:void 0===e?nN:Jv(+e),t="function"==typeof t?t:Jv(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?rN:Jv(+n),c.x=function(t){return arguments.length?(e="function"==typeof t?t:Jv(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:Jv(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Jv(+e),c):r},c.y=function(e){return arguments.length?(t="function"==typeof e?e:Jv(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"==typeof e?e:Jv(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:Jv(+e),c):n},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(n)},c.lineX1=function(){return u().x(r).y(t)},c.defined=function(e){return arguments.length?(i="function"==typeof e?e:Jv(!!e),c):i},c.curve=function(e){return arguments.length?(o=e,null!=a&&(s=o(a)),c):o},c.context=function(e){return arguments.length?(null==e?a=s=null:s=o(a=e),c):a},c}function oN(){return oN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oN.apply(null,arguments)}function sN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sN(Object(n),!0).forEach((function(t){cN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}eN.prototype;var uN={curveBasisClosed:function(e){return new IL(e)},curveBasisOpen:function(e){return new LL(e)},curveBasis:function(e){return new DL(e)},curveBumpX:function(e){return new NL(e,!0)},curveBumpY:function(e){return new NL(e,!1)},curveLinearClosed:function(e){return new kL(e)},curveLinear:FL,curveMonotoneX:function(e){return new VL(e)},curveMonotoneY:function(e){return new GL(e)},curveNatural:function(e){return new XL(e)},curveStep:function(e){return new YL(e,.5)},curveStepAfter:function(e){return new YL(e,1)},curveStepBefore:function(e){return new YL(e,0)}},dN=e=>xp(e.x)&&xp(e.y),hN=e=>null!=e.base&&dN(e.base)&&dN(e),pN=e=>e.x,fN=e=>e.y,mN={connectNulls:!1,type:"linear"},gN=e=>{var{className:t,points:n,path:i,pathRef:a}=e,o=By();if(!(n&&n.length||i))return null;var s={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||o,connectNulls:e.connectNulls},l=n&&n.length?(e=>{var{type:t=mN.type,points:n=[],baseLine:r,layout:i,connectNulls:a=mN.connectNulls}=e,o=((e,t)=>{if("function"==typeof e)return e;var n="curve".concat(lp(e));if(("curveMonotone"===n||"curveBump"===n)&&t){var r=uN["".concat(n).concat("vertical"===t?"Y":"X")];if(r)return r}return uN[n]||FL})(t,i),s=a?n.filter(dN):n;if(Array.isArray(r)){var l=n.map(((e,t)=>lN(lN({},e),{},{base:r[t]})));return("vertical"===i?aN().y(fN).x1(pN).x0((e=>e.base.x)):aN().x(pN).y1(fN).y0((e=>e.base.y))).defined(hN).curve(o)(a?l.filter(hN):l)}return("vertical"===i&&Qh(r)?aN().y(fN).x1(pN).x0(r):Qh(r)?aN().x(pN).y1(fN).y0(r):iN().x(pN).y(fN)).defined(dN).curve(o)(s)})(s):i;return r.createElement("path",oN({},XR(e),aI(e),{className:Hh("recharts-curve",t),d:null===l?void 0:l,ref:a}))},vN=["x","y","top","left","width","height","className"];function yN(){return yN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yN.apply(null,arguments)}function xN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _N=(e,t,n,r,i,a)=>"M".concat(e,",").concat(i,"v").concat(r,"M").concat(a,",").concat(t,"h").concat(n),wN=e=>{var{x:t=0,y:n=0,top:i=0,left:a=0,width:o=0,height:s=0,className:l}=e,c=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,vN),u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xN(Object(n),!0).forEach((function(t){bN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({x:t,y:n,top:i,left:a,width:o,height:s},c);return Qh(t)&&Qh(n)&&Qh(o)&&Qh(s)&&Qh(i)&&Qh(a)?r.createElement("path",yN({},YR(u),{className:Hh("recharts-cross",l),d:_N(t,n,o,s,i,a)})):null};function SN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function MN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SN(Object(n),!0).forEach((function(t){EN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function EN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var TN=(e,t)=>Object.keys(t).reduce(((n,r)=>MN(MN({},n),{},{[r]:e(r,t[r])})),{});function AN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function CN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AN(Object(n),!0).forEach((function(t){PN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function PN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var RN=(e,t,n)=>e+(t-e)*n,ON=e=>{var{from:t,to:n}=e;return t!==n},DN=(e,t,n)=>{var r=TN(((t,n)=>{if(ON(n)){var[r,i]=e(n.from,n.to,n.velocity);return CN(CN({},n),{},{from:r,velocity:i})}return n}),t);return n<1?TN(((e,t)=>ON(t)&&null!=r[e]?CN(CN({},t),{},{velocity:RN(t.velocity,r[e].velocity,n),from:RN(t.from,r[e].from,n)}):t),t):DN(e,r,n-1)};const IN=(e,t,n,r,i,a)=>{var o,s,l=(o=e,s=t,[Object.keys(o),Object.keys(s)].reduce(((e,t)=>e.filter((e=>t.includes(e))))));return null==n?()=>(i(CN(CN({},e),t)),()=>{}):!0===n.isStepper?function(e,t,n,r,i,a){var o,s=r.reduce(((n,r)=>CN(CN({},n),{},{[r]:{from:e[r],velocity:0,to:t[r]}})),{}),l=null,c=r=>{o||(o=r);var u=(r-o)/n.dt;s=DN(n,s,u),i(CN(CN(CN({},e),t),TN(((e,t)=>t.from),s))),o=r,Object.values(s).filter(ON).length&&(l=a.setTimeout(c))};return()=>(l=a.setTimeout(c),()=>{var e;null===(e=l)||void 0===e||e()})}(e,t,n,l,i,a):function(e,t,n,r,i,a,o){var s,l=null,c=i.reduce(((n,r)=>{var i=e[r],a=t[r];return null==i||null==a?n:CN(CN({},n),{},{[r]:[i,a]})}),{}),u=i=>{s||(s=i);var d=(i-s)/r,h=TN(((e,t)=>RN(...t,n(d))),c);if(a(CN(CN(CN({},e),t),h)),d<1)l=o.setTimeout(u);else{var p=TN(((e,t)=>RN(...t,n(1))),c);a(CN(CN(CN({},e),t),p))}};return()=>(l=o.setTimeout(u),()=>{var e;null===(e=l)||void 0===e||e()})}(e,t,n,r,l,i,a)};var LN=1e-4,NN=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],kN=(e,t)=>e.map(((e,n)=>e*t**n)).reduce(((e,t)=>e+t)),UN=(e,t)=>n=>{var r=NN(e,t);return kN(r,n)},FN=function(){return((e,t,n,r)=>{var i,a,o=UN(e,n),s=UN(t,r),l=(i=e,a=n,e=>{var t=[...NN(i,a).map(((e,t)=>e*t)).slice(1),0];return kN(t,e)}),c=e=>e>1?1:e<0?0:e,u=e=>{for(var t=e>1?1:e,n=t,r=0;r<8;++r){var i=o(n)-t,a=l(n);if(Math.abs(i-t)<LN||a<LN)return s(n);n=c(n-i/a)}return s(n)};return u.isStepper=!1,u})(...function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length)switch(t[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:var r=(e=>{var t,n=e.split("(");if(2!==n.length||"cubic-bezier"!==n[0])return null;var r=null===(t=n[1])||void 0===t||null===(t=t.split(")")[0])||void 0===t?void 0:t.split(",");if(null==r||4!==r.length)return null;var i=r.map((e=>parseFloat(e)));return[i[0],i[1],i[2],i[3]]})(t[0]);if(r)return r}return 4===t.length?t:[0,0,1,1]}(...arguments))},zN=e=>{if("string"==typeof e)switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return FN(e);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stiff:t=100,damping:n=8,dt:r=17}=e,i=(e,i,a)=>{var o=a+(-(e-i)*t-a*n)*r/1e3,s=a*r/1e3+e;return Math.abs(s-i)<LN&&Math.abs(o)<LN?[i,0]:[s,o]};return i.isStepper=!0,i.dt=r,i}();default:if("cubic-bezier"===e.split("(")[0])return FN(e)}return"function"==typeof e?e:null};class jN{setTimeout(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=performance.now(),r=null,i=a=>{a-n>=t?e(a):"function"==typeof requestAnimationFrame&&(r=requestAnimationFrame(i))};return r=requestAnimationFrame(i),()=>{null!=r&&cancelAnimationFrame(r)}}}function BN(){return e=new jN,t=()=>null,n=!1,r=null,i=a=>{if(!n){if(Array.isArray(a)){if(!a.length)return;var o=a,[s,...l]=o;return"number"==typeof s?void(r=e.setTimeout(i.bind(null,l),s)):(i(s),void(r=e.setTimeout(i.bind(null,l))))}"string"==typeof a&&t(a),"object"==typeof a&&t(a),"function"==typeof a&&a()}},{stop:()=>{n=!0},start:e=>{n=!1,r&&(r(),r=null),i(e)},subscribe:e=>(t=e,()=>{t=()=>null}),getTimeoutController:()=>e};var e,t,n,r,i}var HN=(0,r.createContext)(BN),VN={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},GN={t:0},WN={t:1};function XN(e){var t,n,i,a=zO(e,VN),{isActive:o,canBegin:s,duration:l,easing:c,begin:u,onAnimationEnd:d,onAnimationStart:h,children:p}=a,f="auto"===o?!_R.isSsr:o,m=(t=a.animationId,n=a.animationManager,i=(0,r.useContext)(HN),(0,r.useMemo)((()=>null!=n?n:i(t)),[t,n,i])),[g,v]=(0,r.useState)(f?GN:WN),y=(0,r.useRef)(null);return(0,r.useEffect)((()=>{f||v(WN)}),[f]),(0,r.useEffect)((()=>{if(!f||!s)return up;var e=IN(GN,WN,zN(c),l,v,m.getTimeoutController());return m.start([h,u,()=>{y.current=e()},l,d]),()=>{m.stop(),y.current&&y.current(),d()}}),[f,s,l,c,u,h,d,m]),p(g.t)}function qN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"animation-",n=(0,r.useRef)(np(t)),i=(0,r.useRef)(e);return i.current!==e&&(n.current=np(t),i.current=e),n.current}var YN,KN,$N,ZN,JN,QN,ek,tk,nk,rk,ik=["radius"],ak=["radius"];function ok(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ok(Object(n),!0).forEach((function(t){lk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ok(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ck(){return ck=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ck.apply(null,arguments)}function uk(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function dk(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var hk,pk,fk,mk,gk,vk,yk,xk=(e,t,n,r,i)=>{var a,o=Yh(n),s=Yh(r),l=Math.min(Math.abs(o)/2,Math.abs(s)/2),c=s>=0?1:-1,u=o>=0?1:-1,d=s>=0&&o>=0||s<0&&o<0?1:0;if(l>0&&Array.isArray(i)){for(var h=[0,0,0,0],p=0;p<4;p++){var f,m=null!==(f=i[p])&&void 0!==f?f:0;h[p]=m>l?l:m}a=Kh(YN||(YN=dk(["M",",",""])),e,t+c*h[0]),h[0]>0&&(a+=Kh(KN||(KN=dk(["A ",",",",0,0,",",",",",""])),h[0],h[0],d,e+u*h[0],t)),a+=Kh($N||($N=dk(["L ",",",""])),e+n-u*h[1],t),h[1]>0&&(a+=Kh(ZN||(ZN=dk(["A ",",",",0,0,",",\n        ",",",""])),h[1],h[1],d,e+n,t+c*h[1])),a+=Kh(JN||(JN=dk(["L ",",",""])),e+n,t+r-c*h[2]),h[2]>0&&(a+=Kh(QN||(QN=dk(["A ",",",",0,0,",",\n        ",",",""])),h[2],h[2],d,e+n-u*h[2],t+r)),a+=Kh(ek||(ek=dk(["L ",",",""])),e+u*h[3],t+r),h[3]>0&&(a+=Kh(tk||(tk=dk(["A ",",",",0,0,",",\n        ",",",""])),h[3],h[3],d,e,t+r-c*h[3])),a+="Z"}else if(l>0&&i===+i&&i>0){var g=Math.min(l,i);a=Kh(nk||(nk=dk(["M ",",","\n            A ",",",",0,0,",",",",","\n            L ",",","\n            A ",",",",0,0,",",",",","\n            L ",",","\n            A ",",",",0,0,",",",",","\n            L ",",","\n            A ",",",",0,0,",",",","," Z"])),e,t+c*g,g,g,d,e+u*g,t,e+n-u*g,t,g,g,d,e+n,t+c*g,e+n,t+r-c*g,g,g,d,e+n-u*g,t+r,e+u*g,t+r,g,g,d,e,t+r-c*g)}else a=Kh(rk||(rk=dk(["M ",","," h "," v "," h "," Z"])),e,t,n,r,-n);return a},bk={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_k=e=>{var t=zO(e,bk),n=(0,r.useRef)(null),[i,a]=(0,r.useState)(-1);(0,r.useEffect)((()=>{if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&a(e)}catch(e){}}),[]);var{x:o,y:s,width:l,height:c,radius:u,className:d}=t,{animationEasing:h,animationDuration:p,animationBegin:f,isAnimationActive:m,isUpdateAnimationActive:g}=t,v=(0,r.useRef)(l),y=(0,r.useRef)(c),x=(0,r.useRef)(o),b=(0,r.useRef)(s),_=qN((0,r.useMemo)((()=>({x:o,y:s,width:l,height:c,radius:u})),[o,s,l,c,u]),"rectangle-");if(o!==+o||s!==+s||l!==+l||c!==+c||0===l||0===c)return null;var w=Hh("recharts-rectangle",d);if(!g){var S=YR(t),{radius:M}=S,E=uk(S,ik);return r.createElement("path",ck({},E,{x:Yh(o),y:Yh(s),width:Yh(l),height:Yh(c),radius:"number"==typeof u?u:void 0,className:w,d:xk(o,s,l,c,u)}))}var T,A,C=v.current,P=y.current,R=x.current,O=b.current,D="0px ".concat(-1===i?1:i,"px"),I="".concat(i,"px 0px"),L=(T=p,A="string"==typeof h?h:bk.animationEasing,["strokeDasharray"].map((e=>{return"".concat((t=e,t.replace(/([A-Z])/g,(e=>"-".concat(e.toLowerCase()))))," ").concat(T,"ms ").concat(A);var t})).join(","));return r.createElement(XN,{animationId:_,key:_,canBegin:i>0,duration:p,easing:h,isActive:g,begin:f},(e=>{var i,a=ap(C,l,e),d=ap(P,c,e),h=ap(R,o,e),p=ap(O,s,e);n.current&&(v.current=a,y.current=d,x.current=h,b.current=p),i=m?e>0?{transition:L,strokeDasharray:I}:{strokeDasharray:D}:{strokeDasharray:I};var f=YR(t),{radius:g}=f,_=uk(f,ak);return r.createElement("path",ck({},_,{radius:"number"==typeof u?u:void 0,className:w,d:xk(h,p,a,d,u),ref:n,style:sk(sk({},i),t.style)}))}))};function wk(e){var{cx:t,cy:n,radius:r,startAngle:i,endAngle:a}=e;return{points:[qM(t,n,r,i),qM(t,n,r,a)],cx:t,cy:n,radius:r,startAngle:i,endAngle:a}}function Sk(){return Sk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sk.apply(null,arguments)}function Mk(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Ek=e=>{var{cx:t,cy:n,radius:r,angle:i,sign:a,isExternal:o,cornerRadius:s,cornerIsExternal:l}=e,c=s*(o?1:-1)+r,u=Math.asin(s/c)/WM,d=l?i:i+a*u,h=l?i-a*u:i;return{center:qM(t,n,c,d),circleTangency:qM(t,n,r,d),lineTangency:qM(t,n,c*Math.cos(u*WM),h),theta:u}},Tk=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:i,startAngle:a,endAngle:o}=e,s=((e,t)=>$h(t-e)*Math.min(Math.abs(t-e),359.999))(a,o),l=a+s,c=qM(t,n,i,a),u=qM(t,n,i,l),d=Kh(hk||(hk=Mk(["M ",",","\n    A ",",",",0,\n    ",",",",\n    ",",","\n  "])),c.x,c.y,i,i,+(Math.abs(s)>180),+(a>l),u.x,u.y);if(r>0){var h=qM(t,n,r,a),p=qM(t,n,r,l);d+=Kh(pk||(pk=Mk(["L ",",","\n            A ",",",",0,\n            ",",",",\n            ",","," Z"])),p.x,p.y,r,r,+(Math.abs(s)>180),+(a<=l),h.x,h.y)}else d+=Kh(fk||(fk=Mk(["L ",","," Z"])),t,n);return d},Ak={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Ck=e=>{var t=zO(e,Ak),{cx:n,cy:i,innerRadius:a,outerRadius:o,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:h}=t;if(o<a||u===d)return null;var p,f=Hh("recharts-sector",h),m=o-a,g=rp(s,m,0,!0);return p=g>0&&Math.abs(u-d)<360?(e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:i,cornerRadius:a,forceCornerRadius:o,cornerIsExternal:s,startAngle:l,endAngle:c}=e,u=$h(c-l),{circleTangency:d,lineTangency:h,theta:p}=Ek({cx:t,cy:n,radius:i,angle:l,sign:u,cornerRadius:a,cornerIsExternal:s}),{circleTangency:f,lineTangency:m,theta:g}=Ek({cx:t,cy:n,radius:i,angle:c,sign:-u,cornerRadius:a,cornerIsExternal:s}),v=s?Math.abs(l-c):Math.abs(l-c)-p-g;if(v<0)return o?Kh(mk||(mk=Mk(["M ",",","\n        a",",",",0,0,1,",",0\n        a",",",",0,0,1,",",0\n      "])),h.x,h.y,a,a,2*a,a,a,2*-a):Tk({cx:t,cy:n,innerRadius:r,outerRadius:i,startAngle:l,endAngle:c});var y=Kh(gk||(gk=Mk(["M ",",","\n    A",",",",0,0,",",",",","\n    A",",",",0,",",",",",",","\n    A",",",",0,0,",",",",","\n  "])),h.x,h.y,a,a,+(u<0),d.x,d.y,i,i,+(v>180),+(u<0),f.x,f.y,a,a,+(u<0),m.x,m.y);if(r>0){var{circleTangency:x,lineTangency:b,theta:_}=Ek({cx:t,cy:n,radius:r,angle:l,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),{circleTangency:w,lineTangency:S,theta:M}=Ek({cx:t,cy:n,radius:r,angle:c,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),E=s?Math.abs(l-c):Math.abs(l-c)-_-M;if(E<0&&0===a)return"".concat(y,"L").concat(t,",").concat(n,"Z");y+=Kh(vk||(vk=Mk(["L",",","\n      A",",",",0,0,",",",",","\n      A",",",",0,",",",",",",","\n      A",",",",0,0,",",",",","Z"])),S.x,S.y,a,a,+(u<0),w.x,w.y,r,r,+(E>180),+(u>0),x.x,x.y,a,a,+(u<0),b.x,b.y)}else y+=Kh(yk||(yk=Mk(["L",",","Z"])),t,n);return y})({cx:n,cy:i,innerRadius:a,outerRadius:o,cornerRadius:Math.min(g,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):Tk({cx:n,cy:i,innerRadius:a,outerRadius:o,startAngle:u,endAngle:d}),r.createElement("path",Sk({},YR(t),{className:f,d:p}))};function Pk(e,t,n){if("horizontal"===e)return[{x:t.x,y:n.top},{x:t.x,y:n.top+n.height}];if("vertical"===e)return[{x:n.left,y:t.y},{x:n.left+n.width,y:t.y}];if(iI(t)){if("centric"===e){var{cx:r,cy:i,innerRadius:a,outerRadius:o,angle:s}=t,l=qM(r,i,a,s),c=qM(r,i,o,s);return[{x:l.x,y:l.y},{x:c.x,y:c.y}]}return wk(t)}}function Rk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ok(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rk(Object(n),!0).forEach((function(t){Dk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ik=()=>{var e=Xv(iT),t=Xv(_C),n=Xv(yC);return my(e&&n?Ok(Ok({},e),{},{scale:n}):void 0,t)};function Lk(){return Lk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lk.apply(null,arguments)}function Nk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nk(Object(n),!0).forEach((function(t){Uk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Uk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fk(e){var{cursor:t,cursorComp:n,cursorProps:i}=e;return(0,r.isValidElement)(t)?(0,r.cloneElement)(t,i):(0,r.createElement)(n,i)}function zk(e){var t,n,i,a,{coordinate:o,payload:s,index:l,offset:c,tooltipAxisBandSize:u,layout:d,cursor:h,tooltipEventType:p,chartName:f}=e,m=o,g=s,v=l;if(!h||!m||"ScatterChart"!==f&&"axis"!==p)return null;if("ScatterChart"===f)n=m,i=wN,a=$M.cursorLine;else if("BarChart"===f)n=function(e,t,n,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-i:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-i,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(d,m,c,u),i=_k,a=$M.cursorRectangle;else if("radial"===d&&iI(m)){var{cx:y,cy:x,radius:b,startAngle:_,endAngle:w}=wk(m);n={cx:y,cy:x,startAngle:_,endAngle:w,innerRadius:b,outerRadius:b},i=Ck,a=$M.cursorLine}else n={points:Pk(d,m,c)},i=gN,a=$M.cursorLine;var S="object"==typeof h&&"className"in h?h.className:void 0,M=kk(kk(kk(kk({stroke:"#ccc",pointerEvents:"none"},c),n),qR(h)),{},{payload:g,payloadIndex:v,className:Hh("recharts-tooltip-cursor",S)});return r.createElement(ID,{zIndex:null!==(t=e.zIndex)&&void 0!==t?t:a},r.createElement(Fk,{cursor:h,cursorComp:i,cursorProps:M}))}function jk(e){var t=Ik(),n=Uy(),i=By(),a=zC();return null==t||null==n||null==i||null==a?null:r.createElement(zk,Lk({},e,{offset:n,layout:i,tooltipAxisBandSize:t,chartName:a}))}function Bk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bk(Object(n),!0).forEach((function(t){Vk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gk(e){return e.dataKey}var Wk=[],Xk={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function qk(e){var t,n,i=zO(e,Xk),{active:a,allowEscapeViewBox:o,animationDuration:s,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:h,payloadUniqBy:p,position:f,reverseDirection:m,useTranslate3d:g,wrapperStyle:v,cursor:y,shared:x,trigger:b,defaultIndex:_,portal:w,axisId:S}=i,M=Hv(),E="number"==typeof _?String(_):_;(0,r.useEffect)((()=>{M(uv({shared:x,trigger:b,axisId:S,active:a,defaultIndex:E}))}),[M,x,b,S,a,E]);var T=Ny(),A=jR(),C=function(e){return Xv((t=>AA(t,e)))}(x),{activeIndex:P,isActive:R}=null!==(t=Xv((e=>ZC(e,C,b,E))))&&void 0!==t?t:{},O=Xv((e=>$C(e,C,b,E))),D=Xv((e=>KC(e,C,b,E))),I=Xv((e=>YC(e,C,b,E))),L=O,N=(0,r.useContext)(vO),k=null!==(n=null!=a?a:R)&&void 0!==n&&n,[U,F]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,n]=(0,r.useState)({height:0,left:0,top:0,width:0}),i=(0,r.useCallback)((e=>{if(null!=e){var r=e.getBoundingClientRect(),i={height:r.height,left:r.left,top:r.top,width:r.width};(Math.abs(i.height-t.height)>1||Math.abs(i.left-t.left)>1||Math.abs(i.top-t.top)>1||Math.abs(i.width-t.width)>1)&&n({height:i.height,left:i.left,top:i.top,width:i.width})}}),[t.width,t.height,t.top,t.left,...e]);return[t,i]}([L,k]),z="axis"===C?D:void 0;!function(e,t,n,i,a,o){var s=Xv((n=>((e,t,n)=>{if(null!=t){var r=UA(e);return"axis"===t?"hover"===n?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:"hover"===n?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}})(n,e,t))),l=Xv(BM),c=Xv(zM),u=Xv(jM),d=Xv(dO),h=null==d?void 0:d.active,p=Ny();(0,r.useEffect)((()=>{if(!h&&null!=c&&null!=l){var e=vv({active:o,coordinate:n,dataKey:s,index:a,label:"number"==typeof i?String(i):i,sourceViewBox:p,graphicalItemId:void 0});lO.emit(cO,c,e,l)}}),[h,n,s,a,i,l,c,u,o,p])}(C,b,I,z,P,k);var j=null!=w?w:N;if(null==j||null==T||null==C)return null;var B=null!=L?L:Wk;k||(B=Wk),u&&B.length&&(B=function(e,t,n){return!0===t?PL()(e,n):"function"==typeof t?PL()(e,t):e}(B.filter((e=>null!=e.value&&(!0!==e.hide||i.includeHidden))),p,Gk));var H=B.length>0,V=r.createElement(AL,{allowEscapeViewBox:o,animationDuration:s,animationEasing:l,isAnimationActive:d,active:k,coordinate:I,hasPayload:H,offset:h,position:f,reverseDirection:m,useTranslate3d:g,viewBox:T,wrapperStyle:v,lastBoundingBox:U,innerRef:F,hasPortalFromProps:Boolean(w)},function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):"function"==typeof e?r.createElement(e,t):r.createElement(xL,t)}(c,Hk(Hk({},i),{},{payload:B,label:z,active:k,activeIndex:P,coordinate:I,accessibilityLayer:A})));return r.createElement(r.Fragment,null,(0,tg.createPortal)(V,j),k&&r.createElement(jk,{cursor:y,tooltipEventType:C,coordinate:I,payload:B,index:P}))}var Yk=s(207),Kk=s.n(Yk),$k=["valueAccessor"],Zk=["dataKey","clockWise","id","textBreakAll","zIndex"];function Jk(){return Jk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jk.apply(null,arguments)}function Qk(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var eU=e=>Array.isArray(e.value)?Kk()(e.value):e.value,tU=(0,r.createContext)(void 0),nU=tU.Provider,rU=(0,r.createContext)(void 0);function iU(e){var{valueAccessor:t=eU}=e,n=Qk(e,$k),{dataKey:i,clockWise:a,id:o,textBreakAll:s,zIndex:l}=n,c=Qk(n,Zk),u=(0,r.useContext)(tU),d=(0,r.useContext)(rU),h=u||d;return h&&h.length?r.createElement(ID,{zIndex:null!=l?l:$M.label},r.createElement(sD,{className:"recharts-label-list"},h.map(((e,a)=>{var l,u=sp(i)?t(e,a):oy(e.payload,i),d=sp(o)?{}:{id:"".concat(o,"-").concat(a)};return r.createElement(nI,Jk({key:"label-".concat(a)},YR(e),c,d,{fill:null!==(l=n.fill)&&void 0!==l?l:e.fill,parentViewBox:e.parentViewBox,value:u,textBreakAll:s,viewBox:e.viewBox,index:a,zIndex:0}))})))):null}function aU(e){var{label:t}=e;return t?!0===t?r.createElement(iU,{key:"labelList-implicit"}):r.isValidElement(t)||ZD(t)?r.createElement(iU,{key:"labelList-implicit",content:t}):"object"==typeof t?r.createElement(iU,Jk({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function oU(){return oU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oU.apply(null,arguments)}rU.Provider,iU.displayName="LabelList";var sU=e=>{var{cx:t,cy:n,r:i,className:a}=e,o=Hh("recharts-dot",a);return Qh(t)&&Qh(n)&&Qh(i)?r.createElement("circle",oU({},XR(e),aI(e),{className:o,cx:t,cy:n,r:i})):null};s(9864);var lU=e=>!e||"object"!=typeof e||!("clipDot"in e)||Boolean(e.clipDot),cU=["points"];function uU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uU(Object(n),!0).forEach((function(t){hU(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pU(){return pU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pU.apply(null,arguments)}function fU(e){var{option:t,dotProps:n,className:i}=e;if((0,r.isValidElement)(t))return(0,r.cloneElement)(t,n);if("function"==typeof t)return t(n);var a=Hh(i,"boolean"!=typeof t?t.className:""),o=null!=n?n:{},{points:s}=o,l=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(o,cU);return r.createElement(sU,pU({},l,{className:a}))}function mU(e){var{points:t,dot:n,className:i,dotClassName:a,dataKey:o,baseProps:s,needClip:l,clipPathId:c,zIndex:u=$M.scatter}=e;if(!function(e,t){return null!=e&&(!!t||1===e.length)}(t,n))return null;var d,h=lU(n),p=null==(d=n)?null:(0,r.isValidElement)(d)?YR(d.props):"object"!=typeof d||Array.isArray(d)?null:YR(d),f=t.map(((e,i)=>{var l,c,u=dU(dU(dU({r:3},s),p),{},{index:i,cx:null!==(l=e.x)&&void 0!==l?l:void 0,cy:null!==(c=e.y)&&void 0!==c?c:void 0,dataKey:o,value:e.value,payload:e.payload,points:t});return r.createElement(fU,{key:"dot-".concat(i),option:n,dotProps:u,className:a})})),m={};return l&&null!=c&&(m.clipPath="url(#clipPath-".concat(h?"":"dots-").concat(c,")")),r.createElement(ID,{zIndex:u},r.createElement(sD,pU({className:i},m),f))}function gU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gU(Object(n),!0).forEach((function(t){yU(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xU=e=>{var{point:t,childIndex:n,mainColor:i,activeDot:a,dataKey:o,clipPath:s}=e;if(!1===a||null==t.x||null==t.y)return null;var l,c=vU(vU(vU({},{index:n,dataKey:o,cx:t.x,cy:t.y,r:4,fill:null!=i?i:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value}),qR(a)),aI(a));return l=(0,r.isValidElement)(a)?(0,r.cloneElement)(a,c):"function"==typeof a?a(c):r.createElement(sU,c),r.createElement(sD,{className:"recharts-active-dot",clipPath:s},l)};function bU(e){var{points:t,mainColor:n,activeDot:i,itemDataKey:a,clipPath:o,zIndex:s=$M.activeDot}=e,l=Xv(TC),c=Xv(LC);if(null==t||null==c)return null;var u=t.find((e=>c.includes(e.payload)));return sp(u)?null:r.createElement(ID,{zIndex:s},r.createElement(xU,{point:u,childIndex:Number(l),mainColor:n,dataKey:a,activeDot:i,clipPath:o}))}function _U(e){var{tooltipEntrySettings:t}=e,n=Hv(),i=Oy(),a=(0,r.useRef)(null);return(0,r.useLayoutEffect)((()=>{i||(null===a.current?n(sv(t)):a.current!==t&&n(lv({prev:a.current,next:t})),a.current=t)}),[t,n,i]),(0,r.useLayoutEffect)((()=>()=>{a.current&&(n(cv(a.current)),a.current=null)}),[n]),null}function wU(e,t){var n,r,i=Xv((t=>OE(t,e))),a=Xv((e=>LE(e,t))),o=null!==(n=null==i?void 0:i.allowDataOverflow)&&void 0!==n?n:PE.allowDataOverflow,s=null!==(r=null==a?void 0:a.allowDataOverflow)&&void 0!==r?r:DE.allowDataOverflow;return{needClip:o||s,needClipX:o,needClipY:s}}function SU(e){var{xAxisId:t,yAxisId:n,clipPathId:i}=e,a=DO(),{needClipX:o,needClipY:s,needClip:l}=wU(t,n);if(!l||!a)return null;var{x:c,y:u,width:d,height:h}=a;return r.createElement("clipPath",{id:"clipPath-".concat(i)},r.createElement("rect",{x:o?c:c-d/2,y:s?u:u-h/2,width:o?d:2*d,height:s?h:2*h}))}function MU(e,t){var n,r;return null!==(n=null===(r=e.graphicalItems.cartesianItems.find((e=>e.id===t)))||void 0===r?void 0:r.xAxisId)&&void 0!==n?n:0}function EU(e,t){var n,r;return null!==(n=null===(r=e.graphicalItems.cartesianItems.find((e=>e.id===t)))||void 0===r?void 0:r.yAxisId)&&void 0!==n?n:0}var TU,AU=(e,t,n)=>_A(e,"xAxis",MU(e,t),n),CU=(e,t,n)=>bA(e,"xAxis",MU(e,t),n),PU=(e,t,n)=>_A(e,"yAxis",EU(e,t),n),RU=(e,t,n)=>bA(e,"yAxis",EU(e,t),n),OU=Fv([jy,AU,PU,CU,RU],((e,t,n,r,i)=>sy(e,"xAxis")?my(t,r,!1):my(n,i,!1))),DU=Fv([BE,(e,t)=>t],((e,t)=>e.filter((e=>"area"===e.type)).find((e=>e.id===t)))),IU=e=>{var t=jy(e);return sy(t,"xAxis")?"yAxis":"xAxis"},LU=Fv([DU,(e,t,n)=>lT(e,IU(e),((e,t)=>"yAxis"===IU(e)?EU(e,t):MU(e,t))(e,t),n)],((e,t)=>{var n;if(null!=e&&null!=t){var{stackId:r}=e,i=gE(e);if(null!=r&&null!=i){var a=null===(n=t[r])||void 0===n?void 0:n.stackedData,o=null==a?void 0:a.find((e=>e.key===i));if(null!=o)return o.map((e=>[e[0],e[1]]))}}})),NU=Fv([jy,AU,PU,CU,RU,LU,(e,t,n)=>n?KS(e):YS(e),OU,DU,e=>e.rootProps.baseValue],((e,t,n,r,i,a,o,s,l,c)=>{var{chartData:u,dataStartIndex:d,dataEndIndex:h}=o;if(null!=l&&("horizontal"===e||"vertical"===e)&&null!=t&&null!=n&&null!=r&&null!=i&&0!==r.length&&0!==i.length&&null!=s){var p,{data:f}=l;if(null!=(p=f&&f.length>0?f:null==u?void 0:u.slice(d,h+1)))return function(e){var t,{areaSettings:{connectNulls:n,baseValue:r,dataKey:i},stackedData:a,layout:o,chartBaseValue:s,xAxis:l,yAxis:c,displayedData:u,dataStartIndex:d,xAxisTicks:h,yAxisTicks:p,bandSize:f}=e,m=a&&a.length,g=cF(o,s,r,l,c),v="horizontal"===o,y=!1,x=u.map(((e,t)=>{var r,o,s,u;if(m)u=a[d+t];else{var x=oy(e,i);Array.isArray(x)?(u=x,y=!0):u=[g,x]}var b,_=null!==(r=null===(o=u)||void 0===o?void 0:o[1])&&void 0!==r?r:null,w=null==_||m&&!n&&null==oy(e,i);return v?{x:hy({axis:l,ticks:h,bandSize:f,entry:e,index:t}),y:w?null:null!==(b=c.scale.map(_))&&void 0!==b?b:null,value:u,payload:e}:{x:w?null:null!==(s=l.scale.map(_))&&void 0!==s?s:null,y:hy({axis:c,ticks:p,bandSize:f,entry:e,index:t}),value:u,payload:e}}));return t=m||y?x.map((e=>{var t,n,r=Array.isArray(e.value)?e.value[0]:null;return v?{x:e.x,y:null!=r&&null!=e.y&&null!==(n=c.scale.map(r))&&void 0!==n?n:null,payload:e.payload}:{x:null!=r&&null!==(t=l.scale.map(r))&&void 0!==t?t:null,y:e.y,payload:e.payload}})):v?c.scale.map(g):l.scale.map(g),{points:x,baseLine:null!=t?t:0,isRange:y}}({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:i,dataStartIndex:d,areaSettings:l,stackedData:a,displayedData:p,chartBaseValue:c,bandSize:s})}}));function kU(e){var{legendPayload:t}=e,n=Hv(),i=Oy(),a=(0,r.useRef)(null);return(0,r.useLayoutEffect)((()=>{i||(null===a.current?n(VP(t)):a.current!==t&&n(GP({prev:a.current,next:t})),a.current=t)}),[n,i,t]),(0,r.useLayoutEffect)((()=>()=>{a.current&&(n(WP(a.current)),a.current=null)}),[n]),null}var UU=null!==(TU=r["useId".toString()])&&void 0!==TU?TU:()=>{var[e]=r.useState((()=>np("uid-")));return e},FU=(0,r.createContext)(void 0),zU=e=>{var t,n,i,{id:a,type:o,children:s}=e,l=(t="recharts-".concat(o),n=a,i=UU(),n||(t?"".concat(t,"-").concat(i):i));return r.createElement(FU.Provider,{value:l},s(l))},jU=e=>{var t=Hv(),n=(0,r.useRef)(null);return(0,r.useLayoutEffect)((()=>{null===n.current?t(wP(e)):n.current!==e&&t(SP({prev:n.current,next:e})),n.current=e}),[t,e]),(0,r.useLayoutEffect)((()=>()=>{n.current&&(t(MP(n.current)),n.current=null)}),[t]),null},BU=(0,r.memo)(jU),HU=["id"],VU=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function GU(){return GU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GU.apply(null,arguments)}function WU(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function XU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?XU(Object(n),!0).forEach((function(t){YU(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function YU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KU(e,t){return e&&"none"!==e?e:t}var $U=e=>{var{dataKey:t,name:n,stroke:r,fill:i,legendType:a,hide:o}=e;return[{inactive:o,dataKey:t,type:a,color:KU(r,i),value:vy(n,t),payload:e}]},ZU=r.memo((e=>{var{dataKey:t,data:n,stroke:i,strokeWidth:a,fill:o,name:s,hide:l,unit:c,tooltipType:u,id:d}=e,h={dataDefinedOnItem:n,getPosition:up,settings:{stroke:i,strokeWidth:a,fill:o,dataKey:t,nameKey:void 0,name:vy(s,t),hide:l,type:u,color:KU(i,o),unit:c,graphicalItemId:d}};return r.createElement(_U,{tooltipEntrySettings:h})}));function JU(e){var{clipPathId:t,points:n,props:i}=e,{needClip:a,dot:o,dataKey:s}=i,l=XR(i);return r.createElement(mU,{points:n,dot:o,className:"recharts-area-dots",dotClassName:"recharts-area-dot",dataKey:s,baseProps:l,needClip:a,clipPathId:t})}function QU(e){var{showLabels:t,children:n,points:i}=e,a=i.map((e=>{var t,n,r={x:null!==(t=e.x)&&void 0!==t?t:0,y:null!==(n=e.y)&&void 0!==n?n:0,width:0,lowerWidth:0,upperWidth:0,height:0};return qU(qU({},r),{},{value:e.value,payload:e.payload,parentViewBox:void 0,viewBox:r,fill:void 0})}));return r.createElement(nU,{value:t?a:void 0},n)}function eF(e){var{points:t,baseLine:n,needClip:i,clipPathId:a,props:o}=e,{layout:s,type:l,stroke:c,connectNulls:u,isRange:d}=o,{id:h}=o,p=WU(o,HU),f=XR(p),m=YR(p);return r.createElement(r.Fragment,null,(null==t?void 0:t.length)>1&&r.createElement(sD,{clipPath:i?"url(#clipPath-".concat(a,")"):void 0},r.createElement(gN,GU({},m,{id:h,points:t,connectNulls:u,type:l,baseLine:n,layout:s,stroke:"none",className:"recharts-area-area"})),"none"!==c&&r.createElement(gN,GU({},f,{className:"recharts-area-curve",layout:s,type:l,connectNulls:u,fill:"none",points:t})),"none"!==c&&d&&r.createElement(gN,GU({},f,{className:"recharts-area-curve",layout:s,type:l,connectNulls:u,fill:"none",points:n}))),r.createElement(JU,{points:t,props:p,clipPathId:a}))}function tF(e){var t,n,{alpha:i,baseLine:a,points:o,strokeWidth:s}=e,l=null===(t=o[0])||void 0===t?void 0:t.y,c=null===(n=o[o.length-1])||void 0===n?void 0:n.y;if(!xp(l)||!xp(c))return null;var u=i*Math.abs(l-c),d=Math.max(...o.map((e=>e.x||0)));return Qh(a)?d=Math.max(a,d):a&&Array.isArray(a)&&a.length&&(d=Math.max(...a.map((e=>e.x||0)),d)),Qh(d)?r.createElement("rect",{x:0,y:l<c?l:l-u,width:d+(s?parseInt("".concat(s),10):1),height:Math.floor(u)}):null}function nF(e){var t,n,{alpha:i,baseLine:a,points:o,strokeWidth:s}=e,l=null===(t=o[0])||void 0===t?void 0:t.x,c=null===(n=o[o.length-1])||void 0===n?void 0:n.x;if(!xp(l)||!xp(c))return null;var u=i*Math.abs(l-c),d=Math.max(...o.map((e=>e.y||0)));return Qh(a)?d=Math.max(a,d):a&&Array.isArray(a)&&a.length&&(d=Math.max(...a.map((e=>e.y||0)),d)),Qh(d)?r.createElement("rect",{x:l<c?l:l-u,y:0,width:u,height:Math.floor(d+(s?parseInt("".concat(s),10):1))}):null}function rF(e){var{alpha:t,layout:n,points:i,baseLine:a,strokeWidth:o}=e;return"vertical"===n?r.createElement(tF,{alpha:t,points:i,baseLine:a,strokeWidth:o}):r.createElement(nF,{alpha:t,points:i,baseLine:a,strokeWidth:o})}function iF(e){var{needClip:t,clipPathId:n,props:i,previousPointsRef:a,previousBaselineRef:o}=e,{points:s,baseLine:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:h,onAnimationStart:p,onAnimationEnd:f}=i,m=qN((0,r.useMemo)((()=>({points:s,baseLine:l})),[s,l]),"recharts-area-"),g=Hy(),[v,y]=(0,r.useState)(!1),x=!v,b=(0,r.useCallback)((()=>{"function"==typeof f&&f(),y(!1)}),[f]),_=(0,r.useCallback)((()=>{"function"==typeof p&&p(),y(!0)}),[p]);if(null==g)return null;var w=a.current,S=o.current;return r.createElement(QU,{showLabels:x,points:s},i.children,r.createElement(XN,{animationId:m,begin:u,duration:d,isActive:c,easing:h,onAnimationEnd:b,onAnimationStart:_,key:m},(e=>{if(w){var u,d=w.length/s.length,h=1===e?s:s.map(((t,n)=>{var r=Math.floor(n*d);if(w[r]){var i=w[r];return qU(qU({},t),{},{x:ap(i.x,t.x,e),y:ap(i.y,t.y,e)})}return t}));return u=Qh(l)?ap(S,l,e):sp(l)||Zh(l)?ap(S,0,e):l.map(((t,n)=>{var r=Math.floor(n*d);if(Array.isArray(S)&&S[r]){var i=S[r];return qU(qU({},t),{},{x:ap(i.x,t.x,e),y:ap(i.y,t.y,e)})}return t})),e>0&&(a.current=h,o.current=u),r.createElement(eF,{points:h,baseLine:u,needClip:t,clipPathId:n,props:i})}return e>0&&(a.current=s,o.current=l),r.createElement(sD,null,c&&r.createElement("defs",null,r.createElement("clipPath",{id:"animationClipPath-".concat(n)},r.createElement(rF,{alpha:e,points:s,baseLine:l,layout:g,strokeWidth:i.strokeWidth}))),r.createElement(sD,{clipPath:"url(#animationClipPath-".concat(n,")")},r.createElement(eF,{points:s,baseLine:l,needClip:t,clipPathId:n,props:i})))})),r.createElement(aU,{label:i.label}))}function aF(e){var{needClip:t,clipPathId:n,props:i}=e,a=(0,r.useRef)(null),o=(0,r.useRef)();return r.createElement(iF,{needClip:t,clipPathId:n,props:i,previousPointsRef:a,previousBaselineRef:o})}class oF extends r.PureComponent{render(){var{hide:e,dot:t,points:n,className:i,top:a,left:o,needClip:s,xAxisId:l,yAxisId:c,width:u,height:d,id:h,baseLine:p,zIndex:f}=this.props;if(e)return null;var m=Hh("recharts-area",i),g=h,{r:v,strokeWidth:y}=function(e){var t=qR(e);if(null!=t){var{r:n,strokeWidth:r}=t,i=Number(n),a=Number(r);return(Number.isNaN(i)||i<0)&&(i=3),(Number.isNaN(a)||a<0)&&(a=2),{r:i,strokeWidth:a}}return{r:3,strokeWidth:2}}(t),x=lU(t),b=2*v+y,_=s?"url(#clipPath-".concat(x?"":"dots-").concat(g,")"):void 0;return r.createElement(ID,{zIndex:f},r.createElement(sD,{className:m},s&&r.createElement("defs",null,r.createElement(SU,{clipPathId:g,xAxisId:l,yAxisId:c}),!x&&r.createElement("clipPath",{id:"clipPath-dots-".concat(g)},r.createElement("rect",{x:o-b/2,y:a-b/2,width:u+b,height:d+b}))),r.createElement(aF,{needClip:s,clipPathId:g,props:this.props})),r.createElement(bU,{points:n,mainColor:KU(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:_}),this.props.isRange&&Array.isArray(p)&&r.createElement(bU,{points:p,mainColor:KU(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:_}))}}var sF={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:"auto",legendType:"line",stroke:"#3182bd",strokeWidth:1,type:"linear",label:!1,xAxisId:0,yAxisId:0,zIndex:$M.area};function lF(e){var t,n=zO(e,sF),{activeDot:i,animationBegin:a,animationDuration:o,animationEasing:s,connectNulls:l,dot:c,fill:u,fillOpacity:d,hide:h,isAnimationActive:p,legendType:f,stroke:m,xAxisId:g,yAxisId:v}=n,y=WU(n,VU),x=By(),b=zC(),{needClip:_}=wU(g,v),w=Oy(),{points:S,isRange:M,baseLine:E}=null!==(t=Xv((t=>NU(t,e.id,w))))&&void 0!==t?t:{},T=DO();if("horizontal"!==x&&"vertical"!==x||null==T)return null;if("AreaChart"!==b&&"ComposedChart"!==b)return null;var{height:A,width:C,x:P,y:R}=T;return S&&S.length?r.createElement(oF,GU({},y,{activeDot:i,animationBegin:a,animationDuration:o,animationEasing:s,baseLine:E,connectNulls:l,dot:c,fill:u,fillOpacity:d,height:A,hide:h,layout:x,isAnimationActive:"auto"===p?!_R.isSsr:p,isRange:M,legendType:f,needClip:_,points:S,stroke:m,width:C,left:P,top:R,xAxisId:g,yAxisId:v})):null}var cF=(e,t,n,r,i)=>{var a=null!=n?n:t;if(Qh(a))return a;var o="horizontal"===e?i:r,s=o.scale.domain();if("number"===o.type){var l=Math.max(s[0],s[1]),c=Math.min(s[0],s[1]);return"dataMin"===a?c:"dataMax"===a||l<0?l:Math.max(Math.min(s[0],s[1]),0)}return"dataMin"===a?s[0]:"dataMax"===a?s[1]:s[0]};function uF(e){var t=zO(e,sF),n=Oy();return r.createElement(zU,{id:t.id,type:"area"},(e=>{return r.createElement(r.Fragment,null,r.createElement(kU,{legendPayload:$U(t)}),r.createElement(ZU,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:e}),r.createElement(BU,{type:"area",id:e,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:(i=t.stackId,null==i?void 0:String(i)),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:n,connectNulls:t.connectNulls}),r.createElement(lF,GU({},t,{id:e})));var i}))}var dF=r.memo(uF,kR);dF.displayName="Area";var hF=s(3379),pF=s.n(hF),fF=s(7795),mF=s.n(fF),gF=s(569),vF=s.n(gF),yF=s(3565),xF=s.n(yF),bF=s(9216),_F=s.n(bF),wF=s(4589),SF=s.n(wF),MF=s(5131),EF={};EF.styleTagTransform=SF(),EF.setAttributes=xF(),EF.insert=vF().bind(null,"head"),EF.domAPI=mF(),EF.insertStyleElement=_F(),pF()(MF.Z,EF),MF.Z&&MF.Z.locals&&MF.Z.locals;const TF="selected_dam",AF=["selected_dam_changed","dam_name_changed","dam_selected"],CF=()=>{if("undefined"==typeof window)return"";try{return(localStorage.getItem(TF)||"").trim()}catch(e){return console.error("Error reading selected_dam from localStorage:",e),""}},PF=()=>{const[e,t]=(0,r.useState)((()=>CF())),n=(0,r.useRef)();return(0,r.useEffect)((()=>{if("undefined"==typeof window)return;let e=CF(),r=null;const i=()=>{const n=CF();n!==e&&(e=n,t(n))},a=e=>{e.key&&e.key!==TF||i()},o=()=>{i()};window.addEventListener("storage",a),AF.forEach((e=>{window.addEventListener(e,o)})),r=window.setInterval(i,200);const s=()=>{i(),n.current=window.requestAnimationFrame(s)};return n.current=window.requestAnimationFrame(s),()=>{window.removeEventListener("storage",a),AF.forEach((e=>{window.removeEventListener(e,o)})),null!==r&&window.clearInterval(r),n.current&&window.cancelAnimationFrame(n.current)}}),[]),e},RF={todakol:{uz:"To'dako'l suv ombori",ru:"Водохранилище Тудакуль",uzcryl:"Тўдакўл сув омбори"},chortoq:{uz:"Chortoq suv ombori",ru:"Водохранилище Чорток",uzcryl:"Чортоқ сув омбори"},topalang:{uz:"To'palang suv ombori",ru:"Водохранилище Топаланг",uzcryl:"Тўпаланг сув омбори"},tusunsoy:{uz:"To'sinsoy suv ombori",ru:"Водохранилище Тосинсой",uzcryl:"Тўсиной сув омбори"},tosinsoy:{uz:"To'sinsoy suv ombori",ru:"Водохранилище Тосинсой",uzcryl:"Тўсиной сув омбори"},toshkent:{uz:"Toshkent suv ombori",ru:"Водохранилище Ташкент",uzcryl:"Тошкент сув омбори"},talimarjon:{uz:"Talimarjon suv ombori",ru:"Водохранилище Талимарджон",uzcryl:"Талимаржон сув омбори"},kattakorgon:{uz:"Kattaqo'rg'on suv ombori",ru:"Водохранилище Каттакоргон",uzcryl:"Каттақўрғон сув омбори"},zarkent:{uz:"Zarkent suv ombori",ru:"Водохранилище Заркент",uzcryl:"Заркент сув омбори"},zomin:{uz:"Zomin suv ombori",ru:"Водохранилище Зомин",uzcryl:"Зомин сув омбори"},qorovultepa:{uz:"Qorovultepa suv ombori",ru:"Водохранилище Коровултепа",uzcryl:"Қоровултепа сув омбори"},oktepa:{uz:"Oqtepa suv ombori",ru:"Водохранилище Октепа",uzcryl:"Оқтепа сув омбори"},jiydalisoy:{uz:"Jiydalisoy suv ombori",ru:"Водохранилище Джийдалисой",uzcryl:"Джийдалисой сув омбори"},ohangaron:{uz:"Ohangaron suv ombori",ru:"Водохранилище Охангарон",uzcryl:"Оҳангарон сув омбори"},pachkamar:{uz:"Pachkamar suv ombori",ru:"Водохранилище Пачкамар",uzcryl:"Пачкамар сув омбори"},karkidon:{uz:"Karkidon suv ombori",ru:"Водохранилище Каркиндон",uzcryl:"Каркиндон сув омбори"},jizzakh:{uz:"Jizzax suv ombori",ru:"Водохранилище Джизах",uzcryl:"Джизах сув омбори"},hisorak:{uz:"Hisorak suv ombori",ru:"Водохранилище Хисорак",uzcryl:"Ҳисорак сув омбори"},qorgontepa:{uz:"Qo'rg'ontepa suv ombori",ru:"Водохранилище Коргонтепа",uzcryl:"Қўрғонтепа сув омбори"},chorvoq:{uz:"Chorvoq suv ombori",ru:"Водохранилище Чорвок",uzcryl:"Чорвоқ сув омбори"},quyumozor:{uz:"Quyimozor suv ombori",ru:"Водохранилище Куйимазар",uzcryl:"Қўйимозор сув омбори"},oqdaryo:{uz:"Oqdaryo suv ombori",ru:"Акдарьинское водохранилище",uzcryl:"Оқдарё сув омбори"},shurkul:{uz:"Sho'rko'l suv ombori",ru:"Шуркульское водохранилище",uzcryl:"Шўркўл сув омбори"},qorasuvnamangan:{uz:"Qorasuv suv ombori(Namangan)",ru:"Корасувсукое водохранилище(Наманган)",uzcryl:"Қорасув сув омбори(Наманган)"},uchqizil:{uz:"Uchqizil suv ombori",ru:"Учкызылское водохранилище",uzcryl:"Учқизил сув омбори"},qorabog:{uz:"Qorabog' suv ombori",ru:"Карабагское водохранилище",uzcryl:"Қорабоғ сув омбори"},nugayli:{uz:"No'g'ayli suv ombori",ru:"Нугайлийское водохранилище",uzcryl:"Нўғайли сув омбори"},yangikurgan:{uz:"Yangi Qo'rg'on suv ombori",ru:"Янгикурганское водохранилище",uzcryl:"Янги Қўрғон сув омбори"},qamashi:{uz:"Qamashi suv ombori",ru:"Камашинское водохранилище",uzcryl:"Қамаши сув омбори"},sobirsoy:{uz:"Sobirsoy suv ombori",ru:"Сабирсайское водохранилище",uzcryl:"Собирсой сув омбори"},degrez:{uz:"Degrez suv ombori",ru:"Дегрезское водохранилище",uzcryl:"Дегрез сув омбори"},eskiyer:{uz:"Eskiyer suv ombori",ru:"Эскиерское водохранилище",uzcryl:"Эскиер сув омбори"},girvansoy:{uz:"Girvansoy suv ombori",ru:"Гирвансайское водохранилище",uzcryl:"Гирвансой сув омбори"},oqbilol:{uz:"Oqbilol suv ombori",ru:"Окбилолское водохранилище",uzcryl:"Оқбилол сув омбори"},kengkol:{uz:"Kengko'l suv ombori",ru:"Кенгкольское водохранилище",uzcryl:"Кенгкўл сув омбори"},omondara:{uz:"Omondora suv ombori",ru:"Водохранилище Омондора",uzcryl:"Омондора сув омбори"},rezaksoy:{uz:"Rezaksoy suv ombori",ru:"Резаксойское водохранилище",uzcryl:"Резаксой сув омбори"},qoratepa:{uz:"Qoratepa suv ombori",ru:"Водохранилище Каратепа",uzcryl:"Қоратепа сув омбори"},kamongaron:{uz:"Kamongaron suv ombori",ru:"Водохранилище Камонгарон",uzcryl:"Камонгарон сув омбори"},mominobod:{uz:"Mominobod suv ombori",ru:"Водохранилище Моминабад",uzcryl:"Мўминобод сув омбори"},koksareksoy:{uz:"Ko'kseraksoy suv ombori",ru:"Водохранилище Коксарексай",uzcryl:"Кўксераксой сув омбори"},ertikon:{uz:"Yertikon suv ombori",ru:"Водохранилище Ертикан",uzcryl:"Ертикон сув омбори"},langar:{uz:"Langar suv ombori",ru:"Лангарское водохранилище",uzcryl:"Лангар сув омбори"},fargona:{uz:"Markaziy Farg'ona suv ombori",ru:"Центральное Ферганское водохранилище",uzcryl:"Марказий Фарғона сув омбори"},qorasuvsamarqand:{uz:"Qorasuv suv ombori",ru:"Корасувское водохранилище",uzcryl:"Қорасув сув омбори"},qalqama:{uz:"Qalqama sel ombori",ru:"Водохранилище Калкама",uzcryl:"Қалқама сел омбори"},shorabsoy:{uz:"Sho'robsoy suv ombori",ru:"Шурабсойское водохранилище",uzcryl:"Шўробсой сув омбори"},dehqonobod:{uz:"Dexqonobod suv ombori",ru:"Дехканабадское водохранилище",uzcryl:"Дехқонобод сув омбори"},sentabsoy:{uz:"Sentobsoy suv ombori",ru:"Водохранилище Сентобсой",uzcryl:"Сентобсой сув омбори"},koksaroy:{uz:"Ko'ksaroy suv ombori",ru:"Коксаройское водохранилище",uzcryl:"Кўксарой сув омбори"},xojamushkent:{uz:"Xo'jamushkent suv ombori",ru:"Ходжамушкентское водохранилище",uzcryl:"Хўжамушкент сув омбори"},oqchobsoy:{uz:"Oqchobsoy suv ombori",ru:"Акчобсойское водохранилище",uzcryl:"Oқчобсой сув омбори"},shorsuv:{uz:"Sho'rsuv sel ombori",ru:"Водохранилище Шорсув",uzcryl:"Шўрсув сел омбори"},oqbuloq:{uz:"Oqbuloq suv ombori",ru:"Окбулокское водохранилище",uzcryl:"Оқбулоқ сув омбори"},qizilsuv:{uz:"Qizilsuv suv ombori",ru:"Кызылсувское водохранилище",uzcryl:"Қизилсув сув омбори"},asaka:{uz:"Asaka adir suv ombori",ru:"Водохранилище Асака адир",uzcryl:"Асака адир сув омбори"},qoramurut:{uz:"Qoramurut suv ombori",ru:"Карамурутское водохранилище",uzcryl:"Қорамурут сув омбори"},chimqurgon:{uz:"Chimqo'rg'on suv ombori",ru:"Чимкурганское водохранилище",uzcryl:"Чимқўрғон сув омбори"},surxon:{uz:"Janubiy Surxon suv ombori",ru:"Южно-Сурханское водохранилище",uzcryl:"Жанубий Сурхон сув омбори"},arnasoy:{uz:"Arnasoy suv ombori",ru:"Арнасойское водохранилище",uzcryl:"Арнасой сув омбори"},qashqadaryo:{uz:"Qashqadaryo suv ombori",ru:"Кашкадарьинское водохранилище",uzcryl:"Қашқадарё сув омбори"},varziq:{uz:"Varziq suv ombori",ru:"Водохранилище Варзик",uzcryl:"Варзиқ сув омбори"},shorobsoy:{uz:"Sho'robsoy suv ombori",ru:"Шоробсойское водохранилище",uzcryl:"Шўробсой сув омбори"},andijon:{uz:"Andijon suv ombori",ru:"Андижанское водохранилище",uzcryl:"Андижон сув омбори"}},OF={selectDam:{uz:"Suv omborini tanlang",ru:"Выберите водохранилище",uzcryl:"Сув омборини танланг"},noDataForDam:{uz:"Ushbu suv ombori uchun ma'lumot yo'q",ru:"Нет данных для этого водохранилища",uzcryl:"Ушбу сув омбори учун маълумот йўқ"},errorLoadingModel:{uz:"Modelni yuklashda xatolik",ru:"Ошибка загрузки модели",uzcryl:"Моделни юклашда хатолик"},retry:{uz:"Qayta urinish",ru:"Повторить",uzcryl:"Қайта уриниш"},download:{uz:"Yuklab olish",ru:"Скачать",uzcryl:"Юклаб олиш"},totalDistance:{uz:"Umumiy masofa:",ru:"Общее расстояние:",uzcryl:"Умумий масофа:"},buildLineToSeeProfile:{uz:"Balandlik profilini ko'rish uchun o'lchov chizig'ini yarating.",ru:"Постройте линию измерения, чтобы увидеть профиль высот.",uzcryl:"Бalandлик профилини кўриш учун ўлчов чизиғини яратинг."},lineAlreadyExists:{uz:"Chiziq allaqachon mavjud. Yangisini chizish uchun uni tozalang.",ru:"Линия уже существует. Очистите её, чтобы нарисовать новую.",uzcryl:"Чизиқ аллақачон мавжуд. Янисини чизиш учун уни тозаланг."},exitDrawingMode:{uz:"Chizish rejimidan chiqish",ru:"Выйти из режима рисования",uzcryl:"Чизиш режимидан чиқиш"},startDrawingLine:{uz:"Chiziq chizishni boshlash",ru:"Начать рисовать линию",uzcryl:"Чизиқ чизишни бошлаш"},deleteLine:{uz:"Chiziqni o'chirish",ru:"Удалить линию",uzcryl:"Чизиқни ўчириш"},stopRotating:{uz:"Aylanishni to'xtatish",ru:"Остановить вращение",uzcryl:"Айланишни тўхтатиш"},startRotating:{uz:"Aylanishni boshlash",ru:"Начать вращение",uzcryl:"Айланишни бошлаш"},spinningDisabled:{uz:"Chizish yoki chiziq mavjud bo'lganda aylanish o'chiriladi",ru:"Вращение отключено во время рисования или когда линия существует",uzcryl:"Чизиш ёки чизиқ мавжуд бўлганда айланиш ўчирилади"},noGeographicCoordinates:{uz:"Geografik koordinatalar yo'q.",ru:"Нет географических координат.",uzcryl:"Географик координаталар йўқ."},invalidGeographicCoordinates:{uz:"Noto'g'ri geografik koordinatalar.",ru:"Некорректные географические координаты.",uzcryl:"Нотўғри географик координаталар."},failedToLoadProfile:{uz:"Profilni yuklab bo'lmadi.",ru:"Не удалось загрузить профиль.",uzcryl:"Профилни юклаб бўлмади."},type1SupportsOneLine:{uz:"1-tur faqat bitta chiziqni qo'llab-quvvatlaydi. Yangisini chizish uchun mavjudini o'chiring.",ru:"Тип 1 поддерживает только одну линию. Удалите существующую, чтобы нарисовать новую.",uzcryl:"1-тур фақат битта чизиқни қўллаб-қувватлайди. Янисини чизиш учун мавжудини ўчиринг."},elevation:{uz:"Balandlik",ru:"Высота",uzcryl:"Бalandлик"},elevationM:{uz:"Balandlik (m)",ru:"Высота (м)",uzcryl:"Бalandлик (м)"},distance:{uz:"Masofa",ru:"Расстояние",uzcryl:"Масофа"},distanceM:{uz:"Masofa (m)",ru:"Расстояние (м)",uzcryl:"Масофа (м)"},distanceLabel:{uz:"Masofa:",ru:"Расстояние:",uzcryl:"Масофа:"},unknownError:{uz:"Noma'lum xatolik",ru:"Неизвестная ошибка",uzcryl:"Номаълум хатолик"},unableToLoadDamData:{uz:"Suv ombori ma'lumotlarini yuklab bo'lmadi",ru:"Не удалось загрузить данные водохранилища",uzcryl:"Сув омбори маълумотларини юклаб бўлмади"},failedToLoadModel:{uz:"Modelni yuklab bo'lmadi",ru:"Не удалось загрузить модель",uzcryl:"Моделни юклаб бўлмади"},failedToLoad3DModel:{uz:"3D modelni yuklab bo'lmadi",ru:"Не удалось загрузить 3D модель",uzcryl:"3D моделни юклаб бўлмади"},failedToLoadData:{uz:"Ma'lumotlarni yuklab bo'lmadi",ru:"Не удалось загрузить данные",uzcryl:"Маълумотларни юклаб бўлмади"},unableToLoadWaterLevelData:{uz:"Suv sathini yuklab bo'lmadi",ru:"Не удалось загрузить данные уровня воды",uzcryl:"Сув сатини юклаб бўлмади"},waterDataNotAvailable:{uz:"Suv ma'lumotlari mavjud emas",ru:"Данные о воде недоступны",uzcryl:"Сув маълумотлари мавжуд эмас"},selectTypeTwoForWaterData:{uz:'Suv sathini ko\'rish uchun "Ikkinchi tur"ni tanlang',ru:'Выберите "Тип 2" для просмотра данных уровня воды',uzcryl:'Сув сатини кўриш учун "Иккинчи тур"ни танланг'},waterLevel:{uz:"Suv sathi:",ru:"Уровень воды:",uzcryl:"Сув сати:"},volume:{uz:"Hajm:",ru:"Объем:",uzcryl:"Ҳажм:"},area:{uz:"Maydon:",ru:"Площадь:",uzcryl:"Майдон:"},clickOnTerrainToPlacePoints:{uz:"Nuqtalarni joylashtirish uchun relyefga bosing",ru:"Нажмите на рельеф, чтобы разместить точки",uzcryl:"Нуқталарни жойлаштириш учун релйефга босинг"},spinningMode:{uz:"Aylanish rejimi faollashtirildi",ru:"Режим вращения активирован",uzcryl:"Айланиш режими фаоллаштирилди"},showDepositRed:{uz:"Cho'kindi (qizil)",ru:"Нанос (красный)",uzcryl:"Чўкинди (қизил)"},showCutBlue:{uz:"Chuqurlik (ko'k)",ru:"Выемка (синий)",uzcryl:"Чуқурлик (кўк)"},depositCutInfo:{uz:"Nanos: baza=2023, qizil↑ • Yemka: baza=2025, ko'k↑",ru:"Нанос: база=2023, красный↑ • Выемка: база=2025, синий↑",uzcryl:"Нанос: база=2023, қизил↑ • Емка: база=2025, кўк↑"}},DF={type1:{uz:"Profil",ru:"Профиль",uzcryl:"Профиль"},type2:{uz:"3D model",ru:"3D модель",uzcryl:"3D модель"},type3:{uz:"Solishtirma",ru:"Сравнительный",uzcryl:"Солиштирма"},type4:{uz:"Izoliniya",ru:"Изолиния",uzcryl:"Изолиния"}},IF=(e,t)=>{const n=t||"undefined"!=typeof window&&localStorage.getItem("custom_locale")||"ru",r=OF[e];return r&&(r[n]||r.ru)||e};var LF=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const NF=6378137,kF=Math.PI/180;Math.PI;const UF="glb_files",FF=()=>new Promise(((e,t)=>{const n=indexedDB.open("glb_cache_db",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(UF)||t.createObjectStore(UF,{keyPath:"key"})}})),zF=e=>{var t,i,a,o,l,c;const[u,d]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),f=(PF()||"").trim(),[m,g]=(0,r.useState)((()=>"undefined"==typeof window?"ru":localStorage.getItem("custom_locale")||"ru"));(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("custom_locale")||"ru";g(e)};e(),window.addEventListener("storage",e);const t=setInterval(e,250);return()=>{window.removeEventListener("storage",e),clearInterval(t)}}),[]);const v=(0,r.useRef)(null),y=(0,r.useRef)(null),x=(0,r.useRef)(null),b=(0,r.useRef)(null),_=(0,r.useRef)(null),w=(0,r.useRef)(null),S=(0,r.useRef)(null),M=(0,r.useRef)(null),E=(0,r.useRef)(null),T=(0,r.useRef)([0,0]),[A,C]=(0,r.useState)(!1),[P,R]=(0,r.useState)(null),[O,D]=(0,r.useState)([]),[I,L]=(0,r.useState)(!1),N=(0,r.useRef)(I),[k,U]=(0,r.useState)(null),F=(0,r.useRef)(null),z=(0,r.useRef)(null),[j,B]=(0,r.useState)(null),[H,V]=(0,r.useState)(!1),[G,W]=(0,r.useState)(null),[X,q]=(0,r.useState)({start:null,end:null}),Y=(0,r.useMemo)((()=>(e.drawnLines||[]).some((e=>!("Тип 1"!==(null==e?void 0:e.damType)||!Array.isArray(null==e?void 0:e.points))&&e.points.length>=2))),[e.drawnLines]),K=Array.isArray(e.currentLinePoints)&&e.currentLinePoints.length>0,$=!(A||K||Y),Z=e=>{try{const[t,n]=function([e,t],[n,r]=[0,0]){const i=function(e,t){const n=Math.cos(t*Math.PI/180);return NF*n*(e*kF)}(n,r),a=function(e,t){const n=Math.cos(t*Math.PI/180),r=Math.max(Math.min(Math.sin(e*kF),.9996),-.9996);return NF*n*Math.log((1+r)/(1-r))/2}(r,r),o=-t+a,s=function(e,t){const n=Math.cos(t*Math.PI/180);return e/(NF*n)/kF}(e+i,r),l=function(e,t){const n=Math.cos(t*Math.PI/180);return(2*Math.atan(Math.exp(e/(NF*n)))-Math.PI/2)/kF}(o,r);return[s,l]}([e.x,e.z],T.current);return t&&n&&Number.isFinite(t)&&Number.isFinite(n)?{lat:n,lon:t}:null}catch(e){return null}};(0,r.useEffect)((()=>{if(!Y)return B(null),void q({start:null,end:null});if(!f)return W(IF("selectDam",m)),void B(null);const t=(e.drawnLines||[]).filter((e=>"Тип 1"===(null==e?void 0:e.damType)));if(!t.length)return;const n=t[t.length-1];if(!(null==n?void 0:n.points)||n.points.length<2)return;const r=n.points[0],i=n.points[n.points.length-1],a=Z(r),o=Z(i);if(!a||!o)return void W(IF("noGeographicCoordinates",m));q({start:a,end:o});const s=[a.lat,a.lon,o.lat,o.lon].some((e=>"number"!=typeof e||!Number.isFinite(e)));if(s)return void W(IF("invalidGeographicCoordinates",m));const l=[a.lon,a.lat],c=[o.lon,o.lat],u=new AbortController;return LF(void 0,void 0,void 0,(function*(){var e;try{V(!0),W(null);const t=yield fetch(`https://api-dam3d.spacemc.uz/core/3d-models/by-dam/${encodeURIComponent(f)}/`,{signal:u.signal});if(!t.ok)throw new Error(`Failed to load 3D models: ${t.status}`);const r=yield t.json(),i=Array.isArray(r)&&r.length>0?r[0]:null,a=null==i?void 0:i.tif_file;if(!a||"string"!=typeof a)throw new Error(IF("failedToLoadProfile",m));const o=a.includes("django_movie/")?a.split("django_movie/")[1]:a.replace(/^https?:\/\/[^/]+\//,""),s=yield fetch("https://api-dam3d.spacemc.uz/profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({a:l,b:c,sampling_interval:null!==(e=null==n?void 0:n.samplingInterval)&&void 0!==e?e:1,file_path:o}),signal:u.signal}),d=yield s.text();let h=null;try{h=JSON.parse(d)}catch(e){}if(!s.ok){const e=(null==h?void 0:h.error)||(null==h?void 0:h.message)||d||`API error: ${s.status}`;throw new Error(e)}B(h)}catch(e){u.signal.aborted||(W(e instanceof Error?e.message:IF("failedToLoadProfile",m)),B(null))}finally{u.signal.aborted||V(!1)}})),()=>u.abort()}),[Y,e.drawnLines,f,m]);const J=e=>{const t=new ra(2,32,32),n=new nr({color:16711680,transparent:!0,opacity:1}),r=new Pr(t,n);r.position.copy(e);const i=new ra(3,32,32),a=new nr({color:16724787,transparent:!0,opacity:.3}),o=new Pr(i,a);return o.position.copy(e),y.current&&(y.current.add(r),y.current.add(o)),[r,o]},Q=e=>{const t=(new vr).setFromPoints(e),n=new Oi({color:16711680,linewidth:5,transparent:!1,opacity:1}),r=new zi(t,n),i=(new vr).setFromPoints(e),a=new Oi({color:16737894,linewidth:8,transparent:!0,opacity:.4}),o=new zi(i,a);return r.glowLine=o,r};(0,r.useEffect)((()=>{N.current=I}),[I]),(0,r.useEffect)((()=>{!$&&I&&L(!1)}),[$,I]),(0,r.useEffect)((()=>{if(y.current){const t=e.isDark?1052955:15790320;y.current.background=new Jn(t)}}),[e.isDark]),(0,r.useEffect)((()=>{f&&(E.current=f,e.onCloseChart(),C(!1),e.onClearAllLines(),B(null),W(null),q({start:null,end:null}),L(!1),y.current&&(P&&(y.current.remove(P),P.glowLine&&y.current.remove(P.glowLine),R(null)),O.forEach((e=>{var t;null===(t=y.current)||void 0===t||t.remove(e)})),D([])))}),[f]),(0,r.useEffect)((()=>(te(),()=>{M.current&&M.current.cancel("Operation canceled by the user."),ee()})),[e.damType,e.isDark,f]),(0,r.useEffect)((()=>{const e=()=>{if(x.current&&b.current&&v.current){const e=v.current.clientWidth,t=v.current.clientHeight;b.current.aspect=e/t,b.current.updateProjectionMatrix(),x.current.setSize(e,t)}};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,r.useEffect)((()=>{0===e.drawnLines.length&&y.current&&(P&&(y.current.remove(P),P.glowLine&&y.current.remove(P.glowLine),R(null)),O.forEach((e=>{var t;null===(t=y.current)||void 0===t||t.remove(e)})),D([]))}),[e.drawnLines.length]);const ee=()=>{var e,t;if(S.current&&(cancelAnimationFrame(S.current),S.current=null),_.current&&(_.current.dispose(),_.current=null),x.current){const e=x.current.__resizeObserver,t=x.current.__resizeHandler,n=x.current.__observedContainer;e&&n&&(e.unobserve(n),e.disconnect()),t&&window.removeEventListener("resize",t)}(null===(e=x.current)||void 0===e?void 0:e.domElement)&&(null===(t=v.current)||void 0===t?void 0:t.contains(x.current.domElement))&&v.current.removeChild(x.current.domElement),x.current&&(x.current.dispose(),x.current=null),y.current&&(y.current.clear(),y.current=null),w.current=null,b.current=null},te=()=>LF(void 0,void 0,void 0,(function*(){var e;if(v.current){if(ee(),!f)return d(!1),void p(IF("selectDam",m));d(!0),p(null),M.current&&M.current.cancel("Operation canceled due to new request."),M.current=jh.CancelToken.source();try{const e=`glb_${f}_type1`,t=encodeURIComponent(f);let n=(yield jh.get(`https://api-dam3d.spacemc.uz/core/3d-models/by-dam/${t}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},cancelToken:M.current.token})).data;Array.isArray(n)&&n.length>0&&(n=n[0]);const r=null!=(null==n?void 0:n.tif_lat)?parseFloat(String(n.tif_lat)):NaN,i=null!=(null==n?void 0:n.tif_long)?parseFloat(String(n.tif_long)):NaN;Number.isFinite(r)&&Number.isFinite(i)&&(T.current=[r,i]);const a=null==n?void 0:n.model_file_type_1;if(!a)return d(!1),void p(IF("noDataForDam",m));const o=yield(e=>LF(void 0,void 0,void 0,(function*(){try{const t=yield FF();return new Promise(((n,r)=>{const i=t.transaction([UF],"readonly").objectStore(UF).get(e);i.onsuccess=()=>{const e=i.result;e&&e.data?n(e.data):n(null)},i.onerror=()=>r(i.error)}))}catch(e){return null}})))(e);if(o){const e=URL.createObjectURL(o);return ne(e),void d(!1)}const s=a.replace(/^http:/,"https:"),l=yield jh.get(s,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},cancelToken:M.current.token});yield("type1",LF(void 0,void 0,void 0,(function*(){try{const e=yield FF();return new Promise(((t,n)=>{const r=e.transaction([UF],"readwrite").objectStore(UF),i=r.openCursor(),a=[];i.onsuccess=e=>{const n=e.target.result;if(n){const e=n.key;e&&"string"==typeof e&&e.endsWith("_type1")&&a.push(e),n.continue()}else{if(0===a.length)return void t();let e=0;a.forEach((n=>{const i=r.delete(n);i.onsuccess=()=>{e++,e===a.length&&t()},i.onerror=()=>{e++,e===a.length&&t()}}))}},i.onerror=()=>n(i.error)}))}catch(e){}}))),yield((e,t)=>LF(void 0,void 0,void 0,(function*(){try{const n=yield FF();return new Promise(((r,i)=>{const a=n.transaction([UF],"readwrite").objectStore(UF).put({key:e,data:t,timestamp:Date.now()});a.onsuccess=()=>r(),a.onerror=()=>i(a.error)}))}catch(e){}})))(e,l.data);const c=URL.createObjectURL(l.data);ne(c)}catch(t){jh.isCancel(t)||(jh.isAxiosError(t)&&404===(null===(e=t.response)||void 0===e?void 0:e.status)?p(IF("noDataForDam",m)):p(t instanceof Error?t.message:IF("unknownError",m)),d(!1))}}})),ne=t=>{if(!v.current)return;const n=v.current;new Promise((e=>{const t=()=>{const r=n.clientWidth,i=n.clientHeight;r>0&&i>0?e({width:r,height:i}):setTimeout(t,50)};t()})).then((({width:r,height:i})=>{if(!v.current)return;const a=new Kr,o=e.isDark?1052955:15790320;a.background=new Jn(o),y.current=a;const s=new Br(45,r/i,1,1e4);s.position.set(50,25,50),s.lookAt(0,0,0),b.current=s,x.current&&(x.current.domElement&&n.contains(x.current.domElement)&&n.removeChild(x.current.domElement),x.current.dispose(),x.current=null);const l=new dc({antialias:!0});l.setSize(r,i);const c=l.domElement;c.style.display="block",c.style.width="100%",c.style.height="100%",c.style.position="absolute",c.style.top="0",c.style.left="0",x.current=l,n.appendChild(c);const u=new ResizeObserver((()=>{if(!v.current||!x.current||!b.current)return;const e=v.current.clientWidth,t=v.current.clientHeight;e>0&&t>0&&(b.current.aspect=e/t,b.current.updateProjectionMatrix(),x.current.setSize(e,t))}));u.observe(n),x.current.__resizeObserver=u,x.current.__observedContainer=n;const d=()=>{if(!v.current||!x.current||!b.current)return;const e=v.current.clientWidth,t=v.current.clientHeight;e>0&&t>0&&(b.current.aspect=e/t,b.current.updateProjectionMatrix(),x.current.setSize(e,t))};window.addEventListener("resize",d),x.current.__resizeHandler=d,re(t,a,s,l)}))},re=(e,t,n,r)=>{const i=new Ja(16777215,1);t.add(i);const a=new Za(16777215,1);a.position.set(10,10,5),t.add(a);const o=new mu(n,r.domElement);o.enableDamping=!0,o.dampingFactor=.05,_.current=o,(new pc).load(e,(n=>{const r=n.scene;w.current=r,t.add(r),r.traverse((e=>{e.isMesh&&(e.material=new sa({flatShading:!0,vertexColors:!0}))}));const i=(new Dt).setFromObject(r),a=i.getSize(new lt),o=i.getCenter(new lt),s=Math.max(a.x,a.y,a.z);if(b.current&&_.current){const e=b.current.fov*Math.PI/180,t=s/2/Math.tan(e/2)*1.6;b.current.near=Math.max(.01,s/100),b.current.far=Math.max(2e3,100*s),b.current.position.set(o.x+.3*t,o.y+.3*t,o.z+t),b.current.lookAt(o),b.current.updateProjectionMatrix(),_.current.target.copy(o),_.current.update()}d(!1),p(null),e.startsWith("blob:")&&URL.revokeObjectURL(e)}),void 0,(e=>{d(!1),p(e instanceof Error?e.message:"Failed to load model")}));const s=()=>{S.current=requestAnimationFrame(s),_.current&&o.update(),N.current&&w.current&&(w.current.rotation.y+=.005),r.render(t,n)};s()};(0,r.useEffect)((()=>{var t,n;if(!y.current)return;P&&(y.current.remove(P),P.glowLine&&y.current.remove(P.glowLine)),O.forEach((e=>{var t;null===(t=y.current)||void 0===t||t.remove(e)})),R(null),D([]);const r=(e.drawnLines||[]).filter((e=>"Тип 1"===(null==e?void 0:e.damType)));if(r.length>0){const e=r[r.length-1],i=Array.isArray(null==e?void 0:e.points)?e.points:[];if(i.length>=2){const e=i.map((e=>{var t,n,r;return e instanceof lt?e.clone():new lt(null!==(t=null==e?void 0:e.x)&&void 0!==t?t:0,null!==(n=null==e?void 0:e.y)&&void 0!==n?n:0,null!==(r=null==e?void 0:e.z)&&void 0!==r?r:0)})),r=Q(e);null===(t=y.current)||void 0===t||t.add(r),r.glowLine&&(null===(n=y.current)||void 0===n||n.add(r.glowLine)),R(r);const a=[];e.forEach((e=>{const t=J(e);a.push(...t)})),D(a)}}}),[e.drawnLines]);const ie=Array.isArray(null==j?void 0:j.profile)&&j.profile.length>0,ae=ie&&null!==(t=null==j?void 0:j.profile)&&void 0!==t?t:[],oe=ie&&null!==(i=null==j?void 0:j.metadata)&&void 0!==i?i:null,se=ae.map(((e,t)=>{var n;return{distance:null!==(n=e.distance)&&void 0!==n?n:0,elevation:e.elevation}})),le=(e,t)=>{if(!e.length)return t;const n=Math.min(...e),r=Math.max(...e);return n===r?[n,n+1]:[n,r]},ce=(e,t)=>{const[n,r]=e;if(r<=n)return[Math.round(n)];const i=r-n;let a;if(a=i<100?5:i<500?6:i<1e3?7:i<5e3?8:10,t.every((e=>{const t=Math.round(e);return Math.abs(e-t)<.01}))){const e=Math.floor(n),t=Math.ceil(r),i=t-e,o=Math.max(1,Math.ceil(i/a)),s=[];for(let n=e;n<=t;n+=o)s.push(n);return s[s.length-1]<t&&s.push(t),s}const o=i/a;let s;return s=o>=100?0:o>=10||o>=1?1:2,Array.from({length:a+1},((e,t)=>Number((n+o*t).toFixed(s))))},ue=le(se.map((e=>e.distance)),[0,1]),de=se.map((e=>e.distance)),he=le(se.map((e=>e.elevation)),[0,1]),pe=se.map((e=>e.elevation)),fe=ce(ue,de),me=ce(he,pe),ge=oe?{totalDistance:null!==(a=null==oe?void 0:oe.totalDistance)&&void 0!==a?a:null==oe?void 0:oe.total_distance,samplingInterval:null!==(o=null==oe?void 0:oe.samplingInterval)&&void 0!==o?o:null==oe?void 0:oe.sampling_interval,minElevation:null!==(l=null==oe?void 0:oe.minElevation)&&void 0!==l?l:null==oe?void 0:oe.min_elevation,maxElevation:null!==(c=null==oe?void 0:oe.maxElevation)&&void 0!==c?c:null==oe?void 0:oe.max_elevation}:null,ve=H&&!ie,ye=!H&&!ie&&!G&&Y,xe=Y||H||ie||!!G;(0,r.useEffect)((()=>{if(y.current){if(F.current){y.current.remove(F.current);const e=F.current.glowMarker;e&&y.current.remove(e),F.current=null}if(null!==k&&ie&&ae.length>0){console.log("🎯 Creating marker for distance:",k),console.log("📊 Profile data length:",ae.length);const e=(e=>{var t;if(!ie||!ae.length||!P)return null;const n=(null===(t=ae[ae.length-1])||void 0===t?void 0:t.distance)||0;if(0===n)return null;const r=P.geometry.attributes.position;if(!r||r.count<2)return null;const i=[];for(let e=0;e<r.count;e++){const t=r.getX(e),n=r.getY(e),a=r.getZ(e);i.push(new lt(t,n,a))}if(i.length<2)return null;let a=0;const o=[];for(let e=0;e<i.length-1;e++){const t=i[e].distanceTo(i[e+1]);o.push(t),a+=t}const s=a*(e/n);let l=0;for(let e=0;e<o.length;e++){const t=o[e];if(s<=l+t){const n=(s-l)/t,r=i[e],a=i[e+1];return(new lt).lerpVectors(r,a,n)}l+=t}const c=i[i.length-1].clone(),u=ae[ae.length-1];return c.y=u.elevation,c})(k);if(console.log("📍 Found 3D point:",e),e){try{const t=(e=>{if(!y.current)throw new Error("Scene is not initialized");const t=new ra(6,32,32),n=new nr({color:16776960,transparent:!0,opacity:1}),r=new Pr(t,n);r.position.copy(e);const i=new ra(8,32,32),a=new nr({color:16776960,transparent:!0,opacity:.6}),o=new Pr(i,a);o.position.copy(e);const s=new ra(12,32,32),l=new nr({color:16776960,transparent:!0,opacity:.3}),c=new Pr(s,l);c.position.copy(e);const u=new ra(6.5,32,32),d=new nr({color:0,transparent:!0,opacity:.8,side:1}),h=new Pr(u,d);return h.position.copy(e),h.scale.multiplyScalar(1.05),y.current.add(r),y.current.add(o),y.current.add(c),y.current.add(h),r.midGlowMarker=o,r.outerGlowMarker=c,r.outlineMarker=h,r})(e);F.current=t,console.log("✅ Marker created and added to scene");const n=()=>{if(F.current&&y.current){const e=.003*Date.now(),t=1+.15*Math.sin(e);F.current.scale.set(t,t,t);const r=F.current.midGlowMarker;r&&r.scale.set(1.3*t,1.3*t,1.3*t);const i=F.current.outerGlowMarker;i&&i.scale.set(2*t,2*t,2*t);const a=F.current.outlineMarker;a&&a.scale.set(1.05*t,1.05*t,1.05*t),z.current=requestAnimationFrame(n)}};n()}catch(e){console.error("❌ Error creating marker:",e)}return()=>{if(null!==z.current&&(cancelAnimationFrame(z.current),z.current=null),F.current&&y.current){y.current.remove(F.current);const e=F.current.midGlowMarker;e&&y.current.remove(e);const t=F.current.outerGlowMarker;t&&y.current.remove(t);const n=F.current.outlineMarker;n&&y.current.remove(n),F.current=null}}}}return()=>{if(F.current&&y.current){y.current.remove(F.current);const e=F.current.midGlowMarker;e&&y.current.remove(e);const t=F.current.outerGlowMarker;t&&y.current.remove(t);const n=F.current.outlineMarker;n&&y.current.remove(n),F.current=null}}}}),[k,ie,ae]);const be=e.isDark?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)",_e=e.isDark?"rgba(255, 255, 255, 0.9)":"#2c3e50",we=e.isDark?"rgba(40, 46, 64, 0.98)":"rgba(255, 255, 255, 0.98)",Se=e.isDark?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",Me=e.isDark?"rgba(255, 255, 255, 0.9)":"#2c3e50";return(0,n.jsx)("div",{className:"type1-component "+(e.isDark?"dark":"")},(0,n.jsx)("div",{className:"drawing-tools"},(0,n.jsx)("div",{className:`icon-button ${A?"active":""} ${Y||u||!f||h?"disabled":""}`,onClick:u||!f||h?void 0:()=>{Y||(C(!A),A||y.current&&(P&&(y.current.remove(P),P.glowLine&&y.current.remove(P.glowLine),R(null)),O.forEach((e=>{var t;null===(t=y.current)||void 0===t||t.remove(e)})),D([]),e.onLinePointsChange([])))},title:u?"Loading...":IF(!f||h?"selectDam":Y?"lineAlreadyExists":A?"exitDrawingMode":"startDrawingLine",m)},(0,n.jsx)("svg",{width:"21",height:"21",viewBox:"0 0 21 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M13.1673 0.427038C13.9155 -0.183266 15.0195 -0.139282 15.717 0.558198L19.6091 4.45019L19.7393 4.59437C20.3092 5.29274 20.309 6.30048 19.7393 6.99896L19.6091 7.14408L7.144 19.6089C6.4464 20.3064 5.34249 20.3497 4.59424 19.7391L4.45005 19.6089L0.557959 15.7169C-0.186011 14.9729 -0.185962 13.767 0.557959 13.023L13.0231 0.558198L13.1673 0.427038ZM1.90494 14.3699L5.79703 18.2619L8.02214 16.0369L6.55237 14.5671L7.89935 13.2202L9.36912 14.6899L11.3561 12.703L9.41005 10.757L10.757 9.41006L12.7031 11.3561L14.69 9.36914L13.2203 7.89941L14.5673 6.55246L16.037 8.02219L18.2621 5.79713L14.37 1.90514L1.90494 14.3699Z",fill:"currentColor"}))),Y&&(0,n.jsx)("div",{className:"icon-button delete-icon "+(u||!f||h?"disabled":""),title:u||!f||h?u?"Loading...":IF("selectDam",m):IF("deleteLine",m),onClick:u||!f||h?void 0:()=>{if(y.current){if(P&&(y.current.remove(P),P.glowLine&&y.current.remove(P.glowLine)),O.forEach((e=>{var t;null===(t=y.current)||void 0===t||t.remove(e)})),F.current){y.current.remove(F.current);const e=F.current.midGlowMarker;e&&y.current.remove(e);const t=F.current.outerGlowMarker;t&&y.current.remove(t);const n=F.current.outlineMarker;n&&y.current.remove(n),F.current=null}null!==z.current&&(cancelAnimationFrame(z.current),z.current=null),R(null),D([]),U(null),e.onClearAllLines(),B(null),W(null),q({start:null,end:null}),C(!1)}}},(0,n.jsx)("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M18.0513 5.07692L3.94872 5.07692L3.94872 13.2564C3.94872 15.4221 3.95916 16.3045 4.18339 16.9947C4.65771 18.4543 5.80211 19.5987 7.26172 20.073C7.95185 20.2972 8.83423 20.3077 11 20.3077C13.1658 20.3077 14.0481 20.2972 14.7383 20.073C16.1979 19.5987 17.3423 18.4543 17.8166 16.9947C18.0408 16.3045 18.0513 15.4221 18.0513 13.2564V5.07692ZM7.33333 16.0769L7.33333 8.17947C7.33333 7.71216 7.71217 7.33332 8.17949 7.33332C8.64681 7.33332 9.02564 7.71216 9.02564 8.17947V16.0769C9.02564 16.5442 8.64681 16.923 8.17949 16.923C7.71217 16.923 7.33333 16.5442 7.33333 16.0769ZM12.9744 16.0769V8.17947C12.9744 7.71216 13.3532 7.33332 13.8205 7.33332C14.2878 7.33332 14.6667 7.71216 14.6667 8.17947V16.0769C14.6667 16.5442 14.2878 16.923 13.8205 16.923C13.3532 16.923 12.9744 16.5442 12.9744 16.0769ZM11 1.69231C10.4629 1.69231 10.1025 1.69311 9.82332 1.71214C9.55174 1.73067 9.41898 1.76313 9.33193 1.79918C8.98638 1.94231 8.71154 2.21715 8.56841 2.5627C8.53236 2.64974 8.4999 2.78251 8.48137 3.05408C8.47465 3.1527 8.47214 3.26149 8.46925 3.38461L13.5308 3.38461C13.5279 3.26149 13.5254 3.1527 13.5186 3.05408C13.5001 2.78251 13.4676 2.64974 13.4316 2.5627C13.2885 2.21715 13.0136 1.94231 12.6681 1.79918C12.581 1.76313 12.4483 1.73067 12.1767 1.71214C11.8975 1.69311 11.5371 1.69231 11 1.69231ZM19.7436 13.2564C19.7436 15.2901 19.754 16.5077 19.4263 17.5169C18.7846 19.4918 17.2355 21.041 15.2605 21.6827C14.2513 22.0104 13.0337 22 11 22C8.96632 22 7.74869 22.0104 6.73948 21.6827C4.76454 21.041 3.21542 19.4918 2.57372 17.5169C2.24596 16.5077 2.25641 15.2901 2.25641 13.2564L2.25641 5.07692H0.846154C0.378836 5.07692 0 4.69808 0 4.23076C0 3.76345 0.378836 3.38461 0.846154 3.38461L6.77694 3.38461C6.78032 3.22377 6.78304 3.07505 6.79237 2.9384C6.81678 2.5807 6.86932 2.24244 7.00501 1.91486C7.3199 1.15481 7.92404 0.550666 8.6841 0.235779C9.01167 0.100093 9.34993 0.0475531 9.70763 0.0231396C10.0578 -0.000751131 10.4859 2.6558e-06 11 2.6558e-06C11.5141 2.6558e-06 11.9422 -0.000751131 12.2924 0.0231396C12.6501 0.0475531 12.9883 0.100093 13.3159 0.235779C14.076 0.550666 14.6801 1.15481 14.995 1.91486C15.1307 2.24244 15.1832 2.5807 15.2076 2.9384C15.217 3.07505 15.2197 3.22377 15.2231 3.38461L21.1538 3.38461C21.6212 3.38461 22 3.76345 22 4.23076C22 4.69808 21.6212 5.07692 21.1538 5.07692H19.7436V13.2564Z",fill:"white"}))),(0,n.jsx)("div",{className:`icon-button ${I?"active spinning":""} ${!$||u||!f||h?"disabled":""}`,onClick:u||!$||!f||h?void 0:()=>{$&&L(!I)},"aria-disabled":!$||u||!f||!!h,title:u?"Loading...":IF(!f||h?"selectDam":$?I?"stopRotating":"startRotating":"spinningDisabled",m)},I?(0,n.jsx)("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M9 15H7L7 7H9V15Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M15 15H13V7H15V15Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 0C4.92487 0 0 4.92487 0 11C0 17.0751 4.92487 22 11 22C17.0751 22 22 17.0751 22 11C22 4.92487 17.0751 0 11 0ZM2 11C2 6.02944 6.02944 2 11 2C15.9706 2 20 6.02944 20 11C20 15.9706 15.9706 20 11 20C6.02944 20 2 15.9706 2 11Z",fill:"currentColor"})):(0,n.jsx)("svg",{width:"21",height:"21",viewBox:"0 0 21 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.75848 5.65396C8.47719 5.46643 8.11553 5.44895 7.81746 5.60847C7.5194 5.76798 7.33333 6.07861 7.33333 6.41667V13.75C7.33333 14.0881 7.5194 14.3987 7.81746 14.5582C8.11553 14.7177 8.47719 14.7002 8.75848 14.5127L14.2585 10.846C14.5135 10.676 14.6667 10.3898 14.6667 10.0833C14.6667 9.77684 14.5135 9.49063 14.2585 9.32062L8.75848 5.65396ZM12.0975 10.0833L9.16667 12.0372V8.12948L12.0975 10.0833Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0833 0C4.51446 0 0 4.51446 0 10.0833C0 15.6522 4.51446 20.1667 10.0833 20.1667C15.6522 20.1667 20.1667 15.6522 20.1667 10.0833C20.1667 4.51446 15.6522 0 10.0833 0ZM1.83333 10.0833C1.83333 5.52698 5.52698 1.83333 10.0833 1.83333C14.6397 1.83333 18.3333 5.52698 18.3333 10.0833C18.3333 14.6397 14.6397 18.3333 10.0833 18.3333C5.52698 18.3333 1.83333 14.6397 1.83333 10.0833Z",fill:"currentColor"})))),(0,n.jsx)("div",{className:"type1-layout"},(0,n.jsx)("div",{className:`container-3d ${A?"drawing-mode":""} ${I?"spinning-mode":""}`,ref:v,onClick:t=>{if(!y.current||!b.current||!x.current)return;if(Y||!A||!w.current)return;const n=t.currentTarget.getBoundingClientRect(),r=new ot;r.x=(t.clientX-n.left)/n.width*2-1,r.y=-(t.clientY-n.top)/n.height*2+1;const i=new ho;i.setFromCamera(r,b.current);const a=i.intersectObject(w.current,!0);if(a.length>0){const t=a[0].point,n=[...e.currentLinePoints,t];e.onLinePointsChange(n);const r=J(t);if(D((e=>[...e,...r])),2===n.length){const t=Q(n);R(t),y.current.add(t),e.onLineCompleted(n),C(!1)}}}},A&&(0,n.jsx)("div",{className:"drawing-mode-message"},IF("clickOnTerrainToPlacePoints",m)),u&&(0,n.jsx)("div",{className:"loading"},(0,n.jsx)("div",{className:"loading-spinner-modern"},(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"}))),h&&(0,n.jsx)("div",{className:"error-message"},(0,n.jsx)("div",{className:"error-content"},(0,n.jsx)("div",{className:"error-icon-wrapper"},(0,n.jsx)("svg",{className:"error-icon-svg",width:"80",height:"80",viewBox:"0 0 46 42",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M28.1746 3.16754C27.6273 2.20563 26.8349 1.40582 25.8782 0.849456C24.9215 0.293087 23.8345 0 22.7278 0C21.621 0 20.5341 0.293087 19.5773 0.849456C18.6206 1.40582 17.8283 2.20563 17.281 3.16754L0.785217 32.5569C0.261401 33.4791 -0.00939594 34.5235 0.000248916 35.5841C0.00989377 36.6447 0.299638 37.6839 0.840139 38.5965C1.38858 39.538 2.17614 40.3178 3.12302 40.857C4.0699 41.3961 5.14246 41.6753 6.23203 41.6665H39.2235C40.3131 41.6753 41.3857 41.3961 42.3325 40.857C43.2794 40.3178 44.067 39.538 44.6154 38.5965C45.1559 37.6839 45.4457 36.6447 45.4553 35.5841C45.465 34.5235 45.1942 33.4791 44.6703 32.5569L28.1746 3.16754ZM41.3466 36.6893C41.1285 37.0567 40.8174 37.3601 40.4447 37.5689C40.0719 37.7777 39.6507 37.8846 39.2235 37.8787H6.23203C5.80428 37.884 5.3827 37.7763 5.00992 37.5665C4.63713 37.3566 4.32635 37.0521 4.10899 36.6836C3.90296 36.3412 3.79237 35.9498 3.7887 35.5502C3.78504 35.1505 3.88844 34.7572 4.08815 34.411L20.5839 5.01976C20.8176 4.6646 21.1358 4.37305 21.51 4.17131C21.8842 3.96957 22.3027 3.86395 22.7278 3.86395C23.1529 3.86395 23.5714 3.96957 23.9456 4.17131C24.3198 4.37305 24.638 4.6646 24.8717 5.01976L41.3674 34.4091C41.5675 34.7555 41.6711 35.1492 41.6674 35.5492C41.6638 35.9492 41.553 36.341 41.3466 36.6836V36.6893Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 11.3643C22.2255 11.3643 21.7438 11.5638 21.3886 11.919C21.0334 12.2742 20.8339 12.7559 20.8339 13.2582V24.6215C20.8339 25.1238 21.0334 25.6055 21.3886 25.9607C21.7438 26.3158 22.2255 26.5154 22.7278 26.5154C23.2301 26.5154 23.7118 26.3158 24.067 25.9607C24.4221 25.6055 24.6217 25.1238 24.6217 24.6215V13.2582C24.6217 12.7559 24.4221 12.2742 24.067 11.919C23.7118 11.5638 23.2301 11.3643 22.7278 11.3643Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 34.0909C23.7737 34.0909 24.6217 33.243 24.6217 32.197C24.6217 31.1511 23.7737 30.3031 22.7278 30.3031C21.6818 30.3031 20.8339 31.1511 20.8339 32.197C20.8339 33.243 21.6818 34.0909 22.7278 34.0909Z",fill:"#F0C039"}))),(0,n.jsx)("div",{className:"error-title"},h),h===IF("selectDam",m)&&(0,n.jsx)("div",{className:"error-description"},"uz"===m?"3D modelni ko'rish uchun suv omborini tanlang":"uzcryl"===m?"3D моделни кўриш учун сув омборини танланг":"Пожалуйста, выберите водохранилище для просмотра 3D модели"),h===IF("noDataForDam",m)&&(0,n.jsx)("div",{className:"error-description"},"uz"===m?"Ushbu suv ombori uchun 3D model mavjud emas":"uzcryl"===m?"Ушбу сув омбори учун 3D модель мавжуд эмас":"Для этого водохранилища 3D модель недоступна"),h!==IF("selectDam",m)&&h!==IF("noDataForDam",m)&&(0,n.jsx)("div",null,(0,n.jsx)("div",{className:"error-description"},IF("errorLoadingModel",m)),(0,n.jsx)("button",{className:"retry-button",onClick:()=>te()},IF("retry",m)))))),xe&&(0,n.jsx)("div",{className:"integrated-chart-section "+(e.isDark?"dark":"")},(0,n.jsx)("div",{className:"chart-header"},(0,n.jsx)("h3",{className:"chart-title"},(0,n.jsx)("span",null,IF("download",m))),(0,n.jsx)("div",{className:"chart-actions"},(0,n.jsx)("button",{className:"chart-download-button",onClick:()=>LF(void 0,void 0,void 0,(function*(){try{const e=(yield s.e("vendors-node_modules_html2canvas_dist_html2canvas_esm_js").then(s.bind(s,1407))).default,t=(yield s.e("vendors-node_modules_jspdf_dist_jspdf_es_min_js").then(s.bind(s,2524))).default;yield new Promise((e=>setTimeout(e,500)));const n=document.querySelector(".integrated-chart-section"),r=document.querySelector(".chart-header"),i=document.querySelector(".chart-body");if(!n)throw new Error("Chart section not found");const a=(()=>{const e=localStorage.getItem("selected_dam")||"",t=localStorage.getItem("custom_locale")||"ru";if(!e)return"";const n=e.toLowerCase().trim(),r=RF[n];return r&&(r[t]||r.ru)||e})(),o=r?r.style.display:"",l=n.style.backgroundColor,c=i?i.style.backgroundColor:"",u=n.style.paddingTop,d=n.style.position;r&&(r.style.display="none"),n.style.backgroundColor="#ffffff",i&&(i.style.backgroundColor="#ffffff");let h=null;a&&(h=document.createElement("div"),h.textContent=a,h.style.color="#1a202e",h.style.fontSize="24px",h.style.fontWeight="bold",h.style.textAlign="center",h.style.marginBottom="15px",h.style.fontFamily="Arial, sans-serif",h.style.lineHeight="1.5",h.style.paddingTop="20px",h.className="temp-pdf-title",n.insertBefore(h,n.firstChild));const p=n.querySelectorAll(".profile-metadata-inline, .profile-metadata-inline span, .line-coordinates, .axis-label-x, .axis-label-y"),f=[];p.forEach((e=>{const t=e;f.push(t.style.color),t.style.color="#1a202e"})),n.style.position="relative",n.style.paddingTop="0",yield new Promise((e=>setTimeout(e,500)));const m=yield e(n,{backgroundColor:"#ffffff",useCORS:!0,allowTaint:!0,logging:!1,scale:2,width:n.offsetWidth,height:n.offsetHeight});n.style.paddingTop=u,n.style.position=d,n.style.backgroundColor=l,i&&(i.style.backgroundColor=c),r&&(r.style.display=o),p.forEach(((e,t)=>{e.style.color=f[t]})),h&&h.parentNode&&h.parentNode.removeChild(h);const g=m.toDataURL("image/png",1),v=new t({orientation:"landscape",unit:"mm",format:"a4"}),y=v.internal.pageSize.getWidth(),x=v.internal.pageSize.getHeight(),b=10,_=y-2*b,w=x-2*b,S=m.width/m.height;let M,E,T,A;S>_/w?(M=_,E=_/S,T=b,A=(x-E)/2):(E=w,M=w*S,T=(y-M)/2,A=b),v.addImage(g,"PNG",T,A,M,E),v.save("elevation")}catch(e){console.error("Error generating PDF:",e),(()=>{const e=ie?ae:[];if(0===e.length)return void console.warn("No data to export");const t="data:text/csv;charset=utf-8,Distance (m),Elevation (m),Longitude,Latitude\n"+e.map((e=>{var t,n,r,i;return`${e.distance},${e.elevation},${null!==(n=null===(t=e.coordinates)||void 0===t?void 0:t[0])&&void 0!==n?n:""},${null!==(i=null===(r=e.coordinates)||void 0===r?void 0:r[1])&&void 0!==i?i:""}`})).join("\n"),n=encodeURI(t),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download","elevation_profile.csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r)})()}})),disabled:u||H},(0,n.jsx)("svg",{width:"19",height:"21",viewBox:"0 0 19 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.222325 16.695L0 15.8057L1.77859 15.361L2.00092 16.2503C2.17306 16.9389 2.28402 17.3764 2.40554 17.6954C2.51828 17.9913 2.60516 18.086 2.67326 18.1392C2.74136 18.1924 2.85427 18.2537 3.16871 18.2913C3.50763 18.3318 3.95904 18.3333 4.66881 18.3333H13.6098C14.3196 18.3333 14.771 18.3318 15.1099 18.2913C15.4243 18.2537 15.5372 18.1924 15.6053 18.1392C15.6734 18.086 15.7603 17.9913 15.8731 17.6954C15.9946 17.3764 16.1055 16.9389 16.2777 16.2503L16.5 15.361L18.2786 15.8057L18.0439 16.7445C17.8878 17.369 17.7515 17.9145 17.5863 18.3481C17.408 18.8162 17.1628 19.2491 16.7336 19.5842C16.3044 19.9194 15.8249 20.0522 15.3276 20.1116C14.8668 20.1667 14.3046 20.1667 13.6608 20.1667H4.66881C4.65175 20.1667 4.63474 20.1667 4.61779 20.1667C3.974 20.1667 3.41176 20.1667 2.95103 20.1116C2.45369 20.0522 1.97422 19.9194 1.545 19.5842C1.11579 19.2491 0.870644 18.8162 0.692325 18.3481C0.527133 17.9145 0.390803 17.369 0.234698 16.7445C0.230588 16.728 0.226463 16.7115 0.222325 16.695Z",fill:"white"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.28748 7.60182L7.19475 10.5091C7.82419 11.1385 8.23244 11.544 8.57253 11.8035C8.89147 12.0468 9.04061 12.0739 9.1393 12.0739C9.23798 12.0739 9.38713 12.0468 9.70607 11.8035C10.0462 11.544 10.4544 11.1385 11.0838 10.5091L13.9911 7.60182L15.2875 8.89818L12.3375 11.8481C11.763 12.4228 11.2679 12.9179 10.8181 13.261C10.3361 13.6288 9.8 13.9073 9.1393 13.9073C8.47859 13.9073 7.94248 13.6288 7.46046 13.261C7.01069 12.9179 6.51563 12.4228 5.94106 11.8481C5.92689 11.834 5.91266 11.8197 5.89839 11.8055L2.99112 8.89818L4.28748 7.60182Z",fill:"white"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.22263 12.8333V0H10.056V12.8333H8.22263Z",fill:"white"}))))),(0,n.jsx)("div",{className:"chart-body"},((null==ge?void 0:ge.totalDistance)||X.start&&X.end)&&ie&&(0,n.jsx)("div",{className:"profile-metadata-inline",style:{display:"flex",flexWrap:"wrap",gap:"16px",marginBottom:"8px",fontSize:"11px",alignItems:"center"}},(null==ge?void 0:ge.totalDistance)&&(0,n.jsx)("span",null,IF("totalDistance",m)," ",ge.totalDistance," м"),X.start&&X.end&&(0,n.jsx)("div",{style:{display:"flex",gap:"10px"}},(0,n.jsx)("span",null,"A: [",X.start.lat.toFixed(6),", ",X.start.lon.toFixed(6),"]"),(0,n.jsx)("span",null,"B: [",X.end.lat.toFixed(6),", ",X.end.lon.toFixed(6),"]"))),(0,n.jsx)("div",{className:"chart-content-wrapper"},ve&&(0,n.jsx)("div",{className:"chart-loading "+(e.isDark?"dark":"")},(0,n.jsx)("div",{className:"chart-loader-orbit"},(0,n.jsx)("span",null),(0,n.jsx)("span",null),(0,n.jsx)("span",null))),ye&&(0,n.jsx)("div",{className:"chart-empty-state "+(e.isDark?"dark":"")},(0,n.jsx)("p",null,IF("buildLineToSeeProfile",m))),G&&(0,n.jsx)("div",{className:"chart-error "+(e.isDark?"dark":"")},(0,n.jsx)("p",null,G)),ie&&(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",height:"100%",position:"relative"}},(0,n.jsx)("div",{className:"axis-label-y",style:{position:"absolute",left:"-20px",top:"50%",transform:"translateY(-50%) rotate(-90deg)",fontSize:"11px",color:_e,whiteSpace:"nowrap",fontWeight:"500",zIndex:10}},IF("elevationM",m)),(0,n.jsx)(Pp,{width:"100%",height:"100%"},(0,n.jsx)(GO,{data:se,margin:{top:5,right:10,left:35,bottom:25},onMouseMove:e=>{if(console.log("🖱️ Mouse move on chart:",e),e){let t=null;if(e.activePayload&&Array.isArray(e.activePayload)&&e.activePayload.length>0){const n=e.activePayload[0].payload;console.log("📊 Active payload data:",n),n&&"number"==typeof n.distance&&(t=n.distance)}if(null===t&&e.activeLabel){const n=parseFloat(String(e.activeLabel));console.log("📏 Active label:",e.activeLabel,"parsed:",n),isNaN(n)||(t=n)}if(null===t&&e.chartX&&se.length>0){const t=e.chartX;e.chartX&&e.chartX,console.log("🖱️ Mouse X position:",t)}console.log("📍 Setting hovered distance:",t),null!==t&&U(t)}},onMouseLeave:()=>{console.log("👋 Mouse left chart"),U(null)}},(0,n.jsx)(NI,{strokeDasharray:"3 3",stroke:be}),(0,n.jsx)(QI,{dataKey:"distance",type:"number",axisLine:!1,tickLine:!1,tick:{fontSize:11,fill:_e},domain:ue,ticks:fe,tickFormatter:e=>`${e}`}),(0,n.jsx)(hL,{axisLine:!1,tickLine:!1,tick:{fontSize:11,fill:_e},domain:he,ticks:me,tickFormatter:e=>`${e}`,width:30}),(0,n.jsx)(qk,{contentStyle:{backgroundColor:we,border:`1px solid ${Se}`,borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",color:Me,fontSize:"12px"},formatter:(e,t,n)=>(n&&n.payload&&"number"==typeof n.payload.distance&&(console.log("📍 Setting distance from tooltip formatter:",n.payload.distance),U(n.payload.distance)),"elevation"===t?[`${e} m`,IF("elevation",m)]:[e,t]),labelFormatter:e=>{const t=parseFloat(String(e));return isNaN(t)||(console.log("📍 Setting distance from tooltip label:",t),U(t)),`${IF("distanceLabel",m)} ${e} m`}}),(0,n.jsx)(dF,{type:"monotone",dataKey:"elevation",stroke:"#4a90e2",strokeWidth:2,fill:"url(#colorGradient)",fillOpacity:1}),(0,n.jsx)("defs",null,(0,n.jsx)("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1"},(0,n.jsx)("stop",{offset:"5%",stopColor:"#4a90e2",stopOpacity:.6}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#4a90e2",stopOpacity:.1}))))),(0,n.jsx)("div",{className:"axis-label-x",style:{fontSize:"11px",color:_e,textAlign:"center",marginTop:"0px",fontWeight:"500"}},IF("distanceM",m))))))))},jF=(0,r.createContext)(void 0),BF=({children:e})=>{const[t,n]=(0,r.useState)(395),i=(0,r.useCallback)((e=>{n(e)}),[]),a=(0,r.useMemo)((()=>({waterLevel:t,updateWaterLevel:i})),[t,i]);return r.default.createElement(jF.Provider,{value:a},e)},HF=()=>{const e=(0,r.useContext)(jF);if(void 0===e)throw new Error("useWaterLevel must be used within a WaterLevelProvider");return e};class VF extends Kr{constructor(){super(),this.name="RoomEnvironment";const e=new Or;e.deleteAttribute("uv");const t=new aa({side:1}),n=new aa,r=new Ya(16777215,900,28,2);r.position.set(.418,16.199,.3),this.add(r);const i=new Pr(e,t);i.position.set(-.757,13.219,.717),i.scale.set(31.713,28.305,28.591),this.add(i);const a=new wi(e,n,6),o=new In;o.position.set(-10.906,2.009,1.846),o.rotation.set(0,-.195,0),o.scale.set(2.328,7.905,4.651),o.updateMatrix(),a.setMatrixAt(0,o.matrix),o.position.set(-5.607,-.754,-.758),o.rotation.set(0,.994,0),o.scale.set(1.97,1.534,3.955),o.updateMatrix(),a.setMatrixAt(1,o.matrix),o.position.set(6.167,.857,7.803),o.rotation.set(0,.561,0),o.scale.set(3.927,6.285,3.687),o.updateMatrix(),a.setMatrixAt(2,o.matrix),o.position.set(-2.017,.018,6.124),o.rotation.set(0,.333,0),o.scale.set(2.002,4.566,2.064),o.updateMatrix(),a.setMatrixAt(3,o.matrix),o.position.set(2.291,-.756,-2.621),o.rotation.set(0,-.286,0),o.scale.set(1.546,1.552,1.496),o.updateMatrix(),a.setMatrixAt(4,o.matrix),o.position.set(-2.193,-.369,-5.547),o.rotation.set(0,.516,0),o.scale.set(3.875,3.487,2.986),o.updateMatrix(),a.setMatrixAt(5,o.matrix),this.add(a);const s=new Pr(e,GF(50));s.position.set(-16.116,14.37,8.208),s.scale.set(.1,2.428,2.739),this.add(s);const l=new Pr(e,GF(50));l.position.set(-16.109,18.021,-8.207),l.scale.set(.1,2.425,2.751),this.add(l);const c=new Pr(e,GF(17));c.position.set(14.904,12.198,-1.832),c.scale.set(.15,4.265,6.331),this.add(c);const u=new Pr(e,GF(43));u.position.set(-.462,8.89,14.52),u.scale.set(4.38,5.441,.088),this.add(u);const d=new Pr(e,GF(20));d.position.set(3.235,11.486,-12.541),d.scale.set(2.5,2,.1),this.add(d);const h=new Pr(e,GF(100));h.position.set(0,20,0),h.scale.set(1,.1,1),this.add(h)}dispose(){const e=new Set;this.traverse((t=>{t.isMesh&&(e.add(t.geometry),e.add(t.material))}));for(const t of e)t.dispose()}}function GF(e){return new la({color:0,emissive:16777215,emissiveIntensity:e})}var WF=s(3722),XF={};XF.styleTagTransform=SF(),XF.setAttributes=xF(),XF.insert=vF().bind(null,"head"),XF.domAPI=mF(),XF.insertStyleElement=_F(),pF()(WF.Z,XF),WF.Z&&WF.Z.locals&&WF.Z.locals;var qF=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const YF="glb_files",KF=()=>new Promise(((e,t)=>{const n=indexedDB.open("glb_cache_db",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(YF)||t.createObjectStore(YF,{keyPath:"key"})}})),$F={model_min_height:0,res_min_height:0,res_max_height:0,Qgis_depth:0},ZF=function({modelName:e,damType:t="two",showOnlyRelief:n=!1,isDark:i=!1,onStatusChange:a,rotationControl:o,hideRotationButton:s=!1,hideStatusMessages:l=!1}){var c,u;const d=(0,r.useRef)(null),h=(0,r.useRef)(null),f=(0,r.useRef)(null),m=(0,r.useRef)(null),[g,v]=(0,r.useState)(!1),y=(0,r.useRef)(g),[x,b]=(0,r.useState)(!0),_=null!==(c=null==o?void 0:o.isRotating)&&void 0!==c?c:x,w=null!==(u=null==o?void 0:o.setIsRotating)&&void 0!==u?u:b,S=(0,r.useRef)(_),M=(0,r.useRef)(),E=(0,r.useRef)(null),T=(0,r.useRef)(null),A=(0,r.useRef)(null),C=(0,r.useRef)(null),[P,R]=(0,r.useState)(!1),[O,D]=(0,r.useState)("3d_mountains"),I=PF(),L=((null==e?void 0:e.trim())||I||"").trim(),[N,k]=(0,r.useState)(0),[U,F]=(0,r.useState)(0),[z,j]=(0,r.useState)((()=>Object.assign({},$F))),[B,H]=(0,r.useState)(!1),[V,G]=(0,r.useState)(null),W=(0,r.useRef)(null),[X,q]=(0,r.useState)("idle"),[Y,K]=(0,r.useState)(""),{waterLevel:$}=HF(),[Z,J]=(0,r.useState)((()=>"undefined"==typeof window?"ru":localStorage.getItem("custom_locale")||"ru"));function Q(e,t,n,r,i){if(!isFinite(e)||!isFinite(t)||e===t)return console.warn("⚠️ Invalid model height range:",{modelMaxHeight:e,modelMinHeight:t}),t||0;if(!isFinite(r)||!isFinite(n)||r<=n)return console.warn("⚠️ Invalid reservoir height range:",{resMaxHeight:r,resMinHeight:n}),t||0;const a=(r-n)/(e-t),o=n-a*t,s=(i-o)/a;return!isFinite(s)||isNaN(s)?(console.warn("⚠️ Calculated model height is invalid:",{model_height:s,waterLevel:i,modelMaxHeight:e,modelMinHeight:t,resMaxHeight:r,resMinHeight:n,m:a,c:o}),t):s}return(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("custom_locale")||"ru";J(e)};e(),window.addEventListener("storage",e);const t=setInterval(e,250);return()=>{window.removeEventListener("storage",e),clearInterval(t)}}),[]),(0,r.useEffect)((()=>{a&&a(X,Y)}),[X,Y,a]),(0,r.useEffect)((()=>{L&&(C.current=L)}),[L]),(0,r.useEffect)((()=>{let e=!0;return R(!1),j((()=>Object.assign({},$F))),H(!1),G(null),W.current=null,L?(q("loading"),K(""),(()=>{qF(this,void 0,void 0,(function*(){var t,n,r,i,a,o,s;try{const s=yield jh.get(`https://api-dam3d.spacemc.uz/core/by-name/${encodeURIComponent(L)}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`}});if(!e)return;if(console.log("📊 Dam data received:",s.data),!s.data)return q("noData"),void K("");let l;l="3d_model"===O?s.data.max_height:"3d_mountains"===O?s.data.terrain_height:0;const c=null!==(n=null!==(t=s.data.model_min)&&void 0!==t?t:s.data.model_min_height)&&void 0!==n?n:0,u=null!==(i=null!==(r=s.data.min_height)&&void 0!==r?r:s.data.res_min_height)&&void 0!==i?i:0,d=null!==(a=null!=l?l:s.data.res_max_height)&&void 0!==a?a:0,h=null!==(o=s.data.Qgis_depth)&&void 0!==o?o:0;console.log("📊 Extracted dam data:",{modelMin:c,resMin:u,resMax:d,qgisDepth:h,rawData:s.data}),j({model_min_height:c,res_min_height:u,res_max_height:d,Qgis_depth:h}),H(!0)}catch(t){if(!e)return;jh.isAxiosError(t)&&404===(null===(s=t.response)||void 0===s?void 0:s.status)?(q("noData"),K("")):(console.error("Error fetching dam data:",t),q("error"),K(t instanceof Error?t.message:IF("unknownError",Z)))}}))})(),()=>{e=!1}):(q("selectDam"),K(""),()=>{e=!1})}),[L,O]),(0,r.useEffect)((()=>{S.current=_}),[_]),(0,r.useEffect)((()=>{y.current=g}),[g]),(0,r.useEffect)((()=>{if(f.current){const e=i?1052955:16250871;f.current.background=new Jn(e)}}),[i]),(0,r.useEffect)((()=>{if(!L)return;R(!1),k(0);const e=new Xr,n=new dc({antialias:!0,alpha:!0});n.setPixelRatio(window.devicePixelRatio);const r=()=>{requestAnimationFrame((()=>{if(d.current){const e=d.current.clientWidth,t=d.current.clientHeight;E.current=t,n.setSize(e,t),l.aspect=e/t,l.updateProjectionMatrix()}}))};d.current.appendChild(n.domElement),h.current=n;const a=new Ho(n),o=new Kr,s=i?1052955:16250871;o.background=new Jn(s),f.current=o,o.environment=a.fromScene(new VF,.045).texture;const l=new Br(75,d.current.clientWidth/d.current.clientHeight,.1,1e3);l.position.set(0,0,5);const c=new mu(l,n.domElement);c.target.set(0,.5,0),c.update();const u=()=>{y.current?(l.aspect=d.current.clientWidth/d.current.clientHeight,l.updateProjectionMatrix(),n.setSize(d.current.clientWidth,d.current.clientHeight)):(l.aspect=d.current.clientWidth/E.current,l.updateProjectionMatrix(),n.setSize(d.current.clientWidth,E.current))};function g(n,r){const i=n.scene,a=(new Dt).setFromObject(n.scene),s=new lt;a.getSize(s);const c=a.min.y,u=a.max.y;k(u),F(c),console.log("📐 Model bounding box:",{minY:c,maxY:u,sizeY:s.y});const d=new lt;a.getCenter(d);const h=.3*s.length()/Math.tan(.5*l.fov*Math.PI/200);if(l.position.set(d.x+h,d.y+h,d.z),"3d_mountains"===O){let e=n.scene.getObjectByName("Plane")||n.scene.getObjectByName("plane")||n.scene.getObjectByName("Plane_water")||n.scene.getObjectByName("water");if(e||(console.log("🔍 No plane found by name in 3d_mountains model, traversing scene for plane geometry"),n.scene.traverse((t=>{t instanceof Pr&&t.geometry instanceof na&&(e||(e=t))}))),e&&e instanceof Pr){console.log("💧 Found water plane in 3d_mountains model:",e.name||"unnamed");const n=document.createElement("canvas");n.width=512,n.height=512;const r=n.getContext("2d");if(r){const e=r.createImageData(512,512),t=e.data;for(let e=0;e<512;e++)for(let n=0;n<512;n++){const r=4*(512*e+n),i=n/512,a=e/512,o=128+20*(.3*(.5*Math.sin(i*Math.PI*2+a*Math.PI*3)+.5)+.4*(.5*Math.sin(i*Math.PI*4-a*Math.PI*2)+.5)+.3*(.5*Math.sin((i+a)*Math.PI*6)+.5)-.5);t[r]=o,t[r+1]=o,t[r+2]=o,t[r+3]=255}r.putImageData(e,0,0)}const i=new Ji(n);i.wrapS=p,i.wrapT=p,i.repeat.set(4,4),T.current=i,e.material&&(Array.isArray(e.material)?e.material.forEach((e=>{e instanceof tr&&e.dispose()})):e.material instanceof tr&&e.material.dispose());const a=new nr({map:i,color:"two"===t?"#1E90FF":"#008080",side:2,transparent:!1,opacity:1});e.material=a,A.current=e,e.visible=!0;const o=c,s=u;let l,d,h=!1;if(B&&z.res_max_height>z.res_min_height&&z.res_min_height>0&&(l=z.res_min_height,d=z.res_max_height,h=!0,console.log("💧 Using damData from by-name API for water position calculation:",{resMinHeight:l,resMaxHeight:d})),h){const t=.2;if($<l-t)A.current instanceof Pr&&(A.current.visible=!1),console.log("💧 Initial water level below minimum in 3d_mountains, hiding water:",{waterLevel:$,resMinHeight:l,threshold:l-t});else{const t=Math.min($,d),n=Q(s,o,l,d,t);isFinite(n)&&!isNaN(n)?(A.current.position.y=n,A.current instanceof Pr&&(A.current.visible=!0),console.log("💧 Water mesh initialized in 3d_mountains with position:",{planeName:e.name||"unnamed",initialY:n,waterLevel:$,clampedWaterLevel:t,modelRange:{min:o,max:s},reservoirRange:{min:l,max:d}})):(console.warn("⚠️ Invalid initial Y position in 3d_mountains, will be set by useEffect"),A.current instanceof Pr&&(A.current.visible=!1))}}else console.warn("⚠️ No valid reservoir data for initial water position in 3d_mountains, will be set by useEffect"),A.current instanceof Pr&&(A.current.visible=!1)}else console.log("⚠️ Plane not found in 3d_mountains model. Water visualization may not work.")}l.lookAt(d),e.add(i),o.add(e),R(!0),v(),URL.revokeObjectURL(r),q("ready"),K("")}m.current=u,window.addEventListener("resize",u),L&&function(){qF(this,void 0,void 0,(function*(){const e=encodeURIComponent(L);M.current&&M.current.cancel("Operation canceled due to new request."),M.current=jh.CancelToken.source();try{const n="two"===t?"type2":"three"===t?"type3":"four"===t?"type4":"type2",i=`glb_${L}_${n}`,a=yield(e=>qF(void 0,void 0,void 0,(function*(){try{const t=yield KF();return new Promise(((n,r)=>{const i=t.transaction([YF],"readonly").objectStore(YF).get(e);i.onsuccess=()=>{const e=i.result;e&&e.data?n(e.data):n(null)},i.onerror=()=>r(i.error)}))}catch(e){return console.warn("Failed to read from cache:",e),null}})))(i);if(a){console.log("✅ Found cached GLB file, loading from cache");const t=URL.createObjectURL(a),n=new pc;return r(),n.load(t,(function(e){g(e,t)}),void 0,(e=>{console.error("An error happened:",e),q("error"),K(e instanceof Error?e.message:IF("failedToLoadModel",Z))})),void jh.get(`https://api-dam3d.spacemc.uz/core/3d-models/by-dam/${e}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},cancelToken:M.current.token}).then((e=>{let t=e.data;Array.isArray(t)&&t.length>0&&(t=t[0]);const n=(null==t?void 0:t.model_data)||[];if(Array.isArray(n)&&n.length>0){const e=n.filter((e=>Array.isArray(e)&&e.length>=3&&!Number.isNaN(Number(e[0])))).map((e=>Number(e[0])));if(e.length>0){const t={min:Math.min(...e),max:Math.max(...e)};G(t),W.current=t,console.log("💧 Water level range extracted:",t)}}})).catch((e=>{console.warn("Failed to fetch metadata for water level range:",e)}))}console.log("📡 Cache miss, fetching from API...");const o=yield jh.get(`https://api-dam3d.spacemc.uz/core/3d-models/by-dam/${e}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},cancelToken:M.current.token});let s=o.data;Array.isArray(s)&&s.length>0&&(s=s[0]),console.log("🔍 ReservoirScene API Response:",o.data),console.log("🔍 Parsed response data:",s),console.log("🔍 Available fields:",Object.keys(s||{}));const l=(null==s?void 0:s.model_data)||[];if(Array.isArray(l)&&l.length>0){const e=l.filter((e=>Array.isArray(e)&&e.length>=3&&!Number.isNaN(Number(e[0])))).map((e=>Number(e[0])));if(e.length>0){const t={min:Math.min(...e),max:Math.max(...e)};G(t),W.current=t,console.log("💧 Water level range extracted:",t)}}const c="two"===t?null==s?void 0:s.model_file_type_2:"three"===t?null==s?void 0:s.model_file_type_3:"four"===t?null==s?void 0:s.model_file_type_4:null==s?void 0:s.model_file_type_2;if(console.log("🔍 ReservoirScene Model File URL:",c),!c)return console.log("❌ ReservoirScene: No model file URL found in response"),console.log("❌ Response data:",o.data),q("noData"),void K("");const u=c.replace(/^http:/,"https:");console.log("🔒 Secure Model File URL:",u);const d=yield jh.get(u,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},cancelToken:M.current.token});console.log(`🗑️ Deleting previous ${n} cache entries...`),yield(e=>qF(void 0,void 0,void 0,(function*(){try{const t=yield KF();return new Promise(((n,r)=>{const i=t.transaction([YF],"readwrite").objectStore(YF),a=i.openCursor(),o=[];a.onsuccess=t=>{const r=t.target.result;if(r){const t=r.key;t&&"string"==typeof t&&t.endsWith(`_${e}`)&&o.push(t),r.continue()}else{if(0===o.length)return void n();let e=0;o.forEach((t=>{const r=i.delete(t);r.onsuccess=()=>{e++,e===o.length&&n()},r.onerror=()=>{e++,e===o.length&&n()}}))}},a.onerror=()=>r(a.error)}))}catch(e){console.warn("Failed to delete cache entries by type:",e)}})))(n),console.log("💾 Saving GLB file to cache..."),yield((e,t)=>qF(void 0,void 0,void 0,(function*(){try{const n=yield KF();return new Promise(((r,i)=>{const a=n.transaction([YF],"readwrite").objectStore(YF).put({key:e,data:t,timestamp:Date.now()});a.onsuccess=()=>r(),a.onerror=()=>i(a.error)}))}catch(e){console.warn("Failed to write to cache:",e)}})))(i,d.data),console.log("✅ GLB file cached successfully");const h=URL.createObjectURL(d.data),p=new pc;r(),p.load(h,(function(e){g(e,h)}),void 0,(e=>{console.error("An error happened:",e),q("error"),K(e instanceof Error?e.message:IF("failedToLoadModel",Z))}))}catch(e){jh.isCancel(e)?console.log("Request canceled:",e.message):(console.error("Error fetching 3D model:",e),jh.isAxiosError(e)&&e.response&&404===e.response.status?(q("noData"),K("")):e instanceof Error?(q("error"),K(e.message)):(q("error"),K(IF("failedToLoad3DModel",Z))))}}))}();const v=function(){requestAnimationFrame(v),c.update(),n.render(o,l),window.removeEventListener("load",r),window.removeEventListener("resize",u),S.current&&(o.rotation.y+=.002),T.current&&"3d_mountains"===O&&(T.current.offset.y+=3e-4)};return window.addEventListener("load",r),()=>{var t,r;M.current&&M.current.cancel("Operation canceled by the user."),n.dispose(),c.dispose(),o.remove(e),o.clear(),(null===(t=h.current)||void 0===t?void 0:t.domElement)&&(null===(r=d.current)||void 0===r?void 0:r.contains(h.current.domElement))&&d.current.removeChild(h.current.domElement)}}),[L,O]),(0,r.useEffect)((()=>{if(A.current&&P&&N>0&&void 0!==U){const e=U,t=N;let n,r,i;if(!(B&&z.res_max_height>z.res_min_height&&z.res_min_height>0))return void console.error("❌ Cannot calculate water position: no valid reservoir data",{reservoirName:O,damDataReady:B,damData:z});r=z.res_min_height,i=z.res_max_height,console.log("💧 Using dam data from by-name API for reservoir range:",{resMinHeight:r,resMaxHeight:i,damData:z});const a=.2;if($<r-a)return A.current instanceof Pr&&(A.current.visible=!1),void console.log("💧 Water level below minimum, hiding water:",{waterLevel:$,resMinHeight:r,threshold:r-a});const o=Math.min($,i);$>i&&console.warn("⚠️ Water level exceeds maximum, clamping:",{waterLevel:$,resMaxHeight:i,clampedWaterLevel:o}),n=Q(t,e,r,i,o),console.log("💧 Water position calculated:",{waterLevel:$,modelY:n,modelRange:{min:e,max:t},reservoirRange:{min:r,max:i},normalizedLevel:($-r)/(i-r)}),isFinite(n)&&!isNaN(n)?(A.current.position.y=n,A.current instanceof Pr&&(A.current.visible=!0)):console.error("❌ Invalid calculated Y position:",{newY:n,waterLevel:$,effectiveModelMin:e,effectiveModelMax:t,resMinHeight:r,resMaxHeight:i})}}),[$,P,N,U,z,B,V,O]),r.default.createElement("div",{ref:d,className:`reservoir-scene-container ${g?"fullscreen":"normal"} ${i?"dark":""}`},!l&&(()=>{switch(X){case"selectDam":return r.default.createElement("div",{className:"error-message"},r.default.createElement("div",{className:"error-content"},r.default.createElement("div",{className:"error-icon-wrapper"},r.default.createElement("svg",{className:"error-icon-svg",width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("defs",null,r.default.createElement("linearGradient",{id:"warningTriangleGradient",x1:"0%",y1:"0%",x2:"50%",y2:"100%"},r.default.createElement("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0.15"}),r.default.createElement("stop",{offset:"100%",stopColor:"currentColor",stopOpacity:"0.08"}))),r.default.createElement("path",{d:"M12 2L22 20H2L12 2Z",fill:"url(#warningTriangleGradient)",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.3"}),r.default.createElement("path",{d:"M12 2L22 20H2L12 2Z",fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.5"}),r.default.createElement("circle",{cx:"12",cy:"9",r:"1.5",fill:"currentColor",opacity:"0.8"}),r.default.createElement("path",{d:"M12 12v3",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.8"}))),r.default.createElement("div",{className:"error-title"},IF("selectDam",Z)),r.default.createElement("div",{className:"error-description"},"uz"===Z?"3D modelni ko'rish uchun suv omborini tanlang":"uzcryl"===Z?"3D моделни кўриш учун сув омборини танланг":"Пожалуйста, выберите водохранилище для просмотра 3D модели")));case"noData":return r.default.createElement("div",{className:"error-message"},r.default.createElement("div",{className:"error-content"},r.default.createElement("div",{className:"error-icon-wrapper"},r.default.createElement("svg",{className:"error-icon-svg",width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("defs",null,r.default.createElement("linearGradient",{id:"warningTriangleGradient2",x1:"0%",y1:"0%",x2:"50%",y2:"100%"},r.default.createElement("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0.15"}),r.default.createElement("stop",{offset:"100%",stopColor:"currentColor",stopOpacity:"0.08"}))),r.default.createElement("path",{d:"M12 2L22 20H2L12 2Z",fill:"url(#warningTriangleGradient2)",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.3"}),r.default.createElement("path",{d:"M12 2L22 20H2L12 2Z",fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.5"}),r.default.createElement("circle",{cx:"12",cy:"9",r:"1.5",fill:"currentColor",opacity:"0.8"}),r.default.createElement("path",{d:"M12 12v3",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.8"}))),r.default.createElement("div",{className:"error-title"},IF("noDataForDam",Z)),r.default.createElement("div",{className:"error-description"},"uz"===Z?"Ushbu suv ombori uchun 3D model mavjud emas":"uzcryl"===Z?"Ушбу сув омбори учун 3D модель мавжуд эмас":"Для этого водохранилища 3D модель недоступна")));case"error":return r.default.createElement("div",{className:"error-message"},r.default.createElement("div",{className:"error-content"},r.default.createElement("div",{className:"error-icon-wrapper"},r.default.createElement("svg",{className:"error-icon-svg",width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("defs",null,r.default.createElement("linearGradient",{id:"errorTriangleGradient",x1:"0%",y1:"0%",x2:"50%",y2:"100%"},r.default.createElement("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0.15"}),r.default.createElement("stop",{offset:"100%",stopColor:"currentColor",stopOpacity:"0.08"}))),r.default.createElement("path",{d:"M12 2L22 20H2L12 2Z",fill:"url(#errorTriangleGradient)",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.3"}),r.default.createElement("path",{d:"M12 2L22 20H2L12 2Z",fill:"none",stroke:"currentColor",strokeWidth:"2",opacity:"0.5"}),r.default.createElement("circle",{cx:"12",cy:"9",r:"1.5",fill:"currentColor",opacity:"0.8"}),r.default.createElement("path",{d:"M12 12v3",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.8"}))),r.default.createElement("div",{className:"error-title"},IF("unableToLoadDamData",Z)),Y&&r.default.createElement("div",{className:"error-description"},Y)));case"loading":case"idle":return r.default.createElement("div",{role:"status",className:"loading-container"},r.default.createElement("div",{className:"loading-spinner-modern"},r.default.createElement("div",{className:"spinner-ring"}),r.default.createElement("div",{className:"spinner-ring"}),r.default.createElement("div",{className:"spinner-ring"})));default:return null}})(),"ready"===X&&P&&!s&&!o&&r.default.createElement("button",{onClick:()=>w((e=>!e)),className:"rotation-button"},r.default.createElement("div",{className:"button-icon-container"},_?r.default.createElement("div",{className:"pause-icon"},r.default.createElement("div",{className:"pause-line"}),r.default.createElement("div",{className:"pause-line"})):r.default.createElement("div",{className:"play-icon"}))))};var JF=s(4331),QF={};QF.styleTagTransform=SF(),QF.setAttributes=xF(),QF.insert=vF().bind(null,"head"),QF.domAPI=mF(),QF.insertStyleElement=_F(),pF()(JF.Z,QF),JF.Z&&JF.Z.locals&&JF.Z.locals;var ez=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const tz="glb_files",nz=()=>new Promise(((e,t)=>{const n=indexedDB.open("glb_cache_db",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(tz)||t.createObjectStore(tz,{keyPath:"key"})}})),rz={minLevel:0,maxLevel:0,currentLevel:0,volume:0,area:0},iz=function({modelName:e,damType:t="two",isDark:n=!1,onStatusChange:i}){const{updateWaterLevel:a}=HF(),o=PF(),s=((null==e?void 0:e.trim())||o||"").trim(),[l,c]=(0,r.useState)((()=>Object.assign({},rz))),[u,d]=(0,r.useState)([]),[h,p]=(0,r.useState)("idle"),[f,m]=(0,r.useState)(""),[g,v]=(0,r.useState)((()=>"undefined"==typeof window?"ru":localStorage.getItem("custom_locale")||"ru"));(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("custom_locale")||"ru";v(e)};e(),window.addEventListener("storage",e);const t=setInterval(e,250);return()=>{window.removeEventListener("storage",e),clearInterval(t)}}),[]),(0,r.useEffect)((()=>{i&&i(h,f)}),[h,f,i]),(0,r.useEffect)((()=>{if("two"!==t)return;const e=new AbortController;return(()=>{ez(this,void 0,void 0,(function*(){if(d([]),c(Object.assign({},rz)),!s)return p("selectDam"),void m("");p("loading"),m("");try{const t=`water_data_${s}_type2`,n=yield(e=>ez(void 0,void 0,void 0,(function*(){try{const t=yield nz();return new Promise(((n,r)=>{const i=t.transaction([tz],"readonly").objectStore(tz).get(e);i.onsuccess=()=>{const e=i.result;if(e&&e.data)try{const t="string"==typeof e.data?JSON.parse(e.data):e.data;n(t)}catch(e){n(null)}else n(null)},i.onerror=()=>r(i.error)}))}catch(e){return console.warn("Failed to read water data from cache:",e),null}})))(t);if(n&&Array.isArray(n)&&n.length>0)return console.log("✅ Found cached water level data, loading from cache"),d(n),a(n[0].height),c({minLevel:n[0].height,maxLevel:n[n.length-1].height,currentLevel:n[0].height,volume:n[0].volume,area:n[0].square}),p("ready"),void m("");console.log("📡 Cache miss, fetching water level data from API...");const r=encodeURIComponent(s),i=yield fetch(`https://api-dam3d.spacemc.uz/core/3d-models/by-dam/${r}/?dam=&dam__name=${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},signal:e.signal});if(!i.ok){if(404===i.status)return p("noData"),void m("");throw new Error(`Request failed with status ${i.status}`)}const o=yield i.json();let l=o;Array.isArray(o)&&o.length>0&&(l=o[0]),console.log("🔍 WaterLevelSlider API Response:",o),console.log("🔍 Parsed response data:",l),console.log("🔍 Available fields:",Object.keys(l||{}));const u=(null==l?void 0:l.model_data)||[];console.log("🔍 Raw model data:",u);const h=Array.isArray(u)?u.filter((e=>Array.isArray(e)&&e.length>=3&&!Number.isNaN(Number(e[0])))).map((e=>({height:Number(e[0]),square:Number(e[1])/1e6,volume:Number(e[2])}))):[];if(console.log("🔍 Processed data:",h),0===h.length)return p("noData"),void m("");console.log("💾 Saving water level data to cache..."),yield((e,t)=>ez(void 0,void 0,void 0,(function*(){try{const n=yield nz();return new Promise(((r,i)=>{const a=n.transaction([tz],"readwrite").objectStore(tz).put({key:e,data:JSON.stringify(t),timestamp:Date.now()});a.onsuccess=()=>r(),a.onerror=()=>i(a.error)}))}catch(e){console.warn("Failed to write water data to cache:",e)}})))(t,h),console.log("✅ Water level data cached successfully"),d(h),a(h[0].height),c({minLevel:h[0].height,maxLevel:h[h.length-1].height,currentLevel:h[0].height,volume:h[0].volume,area:h[0].square}),p("ready"),m("")}catch(t){if(e.signal.aborted||"AbortError"===(null==t?void 0:t.name))return;console.error(`Error fetching height and depth data for ${s}:`,t),404===(null==t?void 0:t.status)?(p("noData"),m("")):(p("error"),m(t instanceof Error?t.message:IF("failedToLoadData",g)))}}))})(),()=>{e.abort()}}),[t,s,a]);const y=l.maxLevel-l.minLevel,x=y>0?(l.currentLevel-l.minLevel)/y*100:0;return r.default.createElement("div",{className:"water-level-slider-container "+(n?"dark-theme":"")},"two"!==t?r.default.createElement("div",{className:"water-level-not-available"},r.default.createElement("div",{className:"water-level-not-available-title"},IF("waterDataNotAvailable",g)),r.default.createElement("div",{className:"water-level-not-available-text"},IF("selectTypeTwoForWaterData",g))):r.default.createElement(r.default.Fragment,null,"ready"===h&&r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"water-level-slider-cards"},r.default.createElement("div",{className:"data-card"},r.default.createElement("div",{className:"data-label"},IF("waterLevel",g)),r.default.createElement("div",{className:"data-value"},l.currentLevel," м")),r.default.createElement("div",{className:"data-card"},r.default.createElement("div",{className:"data-label"},IF("volume",g)," (W):"),r.default.createElement("div",{className:"data-value"},Number(l.volume.toFixed(3)).toLocaleString()," м³")),r.default.createElement("div",{className:"data-card"},r.default.createElement("div",{className:"data-label"},IF("area",g)," (F):"),r.default.createElement("div",{className:"data-value"},Number(l.area.toFixed(3)).toLocaleString()," км²"))),r.default.createElement("div",{className:"water-level-slider-section"},r.default.createElement("div",{className:"water-level-slider-input-wrapper"},r.default.createElement("input",{type:"range",id:"water-level",className:"slider water-level-input",style:{background:`linear-gradient(to right, #6699FF 0%, #6699FF ${x}%, #E0E0E0 ${x}%, #E0E0E0 100%)`},step:"0.01",min:l.minLevel,max:l.maxLevel,value:l.currentLevel,onChange:e=>{if(!u.length)return;const t=parseFloat(e.target.value),n=((e,t)=>{if(!e.length)return null;let n=e[0],r=Math.abs(e[0].height-t);for(let i=1;i<e.length;i++){let a=Math.abs(e[i].height-t);a<r&&(r=a,n=e[i])}return n})(u,t);n&&(a(n.height),c((e=>Object.assign(Object.assign({},e),{currentLevel:n.height,volume:n.volume,area:n.square}))))}})),r.default.createElement("div",{className:"water-level-slider-labels"},r.default.createElement("span",null,l.minLevel," м"),r.default.createElement("span",null,l.maxLevel," м")))),"ready"!==h&&!i&&r.default.createElement("div",{className:"water-level-status"},r.default.createElement("div",{className:"loading-spinner-modern"},r.default.createElement("div",{className:"spinner-ring"}),r.default.createElement("div",{className:"spinner-ring"}),r.default.createElement("div",{className:"spinner-ring"}))),"ready"!==h&&i&&r.default.createElement("div",{className:"sr-only"},f||h)))},az=e=>{const t=PF(),[i,a]=(0,r.useState)("idle"),[o,s]=(0,r.useState)("idle"),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!0),[h,p]=(0,r.useState)((()=>"undefined"==typeof window?"ru":localStorage.getItem("custom_locale")||"ru"));(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("custom_locale")||"ru";p(e)};e(),window.addEventListener("storage",e);const t=setInterval(e,250);return()=>{window.removeEventListener("storage",e),clearInterval(t)}}),[]);const f=(0,r.useMemo)((()=>{const e=["idle","loading"];return e.includes(i)||e.includes(o)}),[i,o]),m=(0,r.useMemo)((()=>"selectDam"===i?IF("selectDam",h):"noData"===i?IF("noDataForDam",h):"error"===i?IF("unableToLoadDamData",h):null),[i,h]);return(0,n.jsx)(BF,null,(0,n.jsx)("div",{className:"type2-component "+(e.isDark?"dark":""),css:{display:"flex",height:"100%",gap:"16px",width:"100%",position:"relative"}},f&&(0,n.jsx)("div",null,(0,n.jsx)("div",{css:{position:"absolute",top:0,left:0,right:0,bottom:0,backdropFilter:"blur(8px)",backgroundColor:e.isDark?"rgba(16, 17, 27, 0.5)":"rgba(255, 255, 255, 0.5)",zIndex:999,pointerEvents:"none"}}),(0,n.jsx)("div",{className:"loading",css:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"none"}},(0,n.jsx)("div",{className:"loading-spinner-modern"},(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"})))),m&&(0,n.jsx)("div",{className:"error-message",css:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"auto"}},(0,n.jsx)("div",{className:"error-content"},(0,n.jsx)("div",{className:"error-icon-wrapper"},(0,n.jsx)("svg",{className:"error-icon-svg",width:"80",height:"80",viewBox:"0 0 46 42",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M28.1746 3.16754C27.6273 2.20563 26.8349 1.40582 25.8782 0.849456C24.9215 0.293087 23.8345 0 22.7278 0C21.621 0 20.5341 0.293087 19.5773 0.849456C18.6206 1.40582 17.8283 2.20563 17.281 3.16754L0.785217 32.5569C0.261401 33.4791 -0.00939594 34.5235 0.000248916 35.5841C0.00989377 36.6447 0.299638 37.6839 0.840139 38.5965C1.38858 39.538 2.17614 40.3178 3.12302 40.857C4.0699 41.3961 5.14246 41.6753 6.23203 41.6665H39.2235C40.3131 41.6753 41.3857 41.3961 42.3325 40.857C43.2794 40.3178 44.067 39.538 44.6154 38.5965C45.1559 37.6839 45.4457 36.6447 45.4553 35.5841C45.465 34.5235 45.1942 33.4791 44.6703 32.5569L28.1746 3.16754ZM41.3466 36.6893C41.1285 37.0567 40.8174 37.3601 40.4447 37.5689C40.0719 37.7777 39.6507 37.8846 39.2235 37.8787H6.23203C5.80428 37.884 5.3827 37.7763 5.00992 37.5665C4.63713 37.3566 4.32635 37.0521 4.10899 36.6836C3.90296 36.3412 3.79237 35.9498 3.7887 35.5502C3.78504 35.1505 3.88844 34.7572 4.08815 34.411L20.5839 5.01976C20.8176 4.6646 21.1358 4.37305 21.51 4.17131C21.8842 3.96957 22.3027 3.86395 22.7278 3.86395C23.1529 3.86395 23.5714 3.96957 23.9456 4.17131C24.3198 4.37305 24.638 4.6646 24.8717 5.01976L41.3674 34.4091C41.5675 34.7555 41.6711 35.1492 41.6674 35.5492C41.6638 35.9492 41.553 36.341 41.3466 36.6836V36.6893Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 11.3643C22.2255 11.3643 21.7438 11.5638 21.3886 11.919C21.0334 12.2742 20.8339 12.7559 20.8339 13.2582V24.6215C20.8339 25.1238 21.0334 25.6055 21.3886 25.9607C21.7438 26.3158 22.2255 26.5154 22.7278 26.5154C23.2301 26.5154 23.7118 26.3158 24.067 25.9607C24.4221 25.6055 24.6217 25.1238 24.6217 24.6215V13.2582C24.6217 12.7559 24.4221 12.2742 24.067 11.919C23.7118 11.5638 23.2301 11.3643 22.7278 11.3643Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 34.0909C23.7737 34.0909 24.6217 33.243 24.6217 32.197C24.6217 31.1511 23.7737 30.3031 22.7278 30.3031C21.6818 30.3031 20.8339 31.1511 20.8339 32.197C20.8339 33.243 21.6818 34.0909 22.7278 34.0909Z",fill:"#F0C039"}))),(0,n.jsx)("div",{className:"error-title"},m),m===IF("selectDam",h)&&(0,n.jsx)("div",{className:"error-description"},"uz"===h?"3D modelni ko'rish uchun suv omborini tanlang":"uzcryl"===h?"3D моделни кўриш учун сув омборини танланг":"Пожалуйста, выберите водохранилище для просмотра 3D модели"),m===IF("noDataForDam",h)&&(0,n.jsx)("div",{className:"error-description"},"uz"===h?"Ushbu suv ombori uchun 3D model mavjud emas":"uzcryl"===h?"Ушбу сув омбори учун 3D модель мавжуд эмас":"Для этого водохранилища 3D модель недоступна"),m!==IF("selectDam",h)&&m!==IF("noDataForDam",h)&&(0,n.jsx)("div",{className:"error-description"},IF("errorLoadingModel",h)))),(0,n.jsx)("div",{className:"drawing-tools type2-spin-tools"},(0,n.jsx)("div",{className:`icon-button ${l?"active spinning":""} ${f||!t||m?"disabled":""}`,onClick:f||!t||m?void 0:()=>{c((e=>!e))},title:f||!t||m?f?"Loading...":IF("selectDam",h):IF(l?"stopRotating":"startRotating",h)},l?(0,n.jsx)("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M9 15H7L7 7H9V15Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M15 15H13V7H15V15Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 0C4.92487 0 0 4.92487 0 11C0 17.0751 4.92487 22 11 22C17.0751 22 22 17.0751 22 11C22 4.92487 17.0751 0 11 0ZM2 11C2 6.02944 6.02944 2 11 2C15.9706 2 20 6.02944 20 11C20 15.9706 15.9706 20 11 20C6.02944 20 2 15.9706 2 11Z",fill:"currentColor"})):(0,n.jsx)("svg",{width:"21",height:"21",viewBox:"0 0 21 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.75848 5.65396C8.47719 5.46643 8.11553 5.44895 7.81746 5.60847C7.5194 5.76798 7.33333 6.07861 7.33333 6.41667V13.75C7.33333 14.0881 7.5194 14.3987 7.81746 14.5582C8.11553 14.7177 8.47719 14.7002 8.75848 14.5127L14.2585 10.846C14.5135 10.676 14.6667 10.3898 14.6667 10.0833C14.6667 9.77684 14.5135 9.49063 14.2585 9.32062L8.75848 5.65396ZM12.0975 10.0833L9.16667 12.0372V8.12948L12.0975 10.0833Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0833 0C4.51446 0 0 4.51446 0 10.0833C0 15.6522 4.51446 20.1667 10.0833 20.1667C15.6522 20.1667 20.1667 15.6522 20.1667 10.0833C20.1667 4.51446 15.6522 0 10.0833 0ZM1.83333 10.0833C1.83333 5.52698 5.52698 1.83333 10.0833 1.83333C14.6397 1.83333 18.3333 5.52698 18.3333 10.0833C18.3333 14.6397 14.6397 18.3333 10.0833 18.3333C5.52698 18.3333 1.83333 14.6397 1.83333 10.0833Z",fill:"currentColor"})))),(0,n.jsx)("div",{className:"scene-container "+(e.isDark?"dark":""),css:{flex:"3",minHeight:"400px",position:"relative",width:"100%",height:"100%",overflow:"hidden"}},(0,n.jsx)(ZF,{modelName:t,damType:"two",showOnlyRelief:!0,isDark:e.isDark,onStatusChange:a,rotationControl:{isRotating:l,setIsRotating:c},hideRotationButton:!0,hideStatusMessages:!0})),(0,n.jsx)("div",{className:"slider-container",css:{flex:"1",minWidth:"200px",display:"flex",flexDirection:"column"}},(0,n.jsx)(iz,{modelName:t,damType:"two",isDark:e.isDark,onStatusChange:s}))))};var oz=s(8418),sz={};sz.styleTagTransform=SF(),sz.setAttributes=xF(),sz.insert=vF().bind(null,"head"),sz.domAPI=mF(),sz.insertStyleElement=_F(),pF()(oz.Z,sz),oz.Z&&oz.Z.locals&&oz.Z.locals;var lz=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const cz=({lineData:e,isVisible:t,onClose:i,isDark:a=!1})=>{var o,l,c,u,d,h,p;const f=(0,r.useRef)(null),m=(0,r.useRef)(null),[g,v]=(0,r.useState)(null!==(o=null==e?void 0:e.profileData)&&void 0!==o?o:null),[y,x]=(0,r.useState)(!1),[b,_]=(0,r.useState)(null),w=e=>{if(!e)return null;if(Array.isArray(e)&&e.length>=2)return[Number(e[0]),Number(e[1])];if("object"==typeof e){if("number"==typeof e.lon&&"number"==typeof e.lat)return[e.lon,e.lat];if("number"==typeof e.longitude&&"number"==typeof e.latitude)return[e.longitude,e.latitude];if("number"==typeof e.x&&"number"==typeof e.y)return[e.x,e.y]}return null};(0,r.useEffect)((()=>{var t;v(null!==(t=null==e?void 0:e.profileData)&&void 0!==t?t:null)}),[e]),(0,r.useEffect)((()=>{if(!t)return;const n=null==e?void 0:e.points;if(!n||n.length<2)return;const r=w(n[0]),i=w(n[n.length-1]);if(!r||!i)return void _("Недостаточно координат для построения профиля.");const a=new AbortController;return lz(void 0,void 0,void 0,(function*(){var t,n;try{x(!0),_(null);const o=yield fetch("https://api-dam3d.spacemc.uz/profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({a:r,b:i,sampling_interval:null!==(t=null==e?void 0:e.samplingInterval)&&void 0!==t?t:1,file_path:null!==(n=null==e?void 0:e.filePath)&&void 0!==n?n:"https://sismology.academytable.ru/django_movie/media/dam_3d_models/1.tif"}),signal:a.signal}),s=yield o.text();let l=null;if(s)try{l=JSON.parse(s)}catch(e){l=null}if(!o.ok){const e=(null==l?void 0:l.error)||(null==l?void 0:l.message)||s||`API error: ${o.status}`;throw new Error(e)}v(l)}catch(e){if(a.signal.aborted)return;_(e instanceof Error?e.message:"Не удалось загрузить профиль."),v(null)}finally{a.signal.aborted||x(!1)}})),()=>{a.abort()}}),[t,null==e?void 0:e.id,null==e?void 0:e.points]);const S=[{distance:0,elevation:795.5,coordinates:[70.0701388888889,41.61180555555552]},{distance:20,elevation:797.5,coordinates:[70.0701388888889,41.612083333333295]},{distance:40,elevation:797.5,coordinates:[70.07041666666667,41.61236111111108]},{distance:60,elevation:799,coordinates:[70.07041666666667,41.61263888888885]},{distance:80,elevation:796,coordinates:[70.07069444444446,41.61291666666663]},{distance:100,elevation:796.5,coordinates:[70.07069444444446,41.61319444444441]},{distance:120,elevation:798,coordinates:[70.07097222222224,41.613472222222185]},{distance:140,elevation:799,coordinates:[70.07097222222224,41.61374999999997]},{distance:160,elevation:801,coordinates:[70.07125,41.61402777777774]},{distance:180,elevation:800,coordinates:[70.07125,41.61430555555552]}],M=(e,t)=>{if(!e.length)return t;const n=Math.min(...e),r=Math.max(...e);return n===r?[n,n+1]:[n,r]},E=(e,t=6)=>{const[n,r]=e;if(r<=n)return[Number(n.toFixed(2))];const i=(r-n)/t;return Array.from({length:t+1},((e,t)=>Number((n+i*t).toFixed(2))))},T=Array.isArray(null==g?void 0:g.profile)&&g.profile.length>0,A=T&&null!==(l=null==g?void 0:g.profile)&&void 0!==l?l:[],C=T&&null!==(c=null==g?void 0:g.metadata)&&void 0!==c?c:null,P=A.map((e=>({distance:e.distance,elevation:e.elevation}))),R=M(P.map((e=>e.distance)),[0,1]),O=M(P.map((e=>e.elevation)),[0,1]),D=E(R),I=E(O),L=C?{totalDistance:null!==(u=null==C?void 0:C.totalDistance)&&void 0!==u?u:null==C?void 0:C.total_distance,samplingInterval:null!==(d=null==C?void 0:C.samplingInterval)&&void 0!==d?d:null==C?void 0:C.sampling_interval,minElevation:null!==(h=null==C?void 0:C.minElevation)&&void 0!==h?h:null==C?void 0:C.min_elevation,maxElevation:null!==(p=null==C?void 0:C.maxElevation)&&void 0!==p?p:null==C?void 0:C.max_elevation}:null,N=y&&!T,k=!y&&!T&&!b,U={position:"absolute",top:16,right:16,backgroundColor:a?"rgba(45, 45, 45, 0.92)":"rgba(255, 255, 255, 0.95)",color:a?"#e0e0e0":"#333333",padding:"8px 12px",borderRadius:"6px",boxShadow:a?"0 2px 8px rgba(0,0,0,0.4)":"0 2px 8px rgba(0,0,0,0.1)",zIndex:2};if(!t)return null;const F=a?"#404040":"#e0e0e0",z=a?"#a0a0a0":"#666",j=a?"#2d2d2d":"white",B=a?"#555":"#ccc",H=a?"#e0e0e0":"#333";return(0,n.jsx)("div",{className:"line-chart-modal-overlay "+(a?"dark-theme":"")},(0,n.jsx)("div",{className:"line-chart-modal "+(a?"dark-theme":""),ref:f},(0,n.jsx)("div",{className:"line-chart-header"},(0,n.jsx)("button",{className:"download-button",onClick:()=>lz(void 0,void 0,void 0,(function*(){try{const e=(yield s.e("vendors-node_modules_html2canvas_dist_html2canvas_esm_js").then(s.bind(s,1407))).default,t=(yield s.e("vendors-node_modules_jspdf_dist_jspdf_es_min_js").then(s.bind(s,2524))).default;yield new Promise((e=>setTimeout(e,500)));const n=m.current;if(!n)throw new Error("Chart element not found");const r=(yield e(n,{background:"#ffffff",useCORS:!0,allowTaint:!0,logging:!1,width:888,height:534})).toDataURL("image/png",1),i=new t({orientation:"landscape",unit:"mm",format:"a4"}),a=i.internal.pageSize.getWidth(),o=i.internal.pageSize.getHeight(),l=10,c=a-2*l,u=534*c/888,d=l,h=(o-u)/2;i.addImage(r,"PNG",d,h,c,u),i.save("elevation_profile_chart.pdf")}catch(e){(()=>{const e="data:text/csv;charset=utf-8,Distance (m),Elevation (m),Longitude,Latitude\n"+(T?A:S).map((e=>{var t,n,r,i;return`${e.distance},${e.elevation},${null!==(n=null===(t=e.coordinates)||void 0===t?void 0:t[0])&&void 0!==n?n:""},${null!==(i=null===(r=e.coordinates)||void 0===r?void 0:r[1])&&void 0!==i?i:""}`})).join("\n"),t=encodeURI(e),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download","elevation_profile.csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})()}}))},(0,n.jsx)("span",{className:"download-icon"},"📥"),"Скачать"),(0,n.jsx)("button",{className:"close-button",onClick:i},"✕")),(0,n.jsx)("div",{className:"line-chart-content",ref:m,style:{position:"relative"}},L&&L.totalDistance&&T&&(0,n.jsx)("div",{className:"profile-metadata"},(0,n.jsx)("span",null,"Длина: ",L.totalDistance," м"),L.samplingInterval&&(0,n.jsx)("span",null,"• Шаг: ",L.samplingInterval," м"),L.minElevation&&L.maxElevation&&(0,n.jsx)("span",null,"• Высоты: ",L.minElevation,"–",L.maxElevation," м")),b&&(0,n.jsx)("div",{style:Object.assign(Object.assign({},U),{border:"1px solid #d93025"})},b),(0,n.jsx)("div",{style:{flex:1,minHeight:0,position:"relative"}},N&&(0,n.jsx)("div",{className:"line-chart-loading "+(a?"dark":"")},(0,n.jsx)("div",{className:"line-chart-loader-orbit"},(0,n.jsx)("span",null),(0,n.jsx)("span",null),(0,n.jsx)("span",null))),k&&(0,n.jsx)("div",{className:"line-chart-empty-state "+(a?"dark":"")},(0,n.jsx)("p",null,"Постройте линию измерения, чтобы увидеть профиль высот.")),T&&(0,n.jsx)(Pp,{width:"100%",height:"100%"},(0,n.jsx)(GO,{data:P,margin:{top:20,right:30,left:20,bottom:20}},(0,n.jsx)(NI,{strokeDasharray:"3 3",stroke:F}),(0,n.jsx)(QI,{dataKey:"distance",type:"number",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:z},domain:R,ticks:D,tickFormatter:e=>`${e} m`}),(0,n.jsx)(hL,{axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:z},domain:O,ticks:I,tickFormatter:e=>`${e} m`}),(0,n.jsx)(qk,{contentStyle:{backgroundColor:j,border:`1px solid ${B}`,borderRadius:"4px",boxShadow:a?"0 2px 8px rgba(0,0,0,0.4)":"0 2px 8px rgba(0,0,0,0.1)",color:H},formatter:(e,t)=>[`${e} m`,"elevation"===t?"Elevation":"Distance"],labelFormatter:e=>`Distance: ${e} m`}),(0,n.jsx)(dF,{type:"monotone",dataKey:"elevation",stroke:"#0078d4",strokeWidth:2,fill:"url(#colorGradient)",fillOpacity:.3}),(0,n.jsx)("defs",null,(0,n.jsx)("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1"},(0,n.jsx)("stop",{offset:"5%",stopColor:"#0078d4",stopOpacity:.8}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#0078d4",stopOpacity:.1})))))))))};var uz=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const dz="glb_files",hz=()=>new Promise(((e,t)=>{const n=indexedDB.open("glb_cache_db",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(dz)||t.createObjectStore(dz,{keyPath:"key"})}})),pz=e=>uz(void 0,void 0,void 0,(function*(){try{const t=yield hz();return new Promise(((n,r)=>{const i=t.transaction([dz],"readonly").objectStore(dz).get(e);i.onsuccess=()=>{const e=i.result;e&&e.data?n(e.data):n(null)},i.onerror=()=>r(i.error)}))}catch(e){return console.warn("Failed to read from cache:",e),null}})),fz=(e,t)=>uz(void 0,void 0,void 0,(function*(){try{const n=yield hz();return new Promise(((r,i)=>{const a=n.transaction([dz],"readwrite").objectStore(dz).put({key:e,data:t,timestamp:Date.now()});a.onsuccess=()=>r(),a.onerror=()=>i(a.error)}))}catch(e){console.warn("Failed to write to cache:",e)}})),mz=e=>uz(void 0,void 0,void 0,(function*(){try{const t=yield hz();return new Promise(((n,r)=>{const i=t.transaction([dz],"readwrite").objectStore(dz),a=i.openCursor(),o=[];a.onsuccess=t=>{const r=t.target.result;if(r){const t=r.key;t&&"string"==typeof t&&t.includes(`_${e}_`)&&o.push(t),r.continue()}else{if(0===o.length)return void n();let e=0;o.forEach((t=>{const r=i.delete(t);r.onsuccess=()=>{e++,e===o.length&&n()},r.onerror=()=>{e++,e===o.length&&n()}}))}},a.onerror=()=>r(a.error)}))}catch(e){console.warn("Failed to delete cache entries by type:",e)}})),gz=e=>{console.log("🚀 Type3 Component - Props:",e);const[t,i]=(0,r.useState)(!1),[a,o]=(0,r.useState)(null),[s,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0),d=(PF()||"").trim(),[h,p]=(0,r.useState)((()=>"undefined"==typeof window?"ru":localStorage.getItem("custom_locale")||"ru"));(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("custom_locale")||"ru";p(e)};e(),window.addEventListener("storage",e);const t=setInterval(e,250);return()=>{window.removeEventListener("storage",e),clearInterval(t)}}),[]);const[f,m]=(0,r.useState)("fill"),[v,y]=(0,r.useState)(.01),[x,b]=(0,r.useState)(.003),[_,w]=(0,r.useState)(.75),[S,E]=(0,r.useState)({min:.0015,max:.045,step:5e-4}),[A,C]=(0,r.useState)({min:0,max:.01,step:1e-4}),[P,R]=(0,r.useState)({min:0,max:1,step:.01}),O=(0,r.useRef)(null),D=(0,r.useRef)(null),I=(0,r.useRef)(null),L=(0,r.useRef)(null),N=(0,r.useRef)(null),k=(0,r.useRef)(null),U=(0,r.useRef)(null),F=(0,r.useRef)(null),z=(0,r.useRef)(null),j=(0,r.useRef)(null),B=(0,r.useRef)(null),H=(0,r.useRef)(null),V=(0,r.useRef)(null),G=(0,r.useRef)(null),W=(0,r.useRef)(null),X=(0,r.useRef)(null),[q,Y]=(0,r.useState)(!1),[K,$]=(0,r.useState)(null),[Z,J]=(0,r.useState)([]),[Q,ee]=(0,r.useState)([]),[te,ne]=(0,r.useState)([]),[re,ie]=(0,r.useState)(!1),ae=(e,t)=>{e.traverse((e=>{e instanceof Pr&&(e.material=t)}))},oe=(e,t)=>{e.traverse((e=>{e instanceof Pr&&(e.renderOrder=t)}))},se=(e,t)=>{e.traverse((e=>e.layers.set(1))),t.traverse((e=>e.layers.set(2)))};function le(e){e.traverse((e=>{e.isMesh&&!e.userData._origMat&&(e.userData._origMat=e.material)}))}function ce(e){e.traverse((e=>{e.isMesh&&e.userData._origMat&&(e.material=e.userData._origMat)}))}const ue=()=>{W.current||(W.current=new kr({vertexShader:"\n    varying vec3 vWorldPos;\n    void main() {\n      vec4 wp = modelMatrix * vec4(position, 1.0);\n      vWorldPos = wp.xyz;\n      gl_Position = projectionMatrix * viewMatrix * wp;\n    }\n  ",fragmentShader:"\n    precision highp float;\n    varying vec3 vWorldPos;\n    uniform sampler2D uDepthTex;\n    uniform mat4 uTopPV;\n    uniform float uTopNear, uTopFar, uTopCamPosY;\n    uniform float uMaxDh;\n    uniform float uEps;\n    uniform float uOpacityMax;\n    uniform bool uPositiveIsBlue;\n    uniform int uSignFilter;\n\n    vec3 heatColor(float t, bool positiveIsBlue){\n      t = clamp(t, -1.0, 1.0);\n      if (positiveIsBlue){\n        if (t >= 0.0) return mix(vec3(1.0), vec3(1.0,0.84,0.0), t);\n        else return mix(vec3(0.90,0.22,0.21), vec3(1.0), 1.0 + t);\n      } else {\n        if (t >= 0.0) return mix(vec3(1.0), vec3(0.90,0.22,0.21), t);\n        else return mix(vec3(1.0,0.84,0.0), vec3(1.0), 1.0 + t);\n      }\n    }\n\n    void main() {\n      vec4 clip = uTopPV * vec4(vWorldPos, 1.0);\n      vec3 ndc = clip.xyz / clip.w;\n      vec2 uv = ndc.xy * 0.5 + 0.5;\n      if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) discard;\n      float d = texture2D(uDepthTex, uv).r;\n      if (d >= 1.0) discard;\n      float depthLinear = mix(uTopNear, uTopFar, d);\n      float baseY = uTopCamPosY - depthLinear;\n      float dh = vWorldPos.y - baseY;\n      float ad = abs(dh);\n      if (ad < uEps) discard;\n      if (uSignFilter == 1 && dh <= 0.0) discard;\n      if (uSignFilter == -1 && dh >= 0.0) discard;\n      float t = clamp(dh / uMaxDh, -1.0, 1.0);\n      vec3 col = heatColor(t, uPositiveIsBlue);\n      float alpha = min(uOpacityMax, smoothstep(uEps, uMaxDh, ad));\n      gl_FragColor = vec4(col, alpha);\n    }\n  ",transparent:!0,depthTest:!0,depthWrite:!1,side:2,uniforms:{uDepthTex:{value:V.current?V.current.depthTexture:null},uTopPV:{value:H.current},uTopNear:{value:B.current?B.current.near:.1},uTopFar:{value:B.current?B.current.far:10},uTopCamPosY:{value:B.current?B.current.position.y:0},uMaxDh:{value:v},uEps:{value:x},uOpacityMax:{value:.85},uPositiveIsBlue:{value:!1},uSignFilter:{value:0}}}))},de=e=>{W.current&&V.current&&H.current&&B.current&&(W.current.uniforms.uDepthTex.value=V.current.depthTexture,W.current.uniforms.uTopPV.value=H.current,W.current.uniforms.uTopNear.value=B.current.near,W.current.uniforms.uTopFar.value=B.current.far,W.current.uniforms.uTopCamPosY.value=B.current.position.y,W.current.uniforms.uMaxDh.value=e.maxDh,W.current.uniforms.uEps.value=e.eps,W.current.uniforms.uPositiveIsBlue.value=!!e.positiveIsBlue,W.current.uniforms.uSignFilter.value=0|e.signFilter)},he=e=>{if(!(I.current&&D.current&&B.current&&V.current))return;X.current||(X.current=new kr({vertexShader:"\n    varying vec3 vWorldPos;\n    void main(){\n      vec4 wp = modelMatrix * vec4(position, 1.0);\n      vWorldPos = wp.xyz;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    precision highp float;\n    varying vec3 vWorldPos;\n    uniform float uSlopeCut;\n    uniform vec3 uWorldUp;\n\n    void main(){\n      vec3 dpdx = dFdx(vWorldPos);\n      vec3 dpdy = dFdy(vWorldPos);\n      vec3 nW   = normalize(cross(dpdx, dpdy));\n      float horiz = abs(dot(nW, normalize(uWorldUp)));\n      if (horiz < uSlopeCut) discard;\n    }\n  ",uniforms:{uSlopeCut:{value:_},uWorldUp:{value:new lt(0,1,0)}},depthTest:!0,depthWrite:!0}),X.current.colorWrite=!1,X.current.polygonOffset=!0,X.current.polygonOffsetFactor=1,X.current.polygonOffsetUnits=1),X.current.uniforms.uSlopeCut.value=_;const t=I.current.getRenderTarget(),n=I.current.getClearColor(new Jn),r=I.current.getClearAlpha(),i=D.current.overrideMaterial,a=B.current.layers.mask;B.current.layers.set(1),D.current.overrideMaterial=X.current,I.current.setRenderTarget(V.current),I.current.setClearColor(0,0),I.current.clear(!0,!0,!0),I.current.render(D.current,B.current),D.current.overrideMaterial=i,B.current.layers.mask=a,I.current.setRenderTarget(t),I.current.setClearColor(n,r)},pe=()=>{if(!(z.current&&j.current&&G.current&&B.current&&H.current&&V.current))return void console.warn("⚠️ Cannot apply fill mode: missing required refs");const e=z.current,t=j.current;0!==e.children.length&&0!==t.children.length?(se(e,t),ce(e),oe(e,0),he(),ue(),de({maxDh:v,eps:x,positiveIsBlue:!1,signFilter:1}),ae(t,W.current),oe(t,1)):console.warn("⚠️ Cannot apply fill mode: models not loaded")},fe=()=>{if(!(z.current&&j.current&&G.current&&B.current&&H.current&&V.current))return void console.warn("⚠️ Cannot apply cut mode: missing required refs");const e=j.current,t=z.current;0!==e.children.length&&0!==t.children.length?(se(e,t),ce(e),oe(e,0),he(),ue(),de({maxDh:v,eps:x,positiveIsBlue:!0,signFilter:1}),ae(t,W.current),oe(t,1)):console.warn("⚠️ Cannot apply cut mode: models not loaded")};(0,r.useEffect)((()=>{let e=!0;return uz(void 0,void 0,void 0,(function*(){if(!d)return console.log("ℹ️ No dam selected for Type3 configuration"),void(e&&(l(null),o(IF("selectDam",h)),u(!1),i(!1),me()));try{const n=`config_${d}_type3`,r=yield(t=n,uz(void 0,void 0,void 0,(function*(){try{const e=yield hz();return new Promise(((n,r)=>{const i=e.transaction([dz],"readonly").objectStore(dz).get(t);i.onsuccess=()=>{const e=i.result;if(e&&e.data)try{const t="string"==typeof e.data?JSON.parse(e.data):e.data;n(t)}catch(e){n(null)}else n(null)},i.onerror=()=>r(i.error)}))}catch(e){return console.warn("Failed to read config from cache:",e),null}})));if(r){if(console.log("✅ Found cached API config, loading from cache"),!e)return;return u(!1),o(null),l(r),y(r.visualization.max_dh.value),b(r.visualization.dead_zone.value),w(r.visualization.slope_cutoff.value),m(r.default_mode),E({min:r.visualization.max_dh.min,max:r.visualization.max_dh.max,step:r.visualization.max_dh.step}),C({min:r.visualization.dead_zone.min,max:r.visualization.dead_zone.max,step:r.visualization.dead_zone.step}),void R({min:r.visualization.slope_cutoff.min,max:r.visualization.slope_cutoff.max,step:r.visualization.slope_cutoff.step})}console.log("📡 Cache miss, fetching 3D config from API...",{damName:d}),u(!0),o(null);const i=encodeURIComponent(d),a=yield fetch(`https://api-dam3d.spacemc.uz/api/v1/3d-config/?dam_name=${i}`);if(!a.ok){if(404===a.status)throw new Error(IF("noDataForDam",h));throw new Error(`API request failed: ${a.status} ${a.statusText}`)}const s=yield a.json();if(!e)return;console.log("💾 Saving API config to cache..."),yield((e,t)=>uz(void 0,void 0,void 0,(function*(){try{const n=yield hz();return new Promise(((r,i)=>{const a=n.transaction([dz],"readwrite").objectStore(dz).put({key:e,data:JSON.stringify(t),timestamp:Date.now()});a.onsuccess=()=>r(),a.onerror=()=>i(a.error)}))}catch(e){console.warn("Failed to write config to cache:",e)}})))(n,s),console.log("✅ API config cached successfully"),console.log("✅ API config loaded:",s),l(s),y(s.visualization.max_dh.value),b(s.visualization.dead_zone.value),w(s.visualization.slope_cutoff.value),m(s.default_mode),E({min:s.visualization.max_dh.min,max:s.visualization.max_dh.max,step:s.visualization.max_dh.step}),C({min:s.visualization.dead_zone.min,max:s.visualization.dead_zone.max,step:s.visualization.dead_zone.step}),R({min:s.visualization.slope_cutoff.min,max:s.visualization.slope_cutoff.max,step:s.visualization.slope_cutoff.step})}catch(t){if(!e)return;console.error("❌ Error fetching API config:",t);const n=t instanceof Error?t.message:IF("errorLoadingModel",h),r=n===IF("noDataForDam",h);o(r?n:IF("errorLoadingModel",h)),l(null),i(!1),me()}finally{e&&u(!1)}var t})),()=>{e=!1}}),[d,h]),(0,r.useEffect)((()=>(c||!s||a?a&&me():(console.log("🚀 Initializing Type3 3D scene with API config"),ge()),()=>{console.log("🧹 Cleaning up Type3 3D scene on unmount"),me()})),[s,c,a]),(0,r.useEffect)((()=>{const e=()=>{if(I.current&&L.current&&O.current){const e=O.current.clientWidth,t=O.current.clientHeight;L.current.aspect=e/t,L.current.updateProjectionMatrix(),I.current.setSize(e,t)}};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,r.useEffect)((()=>{if(D.current){const t=e.isDark?1052955:15658734;D.current.background=new Jn(t)}}),[e.isDark]),(0,r.useEffect)((()=>{W.current&&(W.current.uniforms.uMaxDh.value=v,W.current.uniforms.uEps.value=x),X.current&&(X.current.uniforms.uSlopeCut.value=_),z.current&&j.current&&he("fill"===f?z.current:j.current)}),[v,x,_,f]);const me=()=>{k.current&&(cancelAnimationFrame(k.current),k.current=null),N.current&&(N.current.dispose(),N.current=null),I.current&&(I.current.dispose(),I.current=null),D.current&&(D.current.clear(),D.current=null),U.current=null,F.current=null,z.current=null,j.current=null,L.current=null,O.current&&(O.current.innerHTML="")},ge=()=>uz(void 0,void 0,void 0,(function*(){if(console.log("🎨 Loading Type3 3D models"),O.current){me(),i(!0),o(null);try{ve()}catch(e){console.error("❌ Error in load3DModels:",e),o(e instanceof Error?e.message:"Unknown error"),i(!1)}}else console.log("❌ Container ref not available")})),ve=()=>{if(!O.current)return;const t=O.current,n=t.clientWidth,r=t.clientHeight,i=new Kr,a=e.isDark?1052955:15658734;i.background=new Jn(a),D.current=i;const o=new Br(60,n/r,.01,8e3);o.layers.enable(1),o.layers.enable(2),o.position.set(0,1.5,3),L.current=o;const s=new dc({antialias:!0});s.setPixelRatio(Math.min(window.devicePixelRatio,2)),s.setSize(n,r),I.current=s,t.innerHTML="",t.appendChild(s.domElement);const l=new ja(16777215,4473924,1),c=new Za(16777215,1);c.position.set(3,10,10),i.add(l,c);const u=new mu(o,s.domElement);u.enableDamping=!0,N.current=u,i.add(new vo(.5));const d=new go(10,10);d.position.y=-.001,i.add(d);const h=new aa({color:10395294,roughness:.95,metalness:0,transparent:!1,opacity:1,depthTest:!0,depthWrite:!0,side:2});G.current=h,ye(i),xe(),console.log("✅ Type3 Three.js scene initialized successfully")},ye=e=>uz(void 0,void 0,void 0,(function*(){if(console.log("🎨 Loading GLB models for Type3"),!s||!d)return console.error("❌ API config or dam name not available"),o("Configuration not loaded"),void i(!1);const t=new pc;try{let n=s.models.base_model.url,r=s.models.overlay_model.url;n=n.replace(/^http:/,"https:"),r=r.replace(/^http:/,"https:"),console.log("📁 Loading models from API config:",{baseModelUrl:n,overlayModelUrl:r});const a=`glb_${d}_type3_base`,l=`glb_${d}_type3_overlay`,[c,u]=yield Promise.all([pz(a),pz(l)]);let p=null,f=null;const v=[];let y=!1;if(c&&u){console.log("✅ Found both cached models, loading from cache in parallel");try{const[e,n]=yield Promise.all([new Promise(((e,n)=>{const r=URL.createObjectURL(c);t.load(r,(t=>{URL.revokeObjectURL(r),e(t.scene)}),void 0,(e=>n(e)))})),new Promise(((e,n)=>{const r=URL.createObjectURL(u);t.load(r,(t=>{URL.revokeObjectURL(r),e(t.scene)}),void 0,(e=>n(e)))}))]);p=e,f=n,console.log("✅ Both models loaded from cache successfully")}catch(e){const t=e instanceof Error?e.message:"Unknown error loading cached models";v.push(`Cached Models: ${t}`),console.error("❌ Error loading cached models:",t)}}else{if(c){console.log("✅ Found cached base model, loading from cache");try{const e=URL.createObjectURL(c);p=yield new Promise(((n,r)=>{t.load(e,(t=>{URL.revokeObjectURL(e),n(t.scene)}),void 0,(e=>r(e)))})),console.log("✅ Base model loaded from cache")}catch(e){const t=e instanceof Error?e.message:"Unknown error loading base model";v.push(`Base Model: ${t}`),console.error("❌ Base model error:",t)}}else{console.log("📡 Cache miss for base model, fetching from API..."),y=!0;try{const e=yield jh.get(n,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`}});y&&(console.log("🗑️ Deleting previous type3 cache entries..."),yield mz("type3"),y=!1),console.log("💾 Saving base model to cache..."),yield fz(a,e.data),console.log("✅ Base model cached successfully");const r=URL.createObjectURL(e.data);p=yield new Promise(((e,i)=>{t.load(r,(t=>{URL.revokeObjectURL(r),e(t.scene)}),void 0,(e=>{const t=e instanceof Error?e.message:String(e);t.includes("CORS")||t.includes("Cross-Origin")||t.includes("Failed to fetch")?i(new Error(`CORS Error: Base model blocked by browser. The server at ${n} needs to send CORS headers (Access-Control-Allow-Origin)`)):t.includes("404")||t.includes("Not Found")?i(new Error(`404 Error: Base model not found at ${n}`)):i(new Error(`Failed to load base model: ${t}`))}))})),console.log("✅ Base model loaded from API")}catch(e){const t=e instanceof Error?e.message:"Unknown error loading base model";v.push(`Base Model: ${t}`),console.error("❌ Base model error:",t)}}if(u){console.log("✅ Found cached overlay model, loading from cache");try{const e=URL.createObjectURL(u);f=yield new Promise(((n,r)=>{t.load(e,(t=>{URL.revokeObjectURL(e),n(t.scene)}),void 0,(e=>r(e)))})),console.log("✅ Overlay model loaded from cache")}catch(e){const t=e instanceof Error?e.message:"Unknown error loading overlay model";v.push(`Overlay Model: ${t}`),console.error("❌ Overlay model error:",t)}}else{console.log("📡 Cache miss for overlay model, fetching from API..."),y=!0;try{const e=yield jh.get(r,{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`}});y&&(console.log("🗑️ Deleting previous type3 cache entries..."),yield mz("type3"),y=!1),console.log("💾 Saving overlay model to cache..."),yield fz(l,e.data),console.log("✅ Overlay model cached successfully");const n=URL.createObjectURL(e.data);f=yield new Promise(((e,i)=>{t.load(n,(t=>{URL.revokeObjectURL(n),e(t.scene)}),void 0,(e=>{const t=e instanceof Error?e.message:String(e);t.includes("CORS")||t.includes("Cross-Origin")||t.includes("Failed to fetch")?i(new Error(`CORS Error: Overlay model blocked by browser. The server at ${r} needs to send CORS headers (Access-Control-Allow-Origin)`)):t.includes("404")||t.includes("Not Found")?i(new Error(`404 Error: Overlay model not found at ${r}`)):i(new Error(`Failed to load overlay model: ${t}`))}))})),console.log("✅ Overlay model loaded from API")}catch(e){const t=e instanceof Error?e.message:"Unknown error loading overlay model";v.push(`Overlay Model: ${t}`),console.error("❌ Overlay model error:",t)}}}if(!p&&!f)return console.error("❌ Both models failed to load"),i(!1),o(IF("noDataForDam",h)),void me();if(!p||!f){const e=p?"base":"overlay",t=p?"overlay":"base";return console.warn(`⚠️ Only ${e} model loaded. ${t} model failed.`),i(!1),o(IF("noDataForDam",h)),void me()}console.log("✅ GLB models processing completed");const x=new Xr;x.name="group2023",p&&(x.add(p),le(x),e.add(x));const b=new Xr;b.name="group2025",f&&(b.add(f),le(b),e.add(b)),z.current=x,j.current=b,U.current=p,F.current=f;const _=new Dt;if(p&&_.expandByObject(x),f&&_.expandByObject(b),_.isEmpty())return console.error("❌ No models were successfully loaded"),i(!1),o(IF("noDataForDam",h)),void me();const{cam:w,rt:S}=(e=>{var t;const n=e.getCenter(new lt),r=e.getSize(new lt),i=1.04*r.x*.5,a=1.04*r.z*.5,o=Math.max(2,1.04*r.y+2),s=new Ka(-i,i,a,-a,.1,o);s.position.set(n.x,n.y+.5*o,n.z),s.lookAt(n.x,n.y,n.z),s.up.set(0,0,1),s.updateProjectionMatrix(),s.updateMatrixWorld(!0);const l=((e=4096)=>{if(!I.current)return 2048;const t=I.current.getContext(),n=t.getParameter(t.MAX_TEXTURE_SIZE)||2048;return Math.min(e,n)})(4096),c=new Pt(l,l,{minFilter:g,magFilter:g,depthBuffer:!0,stencilBuffer:!1}),u=(null===(t=I.current)||void 0===t?void 0:t.capabilities.isWebGL2)?T:M;return c.depthTexture=new Qi(l,l,u),{cam:s,rt:c}})(_);B.current=w,V.current=S;const E=(new on).copy(w.matrixWorldInverse),A=(new on).copy(w.projectionMatrix),C=(new on).multiplyMatrices(A,E);H.current=C;const P=_.getSize(new lt),R=_.getCenter(new lt),O=Math.max(P.x,P.y,P.z),D=L.current.fov*Math.PI/180,k=O/2/Math.tan(D/2)*1.6;L.current.position.set(R.x+.3*k,R.y+.3*k,R.z+k),L.current.near=Math.max(.01,O/100),L.current.far=Math.max(2e3,100*O),L.current.updateProjectionMatrix(),N.current.target.copy(R),N.current.update(),i(!1),requestAnimationFrame((()=>{s&&"fill"===s.default_mode?(pe(),m("fill")):s&&"cut"===s.default_mode?(fe(),m("cut")):(pe(),m("fill"))}))}catch(e){console.error("❌ Error loading GLB models:",e),i(!1),o(IF("noDataForDam",h)),me()}})),xe=()=>{k.current=requestAnimationFrame(xe),N.current&&N.current.update(),re&&D.current&&(D.current.rotation.y+=.002),I.current&&D.current&&L.current&&I.current.render(D.current,L.current)},be=e=>{m(e),"fill"===e?pe():fe()};return console.log("🎨 Rendering Type3 component with state:",{isLoading:t,loadError:a,currentMode:f,maxDh:v,eps:x,isRotating:re,sceneExists:!!D.current}),(0,n.jsx)("div",{className:"type3-component "+(e.isDark?"dark":""),style:{position:"relative",width:"100%",height:"100%"}},(c||t)&&(0,n.jsx)("div",null,(0,n.jsx)("div",{css:{position:"absolute",top:0,left:0,right:0,bottom:0,backdropFilter:"blur(8px)",backgroundColor:e.isDark?"rgba(16, 17, 27, 0.5)":"rgba(255, 255, 255, 0.5)",zIndex:999,pointerEvents:"none"}}),(0,n.jsx)("div",{className:"loading",css:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"none"}},(0,n.jsx)("div",{className:"loading-spinner-modern"},(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"})))),a&&(0,n.jsx)("div",null,(0,n.jsx)("div",{css:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:e.isDark?"#10111b":"#f8f9fa",zIndex:999,pointerEvents:"none"}}),(0,n.jsx)("div",{className:"error-message",css:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"auto"}},(0,n.jsx)("div",{className:"error-content"},(0,n.jsx)("div",{className:"error-icon-wrapper"},(0,n.jsx)("svg",{className:"error-icon-svg",width:"80",height:"80",viewBox:"0 0 46 42",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M28.1746 3.16754C27.6273 2.20563 26.8349 1.40582 25.8782 0.849456C24.9215 0.293087 23.8345 0 22.7278 0C21.621 0 20.5341 0.293087 19.5773 0.849456C18.6206 1.40582 17.8283 2.20563 17.281 3.16754L0.785217 32.5569C0.261401 33.4791 -0.00939594 34.5235 0.000248916 35.5841C0.00989377 36.6447 0.299638 37.6839 0.840139 38.5965C1.38858 39.538 2.17614 40.3178 3.12302 40.857C4.0699 41.3961 5.14246 41.6753 6.23203 41.6665H39.2235C40.3131 41.6753 41.3857 41.3961 42.3325 40.857C43.2794 40.3178 44.067 39.538 44.6154 38.5965C45.1559 37.6839 45.4457 36.6447 45.4553 35.5841C45.465 34.5235 45.1942 33.4791 44.6703 32.5569L28.1746 3.16754ZM41.3466 36.6893C41.1285 37.0567 40.8174 37.3601 40.4447 37.5689C40.0719 37.7777 39.6507 37.8846 39.2235 37.8787H6.23203C5.80428 37.884 5.3827 37.7763 5.00992 37.5665C4.63713 37.3566 4.32635 37.0521 4.10899 36.6836C3.90296 36.3412 3.79237 35.9498 3.7887 35.5502C3.78504 35.1505 3.88844 34.7572 4.08815 34.411L20.5839 5.01976C20.8176 4.6646 21.1358 4.37305 21.51 4.17131C21.8842 3.96957 22.3027 3.86395 22.7278 3.86395C23.1529 3.86395 23.5714 3.96957 23.9456 4.17131C24.3198 4.37305 24.638 4.6646 24.8717 5.01976L41.3674 34.4091C41.5675 34.7555 41.6711 35.1492 41.6674 35.5492C41.6638 35.9492 41.553 36.341 41.3466 36.6836V36.6893Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 11.3643C22.2255 11.3643 21.7438 11.5638 21.3886 11.919C21.0334 12.2742 20.8339 12.7559 20.8339 13.2582V24.6215C20.8339 25.1238 21.0334 25.6055 21.3886 25.9607C21.7438 26.3158 22.2255 26.5154 22.7278 26.5154C23.2301 26.5154 23.7118 26.3158 24.067 25.9607C24.4221 25.6055 24.6217 25.1238 24.6217 24.6215V13.2582C24.6217 12.7559 24.4221 12.2742 24.067 11.919C23.7118 11.5638 23.2301 11.3643 22.7278 11.3643Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 34.0909C23.7737 34.0909 24.6217 33.243 24.6217 32.197C24.6217 31.1511 23.7737 30.3031 22.7278 30.3031C21.6818 30.3031 20.8339 31.1511 20.8339 32.197C20.8339 33.243 21.6818 34.0909 22.7278 34.0909Z",fill:"#F0C039"}))),(0,n.jsx)("div",{className:"error-title"},a),a===IF("selectDam",h)&&(0,n.jsx)("div",{className:"error-description"},"uz"===h?"3D modelni ko'rish uchun suv omborini tanlang":"uzcryl"===h?"3D моделни кўриш учун сув омборини танланг":"Пожалуйста, выберите водохранилище для просмотра 3D модели"),a===IF("noDataForDam",h)&&(0,n.jsx)("div",{className:"error-description"},"uz"===h?"Ushbu suv ombori uchun 3D model mavjud emas":"uzcryl"===h?"Ушбу сув омбори учун 3D модель мавжуд эмас":"Для этого водохранилища 3D модель недоступна"),a!==IF("selectDam",h)&&a!==IF("noDataForDam",h)&&(0,n.jsx)("div",null,(0,n.jsx)("div",{className:"error-description"},IF("errorLoadingModel",h)),(0,n.jsx)("button",{className:"retry-button",onClick:()=>{o(null),s&&ge()}},IF("retry",h)))))),(0,n.jsx)("div",{className:"type3-controls"},(0,n.jsx)("div",{className:"control-row"},(0,n.jsx)("button",{className:"type-button "+("fill"===f?"active":""),onClick:()=>be("fill"),disabled:c||t||!d||!!a||!s},IF("showDepositRed",h)),(0,n.jsx)("button",{className:"type-button "+("cut"===f?"active":""),onClick:()=>be("cut"),disabled:c||t||!d||!!a||!s},IF("showCutBlue",h)))),!a&&(0,n.jsx)("div",{className:`container-3d ${q?"drawing-mode":""} ${re?"spinning-mode":""}`,ref:O,onClick:t=>{if(!(q&&D.current&&L.current&&I.current))return;const n=t.currentTarget.getBoundingClientRect(),r=new ot;r.x=(t.clientX-n.left)/n.width*2-1,r.y=-(t.clientY-n.top)/n.height*2+1;const i=new ho;i.setFromCamera(r,L.current);const a=[];if(z.current&&a.push(...i.intersectObject(z.current,!0)),j.current&&a.push(...i.intersectObject(j.current,!0)),a.length>0){const t=a[0].point,n=[...e.currentLinePoints,t];e.onLinePointsChange(n);const r=(e=>{const t=new ra(.1,16,16),n=new nr({color:16711680}),r=new Pr(t,n);return r.position.copy(e),r})(t);if(J((e=>[...e,r])),D.current.add(r),2===n.length){const t=(e=>{const t=(new vr).setFromPoints(e),n=new Oi({color:16711680,linewidth:3});return new zi(t,n)})(n);$(t),D.current.add(t),ee((e=>[...e,t])),ne((e=>[...e,...Z,r])),e.onLineCompleted(n),Y(!1),$(null),J([])}}}}),(0,n.jsx)(cz,{lineData:e.lastLineData,isVisible:e.showChart,onClose:e.onCloseChart,isDark:e.isDark}))};var vz=1e-6,yz=1e-12,xz=Math.PI,bz=xz/2,_z=xz/4,wz=2*xz,Sz=180/xz,Mz=xz/180,Ez=Math.abs,Tz=Math.atan,Az=Math.atan2,Cz=Math.cos,Pz=(Math.ceil,Math.exp),Rz=(Math.floor,Math.hypot,Math.log),Oz=(Math.pow,Math.sin),Dz=Math.sign||function(e){return e>0?1:e<0?-1:0},Iz=Math.sqrt,Lz=Math.tan;function Nz(e){return e>1?bz:e<-1?-bz:Math.asin(e)}function kz(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function Uz(e,t){return Ez(e)>xz&&(e-=Math.round(e/wz)*wz),[e,t]}function Fz(e,t,n){return(e%=wz)?t||n?kz(jz(e),Bz(t,n)):jz(e):t||n?Bz(t,n):Uz}function zz(e){return function(t,n){return Ez(t+=e)>xz&&(t-=Math.round(t/wz)*wz),[t,n]}}function jz(e){var t=zz(e);return t.invert=zz(-e),t}function Bz(e,t){var n=Cz(e),r=Oz(e),i=Cz(t),a=Oz(t);function o(e,t){var o=Cz(t),s=Cz(e)*o,l=Oz(e)*o,c=Oz(t),u=c*n+s*r;return[Az(l*i-u*a,s*n-c*r),Nz(u*i+l*a)]}return o.invert=function(e,t){var o=Cz(t),s=Cz(e)*o,l=Oz(e)*o,c=Oz(t),u=c*i-l*a;return[Az(l*i+c*a,s*n+u*r),Nz(u*n-s*r)]},o}function Hz(){}function Vz(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:Hz,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function Gz(e,t){return Ez(e[0]-t[0])<vz&&Ez(e[1]-t[1])<vz}function Wz(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Xz(e,t,n,r,i){var a,o,s=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(Gz(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<t;++a)i.point((r=e[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*vz}s.push(n=new Wz(r,e,null,!0)),l.push(n.o=new Wz(r,null,n,!1)),s.push(n=new Wz(o,e,null,!1)),l.push(n.o=new Wz(o,null,n,!0))}})),s.length){for(l.sort(t),qz(s),qz(l),a=0,o=l.length;a<o;++a)l[a].e=n=!n;for(var c,u,d=s[0];;){for(var h=d,p=!0;h.v;)if((h=h.n)===d)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(a=0,o=c.length;a<o;++a)i.point((u=c[a])[0],u[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(p)for(c=h.p.z,a=c.length-1;a>=0;--a)i.point((u=c[a])[0],u[1]);else r(h.x,h.p.x,-1,i);h=h.p}c=(h=h.o).z,p=!p}while(!h.v);i.lineEnd()}}}function qz(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}Uz.invert=Uz;class Yz{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],a=e+i,o=Math.abs(e)<Math.abs(i)?e-(a-i):i-(a-e);o&&(t[n++]=o),e=a}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,a=0;if(i>0){for(a=e[--i];i>0&&(t=a,n=e[--i],a=t+n,r=n-(a-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=a+n,n==t-a&&(a=t))}return a}}function Kz(e){return[Az(e[1],e[0]),Nz(e[2])]}function $z(e){var t=e[0],n=e[1],r=Cz(n);return[r*Cz(t),r*Oz(t),Oz(n)]}function Zz(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Jz(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Qz(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ej(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function tj(e){var t=Iz(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function nj(e){return Ez(e[0])<=xz?e[0]:Dz(e[0])*((Ez(e[0])+xz)%wz-xz)}function rj(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function ij(e,t,n,r){return function(i){var a,o,s,l=t(i),c=Vz(),u=t(c),d=!1,h={point:p,lineStart:m,lineEnd:g,polygonStart:function(){h.point=v,h.lineStart=y,h.lineEnd=x,o=[],a=[]},polygonEnd:function(){h.point=p,h.lineStart=m,h.lineEnd=g,o=rj(o);var e=function(e,t){var n=nj(t),r=t[1],i=Oz(r),a=[Oz(n),-Cz(n),0],o=0,s=0,l=new Yz;1===i?r=bz+vz:-1===i&&(r=-bz-vz);for(var c=0,u=e.length;c<u;++c)if(h=(d=e[c]).length)for(var d,h,p=d[h-1],f=nj(p),m=p[1]/2+_z,g=Oz(m),v=Cz(m),y=0;y<h;++y,f=b,g=w,v=S,p=x){var x=d[y],b=nj(x),_=x[1]/2+_z,w=Oz(_),S=Cz(_),M=b-f,E=M>=0?1:-1,T=E*M,A=T>xz,C=g*w;if(l.add(Az(C*E*Oz(T),v*S+C*Cz(T))),o+=A?M+E*wz:M,A^f>=n^b>=n){var P=Jz($z(p),$z(x));tj(P);var R=Jz(a,P);tj(R);var O=(A^M>=0?-1:1)*Nz(R[2]);(r>O||r===O&&(P[0]||P[1]))&&(s+=A^M>=0?1:-1)}}return(o<-vz||o<vz&&l<-yz)^1&s}(a,r);o.length?(d||(i.polygonStart(),d=!0),Xz(o,oj,e,n,i)):e&&(d||(i.polygonStart(),d=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),d&&(i.polygonEnd(),d=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(t,n){e(t,n)&&i.point(t,n)}function f(e,t){l.point(e,t)}function m(){h.point=f,l.lineStart()}function g(){h.point=p,l.lineEnd()}function v(e,t){s.push([e,t]),u.point(e,t)}function y(){u.lineStart(),s=[]}function x(){v(s[0][0],s[0][1]),u.lineEnd();var e,t,n,r,l=u.clean(),h=c.result(),p=h.length;if(s.pop(),a.push(s),s=null,p)if(1&l){if((t=(n=h[0]).length-1)>0){for(d||(i.polygonStart(),d=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else p>1&&2&l&&h.push(h.pop().concat(h.shift())),o.push(h.filter(aj))}return h}}function aj(e){return e.length>1}function oj(e,t){return((e=e.x)[0]<0?e[1]-bz-vz:bz-e[1])-((t=t.x)[0]<0?t[1]-bz-vz:bz-t[1])}const sj=ij((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,o){var s=a>0?xz:-xz,l=Ez(a-n);Ez(l-xz)<vz?(e.point(n,r=(r+o)/2>0?bz:-bz),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(a,r),t=0):i!==s&&l>=xz&&(Ez(n-i)<vz&&(n-=i*vz),Ez(a-s)<vz&&(a-=s*vz),r=function(e,t,n,r){var i,a,o=Oz(e-n);return Ez(o)>vz?Tz((Oz(t)*(a=Cz(r))*Oz(n)-Oz(r)*(i=Cz(t))*Oz(e))/(i*a*o)):(t+r)/2}(n,r,a,o),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=a,r=o),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*bz,r.point(-xz,i),r.point(0,i),r.point(xz,i),r.point(xz,0),r.point(xz,-i),r.point(0,-i),r.point(-xz,-i),r.point(-xz,0),r.point(-xz,i);else if(Ez(e[0]-t[0])>vz){var a=e[0]<t[0]?xz:-xz;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}),[-xz,-bz]);function lj(e,t){(t=$z(t))[0]-=e,tj(t);var n,r=(n=-t[1])>1?0:n<-1?xz:Math.acos(n);return((-t[2]<0?-r:r)+wz-vz)%wz}var cj=1e9,uj=-cj;const dj=e=>e;function hj(e){return function(t){var n=new pj;for(var r in e)n[r]=e[r];return n.stream=t,n}}function pj(){}function fj(e,t){e&&gj.hasOwnProperty(e.type)&&gj[e.type](e,t)}pj.prototype={constructor:pj,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var mj={Feature:function(e,t){fj(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)fj(n[r].geometry,t)}},gj={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){vj(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)vj(n[r],t,0)},Polygon:function(e,t){yj(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)yj(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)fj(n[r],t)}};function vj(e,t,n){var r,i=-1,a=e.length-n;for(t.lineStart();++i<a;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function yj(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)vj(e[n],t,1);t.polygonEnd()}var xj=1/0,bj=xj,_j=-xj,wj=_j,Sj={point:function(e,t){e<xj&&(xj=e),e>_j&&(_j=e),t<bj&&(bj=t),t>wj&&(wj=t)},lineStart:Hz,lineEnd:Hz,polygonStart:Hz,polygonEnd:Hz,result:function(){var e=[[xj,bj],[_j,wj]];return _j=wj=-(bj=xj=1/0),e}};const Mj=Sj;function Ej(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),function(e,t){e&&mj.hasOwnProperty(e.type)?mj[e.type](e,t):fj(e,t)}(n,e.stream(Mj)),t(Mj.result()),null!=r&&e.clipExtent(r),e}function Tj(e,t,n){return Ej(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+t[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([o,s])}),n)}var Aj=16,Cj=Cz(30*Mz);function Pj(e,t){return+t?function(e,t){function n(r,i,a,o,s,l,c,u,d,h,p,f,m,g){var v=c-r,y=u-i,x=v*v+y*y;if(x>4*t&&m--){var b=o+h,_=s+p,w=l+f,S=Iz(b*b+_*_+w*w),M=Nz(w/=S),E=Ez(Ez(w)-1)<vz||Ez(a-d)<vz?(a+d)/2:Az(_,b),T=e(E,M),A=T[0],C=T[1],P=A-r,R=C-i,O=y*P-v*R;(O*O/x>t||Ez((v*P+y*R)/x-.5)>.3||o*h+s*p+l*f<Cj)&&(n(r,i,a,o,s,l,A,C,E,b/=S,_/=S,w,m,g),g.point(A,C),n(A,C,E,b,_,w,c,u,d,h,p,f,m,g))}}return function(t){var r,i,a,o,s,l,c,u,d,h,p,f,m={point:g,lineStart:v,lineEnd:x,polygonStart:function(){t.polygonStart(),m.lineStart=b},polygonEnd:function(){t.polygonEnd(),m.lineStart=v}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function v(){u=NaN,m.point=y,t.lineStart()}function y(r,i){var a=$z([r,i]),o=e(r,i);n(u,d,c,h,p,f,u=o[0],d=o[1],c=r,h=a[0],p=a[1],f=a[2],Aj,t),t.point(u,d)}function x(){m.point=g,t.lineEnd()}function b(){v(),m.point=_,m.lineEnd=w}function _(e,t){y(r=e,t),i=u,a=d,o=h,s=p,l=f,m.point=y}function w(){n(u,d,c,h,p,f,i,a,r,o,s,l,Aj,t),m.lineEnd=x,x()}return m}}(e,t):function(e){return hj({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var Rj=hj({point:function(e,t){this.stream.point(e*Mz,t*Mz)}});function Oj(e,t,n,r,i,a){if(!a)return function(e,t,n,r,i){function a(a,o){return[t+e*(a*=r),n-e*(o*=i)]}return a.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},a}(e,t,n,r,i);var o=Cz(a),s=Oz(a),l=o*e,c=s*e,u=o/e,d=s/e,h=(s*n-o*t)/e,p=(s*t+o*n)/e;function f(e,a){return[l*(e*=r)-c*(a*=i)+t,n-c*e-l*a]}return f.invert=function(e,t){return[r*(u*e-d*t+h),i*(p-d*e-u*t)]},f}function Dj(e){return function(e){var t,n,r,i,a,o,s,l,c,u,d=150,h=480,p=250,f=0,m=0,g=0,v=0,y=0,x=0,b=1,_=1,w=null,S=sj,M=null,E=dj,T=.5;function A(e){return l(e[0]*Mz,e[1]*Mz)}function C(e){return(e=l.invert(e[0],e[1]))&&[e[0]*Sz,e[1]*Sz]}function P(){var e=Oj(d,0,0,b,_,x).apply(null,t(f,m)),r=Oj(d,h-e[0],p-e[1],b,_,x);return n=Fz(g,v,y),s=kz(t,r),l=kz(n,s),o=Pj(s,T),R()}function R(){return c=u=null,A}return A.stream=function(e){return c&&u===e?c:c=Rj(function(e){return hj({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(S(o(E(u=e)))))},A.preclip=function(e){return arguments.length?(S=e,w=void 0,R()):S},A.postclip=function(e){return arguments.length?(E=e,M=r=i=a=null,R()):E},A.clipAngle=function(e){return arguments.length?(S=+e?function(e){var t=Cz(e),n=2*Mz,r=t>0,i=Ez(t)>vz;function a(e,n){return Cz(e)*Cz(n)>t}function o(e,n,r){var i=[1,0,0],a=Jz($z(e),$z(n)),o=Zz(a,a),s=a[0],l=o-s*s;if(!l)return!r&&e;var c=t*o/l,u=-t*s/l,d=Jz(i,a),h=ej(i,c);Qz(h,ej(a,u));var p=d,f=Zz(h,p),m=Zz(p,p),g=f*f-m*(Zz(h,h)-1);if(!(g<0)){var v=Iz(g),y=ej(p,(-f-v)/m);if(Qz(y,h),y=Kz(y),!r)return y;var x,b=e[0],_=n[0],w=e[1],S=n[1];_<b&&(x=b,b=_,_=x);var M=_-b,E=Ez(M-xz)<vz;if(!E&&S<w&&(x=w,w=S,S=x),E||M<vz?E?w+S>0^y[1]<(Ez(y[0]-b)<vz?w:S):w<=y[1]&&y[1]<=S:M>xz^(b<=y[0]&&y[0]<=_)){var T=ej(p,(-f+v)/m);return Qz(T,h),[y,Kz(T)]}}}function s(t,n){var i=r?e:xz-e,a=0;return t<-i?a|=1:t>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return ij(a,(function(e){var t,n,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(d,h){var p,f=[d,h],m=a(d,h),g=r?m?0:s(d,h):m?s(d+(d<0?xz:-xz),h):0;if(!t&&(c=l=m)&&e.lineStart(),m!==l&&(!(p=o(t,f))||Gz(t,p)||Gz(f,p))&&(f[2]=1),m!==l)u=0,m?(e.lineStart(),p=o(f,t),e.point(p[0],p[1])):(p=o(t,f),e.point(p[0],p[1],2),e.lineEnd()),t=p;else if(i&&t&&r^m){var v;g&n||!(v=o(f,t,!0))||(u=0,r?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1],3)))}!m||t&&Gz(t,f)||e.point(f[0],f[1]),t=f,l=m,n=g},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return u|(c&&l)<<1}}}),(function(t,r,i,a){!function(e,t,n,r,i,a){if(n){var o=Cz(t),s=Oz(t),l=r*n;null==i?(i=t+r*wz,a=t-l/2):(i=lj(o,i),a=lj(o,a),(r>0?i<a:i>a)&&(i+=r*wz));for(var c,u=i;r>0?u>a:u<a;u-=l)c=Kz([o,-s*Cz(u),-s*Oz(u)]),e.point(c[0],c[1])}}(a,e,n,i,t,r)}),r?[0,-e]:[-xz,e-xz])}(w=e*Mz):(w=null,sj),R()):w*Sz},A.clipExtent=function(e){return arguments.length?(E=null==e?(M=r=i=a=null,dj):function(e,t,n,r){function i(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function a(i,a,s,c){var u=0,d=0;if(null==i||(u=o(i,s))!==(d=o(a,s))||l(i,a)<0^s>0)do{c.point(0===u||3===u?e:n,u>1?r:t)}while((u=(u+s+4)%4)!==d);else c.point(a[0],a[1])}function o(r,i){return Ez(r[0]-e)<vz?i>0?0:3:Ez(r[0]-n)<vz?i>0?2:1:Ez(r[1]-t)<vz?i>0?1:0:i>0?3:2}function s(e,t){return l(e.x,t.x)}function l(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var l,c,u,d,h,p,f,m,g,v,y,x=o,b=Vz(),_={point:w,lineStart:function(){_.point=S,c&&c.push(u=[]),v=!0,g=!1,f=m=NaN},lineEnd:function(){l&&(S(d,h),p&&g&&b.rejoin(),l.push(b.result())),_.point=w,g&&x.lineEnd()},polygonStart:function(){x=b,l=[],c=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=c.length;n<i;++n)for(var a,o,s=c[n],l=1,u=s.length,d=s[0],h=d[0],p=d[1];l<u;++l)a=h,o=p,h=(d=s[l])[0],p=d[1],o<=r?p>r&&(h-a)*(r-o)>(p-o)*(e-a)&&++t:p<=r&&(h-a)*(r-o)<(p-o)*(e-a)&&--t;return t}(),n=y&&t,i=(l=rj(l)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&Xz(l,s,t,a,o),o.polygonEnd()),x=o,l=c=u=null}};function w(e,t){i(e,t)&&x.point(e,t)}function S(a,o){var s=i(a,o);if(c&&u.push([a,o]),v)d=a,h=o,p=s,v=!1,s&&(x.lineStart(),x.point(a,o));else if(s&&g)x.point(a,o);else{var l=[f=Math.max(uj,Math.min(cj,f)),m=Math.max(uj,Math.min(cj,m))],b=[a=Math.max(uj,Math.min(cj,a)),o=Math.max(uj,Math.min(cj,o))];!function(e,t,n,r,i,a){var o,s=e[0],l=e[1],c=0,u=1,d=t[0]-s,h=t[1]-l;if(o=n-s,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<u&&(u=o)}else if(d>0){if(o>u)return;o>c&&(c=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>u)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<u&&(u=o)}if(o=r-l,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<u&&(u=o)}else if(h>0){if(o>u)return;o>c&&(c=o)}if(o=a-l,h||!(o<0)){if(o/=h,h<0){if(o>u)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<u&&(u=o)}return c>0&&(e[0]=s+c*d,e[1]=l+c*h),u<1&&(t[0]=s+u*d,t[1]=l+u*h),!0}}}}}(l,b,e,t,n,r)?s&&(x.lineStart(),x.point(a,o),y=!1):(g||(x.lineStart(),x.point(l[0],l[1])),x.point(b[0],b[1]),s||x.lineEnd(),y=!1)}f=a,m=o,g=s}return _}}(M=+e[0][0],r=+e[0][1],i=+e[1][0],a=+e[1][1]),R()):null==M?null:[[M,r],[i,a]]},A.scale=function(e){return arguments.length?(d=+e,P()):d},A.translate=function(e){return arguments.length?(h=+e[0],p=+e[1],P()):[h,p]},A.center=function(e){return arguments.length?(f=e[0]%360*Mz,m=e[1]%360*Mz,P()):[f*Sz,m*Sz]},A.rotate=function(e){return arguments.length?(g=e[0]%360*Mz,v=e[1]%360*Mz,y=e.length>2?e[2]%360*Mz:0,P()):[g*Sz,v*Sz,y*Sz]},A.angle=function(e){return arguments.length?(x=e%360*Mz,P()):x*Sz},A.reflectX=function(e){return arguments.length?(b=e?-1:1,P()):b<0},A.reflectY=function(e){return arguments.length?(_=e?-1:1,P()):_<0},A.precision=function(e){return arguments.length?(o=Pj(s,T=e*e),R()):Iz(T)},A.fitExtent=function(e,t){return Tj(A,e,t)},A.fitSize=function(e,t){return function(e,t,n){return Tj(e,[[0,0],t],n)}(A,e,t)},A.fitWidth=function(e,t){return function(e,t,n){return Ej(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];e.scale(150*i).translate([a,o])}),n)}(A,e,t)},A.fitHeight=function(e,t){return function(e,t,n){return Ej(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,o])}),n)}(A,e,t)},function(){return t=e.apply(this,arguments),A.invert=t.invert&&C,P()}}((function(){return e}))()}function Ij(e,t){return[e,Rz(Lz((bz+t)/2))]}Ij.invert=function(e,t){return[e,2*Tz(Pz(t))-bz]};var Lj=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const Nj="glb_files",kj=()=>new Promise(((e,t)=>{const n=indexedDB.open("glb_cache_db",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(Nj)||t.createObjectStore(Nj,{keyPath:"key"})}})),Uj=e=>{console.log("🚀 Type4 Component - Props:",e);const[t,i]=(0,r.useState)(!1),[a,o]=(0,r.useState)(null),s=(PF()||"").trim(),[l,c]=(0,r.useState)((()=>"undefined"==typeof window?"ru":localStorage.getItem("custom_locale")||"ru"));(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("custom_locale")||"ru";c(e)};e(),window.addEventListener("storage",e);const t=setInterval(e,250);return()=>{window.removeEventListener("storage",e),clearInterval(t)}}),[]);const u=(0,r.useRef)(null),d=(0,r.useRef)(null),h=(0,r.useRef)(null),p=(0,r.useRef)(null),f=(0,r.useRef)(null),m=(0,r.useRef)(null),g=(0,r.useRef)(null),v=(0,r.useRef)([]),y=(0,r.useRef)(null),x=(0,r.useRef)(new ho),b=(0,r.useRef)(new ot),_=(0,r.useRef)(null);(0,r.useEffect)((()=>(console.log("🚀 Initializing Type4 3D scene",{damName:s}),w(),()=>{console.log("🧹 Cleaning up Type4 3D scene on unmount"),g.current&&g.current.cancel("Operation canceled by the user."),S()})),[e.isDark,s]),(0,r.useEffect)((()=>{const e=()=>{if(h.current&&p.current&&u.current){const e=u.current.clientWidth,t=u.current.clientHeight;p.current.aspect=e/t,p.current.updateProjectionMatrix(),h.current.setSize(e,t)}};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,r.useEffect)((()=>{if(d.current){const t=e.isDark?1052955:15790320;d.current.background=new Jn(t)}}),[e.isDark]);const w=()=>Lj(void 0,void 0,void 0,(function*(){var e;if(u.current){if(S(),!s)return i(!1),void o(IF("selectDam",l));i(!0),o(null),g.current&&g.current.cancel("Operation canceled due to new request."),g.current=jh.CancelToken.source();try{M();const e=`glb_${s}_type4`,t=yield(e=>Lj(void 0,void 0,void 0,(function*(){try{const t=yield kj();return new Promise(((n,r)=>{const i=t.transaction([Nj],"readonly").objectStore(Nj).get(e);i.onsuccess=()=>{const e=i.result;if(e&&e.data)try{const t="string"==typeof e.data?JSON.parse(e.data):e.data;n(t)}catch(e){n(null)}else n(null)},i.onerror=()=>r(i.error)}))}catch(e){return console.warn("Failed to read from cache:",e),null}})))(e);if(t)return console.log("✅ Found cached GeoJSON file, loading from cache"),void(d.current?(E(t),console.log("✅ GeoJSON isolines loaded from cache successfully"),i(!1),o(null)):(console.warn("⚠️ Scene not available for processing isolines"),i(!1),o("Scene not initialized")));console.log("📡 Cache miss, fetching from API..."),console.log("🗑️ Deleting previous type4 cache entries..."),yield("type4",Lj(void 0,void 0,void 0,(function*(){try{const e=yield kj();return new Promise(((t,n)=>{const r=e.transaction([Nj],"readwrite").objectStore(Nj),i=r.openCursor(),a=[];i.onsuccess=e=>{const n=e.target.result;if(n){const e=n.key;e&&"string"==typeof e&&e.endsWith("_type4")&&a.push(e),n.continue()}else{if(0===a.length)return void t();let e=0;a.forEach((n=>{const i=r.delete(n);i.onsuccess=()=>{e++,e===a.length&&t()},i.onerror=()=>{e++,e===a.length&&t()}}))}},i.onerror=()=>n(i.error)}))}catch(e){console.warn("Failed to delete cache entries by type:",e)}})));const n=encodeURIComponent(s),r=yield jh.get(`https://api-dam3d.spacemc.uz/core/3d-models/by-dam/${n}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},cancelToken:g.current.token});let a=r.data;Array.isArray(a)&&a.length>0&&(a=a[0]),console.log("🔍 Type4 API Response:",r.data),console.log("🔍 Parsed response data:",a),console.log("🔍 Available fields:",Object.keys(a||{}));const c=null==a?void 0:a.geojson_file_type_4;if(console.log("🔍 Type4 GeoJSON File URL:",c),!c)return console.log("❌ Type4: No GeoJSON file URL found in response"),console.log("❌ Response data:",r.data),i(!1),void o(IF("noDataForDam",l));const u=c.replace(/^http:/,"https:");console.log("🔒 Secure GeoJSON File URL:",u);const h=(yield jh.get(u,{headers:{Authorization:`Bearer ${localStorage.getItem("jwtToken")}`},cancelToken:g.current.token})).data;console.log("💾 Saving GeoJSON file to cache..."),yield((e,t)=>Lj(void 0,void 0,void 0,(function*(){try{const n=yield kj();return new Promise(((r,i)=>{const a=n.transaction([Nj],"readwrite").objectStore(Nj).put({key:e,data:JSON.stringify(t),timestamp:Date.now()});a.onsuccess=()=>r(),a.onerror=()=>i(a.error)}))}catch(e){console.warn("Failed to write to cache:",e)}})))(e,h),console.log("✅ GeoJSON file cached successfully"),h&&h.features&&Array.isArray(h.features)&&h.features.length>0?d.current?(E(h),console.log("✅ GeoJSON isolines loaded successfully"),i(!1),o(null)):(console.warn("⚠️ Scene not available for processing isolines"),i(!1),o("Scene not initialized")):(console.warn("⚠️ Invalid GeoJSON data received"),i(!1),o("Invalid GeoJSON data"))}catch(t){jh.isCancel(t)?console.log("Request canceled:",t.message):(console.error("❌ Error fetching GeoJSON:",t),jh.isAxiosError(t)&&404===(null===(e=t.response)||void 0===e?void 0:e.status)?o(IF("noDataForDam",l)):o(t instanceof Error?t.message:IF("errorLoadingModel",l)),i(!1))}}else console.log("❌ Container ref not available")})),S=()=>{var e,t;m.current&&(cancelAnimationFrame(m.current),m.current=null),f.current&&(f.current.dispose(),f.current=null),(null===(e=h.current)||void 0===e?void 0:e.domElement)&&(null===(t=u.current)||void 0===t?void 0:t.contains(h.current.domElement))&&u.current.removeChild(h.current.domElement),h.current&&(h.current.dispose(),h.current=null),d.current&&(d.current.clear(),d.current=null),p.current=null,v.current=[]},M=()=>{if(!u.current)return void console.warn("⚠️ Container ref not available");const t=u.current,n=t.clientWidth||800,r=t.clientHeight||600;if(console.log("📐 Container size:",{width:n,height:r}),0===n||0===r)return console.warn("⚠️ Container has zero size, retrying in 100ms"),void setTimeout((()=>M()),100);const i=new Kr,a=e.isDark?1052955:15790320;i.background=new Jn(a),d.current=i;const o=n/r||1.33,s=new Br(60,o,.1,1e5);s.position.set(0,100,100),s.lookAt(0,0,0),p.current=s,console.log("📷 Camera initialized:",{aspect:o,position:{x:s.position.x,y:s.position.y,z:s.position.z},near:s.near,far:s.far}),h.current&&(h.current.domElement&&t.contains(h.current.domElement)&&t.removeChild(h.current.domElement),h.current.dispose(),h.current=null);const l=new dc({antialias:!0});l.setPixelRatio(Math.min(window.devicePixelRatio,2)),l.setSize(n,r),h.current=l,t.appendChild(l.domElement);const c=new Ja(16777215,1);i.add(c);const m=new Za(16777215,1);m.position.set(10,10,5),i.add(m);const g=new mu(s,l.domElement);g.enableDamping=!0,g.dampingFactor=.05,g.screenSpacePanning=!1,g.minDistance=50,g.maxDistance=1e4,g.target.set(0,0,0),f.current=g,l.domElement.addEventListener("mousemove",(e=>{var t;if(!h.current||!p.current||!u.current)return;const n=u.current.getBoundingClientRect();b.current.x=(e.clientX-n.left)/n.width*2-1,b.current.y=-(e.clientY-n.top)/n.height*2+1,x.current.setFromCamera(b.current,p.current);const r=x.current.intersectObjects(v.current,!1);if(r.length>0){const e=r[0].object;if(e!==y.current&&(y.current&&y.current.material.color.set(10526880),y.current=e,e.material.color.set(16776960),_.current&&void 0!==(null===(t=e.userData.props)||void 0===t?void 0:t.Contour))){const t=e.userData.props.Contour,n=_.current.querySelector("div:last-child");n&&(n.textContent=`${t} m`)}}else if(y.current&&(y.current.material.color.set(10526880),y.current=null,_.current)){const e=_.current.querySelector("div:last-child");e&&(e.textContent="--")}})),T(),console.log("✅ Type4 Three.js scene initialized successfully")},E=e=>{var t;if(!d.current)return void console.warn("⚠️ Scene not available for processing isolines");v.current.forEach((e=>{var t;null===(t=d.current)||void 0===t||t.remove(e),e.geometry.dispose(),e.material instanceof tr&&e.material.dispose()})),v.current=[];const n=(e=>{let t=0,n=0,r=0;for(const i of e.features)if("LineString"===i.geometry.type&&i.geometry.coordinates)for(const e of i.geometry.coordinates)t+=e[0],n+=e[1],r++;return 0===r?[0,0]:[t/r,n/r]})(e);console.log("📍 GeoJSON center:",n);const r=function(e){var t,n,r,i=Dj(e),a=i.center,o=i.scale,s=i.translate,l=i.clipExtent,c=null;function u(){var a=xz*o(),s=i(function(e){function t(t){return(t=e(t[0]*Mz,t[1]*Mz))[0]*=Sz,t[1]*=Sz,t}return e=Fz(e[0]*Mz,e[1]*Mz,e.length>2?e[2]*Mz:0),t.invert=function(t){return(t=e.invert(t[0]*Mz,t[1]*Mz))[0]*=Sz,t[1]*=Sz,t},t}(i.rotate()).invert([0,0]));return l(null==c?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:e===Ij?[[Math.max(s[0]-a,c),t],[Math.min(s[0]+a,n),r]]:[[c,Math.max(s[1]-a,t)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(e){return arguments.length?(o(e),u()):o()},i.translate=function(e){return arguments.length?(s(e),u()):s()},i.center=function(e){return arguments.length?(a(e),u()):a()},i.clipExtent=function(e){return arguments.length?(null==e?c=t=n=r=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),u()):null==c?null:[[c,t],[n,r]]},u()}(Ij).scale(961/wz).translate([0,0]).center(n).scale(63781.37);let i=1/0,a=-1/0,o=1/0,s=-1/0,l=1/0,c=-1/0;for(let n=0;n<e.features.length;n++){const u=e.features[n];if("LineString"!==u.geometry.type)continue;const h=[];for(const e of u.geometry.coordinates){const[n,d]=r(e),p=(null===(t=u.properties)||void 0===t?void 0:t.Contour)||0;h.push(n,p,d),i=Math.min(i,n),a=Math.max(a,n),o=Math.min(o,p),s=Math.max(s,p),l=Math.min(l,d),c=Math.max(c,d)}if(0===h.length)continue;const p=new vr;p.setAttribute("position",new cr(h,3));const f=new Oi({color:10526880,linewidth:2}),m=new zi(p,f);m.userData.props=u.properties,d.current.add(m),v.current.push(m)}if(console.log("📊 Isolines bounds:",{x:[i,a],y:[o,s],z:[l,c],size:{x:a-i,y:s-o,z:c-l}}),v.current.length>0&&p.current&&f.current){const e=new Dt;v.current.forEach((t=>{e.expandByObject(t)}));const t=e.getSize(new lt),n=e.getCenter(new lt),r=Math.max(t.x,t.y,t.z);console.log("📐 3D Bounds:",{center:{x:n.x,y:n.y,z:n.z},size:{x:t.x,y:t.y,z:t.z},maxDimension:r});const i=1.5*r;p.current.position.set(n.x+.7*i,n.y+1.2*i,n.z+.7*i),p.current.lookAt(n),p.current.updateProjectionMatrix(),f.current.target.copy(n),f.current.update(),console.log("📷 Camera position:",{x:p.current.position.x,y:p.current.position.y,z:p.current.position.z}),console.log("✅ Isolines processed:",v.current.length,"lines")}else console.warn("⚠️ Cannot auto-frame: missing scene, camera, controls, or isolines")},T=()=>{m.current=requestAnimationFrame(T),f.current&&f.current.update(),h.current&&d.current&&p.current&&h.current.render(d.current,p.current)};return console.log("🎨 Rendering Type4 component with state:",{damType:e.damType,isolinesCount:v.current.length,sceneExists:!!d.current}),(0,n.jsx)("div",{className:"type4-component "+(e.isDark?"dark":""),style:{width:"100%",height:"100%",position:"relative"}},(0,n.jsx)("div",{ref:_,style:{position:"absolute",bottom:"30px",left:"50%",transform:"translateX(-50%)",padding:"16px 32px",background:e.isDark?"linear-gradient(135deg, rgba(16, 17, 27, 0.95) 0%, rgba(30, 32, 48, 0.95) 100%)":"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%)",color:e.isDark?"#fff":"#1e293b",borderRadius:"16px",fontSize:"18px",fontWeight:"600",letterSpacing:"0.5px",zIndex:1e3,boxShadow:e.isDark?"0 8px 32px rgba(0, 0, 0, 0.4), 0 2px 8px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"0 8px 32px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.8)",backdropFilter:"blur(12px)",border:e.isDark?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(0, 0, 0, 0.08)",minWidth:"200px",textAlign:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"}},(0,n.jsx)("div",{style:{fontSize:"12px",fontWeight:"500",opacity:.7,marginBottom:"4px",textTransform:"uppercase",letterSpacing:"1px"}},"uz"===l?"Balandlik":"uzcryl"===l?"Баландлик":"Высота"),(0,n.jsx)("div",{style:{fontSize:"24px",fontWeight:"700",background:e.isDark?"linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%)":"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"}},"--")),t&&(0,n.jsx)("div",{className:"loading",css:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"none"}},(0,n.jsx)("div",{className:"loading-spinner-modern"},(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"}),(0,n.jsx)("div",{className:"spinner-ring"}))),a&&(0,n.jsx)("div",{className:"error-message",css:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"auto"}},(0,n.jsx)("div",{className:"error-content"},(0,n.jsx)("div",{className:"error-icon-wrapper"},(0,n.jsx)("svg",{className:"error-icon-svg",width:"80",height:"80",viewBox:"0 0 46 42",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.jsx)("path",{d:"M28.1746 3.16754C27.6273 2.20563 26.8349 1.40582 25.8782 0.849456C24.9215 0.293087 23.8345 0 22.7278 0C21.621 0 20.5341 0.293087 19.5773 0.849456C18.6206 1.40582 17.8283 2.20563 17.281 3.16754L0.785217 32.5569C0.261401 33.4791 -0.00939594 34.5235 0.000248916 35.5841C0.00989377 36.6447 0.299638 37.6839 0.840139 38.5965C1.38858 39.538 2.17614 40.3178 3.12302 40.857C4.0699 41.3961 5.14246 41.6753 6.23203 41.6665H39.2235C40.3131 41.6753 41.3857 41.3961 42.3325 40.857C43.2794 40.3178 44.067 39.538 44.6154 38.5965C45.1559 37.6839 45.4457 36.6447 45.4553 35.5841C45.465 34.5235 45.1942 33.4791 44.6703 32.5569L28.1746 3.16754ZM41.3466 36.6893C41.1285 37.0567 40.8174 37.3601 40.4447 37.5689C40.0719 37.7777 39.6507 37.8846 39.2235 37.8787H6.23203C5.80428 37.884 5.3827 37.7763 5.00992 37.5665C4.63713 37.3566 4.32635 37.0521 4.10899 36.6836C3.90296 36.3412 3.79237 35.9498 3.7887 35.5502C3.78504 35.1505 3.88844 34.7572 4.08815 34.411L20.5839 5.01976C20.8176 4.6646 21.1358 4.37305 21.51 4.17131C21.8842 3.96957 22.3027 3.86395 22.7278 3.86395C23.1529 3.86395 23.5714 3.96957 23.9456 4.17131C24.3198 4.37305 24.638 4.6646 24.8717 5.01976L41.3674 34.4091C41.5675 34.7555 41.6711 35.1492 41.6674 35.5492C41.6638 35.9492 41.553 36.341 41.3466 36.6836V36.6893Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 11.3643C22.2255 11.3643 21.7438 11.5638 21.3886 11.919C21.0334 12.2742 20.8339 12.7559 20.8339 13.2582V24.6215C20.8339 25.1238 21.0334 25.6055 21.3886 25.9607C21.7438 26.3158 22.2255 26.5154 22.7278 26.5154C23.2301 26.5154 23.7118 26.3158 24.067 25.9607C24.4221 25.6055 24.6217 25.1238 24.6217 24.6215V13.2582C24.6217 12.7559 24.4221 12.2742 24.067 11.919C23.7118 11.5638 23.2301 11.3643 22.7278 11.3643Z",fill:"#F0C039"}),(0,n.jsx)("path",{d:"M22.7278 34.0909C23.7737 34.0909 24.6217 33.243 24.6217 32.197C24.6217 31.1511 23.7737 30.3031 22.7278 30.3031C21.6818 30.3031 20.8339 31.1511 20.8339 32.197C20.8339 33.243 21.6818 34.0909 22.7278 34.0909Z",fill:"#F0C039"}))),(0,n.jsx)("div",{className:"error-title"},a),a===IF("selectDam",l)&&(0,n.jsx)("div",{className:"error-description"},"uz"===l?"3D modelni ko'rish uchun suv omborini tanlang":"uzcryl"===l?"3D моделни кўриш учун сув омборини танланг":"Пожалуйста, выберите водохранилище для просмотра 3D модели"),a===IF("noDataForDam",l)&&(0,n.jsx)("div",{className:"error-description"},"uz"===l?"Ushbu suv ombori uchun 3D model mavjud emas":"uzcryl"===l?"Ушбу сув омбори учун 3D модель мавжуд эмас":"Для этого водохранилища 3D модель недоступна"),a!==IF("selectDam",l)&&a!==IF("noDataForDam",l)&&(0,n.jsx)("div",null,(0,n.jsx)("div",{className:"error-description"},IF("errorLoadingModel",l)),(0,n.jsx)("button",{className:"retry-button",onClick:()=>w()},IF("retry",l))))),(0,n.jsx)("div",{className:"container-3d",ref:u,style:{width:"100%",height:"100%",minHeight:"400px"}}))};const Fj="glb_files",zj=()=>function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){try{const e=yield new Promise(((e,t)=>{const n=indexedDB.open("glb_cache_db",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(Fj)||t.createObjectStore(Fj,{keyPath:"key"})}}));return new Promise(((t,n)=>{const r=e.transaction([Fj],"readwrite").objectStore(Fj).clear();r.onsuccess=()=>{t()},r.onerror=()=>n(r.error)}))}catch(e){}})),jj=e=>{e.config;const[t,i]=(0,r.useState)("undefined"!=typeof window&&localStorage.getItem("customTheme")||"light"),a="dark"===t,[o,s]=(0,r.useState)((()=>"undefined"==typeof window?"ru":localStorage.getItem("custom_locale")||"ru"));(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("custom_locale")||"ru";s(e)};e(),window.addEventListener("storage",e);const t=setInterval(e,250);return()=>{window.removeEventListener("storage",e),clearInterval(t)}}),[]),(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=()=>{const e=localStorage.getItem("customTheme")||"light";i((t=>t===e?t:e))};e(),window.addEventListener("storage",e),window.addEventListener("theme-changed",e);const t=window.setInterval(e,250);return()=>{window.removeEventListener("storage",e),window.removeEventListener("theme-changed",e),clearInterval(t)}}),[]);const l={"Тип 1":{name:"Тип 1",waterLevel:390,waterVolume:165e6,surfaceArea:19.5,description:"Basic 3D Dam Model with Line Drawing"},"Тип 2":{name:"Тип 2",waterLevel:395,waterVolume:174920126.3,surfaceArea:20.643,description:"Advanced 3D Dam Model with Water Level Control"},"Тип 3":{name:"Тип 3",waterLevel:400,waterVolume:185e6,surfaceArea:22.1,description:"High Detail Dam Model"},"Тип 4":{name:"Тип 4",waterLevel:405,waterVolume:19e7,surfaceArea:23.5,description:"Isolines Visualization"}},c=(0,r.useMemo)((()=>"undefined"==typeof window?"Тип 1":(e=>e&&Object.prototype.hasOwnProperty.call(l,e)?e:"Тип 1")(localStorage.getItem("currentDamType"))),[]),[u,d]=(0,r.useState)(c),h=l[c],[p,f]=(0,r.useState)(h.waterLevel),[m,g]=(0,r.useState)(h.waterVolume),[v,y]=(0,r.useState)(h.surfaceArea),[x,b]=(0,r.useState)([]),[_,w]=(0,r.useState)([]),[S,M]=(0,r.useState)(!1),[E,T]=(0,r.useState)(null),A=PF(),C=(0,r.useRef)(null),P=(0,r.useRef)(!0);(0,r.useEffect)((()=>{if(P.current)return C.current=A||"",void(P.current=!1);if(!A||C.current===A)return;const e=l["Тип 1"];d("Тип 1"),f(e.waterLevel),g(e.waterVolume),y(e.surfaceArea),b([]),w([]),T(null),M(!1),zj().catch((()=>{})),C.current=A}),[A]),(0,r.useEffect)((()=>{"undefined"!=typeof window&&localStorage.setItem("currentDamType",u)}),[u]);const R=e=>{f(e)},O=e=>{g(e)},D=e=>{y(e)},I=e=>{w(e)},L=e=>e?"number"==typeof e.x&&"number"==typeof e.y?{x:e.x,y:e.y,z:"number"==typeof e.z?e.z:0}:"function"==typeof e.getComponent?{x:e.getComponent(0),y:e.getComponent(1),z:e.getComponent(2)}:{x:0,y:0,z:0}:{x:0,y:0,z:0},N=e=>{const t=e.map(L),n={id:Date.now(),points:t,damType:u,timestamp:(new Date).toISOString(),waterLevel:p,waterVolume:m,surfaceArea:v};b((e=>[...e,n])),T(n)},k=()=>{E&&M(!0)},U=()=>{M(!1)},F=()=>{b([]),w([]),T(null),M(!1)},z=(x.some((e=>"Тип 1"===(null==e?void 0:e.damType)&&Array.isArray(null==e?void 0:e.points)&&e.points.length>=2)),e=>{const t={"Тип 1":"type1","Тип 2":"type2","Тип 3":"type3","Тип 4":"type4"}[e];return t?((e,t)=>{const n=t||"undefined"!=typeof window&&localStorage.getItem("custom_locale")||"ru",r=DF[e];return r&&(r[n]||r.ru)||e})(t,o):e});return(0,n.jsx)("div",{className:"widget-3d-dams jimu-widget "+(a?"dark-theme":"light-theme")},(0,n.jsx)("div",{className:"top-right-controls"},(0,n.jsx)("div",{className:"type-selection"},Object.keys(l).map((e=>(0,n.jsx)("button",{key:e,className:"type-button "+(e===u?"active":""),onClick:()=>(e=>{const t=l[e];d(e),f(t.waterLevel),g(t.waterVolume),y(t.surfaceArea),"Тип 1"!==e&&(S&&M(!1),b((e=>e.filter((e=>"Тип 1"!==(null==e?void 0:e.damType))))),w([]),"Тип 1"===(null==E?void 0:E.damType)&&T(null))})(e)},z(e)))))),(()=>{const r={damType:u,waterLevel:p,waterVolume:m,surfaceArea:v,onWaterLevelChange:R,onWaterVolumeChange:O,onSurfaceAreaChange:D,context:e.context,currentLinePoints:_,onLinePointsChange:I,onLineCompleted:N,drawnLines:x,lastLineData:E,showChart:S,onShowChart:k,onCloseChart:U,onClearAllLines:F,isDark:a,theme:t};switch(u){case"Тип 1":default:return(0,n.jsx)(zF,Object.assign({},r));case"Тип 2":return(0,n.jsx)(az,Object.assign({},r));case"Тип 3":return(0,n.jsx)(gz,Object.assign({},r));case"Тип 4":return(0,n.jsx)(Uj,Object.assign({},r))}})())};function Bj(e){s.p=e}})(),l})())}}}));